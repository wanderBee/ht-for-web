!function(H,r,J){"use strict";function Q(){this.el=[1,0,0,0,1,0,0,0,1]}var l="ht";if(!H[l]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),H.performance&&H.performance.now||function(){var o=Date.now();H.performance||(H.performance={}),H.performance.now=function(){return Date.now()-o}}();for(var _=Date.now(),E=16,m=["ms","moz","webkit","o"],g=0;g<m.length&&!H.requestAnimationFrame;++g)H.requestAnimationFrame=H[m[g]+"RequestAnimationFrame"],H.cancelAnimationFrame=H[m[g]+"CancelAnimationFrame"]||H[m[g]+"CancelRequestAnimationFrame"];H.requestAnimationFrame||(H.requestAnimationFrame=function(z){var r=Date.now(),a=E+_-r;return 0>a&&(a=0),_=r,H.setTimeout(function(){_=Date.now(),z(performance.now())},a)}),H.cancelAnimationFrame||(H.cancelAnimationFrame=function(O){return H.clearTimeout(O)}),r.assign===J&&(r.assign=function(z){if(z===J||null===z)throw new TypeError("Cannot convert undefined or null to object");for(var Y=r(z),S=1;S<arguments.length;S++){var V=arguments[S];if(V!==J&&null!==V)for(var F in V)r.prototype.hasOwnProperty.call(V,F)&&(Y[F]=V[F])}return Y})}();var b=H.document,d=null,P=H[l]={},o=H[l+"config"],F=P.Default=o&&o.Default||{},S=P.Style=o&&o.Style||{},y=P.Attr=o&&o.Attr||{},s=P.Color=o&&o.Color||{},q=P.IsGetter=o&&o.IsGetter||{};!function(){var u=!1;try{var g=r.defineProperty({},"passive",{get:function(){u=!0}});H.addEventListener("test",g,g),H.removeEventListener("test",g,g)}catch(X){u=!1}F.passiveSupported=u}();var t,R,Y,g,u=F.passiveSupported,N=F.eventListenerOptionsFalse=u?{passive:!1,capture:!1}:!1,c=F.eventListenerOptionsTrue=u?{passive:!1,capture:!0}:!0,$=Math,E=$.round,A=$.floor,n=$.ceil,w=$.sqrt,T=$.max,e=$.min,j=$.abs,v=$.cos,X=$.acos,Z=$.sin,D=$.pow,O=$.asin,M=$.PI,p=2*M,L=M/2,V=$.tan,k=$.atan2,B=$.random,I=$.log,U=!1,a=!1,W=H.parseInt||global.parseInt,m="2019-09-22",G=H.navigator?H.navigator.platform.indexOf("Win")>-1:!1,x=function(T){return T*T},_=H.setTimeout,i=H.clearTimeout,z=H.location,h=H.navigator?H.navigator.userAgent.toLowerCase():"",C=function(f){return f.test(h)},K=C(/msie/),f=C(/msie/)||C(/trident/),wg=C(/msie 10/),mr=C(/edge/),ql=C(/firefox/),fi=C(/mac/),Qr=F.isTouchable===J?G?!1:b?"ontouchend"in b:!1:F.isTouchable,Cq="default",gq="single",Pk="multiple",Sg="front",sl="back",Km="left",_i="right",ai="top",el="bottom",Qh="center",ds="eye",Pl="middle",Oq="east",eb="west",hq="north",xj="none",Cf="px",vc="absolute",Um="border",Ig="triangle",hp="rect",To="circle",_q="cylinder",zd="shape",Mh="items",Bd="normal",hb="remove",Ng="clear",ib="width",Kq="height",Bg="ingroup",Sb="check",Sf="uncheck",Mb="radio",Lq="radioOn",Pc="radioOff",of="points",Ck="values",_k="series",Zi="body",Re="label",Jj="label2",tb="note",yp="note2",zo="icons",Tk="labelFont",Dk="labelColor",Ih="labelSelectColor",Ac="note.expanded",tf="note2.expanded",Oo="edge.expanded",Zk="edge.points",lc="edge.type",wj="rotation",op="hidden",Tl="visible",Fc="tuv",ks="no",Wo="draw",$i="select",ch="currentSubGraph",sk="selectBackground",eg="autoMakeVisible",Ui="autoHideScrollBar",Rj="scrollBarColor",Nr="scrollBarSize",Lj="indent",hl="rowHeight",Og="columnLineColor",re="rowLineColor",yb="columnLineVisible",Gl="rowLineVisible",oo="visibleFunc",$p="expandIcon",Jq="collapseIcon",fp="checkMode",mn="sortFunc",kk="editable",Mf="batchEditable",il="tristate",Wq="asc",dh="desc",Or="position",jm="elevation",Gm="children",gl="translateX",qk="translateY",Lr="dataModel",Cd="maxSize",ig="state",Fq="shape3d",Ij="shape3d.resolution",fm="shape3d.visible",Fh="shape3d.from.visible",sg="shape3d.to.visible",tq="shape3d.top.visible",sj="shape3d.bottom.visible",np="repeat.uv.length",al="serializeValue",wr="deserializeValue",Pg="centerUniform",mg="uniform",Ve="rgba(255,255,255,0)",Rm="style",pd="attr",ol="field",Ye="string",Rb="boolean",te="color",ij="int",ml="number",lo="ew-resize",Wj="ns-resize",Ob="pointer",lk="auto",Uq="mousedown",Br="mousemove",Kf="mouseup",hg="mouseout",kg="touchstart",ap="touchmove",Rr="touchend",jn="keydown",Jh="keyup",Yo=["DOMMouseScroll","mousewheel"],db=ql?Yo[0]:Yo[1],si=Qr?[kg,ap,Rr,jn,Jh,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[jn,Jh,"keypress","input",Uq,Br,Kf,hg,db,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Fn=d,cc=d,Hj=d,vq=Kf.length,Wh=function(){Hj&&(i(Hj.timeout),Hj=d)},Cm=function(){Hj&&oc(Hj.e,Hj.info)};H.addEventListener&&(Qr||(H.addEventListener(hg,function(){Wh()},N),H.addEventListener(db,function(){de()},N)),H.addEventListener(Jh,function(S){91===S.keyCode?js={}:delete js[S.keyCode]},c),H.addEventListener(jn,function(l){js[l.keyCode]=!0},c),H.addEventListener("blur",function(){js={}},N));var Am,pk,vi,$m=0,Jr=d,Cr=function(w,c){var Q=_(function(){delete Jr[Q],nf(Jr)&&(Jr=d),w()},c);return Q},_r=d,ad=d,_g={},yf={},Rn={},Bh={},Xo={},js={},Od={},wc={},Ym={},Wg={},uj=/.json$/,Zb=/^data:image\/svg\+xml/,ak={},Qd=[],tp={},Qk=d,Ko=d,Nk=function(){},sb=function(){throw"Oops!"},gg=[0,0,0],xp={x:0,y:0,width:0,height:0},Pq=d,gj=d,to=d,Im=function(A,c){yf[A]=c,c&&c.comps&&!c.uuid&&(c.uuid=P.Math.generateUUID()),Cc[A]&&(c.cacheRule=Cc[A],delete Cc[A])},kf=function(v){gj&&!v._72O&&(to||(to={}),to[v._72O=Wm()]=v),Am!=d?ef()<.05&&g&&!pk&&(zm=Wh):zm=dr},Ie=function(T,P,k,S){gj||(gj={});var D=gj[T];if(D){if(D.url===P)return;D.image?(D.image.onload=Nk,D.image.onerror=Nk):D.request&&(D.request.onload=Nk,D.request.onerror=Nk)}if(uj.test(P)){var $=new sf;if(gj[T]={request:$,url:P},P=F.beforeLoadURL(P),P.data){var j=F.parse(P.data);Ho(T,j),F.handleImageLoaded(T,j)}else{$.onload=function(){if(200===this.status||0===this.status){var G=F.parse($.getResponseText());Ho(T,G),F.handleImageLoaded(T,G)}else Ho(T,F.handleUnfoundImage(T,P)||d)},$.onerror=function(){Ho(T,F.handleUnfoundImage(T,P)||d)};var w={};w.url=encodeURI(P),w.sync=!1,$.send(w)}}else{var j=new Image;gj[T]={image:j,url:P},/^data:image/.test(P)||(P=F.beforeLoadURL(P),P=F.appendTimeStamp(P),P=encodeURI(P),F.crossOrigin&&(j.crossOrigin=F.crossOrigin)),F.convertImageSrc(P,function(R){f&&(P.toLowerCase().indexOf(".svg")>0||Zb.test(P))?(b.body.appendChild(j),j.style.visibility="hidden",j.onload=function(){_(function(){if(k&&(j.width=k),S&&(j.height=S),!j.width||!j.height){var t=j.width||j.clientWidth,G=j.height||j.clientHeight;j.width=t,j.height=G}F.handleImageLoaded(T,j),Ho(T,j),b.body.removeChild(j),j.style.visibility=""},180)},j.onerror=function(){Ho(T,F.handleUnfoundImage(T,P)||d),b.body.removeChild(j),j.style.visibility=""}):(j.onload=function(){k&&(j.width=k),S&&(j.height=S),F.handleImageLoaded(T,j),Ho(T,j)},j.onerror=function(){Ho(T,F.handleUnfoundImage(T,P)||d)}),j.src=R})}},Ho=function(T,$){if(Im(T,$),delete gj[T],nf(gj)&&(gj=d,to)){for(var Y in to){var m=to[Y];m._2O&&m._2O[T]&&(m.deleteTexture(T),delete m._2O[T]),m.invalidateAll&&m.invalidateAll(J,"imageLoaded",T),m.redraw&&m.redraw(),m.iv(),delete m._72O}to=d}if($&&to)for(var Y in to){var m=to[Y];m.invalidateAll&&m.invalidateAll(J,"imageLoading",T),m.redraw&&m.redraw(),m.iv()}},Ph=function(){return I=$&&Date,function(){return H.performance&&H.performance.now?H.performance.now():Date.now()}}(),In=function(O,J){J?i(O):H.cancelAnimationFrame(O)},ff=function(s,P,Z){return{width:s,height:P,comps:mo(Z)?Z:[Z]}},wh=function(w,E){return{type:To,rect:[w,E,1.6,1.6],borderWidth:1,borderColor:rg,gradient:Ib,gradientColor:Qe,background:rg}},dq=function(O,V){return ff(16,16,{type:Ig,rect:[4,4,10,8],background:O,rotation:V?1.57:3.14})},un=function(B,x){return ff(16,16,{type:Ig,rect:[4,4,8,7],background:B,rotation:x?3.14:0})},ki=function(U){var A=U._orientation;return"horizontal"===A||"h"===A},Bj=function(s,W){var G=d||4,b=d||1,f=d||1;0>G?G=0:G>.25&&(G=.25);var V,o,x,A,h,O,n,Q=.5,H=[],c=[],y=[],j=p/f,K=p/b,u=Q-G;for(o=0;b>=o;o++)for(A=-M+o*K,O=v(A),h=Z(A),V=0;f>=V;V++)x=V*j,n=u+G*O,H.push(v(x)*n,h*G,-Z(x)*n),(R=[s,W])&&c.push(V/f,1-o/b);for(o=0;b>o;o++){var z=o*(f+1),C=(o+1)*(f+1);for(V=0;f>V;V++)y.push(z+V,C+V+1,C+V,z+V,z+V+1,C+V+1),xh.z=Hl.z=[s,W]}},vr=function(Q){var o=2,A=0;for(var i in Q)i.length===o&&W(i,32)===Qm&&(Qk=Ko=Q[i]),A++;return A},Wn=function(Q,x,C,I){return C||(C=Qr?5:3,C/=I||1),{x:Q-C,y:x-C,width:2*C,height:2*C}},Ae=function(h,r,b,y){var m=this;r||(r=Qr?5:3,b=20,y=20);var L={x:h,y:r,width:b,height:y};if(b)for(var $=0;b>$;$++)if(3===b)y=20;else for(var I=0;y>I;I++)m=H?H:b;var c={x:M,y:2*M};if(mb(L,c)){var E=Kq[0]+ai[0]+Ng[1]+Wq.length,x=op[0]+il[0]+Ng[1]+Zi.length;Id[ds]=[m[E],m[x]],m[E]=Hb[ds],m[x]=Hb[Fq]}},Be=function(T){return(/ble$/.test(T)||/ed$/.test(T)||q[T]?"is":"get")+T.charAt(0).toUpperCase()+T.slice(1)},Hb=function(T){return"set"+T.charAt(0).toUpperCase()+T.slice(1)},Jp=function(R){return typeof R===Ye||R instanceof String},nq=function(M){return typeof M===ml},dr=function(N){return typeof N===Rb},yl=function(u){return u&&"object"==typeof u},sr=function(V){return"function"==typeof V},mo=function(A){return A instanceof Array},mc=function(Y){return Y instanceof nm},Zm=function(U){return mo(U)?new nm(U):U},Mp=function(p){return p instanceof wb},$k=function(G){return G instanceof ej},Cb=function(Y){return Y instanceof Gg},Vc=function(W,o){if(!(W instanceof P.Group))return!1;if(!o)return W.isExpanded();var f=o.getDataUI(W);return f&&f._88I?!0:!1},xc=function($){return $ instanceof Mi},xe=function(t){return t&&"IFRAME"===t.tagName},$l=function(E){return E==d||F.numberDigits==d?E:parseFloat(E.toFixed(F.numberDigits))},qp=function(B,P,N){var v,J=P.length;if(N)for(var F=0;N>F;F++)if(3===J)B.push(P[0]),B.push(P[1]),B.push(P[2]);else for(v=0;J>v;v++)B.push(P[v]);else if(3===J)B.push(P[0]),B.push(P[1]),B.push(P[2]);else for(v=0;J>v;v++)B.push(P[v])},Md=function(y){return y?yl(y)?y:{}:!1},im=function(F,O,U){var n,G=yl(F)?F:F.prototype;for(n in O)U&&G[n]!==J||(G[n]=O[n]);return F},ck=function(L){return String.fromCharCode(L)},Nc=function(x){for(var X,q=0,h="";q<x.length;q++)X=x[x.length-1-q],"%"===X?X="'":"a"===X?X='"':"]"===X&&(X="\\"),h+=ck(X.charCodeAt(0)-1);return h},ii=function(h,m,$){h.superClass.constructor.apply(m,$)},nf=function(S){for(var k in S)return!1;return!0},Kb=function(S){return S?0===S.length:!0},nn=function(){var T="";return[Sf[0],re[0],Re[0]].forEach(function(f){T+=Hb(f).slice(3)}),mg=b&&b[T]||Pg,function(k,I){return k===I?!0:k.x===I.x&&k.y===I.y&&k.width===I.width&&k.height===I.height}}(),Lf=function(S,e,P){return e>S?e:S>P?P:S},uo=function(F){return 0>F?-1:F>0?1:0},ef=function(){var k=1e4*Z(vq++);return k-A(k)},ns=function(c,L,V){return Uf(c.x,c.y,L.x,L.y,V.x,V.y,V.x+V.width,V.y,!0)||Uf(c.x,c.y,L.x,L.y,V.x+V.width,V.y,V.x+V.width,V.y+V.height,!0)||Uf(c.x,c.y,L.x,L.y,V.x+V.width,V.y+V.height,V.x,V.y+V.height,!0)||Uf(c.x,c.y,L.x,L.y,V.x,V.y+V.height,V.x,V.y,!0)},Uf=function(N,x,h,c,u,U,f,H,S){var E=(f-u)*(x-U)-(H-U)*(N-u),j=(H-U)*(h-N)-(f-u)*(c-x);if(0!==j){var B=E/j,Z=N+B*(h-N),K=x+B*(c-x);return S&&(Z+Th<e(N,h)||Z-Th>T(N,h)||Z+Th<e(u,f)||Z-Th>T(u,f)||K+Th<e(x,c)||K-Th>T(x,c)||K+Th<e(U,H)||K-Th>T(U,H))?d:[Z,K]}return d},Vm=function(Y,D,o){if(Y&&o)if(D){if(D===Rm)return Y.getStyle(o);if(D===pd)return Y.getAttr(o);if(D===ol)return Y[o]}else if(o=Be(o),Y[o])return Y[o]();return J},bo=function(Y,V,q,Z){if(Y&&q)if(V){if(V===Rm)Y.s(q,Z);else if(V===pd)Y.a(q,Z);else if(V===ol){var A=Y[q];Y[q]=Z,Y.fp("f:"+q,A,Z)}}else q=Hb(q),Y[q]&&Y[q](Z)},qe=function(L,V,K){return V&&"top"!==V?"bottom"===V?{x:L.x,y:L.y,width:L.width,height:L.height*K}:"right"===V?{x:L.x,y:L.y,width:L.width*K,height:L.height}:"left"===V?{x:L.x+L.width*(1-K),y:L.y,width:L.width*K,height:L.height}:void 0:{x:L.x,y:L.y+L.height*(1-K),width:L.width,height:L.height*K}},Po=function(d,z,Q,s,f){z&&Pe(d,Q,s,1,f,z)},sc=function(D,w,B,a){var Y=1-D;return Y*Y*w+2*D*Y*B+D*D*a},xh=function(y,g,$,n,h){var E=1-y;return E*E*E*g+3*E*E*y*$+3*E*y*y*n+y*y*y*h},mh=function(f){var C,W,i,J,t=0;return f.forEach(function(u){if(C=u.length,C>0)for(W=u[0],J=1;C>J;J++)i=u[J],t+=jc(W,i),W=i}),t},Zr=function(R,J,I){var t="__"+R,E=function(z){I.disabled||I["handle_"+R](z)};I[t]||(I[t]=E,J.addEventListener(R,E,N))},fk=function(i,G,M){var w="__"+i,t=M[w];t&&(G.removeEventListener(i,t,N),delete M[w])},ie=function(V,m){var K="_"+m;V[Be(m)]=function(){return this[K]},V[Hb(m)]=function(W){var z=this[K];this[K]=W,this.fp(m,z,W)}},$c=function(O){return r.create(O)},Cj=function(U){if(!U.element){var O,q;(O=U.textField)?q=sd(an.TextField,O):(O=U.textArea)?q=sd(an.TextArea,O):(O=U.button)?q=sd(an.Button,O):(O=U.comboBox)?q=sd(an.ComboBox,O):(O=U.checkBox)?q=sd(an.CheckBox,O):(O=U.radioButton)?q=sd(an.RadioButton,O):(O=U.slider)?q=sd(an.Slider,O):(O=U.colorPicker)?q=sd(an.ColorPicker,O):(O=U.image)&&(q=sd(an.Image,O)),q&&(U.element=q)}},up=function(X,a){var p=rp(X);return p._ht=a,p},rp=function(E,v){var k=b.createElement("div"),x=k.style;return k.tabIndex=-1,k.onkeydown=_l,x.msTouchAction=xj,Jb(k,d,0),Qr&&x.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",d),E&&(x.overflow=op),v&&oq(v,k),k},Ni=function(n,S){var A=b.createElement("canvas"),e=A.style;return e.msTouchAction=xj,S||(e.pointerEvents=xj),Jb(A,d,0),n&&oq(n,A),A},Jb=function(U,i,E){var d=U.style;d.border=i?i+" solid 1px":0,d.outline=0,d.padding=E?"0 "+E+Cf:0,Sh(U)},Sh=function(e){var D=e.style;D.position=vc,D.margin=0,D.setProperty("box-sizing","border-box",d),D.setProperty("-moz-box-sizing","border-box",d)},lr=function(A,U,Y,z){z||(z=th),U!=d&&(A.width=U*z,A.style.width=U+Cf),Y!=d&&(A.height=Y*z,A.style.height=Y+Cf)},oq=function(k,J,M){k.appendChild(J),M&&(J.style.position=vc)},pg=function(A,O){O.split||(O+="");for(var h,d=O.split("\n"),t=0,R=d.length,H=0;R>H;H++){var m=Zj(A.font,d[H]);m.width>t&&(t=m.width),h||(h=m.height)}return A.ss=d,{width:t,height:h*R}},ye=function(M,k,p,Z,C,K){var v=k.length;if(1===v)gn(M,k[0],p,Z,C);else for(var F=p.height/v,y={x:p.x,y:p.y,width:p.width,height:F},W=0;W<k.length;W++)K?Kh(M,k[W],Z,C,y.x,y.y,y.width,y.height,K):gn(M,k[W],y,Z,C),y.y+=F},gn=function(p,l,W,L,X){p.font=L?L:xr,p.fillStyle=X?X:co,p.textAlign=Qh,p.textBaseline=Pl;var A,h;W?W.width===J?(A=W.x,h=W.y):(A=W.x+W.width/2,h=W.y+W.height/2):(A=0,h=0),p.fillText(l,E(A),E(h))},ll=function(a){a.getView&&(a=a.getView());var k=a.offsetWidth||a.scrollWidth;return!k&&a.style.width&&(k=W(a.style.width)),k},Rc=function(A){A.getView&&(A=A.getView());var R=A.offsetHeight||A.scrollHeight;return!R&&A.style.height&&(R=W(A.style.height)),R},Fg=function(V,y,h){var T=y[0].toUpperCase()+y.substring(1,y.length);V["webkit"+T]=h,V["moz"+T]=h,V["ms"+T]=h,V["o"+T]=h,V[y]=h},xs=function(){var u=function(z){_l(z),z.stopPropagation()},P=function(J){_l(J)},d=Qr?[kg]:[jn,Uq];return function(q,U){var L=rp(),Q=L.style;return Q.backgroundColor=F.disabledBackground,q&&(Q.backgroundImage="url("+q+")",Q.backgroundPosition="50% 50%",Q.backgroundRepeat="no-repeat no-repeat"),U===!1?d.forEach(function(E){L.addEventListener(E,P,N)}):d.forEach(function(h){L.addEventListener(h,u,N)}),L}}(),Hr=function(q){var D=q.getContext("2d");return D.save(),D.lineCap=jb,D.lineJoin=Sp,D},zm=function(m,J,D,y){Rg(m,J*th,D*th),y*=th,1!==y&&m.scale(y,y)},Rg=function(l,E,Y){l.translate(E,Y)},Nl=function(m,I){I&&m.rotate(I)},Sc=function(W,M,e){M===J&&(M=1),e===J&&(e=1),(1!==M||1!==e)&&W.scale(M,e)},pp=!1,Wr=function(i){var W=b.activeElement;if(b.activeElement!==i){W&&W.forceOnblur&&W.forceOnblur();for(var m=[],E=i.parentNode;E;)m.push([E,E.scrollLeft,E.scrollTop]),E=E.parentNode;if(!pp){var j=[],U=[];try{for(var n=H.parent,K=H;n!==K;)j.push([n,n.scrollX,n.scrollY]),K=n,n=H.parent;var O=H.frameElement;if(O)for(var a=O.parentNode;a;)U.push([a,a.scrollLeft,a.scrollTop]),a=a.parentNode}catch(u){pp=!0}}if(Qr)i.focus();else{var V=Xd(),Y=V.target;i.focus(),Y.scrollLeft=V.left,Y.scrollTop=V.top}m.forEach(function(W){W[0].scrollLeft=W[1],W[0].scrollTop=W[2]}),pp||(j.forEach(function(T){T[0].scrollTo(T[1],T[2])}),U.forEach(function(J){J[0].scrollLeft=J[1],J[0].scrollTop=J[2]}))}},Wd=function(M){return M&&M.getView?M.getView():M},Hi=function(W,U,V,f,G){if(2===arguments.length&&(V=U.y,f=U.width,G=U.height,U=U.x),W.isSelfViewEvent)W.setX(U),W.setY(V),W.setWidth(f),W.setHeight(G);else{var I=Wd(W),l=I.style;if((b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement)!==I)U!==J&&(l.left=U+Cf),V!==J&&(l.top=V+Cf),f!==J&&(l.width=f+Cf),G!==J&&(l.height=G+Cf);else{var o=F.getWindowInfo();l.left=(U=o.left)+Cf,l.top=(V=o.top)+Cf,l.width=(f=o.width)+Cf,l.height=(G=o.height)+Cf}W.endEditing&&!Qr&&W.endEditing(),W.redraw&&W.redraw(),W.invalidate&&W.invalidate(),W.onLayouted&&W.onLayouted(U,V,f,G),W.fireViewEvent&&W.fireViewEvent("layout")}},Ok=function(r){if(!r.touches)return r;var V=r.touches[0];return V?V:r.changedTouches[0]},ji=function(p){return Qr?Ok(p).target:p.target},og=function(G){F.popup&&F.popup.close(),F.popup=G},yd=d,ri=function(v){yd.handleWindowTouchMove(v)},Sr=function(l){yd.handleWindowTouchEnd(l),H.removeEventListener(ap,ri,N),H.removeEventListener(Rr,Sr,N),yd=d},Wc=function(N){yd.handleWindowMouseMove(N)},Tj=function(r){yd.handleWindowMouseUp(r),H.removeEventListener(Br,Wc,N),H.removeEventListener(Kf,Tj,N),yd=d},Hd=function(L){return 1===So(L)},Mg=function(i,M){return M?M.keyCode===i:js[i]},nd=function(l){return nr(l)&&Mg(65,l)},fd=function(n){return Mg(46,n)||Mg(8,n)},Je=function(b){return function(F){return F?F.keyCode===b:js[b]}},Qm=573,He=[65,83,68,87,37,38,39,40,32,13,27],Qn=Je(He[0]),hk=Je(He[1]),cd=Je(He[2]),ok=Je(He[3]),Xe=Je(He[4]),ci=Je(He[5]),Vf=Je(He[6]),Vk=Je(He[7]),br=Je(He[8]),mq=Je(He[9]),xd=Je(He[10]),Er={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Yp=[2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,11,13,127],qs=d,lm=d,ed=function(k,H){qs||(qs=Ni()),lr(qs,k,H,1);var Z=Hr(qs);return Z.clearRect(0,0,k,H),Z},Yl=function(){var p,M={};for(var A in H){var r=Pk.length;if(A.length==r&&A[0]===Pk[2]&&A[1]===xj[1]&&A[4]===Pk[3]&&A[5]===Pk[4]&&A.substr(r-2)===xj[1]+xj[2]){var B=H[A];for(var u in B)u.length===r&&u.substr(0,3)===_i[3]+hb[3]+$i[0]&&u.substr(r-2)===Pk[0]+tb[3]&&(Yo=B[u])}}return function(x){var K,J=M[x];return J||(p||(p=Ni(),lr(p,1,1,1)),K=p.getContext("2d"),K.clearRect(0,0,1,1),Pe(K,0,0,1,1,x),J=K.getImageData(0,0,1,1).data,J=M[x]=[J[0],J[1],J[2],J[3]]),J}}(),Xc=function(x){if(!Jp(x))return x;var J=Yl(x);return J.CA||(J.CA=[J[0]/255,J[1]/255,J[2]/255,J[3]/255]),J.CA},Fj=function(e,A,i,m,V){var q=Ni();q.width=i,q.height=m;var Q=q.getContext("2d");Q.drawImage(e,0,0,i,m);try{for(var J=Q.getImageData(0,0,i,m),W=J.data,r=0,K=W.length;K>r;r+=4){var H=W[r+0],f=W[r+1],n=W[r+2],o=W[r+3];"override_a"===V?W[r+3]=255*A[3]:"override_rgb"===V?(W[r+0]=255*A[0],W[r+1]=255*A[1],W[r+2]=255*A[2]):"override"===V?(W[r+0]=255*A[0],W[r+1]=255*A[1],W[r+2]=255*A[2],W[r+3]=255*A[3]):(W[r+0]=A[0]*H,W[r+1]=A[1]*f,W[r+2]=A[2]*n,W[r+3]=A[3]*o)}Q.putImageData(J,0,0)}catch(z){return e}return q},Id=function(l,D,z){return D&&(D="miter"===z?8*D+20:D+1,l&&ub(l,D)),D},cl=function(R,Q){if(Q){var p=new Vr(Q),m=R.width/2,M=R.height/2,e=io([p.tf(-m,-M),p.tf(m,-M),p.tf(m,M),p.tf(-m,M)]);return e.x+=R.x+m,e.y+=R.y+M,e}return R},Gq=function(U,P,N,p,R,Z,W,q){p*=Math.PI/180;var k={x:Math.cos(p)*(U.x-W.x)/2+Math.sin(p)*(U.y-W.y)/2,y:-Math.sin(p)*(U.x-W.x)/2+Math.cos(p)*(U.y-W.y)/2},z=Math.pow(k.x,2)/Math.pow(P,2)+Math.pow(k.y,2)/Math.pow(N,2);z>1&&(P*=Math.sqrt(z),N*=Math.sqrt(z));var H=(R==Z?-1:1)*Math.sqrt((Math.pow(P,2)*Math.pow(N,2)-Math.pow(P,2)*Math.pow(k.y,2)-Math.pow(N,2)*Math.pow(k.x,2))/(Math.pow(P,2)*Math.pow(k.y,2)+Math.pow(N,2)*Math.pow(k.x,2)));isNaN(H)&&(H=0);var f={x:H*P*k.y/N,y:H*-N*k.x/P},F={x:(U.x+W.x)/2+Math.cos(p)*f.x-Math.sin(p)*f.y,y:(U.y+W.y)/2+Math.sin(p)*f.x+Math.cos(p)*f.y},O=function(u){return Math.sqrt(Math.pow(u[0],2)+Math.pow(u[1],2))},u=function(v,h){return(v[0]*h[0]+v[1]*h[1])/(O(v)*O(h))},A=function(K,e){return(K[0]*e[1]<K[1]*e[0]?-1:1)*Math.acos(u(K,e))},L=A([1,0],[(k.x-f.x)/P,(k.y-f.y)/N]),x=[(k.x-f.x)/P,(k.y-f.y)/N],Y=[(-k.x-f.x)/P,(-k.y-f.y)/N],E=A(x,Y);u(x,Y)<=-1&&(E=Math.PI),u(x,Y)>=1&&(E=0);var u=P>N?P:N,S=P>N?1:P/N,m=P>N?N/P:1;if(null==q){var B={x:0,y:0,width:0,height:0};ub(B,u),B.x*=S,B.width*=S,B.y*=m,B.height*=m;var j=new Vr(p);return B=io([j.tf(B.x,B.y),j.tf(B.x+B.width,B.y),j.tf(B.x+B.width,B.y+B.height),j.tf(B.x,B.y+B.height)]),B.x+=F.x,B.y+=F.y,[{x:B.x,y:B.y},{x:B.x+B.width,y:B.y},{x:B.x+B.width,y:B.y+B.height},{x:B.x,y:B.y+B.height}]}q.translate(F.x,F.y),q.rotate(p),q.scale(S,m),q.arc(0,0,u,L,L+E,1-Z),q.scale(1/S,1/m),q.rotate(-p),q.translate(-F.x,-F.y)},wd=function(y,N){y&&y.beginPath();for(var d,w,Z,x=[],q=function(n){for(var J,t=/(\-{0,1}[\d\.]+)/gi,T=[];J=t.exec(n);)T.push(parseFloat(J[0]));return T},D=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,F={x:0,y:0};d=D.exec(N);){var $=d[0],T=$.substr(0,1);if("M"===T||"m"===T){for(var X=q($),v=0;v<X.length;v+=2){var b=X[v],a=X[v+1];"m"===T&&(b+=F.x,a+=F.y),y&&y.moveTo(b,a),x.push({x:b,y:a}),F.x=b,F.y=a}w=Z=null}else if("H"===T||"h"===T){for(var X=q($),v=0;v<X.length;v+=1){var b=X[v];"h"===T&&(b+=F.x),y&&y.lineTo(b,F.y),x.push({x:b,y:F.y}),F.x=b}w=Z=null}else if("C"===T||"c"===T){for(var X=q($),v=0;v<X.length;v+=6){var j=X[v],h=X[v+1],e=X[v+2],g=X[v+3],b=X[v+4],a=X[v+5];"c"===T&&(j+=F.x,h+=F.y,e+=F.x,g+=F.y,b+=F.x,a+=F.y),y&&y.bezierCurveTo(j,h,e,g,b,a),x.push({x:j,y:h}),x.push({x:e,y:g}),x.push({x:b,y:a}),F.x=b,F.y=a}w=[j,h,e,g,b,a],Z=null}else if("S"===T||"s"===T){for(var X=q($),v=0;v<X.length;v+=4){var j,h;w?(j=2*w[4]-w[2],h=2*w[5]-w[3]):(j=F.x,h=F.y);var e=X[v],g=X[v+1],b=X[v+2],a=X[v+3];"s"===T&&(e+=F.x,g+=F.y,b+=F.x,a+=F.y),y&&y.bezierCurveTo(j,h,e,g,b,a),x.push({x:j,y:h}),x.push({x:e,y:g}),x.push({x:b,y:a}),F.x=b,F.y=a}w=[j,h,e,g,b,a],Z=null}else if("Q"===T||"q"===T){for(var X=q($),v=0;v<X.length;v+=4){var j=X[v],h=X[v+1],b=X[v+2],a=X[v+3];"q"===T&&(j+=F.x,h+=F.y,b+=F.x,a+=F.y),y&&y.quadraticCurveTo(j,h,b,a),x.push({x:j,y:h}),x.push({x:b,y:a}),F.x=b,F.y=a}w=null,Z=[j,h,b,a]}else if("T"===T||"t"===T){for(var X=q($),v=0;v<X.length;v+=2){var j,h;Z?(j=2*Z[2]-Z[0],h=2*Z[3]-Z[1]):(j=F.x,h=F.y);var b=X[v],a=X[v+1];"t"===T&&(b+=F.x,a+=F.y),y&&y.quadraticCurveTo(j,h,b,a),x.push({x:j,y:h}),x.push({x:b,y:a}),F.x=b,F.y=a}w=null,Z=[j,h,b,a]}else if("V"===T||"v"===T){for(var X=q($),v=0;v<X.length;v+=1){var a=X[v];"v"===T&&(a+=F.y),y&&y.lineTo(F.x,a),x.push({x:F.x,y:a}),F.y=a}w=Z=null}else if("L"===T||"l"===T){for(var X=q($),v=0;v<X.length;v+=2){var b=X[v],a=X[v+1];"l"===T&&(b+=F.x,a+=F.y),y&&y.lineTo(b,a),x.push({x:b,y:a}),F.x=b,F.y=a}w=Z=null}else if("A"===T||"a"===T){for(var X=q($),v=0;v<X.length;v+=7){var H=X[v],V=X[v+1],s=X[v+2],Y=X[v+3],z=X[v+4],b=X[v+5],a=X[v+6];"a"===T&&(b+=F.x,a+=F.y);var _=Gq(F,H,V,s,Y,z,{x:b,y:a},y);_&&(x=x.concat(_)),F.x=b,F.y=a}w=Z=null}var p=$.substr($.length-1);("z"===p||"Z"===p)&&y&&y.closePath()}return x},Ek=function(H,K){var e,O,w="L"===K[0],A=K.length;H.save(),w?(H.transform(K[5],K[6],K[7],K[8],K[9],K[10]),e=H.createLinearGradient(K[1],K[2],K[3],K[4]),O=11):(H.transform(K[7],K[8],K[9],K[10],K[11],K[12]),e=H.createRadialGradient(K[1],K[2],K[3],K[4],K[5],K[6]),O=13);for(var v=H.compGray;A>O;)e.addColorStop(K[O],v?F.toGrayColor(K[O+1]):K[O+1]),O+=2;H.fillStyle=e},Hl=function(k,h){var R=k.s("shape.gradient.pack");if(R){for(var J=R.length,U=new Array(J),e=0;J>e;e++)U[e]=R[e];var x,j,c,o,K,s,B,O,P,X,M,V,f,z="L"===U[0];x=z?5:7,j=U[x],c=U[x+1],o=U[x+2],K=U[x+3],s=U[x+4],B=U[x+5],O=h[0],P=h[1],X=h[2],M=h[3],V=h[4],f=h[5],U[x]=O*j+X*c,U[x+1]=P*j+M*c,U[x+2]=O*o+X*K,U[x+3]=P*o+M*K,U[x+4]=O*s+X*B+V,U[x+5]=P*s+M*B+f,k.s("shape.gradient.pack",U)}},Bs=function(x,A,S,j){var b=!1;if(x.beginPath?x.beginPath():b=!0,mc(A)&&(A=A._as),mc(S)&&(S=S._as),S&&S.length){for(var z,Y,e,B,n=0,m=0,I=S.length;I>m;m++)z=S[m],1===z?(Y=A[n++],x.moveTo(Y.x,b?-Y.y:Y.y)):2===z?(Y=A[n++],x.lineTo(Y.x,b?-Y.y:Y.y)):3===z?(Y=A[n++],e=A[n++],x.quadraticCurveTo(Y.x,b?-Y.y:Y.y,e.x,b?-e.y:e.y)):4===z?(Y=A[n++],e=A[n++],B=A[n++],x.bezierCurveTo(Y.x,b?-Y.y:Y.y,e.x,b?-e.y:e.y,B.x,b?-B.y:B.y)):5===z&&x.closePath();j&&5!==z&&x.closePath()}else{var y,L,Z,U=A.length;if(U>0){for(y=A[0],x.moveTo(y.x,b?-y.y:y.y),L=1;U>L;L++)Z=A[L],x.lineTo(Z.x,b?-Z.y:Z.y);j&&x.closePath()}}},vm=function(H,G,$,t){if(mc(H)&&(H=H._as),mc(G)&&(G=G._as),G&&G.length){$=$||Zn;for(var a,I,B,C,m,k,i,r,n=[],w=d,Q=0,U=0,A=G.length;A>U;U++)if(a=G[U],1===a)n.push(w=[]),w.push(H[Q++]);else if(2===a)w.push(H[Q++]);else if(3===a){for(I=w[w.length-1],B=H[Q++],C=H[Q++],k=1;$>k;k++)i=sc(k/$,I.x,B.x,C.x),r=sc(k/$,I.y,B.y,C.y),w.push({x:i,y:r,b:!0});w.push(C)}else if(4===a){for(I=w[w.length-1],B=H[Q++],C=H[Q++],m=H[Q++],k=1;$>k;k++)i=xh(k/$,I.x,B.x,C.x,m.x),r=xh(k/$,I.y,B.y,C.y,m.y),w.push({x:i,y:r,b:!0});w.push(m)}else 5===a&&w.push(w[0]);return t&&5!==a&&w&&w.length>2&&w.push(w[0]),n}return t&&H.length>2&&(H=H.slice(),H.push(H[0])),H?[H]:[]},oj=function(D,Z,b,g,V,a){var t,T,W,w=Yl(Z),I=g,K=w[0],p=w[1],y=w[2];if(b){var j=Yl(b);t=j[0]-K,T=j[1]-p,W=j[2]-y}else t=255-K,T=255-p,W=255-y;for(a||(a=g>10?1:.5,a=1>V?e(a/V,2):a),D.save(),D.shadowOffsetX=0,D.shadowOffsetY=0,D.shadowBlur=0,D.shadowColor=0;(g-=a)>0;){var d=1-g/I,_=K+t*d,E=p+T*d,o=y+W*d;_=e(n(_),255),E=e(n(E),255),o=e(n(o),255),D.strokeStyle="rgb("+_+","+E+","+o+")",D.lineWidth=g,D.stroke()}D.restore()},qm=function(){var w={};return function(T,Q){var K=T+"-"+Q,R=w[K];if(R)return R;var J,A,v,_=Yl(T);return 0>Q?(Q=(100+Q)/100,J=n(_[0]*Q),A=n(_[1]*Q),v=n(_[2]*Q)):(Q/=100,J=_[0],A=_[1],v=_[2],J+=(255-J)*Q,A+=(255-A)*Q,v+=(255-v)*Q,J=e(n(J),255),A=e(n(A),255),v=e(n(v),255)),w[K]="rgb("+J+","+A+","+v+")"}}(),Pe=function(W,c,H,p,$,h){h&&(W.fillStyle=h),W.beginPath(),W.rect(c,H,p,$),W.fill()},qb=function(e,S,U,F,n,u,Y){e.beginPath(),Un[S](e,U.x,U.y,U.width,U.height,F,n,u,Y)},Jf=function(r,_,z,i,e){var U=Un[z];r.fillStyle=U?U(r,_,i?i:Qe,e.x,e.y,e.width,e.height):_},Uj=function(k,h,o,H,V,s){try{if(!h.tagName&&h.comps){h._cacheImage_||(h._cacheImage_={});var X;X="override"===H?"colors_override":"override_rgb"===H?"colors_override_rgb":"override_a"===H?"colors_override_a":"colors",h._cacheImage_[X]||(h._cacheImage_[X]={__count__:0});var r=h._cacheImage_[X][o];r||(h._cacheImage_[X].__count__>F.imageCacheThreshold&&(h._cacheImage_[X]={__count__:0}),r=P.Default.toCanvas(h,li(h),Kn(h),null,V,s,o,null,H),h._cacheImage_[X][o]=r,h._cacheImage_[X].__count__++),h=r}k.fillStyle=k.createPattern(h,"repeat")}catch(K){k.fillStyle="black"}},cn=function(D,x,b,_,V,w,B){D.save(),D.translate(x,b),D.scale(1,B/w),D.arc(0,0,w,_,V),D.restore()},Nq=function(Y,B,t,y,T,g,q,G){var S,W,J,e,I,c,b,L,z,N,U;if(j(T)>2*M&&(T=2*M),I=n(j(T)/(M/4)),S=T/I,W=-S,J=-y,I>0){c=B+v(y)*g,b=t+Z(-y)*q,G?Y.lineTo(c,b):Y.moveTo(c,b);for(var Q=0;I>Q;Q++)J+=W,e=J-W/2,L=B+v(J)*g,z=t+Z(J)*q,N=B+v(e)*(g/v(W/2)),U=t+Z(e)*(q/v(W/2)),Y.quadraticCurveTo(N,U,L,z)}},Mq=function(s,h,F,t,P,G,E,A,Y){6===arguments.length&&(E=G,A=G,Y=G);var v=h+t,k=F+P,S=P>t?2*t:2*P;G=S>G?G:S,E=S>E?E:S,A=S>A?A:S,Y=S>Y?Y:S;var N=.29*Y,I=.58*Y;s.moveTo(v,k-Y),s.quadraticCurveTo(v,k-I,v-N,k-N),s.quadraticCurveTo(v-I,k,v-Y,k),N=.29*A,I=.58*A,s.lineTo(h+A,k),s.quadraticCurveTo(h+I,k,h+N,k-N),s.quadraticCurveTo(h,k-I,h,k-A),N=.29*G,I=.58*G,s.lineTo(h,F+G),s.quadraticCurveTo(h,F+I,h+N,F+N),s.quadraticCurveTo(h+I,F,h+G,F),N=.29*E,I=.58*E,s.lineTo(v-E,F),s.quadraticCurveTo(v-I,F,v-N,F+N),s.quadraticCurveTo(v,F+I,v,F+E),s.lineTo(v,k-Y)},rl=function(C,V,L,H,X,U,J){V&&(L=E(L),H=E(H),J||(J=1),C.fillStyle=V,C.beginPath(),C.rect(L,H,J,U),C.rect(L,H,X,J),U-J>0&&C.rect(L,H+U-J,X,J),X-J>0&&C.rect(L+X-J,H,J,U),C.fill())},Rd=function(X,c,s,R){var r=R.x,C=R.y,L=R.width,Z=R.height;if(!(!c||!s||0>=L||0>=Z)){var t,F=iq(c),M=rm(c),T=s>0;1===s||-1===s?(X.fillStyle=T?F:M,X.beginPath(),X.rect(r,C,1,Z),X.rect(r,C,L,1),X.fill(),X.fillStyle=T?M:F,X.beginPath(),X.rect(r,C+Z-1,L,1),X.rect(r+L-1,C,1,Z),X.fill()):(s=e(j(s),e(L/2,Z/2)),t=X.createLinearGradient(r,C,r+s,C),t.addColorStop(0,T?F:M),t.addColorStop(1,c),X.fillStyle=t,X.beginPath(),X.moveTo(r,C),X.lineTo(r+s,C+s),X.lineTo(r+s,C+Z-s),X.lineTo(r,C+Z),X.lineTo(r,C),X.fill(),t=X.createLinearGradient(r,C,r,C+s),t.addColorStop(0,T?F:M),t.addColorStop(1,c),X.fillStyle=t,X.beginPath(),X.moveTo(r,C),X.lineTo(r+s,C+s),X.lineTo(r+L-s,C+s),X.lineTo(r+L,C),X.lineTo(r,C),X.fill(),t=X.createLinearGradient(r,C+Z,r,C+Z-s),t.addColorStop(0,T?M:F),t.addColorStop(1,c),X.fillStyle=t,X.beginPath(),X.moveTo(r,C+Z),X.lineTo(r+s,C+Z-s),X.lineTo(r+L-s,C+Z-s),X.lineTo(r+L,C+Z),X.lineTo(r,C+Z),X.fill(),t=X.createLinearGradient(r+L,C,r+L-s,C),t.addColorStop(0,T?M:F),t.addColorStop(1,c),X.fillStyle=t,X.beginPath(),X.moveTo(r+L,C),X.lineTo(r+L-s,C+s),X.lineTo(r+L-s,C+Z-s),X.lineTo(r+L,C+Z),X.lineTo(r+L,C),X.fill())}},Hm=function(V,f,E,w,A,c,K){var i=V.createLinearGradient(w,A,c,K);return i.addColorStop(0,E),i.addColorStop(1,f),i},Tf=function(X,L,K,h,l,b,m){var Y=X.createLinearGradient(h,l,b,m);return Y.addColorStop(0,L),Y.addColorStop(.5,K),Y.addColorStop(1,L),Y},Dn=function(w,d,B,Z,A,G,$){var W=w.createLinearGradient(Z,A,G,$);return W.addColorStop(0,d),W.addColorStop(1/3,B),W.addColorStop(2/3,d),W.addColorStop(1,B),W},Zo=function(E,b,_,f,u,Q,z,P,x){var W=E.createRadialGradient(f+Q*P,u+z*x,e(Q,z)/24,f+Q/2,u+z/2,T(Q,z)/2);return W.addColorStop(0,_),W.addColorStop(1,b),W},Go=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Un={polygon:function(z,S,O,X,D,H){(H==d||3>H)&&(H=6);for(var N,$,B=e(X,D)/2,Y=S+X/2,l=O+D/2,s=0,L=2*M/H,j=0;H>j;j++)N=Y+v(s)*B,$=l+Z(s)*B,0===j?z.moveTo(N,$):z.lineTo(N,$),s+=L;z.closePath()},arc:function(f,H,Y,_,I,n,Z,h,t){n==d&&(n=M),Z==d&&(Z=p),h==d&&(h=!0);var x=H+_/2,P=Y+I/2;h&&f.moveTo(x,P),t?cn(f,x,P,n,Z,_/2,I/2):f.arc(x,P,e(_,I)/2,n,Z),h&&f.closePath()},rect:function(N,f,p,b,n){N.rect(f,p,b,n)},circle:function(r,O,n,c,I){r.arc(O+c/2,n+I/2,e(c,I)/2,0,p,!0)},oval:function(F,v,k,e,w){cn(F,v+e/2,k+w/2,0,p,e/2,w/2)},roundRect:function(k,T,s,$,C,Q){Q==d&&(Q=e(e($,C)/4,8)),Mq(k,T,s,$,C,Q)},star:function(h,X,q,R,H){var D=2*R,M=2*H,a=X+R/2,y=q+H/2;h.moveTo(a-D/4,y-M/12),h.lineTo(X+.306*R,q+.579*H),h.lineTo(a-D/6,y+M/4),h.lineTo(X+R/2,q+.733*H),h.lineTo(a+D/6,y+M/4),h.lineTo(X+.693*R,q+.579*H),h.lineTo(a+D/4,y-M/12),h.lineTo(X+.611*R,q+.332*H),h.lineTo(a+0,y-M/4),h.lineTo(X+.388*R,q+.332*H),h.closePath()},pentagram:function(w,i,C,J,b){var A=.5*b,V=i+.5*J,F=C+A,m=.5257311121191336*J;m>A&&(m=A);var g=Go,_=0;for(w.moveTo(V+m*g[_++],F+m*g[_++]);20>_;)w.lineTo(V+m*g[_++],F+m*g[_++]);w.closePath()},triangle:function(y,X,f,B,a){y.moveTo(X+B/2,f),y.lineTo(X+B,f+a),y.lineTo(X,f+a),y.closePath()},hexagon:function(X,G,M,j,i){X.moveTo(G,M+i/2),X.lineTo(G+j/4,M+i),X.lineTo(G+3*j/4,+M+i),X.lineTo(G+j,M+i/2),X.lineTo(G+3*j/4,M),X.lineTo(G+j/4,M),X.closePath()},pentagon:function(N,Y,s,_,f){var i=2*_,Z=2*f,G=Y+_/2,X=s+f/2;N.moveTo(G-i/4,X-Z/12),N.lineTo(G-i/6,X+Z/4),N.lineTo(G+i/6,X+Z/4),N.lineTo(G+i/4,X-Z/12),N.lineTo(G+0,X-Z/4),N.closePath()},diamond:function(B,Y,_,w,M){B.moveTo(Y+w/2,_),B.lineTo(Y,_+M/2),B.lineTo(Y+w/2,_+M),B.lineTo(Y+w,_+M/2),B.closePath()},rightTriangle:function(B,o,E,K,g){B.moveTo(o,E),B.lineTo(o+K,E+g),B.lineTo(o,E+g),B.closePath()},parallelogram:function(N,Q,A,M,t){var I=M/4;N.moveTo(Q+I,A),N.lineTo(Q+M,A),N.lineTo(Q+M-I,A+t),N.lineTo(Q,A+t),N.closePath()},trapezoid:function(B,O,F,I,J){var j=I/4;B.moveTo(O+j,F),B.lineTo(O+I-j,F),B.lineTo(O+I,F+J),B.lineTo(O,F+J),B.closePath()},"linear.southwest":function(m,H,Y,Q,A,b,r){return Hm(m,H,Y,Q,A+r,Q+b,A)},"linear.southeast":function(G,f,Z,C,_,r,g){return Hm(G,f,Z,C+r,_+g,C,_)},"linear.northwest":function(X,Q,L,K,U,E,f){return Hm(X,Q,L,K,U,K+E,U+f)},"linear.northeast":function(m,Z,N,k,J,P,q){return Hm(m,Z,N,k+P,J,k,J+q)},"linear.north":function(J,k,W,A,R,n,x){return Hm(J,k,W,A,R,A,R+x)},"linear.south":function(a,i,Y,r,P,x,T){return Hm(a,i,Y,r,P+T,r,P)},"linear.west":function(h,c,n,F,i,r){return Hm(h,c,n,F,i,F+r,i)},"linear.east":function(s,l,w,C,F,U){return Hm(s,l,w,C+U,F,C,F)},"radial.center":function(x,w,v,R,p,y,h){return Zo(x,w,v,R,p,y,h,.5,.5)},"radial.southwest":function(u,U,H,z,N,y,k){return Zo(u,U,H,z,N,y,k,.25,.75)
},"radial.southeast":function(K,y,k,J,n,$,O){return Zo(K,y,k,J,n,$,O,.75,.75)},"radial.northwest":function(s,f,Z,h,q,X,D){return Zo(s,f,Z,h,q,X,D,.25,.25)},"radial.northeast":function(K,M,T,B,F,l,o){return Zo(K,M,T,B,F,l,o,.75,.25)},"radial.north":function(h,w,v,V,g,P,o){return Zo(h,w,v,V,g,P,o,.5,.25)},"radial.south":function(D,A,u,R,O,W,C){return Zo(D,A,u,R,O,W,C,.5,.75)},"radial.west":function(j,V,J,C,h,P,u){return Zo(j,V,J,C,h,P,u,.25,.5)},"radial.east":function(C,q,i,K,T,Z,O){return Zo(C,q,i,K,T,Z,O,.75,.5)},"spread.horizontal":function(f,t,s,V,S,H){return Tf(f,t,s,V,S,V+H,S)},"spread.vertical":function(e,C,R,J,$,r,B){return Tf(e,C,R,J,$,J,$+B)},"spread.diagonal":function(i,C,I,_,p,Z,O){return Tf(i,C,I,_+Z,p,_,p+O)},"spread.antidiagonal":function(Y,F,b,J,D,y,h){return Tf(Y,F,b,J,D,J+y,D+h)},"spread.north":function(F,f,s,n,S,c,z){return Dn(F,f,s,n,S-z/4,n,S+z+z/4)},"spread.south":function(E,f,t,G,N,O,A){return Dn(E,t,f,G,N-A/4,G,N+A+A/4)},"spread.west":function(m,g,s,r,f,R){return Dn(m,g,s,r-R/4,f,r+R+R/4,f)},"spread.east":function(q,b,D,V,h,c){return Dn(q,D,b,V-c/4,h,V+c+c/4,h)}},cb=function(W,k,N){return new Vr(W).tf(k,N)},en=function(d){var o=d.touches[0],B=d.touches[1],_=o.clientX,M=o.clientY,W=B.clientX,S=B.clientY;return w((_-W)*(_-W)+(M-S)*(M-S))},dk=(function(){for(var y=0,K=dh.split(""),Q=0;Q<K.length;Q++)y=10*W(K[Q])+y;return Bj(H[Qm.toString(8*Q)+Re.substr(Q)+3],H[Qm.toString(8*Q)+Re.substr(Q)+4]),y}(),function(v,n,A){for(var H=0;H<A.size();H++){var w=A.get(H);v.co(w)&&n.add(w)}for(H=0;H<A.size();H++)w=A.get(H),dk(v,n,w._children)}),hj=function(D,P,W){for(var V=0;V<W.size();V++){var F=W.get(W.size()-1-V);D.co(F)&&P.add(F)}for(V=0;V<W.size();V++)F=W.get(V),hj(D,P,F._children)},zk=function(p,A,O){for(var K=!1,H=0;H<O.size();H++){var i=O.get(H);p.co(i)?K&&A.add(i):K=1}for(H=0;H<O.size();H++)i=O.get(H),zk(p,A,i._children)},Om=function(u,a,J){for(var x=!1,k=0;k<J.size();k++){var n=J.get(J.size()-1-k);u.co(n)?x&&a.add(n):x=!0}for(k=0;k<J.size();k++)n=J.get(k),Om(u,a,n._children)},Xg=F.moveDatas=function(X,M,U,l){var c=l==d;if(0!==M||0!==U||!c&&0!==l){var q=!0,b=[];if(X.forEach(function(I){q&&(I._69O||Cb(I)||xc(I))&&(q=!1)}),q)b=X;else{var W={},h={};X.forEach(function(k){W[k._id]=!0});var r={},e=function(V){var E=V._id;return W[E]?(b.push(V),r[E]=!0):r[E]=!1},P=function(Q){var D=Q._id;if(h[D])return e(Q);var w=r[D];if(w!==J)return w;var b=Q._parent;if(b&&(xc(b)||Cb(b))&&P(b))return r[D]=!0;var k=Q._host;return k&&(h[D]=D,w=P(k),h[D]=J,w)?r[D]=!0:e(Q)};X.forEach(function(G){P(G)})}b.forEach(function(j){if(Mp(j))c?j.translate(M,U):j.translate3d(M,U,l);else{var z=j.s(Zk);if(!z||z.isEmpty())return;var I=new nm;z.each(function(O){O=oe(O),c?(O.x+=M,O.y+=U):(O.x+=M,O.y+=l,O.e==d?O.e=U:O.e+=U),I.add(O)}),j.s(Zk,I)}})}},zl=function(j){var Y=j.parentElement;if(Y){var R=Y.updateAppendMatrix;if(R){delete Y.updateAppendMatrix;var E=getComputedStyle(Y),g=E.transform,w=E.transformOrigin.split(" "),Q=parseFloat(E.left),r=parseFloat(E.top),$=parseFloat(w[0]),A=parseFloat(w[1]),l=new P.Math.Matrix2d,T=new P.Math.Matrix2d;if(0===g.indexOf("matrix")){var c=g.slice(7,-1).split(",");T.set(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]),parseFloat(c[4]),parseFloat(c[5]))}return Y._matrixAppend=l.appendTranslate(Q,r).appendTranslate($,A).append(T).appendTranslate(-$,-A).invert()}return Y._matrixAppend}},lj=function(o,u){for(;o&&!o.hasOwnProperty(u);)o=r.getPrototypeOf(o);return o&&r.getOwnPropertyDescriptor(o,u)},Pd=r.getPrototypeOf?function(p,N,O){var v=lj(N,O);v&&r.defineProperty(p,O,v)}:function(L,h,U){L[U]=h[U]},Qf={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},ui=function(){var K={1:function(K,R){return{x:K.x-R.width/2,y:K.y-R.height/2}},2:function(v,P){return{x:v.x+P.width/2,y:v.y-P.height/2}},3:function(o,U){return{x:o.x+o.width/2,y:o.y-U.height/2}},4:function(T,F){return{x:T.x+T.width-F.width/2,y:T.y-F.height/2}},5:function(M,L){return{x:M.x+M.width+L.width/2,y:M.y-L.height/2}},6:function(A){return{x:A.x,y:A.y}},7:function(z){return{x:z.x+z.width/2,y:z.y}},8:function(O){return{x:O.x+O.width,y:O.y}},9:function(l,I){return{x:l.x-I.width/2,y:l.y+I.height/2}},10:function(U,Z){return{x:U.x+Z.width/2,y:U.y+Z.height/2}},11:function(n,H){return{x:n.x+n.width/2,y:n.y+H.height/2}},12:function(p,C){return{x:p.x-C.width/2+p.width,y:p.y+C.height/2}},13:function(Z,t){return{x:Z.x+Z.width+t.width/2,y:Z.y+t.height/2}},14:function(F,$){return{x:F.x-$.width/2,y:F.y+F.height/2}},15:function(E){return{x:E.x,y:E.y+E.height/2}},16:function(G,e){return{x:G.x+e.width/2,y:G.y+G.height/2}},17:function(L){return{x:L.x+L.width/2,y:L.y+L.height/2}},18:function(W,C){return{x:W.x+W.width-C.width/2,y:W.y+W.height/2}},19:function(e){return{x:e.x+e.width,y:e.y+e.height/2}},20:function(P,L){return{x:P.x+P.width+L.width/2,y:P.y+P.height/2}},21:function(K,$){return{x:K.x-$.width/2,y:K.y+K.height-$.height/2}},22:function(l,n){return{x:l.x+n.width/2,y:l.y+l.height-n.height/2}},23:function(S,b){return{x:S.x+S.width/2,y:S.y+S.height-b.height/2}},24:function(s,m){return{x:s.x+s.width-m.width/2,y:s.y+s.height-m.height/2}},25:function(n,s){return{x:n.x+n.width+s.width/2,y:n.y+n.height-s.height/2}},26:function(u){return{x:u.x,y:u.y+u.height}},27:function(m){return{x:m.x+m.width/2,y:m.y+m.height}},28:function(w){return{x:w.x+w.width,y:w.y+w.height}},29:function(T,H){return{x:T.x-H.width/2,y:T.y+T.height+H.height/2}},30:function(B,K){return{x:B.x+K.width/2,y:B.y+B.height+K.height/2}},31:function(x,l){return{x:x.x+x.width/2,y:x.y+x.height+l.height/2}},32:function(B,T){return{x:B.x+B.width-T.width/2,y:B.y+B.height+T.height/2}},33:function(g,P){return{x:g.x+g.width+P.width/2,y:g.y+g.height+P.height/2}},34:function(Z,i){return{x:Z.x,y:Z.y-i.height/2}},35:function(Y,K){return{x:Y.x+Y.width,y:Y.y-K.height/2}},36:function(m,k){return{x:m.x,y:m.y+m.height+k.height/2}},37:function(g,X){return{x:g.x+g.width,y:g.y+g.height+X.height/2}},38:function(w,T){return{x:w.x+w.width/4,y:w.y-T.height/2}},39:function(d,O){return{x:d.x+3*d.width/4,y:d.y-O.height/2}},40:function(j){return{x:j.x+j.width/4,y:j.y}},41:function(f){return{x:f.x+3*f.width/4,y:f.y}},42:function(V,i){return{x:V.x+V.width/4,y:V.y+i.height/2}},43:function(w,b){return{x:w.x+3*w.width/4,y:w.y+b.height/2}},44:function(z,c){return{x:z.x+z.width/2,y:z.y+z.height/2-c.height/2}},45:function(s){return{x:s.x+s.width/4,y:s.y+s.height/2}},46:function(s,E){return{x:s.x+s.width/2-E.width/2,y:s.y+s.height/2}},47:function(f,W){return{x:f.x+f.width/2+W.width/2,y:f.y+f.height/2}},48:function(C){return{x:C.x+3*C.width/4,y:C.y+C.height/2}},49:function(X,u){return{x:X.x+X.width/2,y:X.y+X.height/2+u.height/2}},50:function(N,A){return{x:N.x+N.width/4,y:N.y+N.height-A.height/2}},51:function(s,H){return{x:s.x+3*s.width/4,y:s.y+s.height-H.height/2}},52:function(j){return{x:j.x+j.width/4,y:j.y+j.height}},53:function(b){return{x:b.x+3*b.width/4,y:b.y+b.height}},54:function(r,N){return{x:r.x+r.width/4,y:r.y+r.height+N.height/2}},55:function(T,d){return{x:T.x+3*T.width/4,y:T.y+T.height+d.height/2}}};return vr(H)?function(y,m,C){return K[y](m,C?C:xp)}:void 0}();im(s,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Kk=s.reverse,Op=s.transparent,_c=s.rectSelectBackground,cp=s.dash,xq=s.titleBackground,We=s.titleIconBackground,rr=s.headerBackground,yn=s.headerIconBackground,bh=s.headerSeparator,Ul=s.headerLine,ne=s.contentIconBackground,fq=s.contentLine,hd=(s.widgetIconHighlight,s.widgetIconBorder),rg=(s.widgetIconGradient,s.imageBackground),Qe=s.imageGradient,Ab=s.highlight,vp=s.label,gm=s.labelSelect;if(m&&!H.shutAlert1){var $j=new Date,Dd=m.split("-"),lp=new Date($j.getFullYear(),$j.getMonth(),$j.getDate()),m=new Date(W(Dd[0],10),W(Dd[1],10)-1,W(Dd[2],10)),$b=lp.getTime(),us=m.getTime(),Jo=l+"_try",gb=H.alert;try{var rh=H.localStorage;if(rh&&gb)if(us>$b&&1728e6>us-$b){var Yf=(us-$b)/864e5;rh&&rh[Jo]!=Yf&&(rh[Jo]=Yf,H.htWillExpire?gb(H.htWillExpire.replace("{{day}}",Yf)):gb("HT for Web free trial license will expire in "+Yf+" days, please apply for a new license!"))}else $b>=us&&(H.htExpired?gb(H.htExpired):gb("Your free trial of HT for Web has expired!")),rh&&delete rh[Jo]}catch(Bo){}}var Mr={ms_ac:function(z,B){for(var P=B.ms_ac,o=0;o<P.length;o++)ie(z,P[o])},ms_listener:function(D){D.addListeners=function(){for(var j=this,z=0;z<si.length;z++)j["handle_"+si[z]]&&Zr(si[z],j.getView(),j)},D.removeListeners=function(){for(var P=this,W=0;W<si.length;W++)P["handle_"+si[W]]&&fk(si[W],P.getView(),P)}},ms_fire:function(R){R.mp=function(s,Q,i){this.addPropertyChangeListener(s,Q,i)},R.ump=function(q,e){this.removePropertyChangeListener(q,e)},R.fp=function(s,J,t,C,g){return this.firePropertyChange(s,J,t,C,g)},R.addPropertyChangeListener=function(P,C,I){var g=this;g._62I||(g._62I=new Mj),g._62I.add(P,C,I)},R.removePropertyChangeListener=function(D,v){this._62I&&this._62I.remove(D,v)},R.firePropertyChange=function(l,S,L,x,M){if(x){if(x(S,L))return!1}else if(S===L)return!1;var H=this,y=M||{};return y.property=l,y.oldValue=S,y.newValue=L,y.source=H,y.data=H,H._62I&&H._62I.fire(y),H.onPropertyChanged&&H.onPropertyChanged(y),!0}},ms_attr:function(W){W.a=function(O,E){var e=this;if(2===arguments.length)e.setAttr(O,E);else{if(!yl(O))return e.getAttr(O);for(var i in O)e.setAttr(i,O[i])}return e},W.getAttr=function(W,T){if(T===J&&(T=1),this._attrObject&&W in this._attrObject)return this._attrObject[W];if(this.getImage){var p=this.getImage();if(Jp(p)&&(p=yf[p]),yl(p)&&"dataBindings"in p)for(var F=p.dataBindings,u=F.length-1;u>=0;u--){var R=F[u];if(R.attr===W){if("defaultValue"in R)return R.defaultValue;break}}}return T?y[W]:J},W.setAttr=function(O,M){var A=this;A._attrObject||(A._attrObject={});var p=A._attrObject[O];M===J?delete A._attrObject[O]:A._attrObject[O]=M,A.fp&&A.fp("a:"+O,p,M)&&A.onAttrChanged&&A.onAttrChanged(O,p,M)},W.getSerializableAttrs=function(){var j,R={};for(j in this._attrObject)R[j]=1;return R}},ms_bnb:function(q){q.getBodyColor=function(Q){return Q.s("body.color")},q.getBorderColor=function(o){return o.s("border.color")}},_51o:function(g){g.mi=function(N,O,A){this.addInteractorListener(N,O,A)},g.umi=function(W,M){this.removeInteractorListener(W,M)},g.fi=function(I){this.fireInteractorEvent(I)},g.addInteractorListener=function(U,z,d){var K=this;K._63I||(K._63I=new Mj),K._63I.add(U,z,d)},g.removeInteractorListener=function(P,w){this._63I.remove(P,w)},g.fireInteractorEvent=function(V){this._63I&&this._63I.fire(V)},g.setInteractors=function(x){var $=this,L=$._interactors;L&&L.each(function(e){e.tearDown()}),mo(x)&&(x=new nm(x)),$._interactors=x,x&&x.each(function(R){R.setUp()}),$.fp("interactors",L,x),$.invalidateSelection()},g.getInteractors=function(){return this._interactors}},_49o:function(e){e._44O=d,e._45O=d,e.getTopPainters=function(){return this._44O},e.getBottomPainters=function(){return this._45O},e.addTopPainter=function($){var J=this;J._44O||(J._44O=new nm),J._44O.contains($)||(J._44O.add($),J.redraw&&J.redraw())},e.removeTopPainter=function(w){var l=this;l._44O&&(l._44O.remove(w),l.redraw&&l.redraw())},e.addBottomPainter=function(s){var i=this;i._45O||(i._45O=new nm),i._45O.contains(s)||(i._45O.add(s),i.redraw&&i.redraw())},e.removeBottomPainter=function($){var b=this;b._45O&&(b._45O.remove($),b.redraw&&b.redraw())},e._93db=function(P,k){var t=this;t._45O&&t._45O.each(function(b){b.draw?b.draw(P,k):b.call(t,P,k)})},e._92db=function(Z,D){var z=this;z._44O&&z._44O.each(function(W){W.draw?W.draw(Z,D):W.call(z,Z,D)})}},ms_sm:function(O){O.sm=function(){return this.getSelectionModel()},O.setSelectableFunc=function(A){this.sm().setFilterFunc(A)},O.getSelectableFunc=function(){return this.sm().getFilterFunc()},O.getSelectionModel=function(){var M=this;return M._selectionModel?M._selectionModel:M.dm().sm()},O.isSelectionModelShared=function(){return!this._selectionModel},O.setSelectionModelShared=function(A){var z=this,q=!z._selectionModel,Z=z.handleSelectionChange,O=z.dm();q!==A&&(z.invalidateSelection&&z.invalidateSelection(),A?(O.sm().ms(Z,z),z._selectionModel.ums(Z,z),z._selectionModel.dispose(),z._selectionModel=d):(O.sm().ums(Z,z),z._selectionModel=new Lh(O),z._selectionModel.ms(Z,z)),z.onSelectionModelSharedChanged(),z.fp("selectionModelShared",q,A))},O.onSelectionModelSharedChanged=function(){var f=this;f.redraw(),f.invalidateSelection&&f.invalidateSelection()},O.removeSelection=function(){var U=this.dm();U.beginTransaction(),this.sm().toSelection().each(U.remove,U),U.endTransaction()},O.selectAll=function(){var e=this;e.sm().ss(e.dm().toDatas(function(j){return e.isVisible(j)&&e.isSelectable(j)}))},O.isSelected=function(l){return this.sm().co(l)},O.isSelectedById=function(s){var t=this.dm().getDataById(s);return t?this.isSelected(t):!1},O.isSelectable=function(Q){return this.sm().isSelectable(Q)}},ms_tx:function(g){g._64I=0,g._65O=0,g.isScrollable=function(){return this.getWidth()<this._64I},g._40o=function(){return this.isScrollable()},g.getLogicalPoint=function(b){return Ub(b,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},g.tx=function(r){return r===J?this.getTranslateX():(this.setTranslateX(r),void 0)},g.getTranslateX=function(){return this._65O},g.setTranslateX=function(S){var Z=this,$=Z.getWidth()-Z._64I;$>S&&(S=$),S>0&&(S=0),S=E(S);var s=Z._65O;Z._65O=S,Z.fp(gl,s,S)}},ms_ty:function(s){s._23Q=0,s._66O=0,s._41o=function(){return this.getHeight()<this._23Q},s.getLogicalPoint=function(T){return Ub(T,this._canvas||this._view,this.tx?this.tx():0,this.ty())},s.ty=function(i){return i===J?this.getTranslateY():(this.setTranslateY(i),void 0)},s.getTranslateY=function(){return this._66O},s.setTranslateY=function(F){var z=this,y=z.getHeight()-z._23Q;y>F&&(F=y),F>0&&(F=0),F=E(F);var s=z._66O;z._66O=F,z.fp(qk,s,F)}},ms_txy:function(I){I._65O=0,I._66O=0,I.tx=function(O){return O===J?this.getTranslateX():(this.setTranslateX(O),void 0)},I.ty=function(W){return W===J?this.getTranslateY():(this.setTranslateY(W),void 0)},I.onTranslateEnded=function(){},I.setTranslate=function(p,y,j){var G=this;if(j=Md(j)){G._65I&&G._65I.stop(!0);var H=G.tx(),f=G.ty();j.action=function(K){G.setTranslate(H+(p-H)*K,f+(y-f)*K)},j._37o=function(){delete G._66I,delete G._65I,G.onTranslateEnded()},G._66I=1,G._65I=Mc(j)}else G.tx(p),G.ty(y)},I.getTranslateX=function(){return this._65O},I.setTranslateX=function(k){var D=this;k=D.adjustTranslateX(k);var y=D._65O;D._65O=k,D.fp(gl,y,k)},I.getTranslateY=function(){return this._66O},I.setTranslateY=function(r){var k=this;r=k.adjustTranslateY(r);var E=k._66O;k._66O=r,k.fp(qk,E,r)},I.adjustTranslateX=function(a){return E(a)},I.adjustTranslateY=function(r){return E(r)},I.translate=function(E,d,q){this.setTranslate(this.tx()+E,this.ty()+d,q)},I.getLogicalPoint=function(E){var D=this;return Ub(E,this._canvas||D._view,D.tx(),D.ty())}},ms_dm:function($){$.dm=function(R){return R?(this.setDataModel(R),void 0):this.getDataModel()},$.getDataModel=function(){return this._dataModel}},ms_lp:function(g){g.lp=function(p){return this.getLogicalPoint(p)}},ms_v:function(k){k._disabled=!1,k.setDisabled=function($,c){var q=this,s=q._disabled;s!==$&&(s&&(Hq(q._63O),delete q._63O),$&&(oq(q._view,q._63O=xs(c)),q.iv()),q._disabled=$,q.fp("disabled",s,$))},k.isDisabled=function(){return this._disabled},k.getDisabledDiv=function(){return this._63O},k.getView=function(){return this._view},k.addToDOM=function(g){var v=this,B=v.getView(),m=B.style;g=g||b.body,g.appendChild(B),m.left="0",m.right="0",m.top="0",m.bottom="0",H.addEventListener("resize",function(){v.iv()},N),v.iv()},k.getWidth=function(){return this._view.clientWidth},k.getHeight=function(){return this._view.clientHeight},k.setWidth=function(s){var S=this;S._view.style.width=s+Cf,S.iv(),S.fp&&S.fp(ib,d,s)},k.setHeight=function(D){var i=this;i._view.style.height=D+Cf,i.iv(),i.fp&&i.fp(Kq,d,D)},k.setFocus=function(I){var j=this,i=j._currentEditor;return I&&i&&(i.getView&&(i=i.getView()),i.contains(I.target))?!1:(Wr(j._view),j.endEditing&&j.endEditing(),j.fireViewEvent("focus"),!0)},k.iv=function(X){this.invalidate(X)},k.invalidate=function(Y){var w=this;w._68I||(w._68I=1,Vo(w.validate,w,d,Y),w.onInvalidated&&w.onInvalidated(),w.fireViewEvent("invalidate"))},k.validate=function(){var R=this,x=R._view;if(R._68I&&(delete R._68I,x.parentNode))if(0===x.offsetWidth&&0===x.offsetHeight&&R._67I!==d)R._67I===J&&(R._67I=F.reinvalidateCount),R._67I>0?R._67I--:R._67I=d,R.iv();else{R.fireViewEvent("beginValidate"),R.validateImpl(),R.onValidated&&R.onValidated(),R.fireViewEvent("validate");var U=R._63O;U&&(x.lastChild!==U&&(Hq(U),oq(x,U)),Hi(U,0,0,R.getWidth(),R.getHeight())),kf(R),$f(R),Cn(R)}},k.layout=function(i,w,L,y){1===arguments.length?Hi(this,i):Hi(this,i,w,L,y)},k.addViewListener=function(W,w,d){var e=this;e._67O||(e._67O=new Mj),e._67O.add(W,w,d)},k.removeViewListener=function(A,v){this._67O.remove(A,v)},k.fireViewEvent=function(n){var Z=this;Z._67O&&(Jp(n)&&(n={kind:n}),Z._67O.fire(n)),F.viewListener&&F.viewListener(Z,n)}},ms_tip:function(l){l.setToolTipEnabled=function(o){var m=this;o?Qr||m._13o||(m.enableToolTip(),m.fp("toolTipEnabled",!1,!0)):m._13o&&(m.disableToolTip(),m.fp("toolTipEnabled",!0,!1))},l.isToolTipEnabled=function(){return!!this._13o},l.enableToolTip=function(){var r=this;Qr||r._13o||(r._13o=function(O){var q=r.getToolTip(O);q!=d?F.toolTipContinual&&F.isToolTipShowing()?oc(O,q):(de(),Hj={timeout:_(Cm,Rh),e:O,info:q}):de()},r.getView().addEventListener(Br,r._13o,N),r.getView().addEventListener("mouseleave",F.hideToolTip,N))},l.disableToolTip=function(){var n=this;n._13o&&(n.getView().removeEventListener(Br,n._13o,N),n.getView().removeEventListener("mouseleave",F.hideToolTip,N),delete n._13o)},l.getToolTip=function(f){var g=this;if(g.getDataAt){var v=g.getDataAt(f);return v?v.getToolTip():d}return g.getValue?g.getValue():void 0}},_52o:function(t){t._zoom=1,t._29I=xp,t.zoomIn=function(f,w){this.setZoom(this._zoom*Ki,f,w)},t.zoomOut=function(p,K){this.setZoom(this._zoom/Ki,p,K)},t.zoomReset=function(Y,$){this.setZoom(1,Y,$)},t.scrollZoomIn=function(S){this.setZoom(this._zoom*yr,d,S)},t.scrollZoomOut=function(b){this.setZoom(this._zoom/yr,d,b)},t.pinchZoomIn=function(Z){this.setZoom(this._zoom*ik,d,Z)},t.pinchZoomOut=function(q){this.setZoom(this._zoom/ik,d,q)},t.adjustZoom=function(k){return tr>k?tr:k>Gj?Gj:k},t.getZoom=function(){return this._zoom},t.setZoom=function(B,r,g){var L=this;if(r=Md(r)){L._14o&&L._14o.stop(!0);var w=L._zoom;r.action=function(q){L._96O(w+(B-w)*q,g)},r._37o=function(){delete L._zooming,delete L._14o,L.onZoomEnded()},L._zooming=1,L._14o=Mc(r)}else L._96O(B,g)},t._96O=function(s,e){var z=this;if(s=z.adjustZoom(s),s!==z._zoom){z.validate();var r=z._29I,Y=z._zoom;0!==r.width&&0!==r.height&&(e=e?e:{x:r.x+r.width/2,y:r.y+r.height/2},z.tx((e.x-r.x)*Y-e.x*s),z.ty((e.y-r.y)*Y-e.y*s)),z._zoom=s,z.fp("zoom",Y,s)}}},ms_edge:function(r){r._2I=function(K){var l=this;l._44I||(l._44I=new nm),l._42I||(l._42I=new nm),l._44I.add(K),l._42I.add(K),l._20I()},r._4I=function(s){var f=this;f._44I||(f._44I=new nm),f._43I||(f._43I=new nm),f._44I.add(s),f._43I.add(s),f._20I()},r._16I=function(z){var g=this;g._44I.remove(z),g._42I.remove(z),g._44I.isEmpty()&&delete g._44I,g._42I.isEmpty()&&delete g._42I,g._20I()},r._18I=function(V){var d=this;d._44I.remove(V),d._43I.remove(V),d._44I.isEmpty()&&delete d._44I,d._43I.isEmpty()&&delete d._43I,d._20I()},r._20I=function(){var v=this;if(delete v._45I,!v._44I||v._44I.isEmpty())return delete v._70O,void 0;var H;v._44I.each(function(F){F.isLooped()&&(H||(H={}),H[F._id]||(v._45I||(v._45I=new nm),v._45I.add(F),H[F._id]=F))}),H?(v._70O=new nm,v._44I.each(function(i){H[i._id]?"A"===H[i._id]||(H[i._id]="A",v._70O.add(i)):v._70O.add(i)})):v._70O=v._44I},r.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},r.getSourceAgentEdges=function(){return this._46I},r.getTargetAgentEdges=function(){return this._47I},r._1I=function(N){var p=this;p._46I||(p._46I=new nm),p._48I||(p._48I=new nm),p._46I.add(N),p._48I.add(N),p._19I()},r._3I=function(S){var C=this;C._47I||(C._47I=new nm),C._48I||(C._48I=new nm),C._47I.add(S),C._48I.add(S),C._19I()},r._15I=function(N){var y=this;y._46I.remove(N),y._48I.remove(N),y._46I.isEmpty()&&delete y._46I,y._48I.isEmpty()&&delete y._48I,y._19I()},r._17I=function(c){var b=this;b._47I.remove(c),b._48I.remove(c),b._47I.isEmpty()&&delete b._47I,b._48I.isEmpty()&&delete b._48I,b._19I()},r._19I=function(){var K=this;delete K._49I;var a=K._48I;if(a&&!a.isEmpty()){var o={};a.each(function(T){o[T._id]?K._49I||(K._49I=new nm):o[T._id]=T}),K._49I?a.each(function(r){o[r._id]&&(K._49I.add(r),delete o[r._id])}):K._49I=a}},r.getLoopedEdges=function(){return this._45I},r.getEdges=function(){return this._70O},r.getAgentEdges=function(){return this._49I},r.getSourceEdges=function(){return this._42I},r.getTargetEdges=function(){return this._43I},r._8I=function(){this._70O&&this._70O.each(function(h){h._7I()})}}};im(F,{numberDigits:5,crossOrigin:"",baseZIndex:J,isTouchable:Qr,devicePixelRatio:H.devicePixelRatio?H.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:s.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return yd},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:Qr?20:1,animDuration:200,animEasing:function(c){return c*c},labelColor:vp,labelSelectColor:gm,labelFont:(Qr?"15":"12")+"px arial, sans-serif",widgetIndent:Qr?30:20,widgetRowHeight:Qr?30:20,widgetHeaderHeight:Qr?32:22,widgetTitleHeight:Qr?34:24,scrollBarColor:Op,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Qr?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:ns,intersectionLineLine:Uf,isEnter:mq,isEsc:xd,isDelete:fd,isSpace:br,isLeft:Xe,isUp:ci,isRight:Vf,isDown:Vk,getTarget:ji,isString:Jp,isNumber:nq,isBoolean:dr,isArray:mo,isSelectAll:nd,isFunction:sr,isObject:yl,getPropertyValue:Vm,setPropertyValue:bo,addMethod:im,getVersion:function(){return"7.0.1"},createGradient:function(O,q,Y,U,T,v,$,L){var Z=Un[q];return Z(O,Y,U,T,v,$,L)},appendToScreen:function(e){e=e.getView?e.getView():e,(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement||b.body).appendChild(e)},encodeString:function(c){return P.Math.encodeBase64(c,F.encodeStringKey)},decodeString:function(R){return P.Math.decodeBase64(R,F.encodeStringKey)},toggleFullscreen:function(l){var c=l.getView();if(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement)b.exitFullscreen?b.exitFullscreen():b.msExitFullscreen?b.msExitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitExitFullscreen&&b.webkitExitFullscreen();else{var x=!0;if(l.isSelfViewEvent){var v=l.getX(),C=l.getY(),$=l.getWidth(),e=l.getHeight(),u=c.style.background,Z=c.style.backgroundColor;u||Z||(c.style.backgroundColor="white"),c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen();var z=setInterval(function(){if(c!==(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement))clearInterval(z),l.setX(v),l.setY(C),l.setWidth($),l.setHeight(e),l._fullscreen=!1,c.style.oldBackgroundColor=Z,l.iv();else{var g=P.Default.getWindowInfo();(x||g.width!==l.getWidth()||g.height!==l.getHeight())&&(l.setX(g.left),l.setY(g.top),l.setWidth(g.width),l.setHeight(g.height),l._fullscreen=!0,l.iv(),x=!1)}},500)}else{var d=c.style.left,s=c.style.top,$=c.style.width,e=c.style.height,u=c.style.background,Z=c.style.backgroundColor;u||Z||(c.style.backgroundColor="white"),c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen();var z=setInterval(function(){if(c!==(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement))clearInterval(z),c.style.left=d,c.style.top=s,c.style.width=$,c.style.height=e,c.style.oldBackgroundColor=Z,l.iv();else{var T=P.Default.getWindowInfo();(x||T.width!==l.getWidth()||T.height!==l.getHeight())&&(Hi(l),x=!1)}},500)}}},appendTimeStamp:function(p){return p},setCompType:function(q,W){sr(W)||yl(W)?Od[q]=W:dd(q)},getCompType:function(m){var T=Od[m];return T===J&&uj.test(m)&&dd(m),T},getCompTypeMap:function(){return Od},drawCompType:function(e,J,u,r,C,D){e(J,u,r,C,D)},numberListener:function(){var z={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(w){var x=w.keyCode;z[x]||65===x&&F.isCtrlDown(w)||86===x&&F.isCtrlDown(w)||67===x&&F.isCtrlDown(w)||88===x&&F.isCtrlDown(w)||x>=35&&40>=x||(w.shiftKey||48>x||x>57)&&(96>x||x>105)&&w.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(p){var _=p.target.tagName;("DIV"===_||"CANVAS"===_)&&!(F.ignoreKeyCodes.indexOf(p.keyCode)>=0)&&("keydown"!==p.type||Xe(p)||Vf(p)||ci(p)||Vk(p)||fd(p)||65===p.keyCode&&(p.metaKey||p.ctrlKey))&&(p.preventDefault(),p.preventManipulation&&p.preventManipulation())},getWindowInfo:function(){var j=b.documentElement,k=j&&(j.scrollLeft||j.scrollTop)?j:b.body;return{target:k,left:k.scrollLeft,top:k.scrollTop,width:H.innerWidth||k.clientWidth,height:H.innerHeight||k.clientHeight}},isDragging:function(){return!!yd},isLeftButton:function(c){return Qr?!0:0===c.button},isMiddleButton:function(u){return Qr?!1:u&&(1===u.button||4&(u.buttons||0))},isInput:function(q){if(!q)return!1;var p=q.tagName;return"INPUT"===p||"TEXTAREA"===p||"SELECT"===p},getTouchCount:function(u){return Qr?u.touches.length:1},isDoubleClick:function(){function S(A){A.details=0,A.timeout=null,A.lastPoint=null}var D={};return _r=new I,ad=_r.getTime(),function(a){if(a.touches&&a.touches.length>1)return!1;var w=a.button==d?"":a.button,s=a.type+w,v=s+"_isDoubleClick",W=D[s];if(W||(W=D[s]={details:0,timeout:null,lastPoint:null}),a[v]===J){a[v]=!0;var Y=vd(a);W.timeout&&(i(W.timeout),W.timeout=null),W.lastPoint&&jc(W.lastPoint,Y)>F.doubleClickRange&&S(W),W.lastPoint=Y,W.details++,W.timeout=_(function(){S(this)}.bind(W),500)}return 2===W.details}}(),isShiftDown:function(o){return o?o.shiftKey:js["16"]},isCtrlDown:function(e){return e?fi?e.metaKey:e.ctrlKey:fi?js["91"]:js["17"]},getClientPoint:function(e){return Qr&&(e=Ok(e)),{x:e.clientX,y:e.clientY}},isMouseEvent:function(P){return P instanceof MouseEvent||0===P.type.indexOf("mouse")},getTargetElement:function(O){if(F.isMouseEvent(O)||!b.elementFromPoint)return O.target;var N=Rp(O);return b.elementFromPoint(N.x,N.y)},getPagePoint:function(L){return Qr&&(L=Ok(L)),{x:L.pageX,y:L.pageY}},createObject:function(I,E){var Q=new I;for(var C in E){var M=E[C];if(sr(M))Q[C]=M;else if(0===C.indexOf("s:"))Q.s(C.substr(2),E[C]);else if(0===C.indexOf("a:"))Q.a(C.substr(2),E[C]);else{var e=Hb(C),M=E[C];Q[e]?(Q[e](M),"setToolTip"===e&&Q.enableToolTip&&Q.enableToolTip()):Q[C]=M}}return Q},setImage:function(P,s,r,u){var F=arguments.length;4===F?Ie(P,u,s,r):2===F?Jp(s)?Ie(P,s):Im(P,s):1===F&&Ie(P,P)},getImage:function(y,u,_){var X;if(y==d)return d;if(yl(y)?X=y:(X=yf[y],y&&X===J&&(gj&&gj[y]||Ie(y,y))),u&&X&&X.tagName){var V;V="override"===_?"colors_override":"override_rgb"===_?"colors_override_rgb":"override_a"===_?"colors_override_a":"colors",X[V]||(X[V]={__count__:0});var P=X[V][u];return P||(X[V].__count__>F.imageCacheThreshold&&(X[V]={__count__:0}),P=Fj(X,Xc(u),X.width,X.height,_),X[V][u]=P,X[V].__count__++),P}return X},isImageComplete:function(b,Y,u){var Z=Hf(b);if(!Z)return!1;if(Z.tagName)return Z.complete;for(var i,b,r,Q=Z.comps,x=!0,I=0,K=Q.length;K>I;I++)if(i=Q[I],r=i.type,"image"===i.type){b=i.name,b&&b.func&&(b=Wf(b,Y));var S=Hc(b,Y,u);if(!S){x=!1;break}}else if(uj.test(r)&&F.getCompType(r)===J){x=!1,dd(r);break}return x},getId:function(){var O=1;return function(){return++O}}(),callLater:function(b,M,Y,y){var g=function(){b.apply(M,Y)};return y?_(g,y):H.requestAnimationFrame(g)},clone:function(K){if(null==K||"object"!=typeof K)return K;if(K instanceof Date){var M=new Date;return M.setTime(K.getTime()),M}if(K instanceof Array){for(var M=[],V=0,E=K.length;E>V;V++)M[V]=oe(K[V]);return M}if(K instanceof nm){for(var M=new nm,V=0,E=K.length;E>V;V++)M.set(V,oe(K.get(V)));return M}if(K instanceof Oc)return K;if(K instanceof r){var M={};for(var u in K)K.hasOwnProperty(u)&&(M[u]=oe(K[u]));return M}return K},callWhenLoaded:function(M,T){T=T||100;var n=Cr(M,T);Jr||(Jr={}),Jr[n]={tick:n,cb:M,delay:T}},beforeLoadURL:function(r){if(Jr){var T={};for(var L in Jr){var h=Jr[L];i(h.tick);var m=Cr(h.cb,h.delay);T[m]={tick:m,delay:h.delay,cb:h.cb}}Jr=T}return F.convertURL?F.convertURL(r):r},convertURL:function(K){return K},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return F.getImage("default_blank")},sortFunc:function(o,Q){if(o===Q)return 0;if(o==d&&Q!=d)return 1;if(o!=d&&Q==d)return-1;if(o==d&&Q==d)return 0;var C,r=typeof o,H=typeof Q;return r===Ye&&H===Ye?C=o.localeCompare(Q):r===ml&&H===ml&&(C=o-Q),C===J&&(C=(""+o).localeCompare(""+Q)),C>0?1:0>C?-1:0},getClassMap:function(){return _g},getClass:function(q){if(Jp(q)){var b,Q=_g[q];if(!Q){b=q.split("."),Q=H;for(var d=0;d<b.length;d++)Q=Q[b[d]];_g[q]=Q}return Q}return q},def:function(X,n,O){var U,g,c,P=function(){};if(P.prototype=n.prototype,U=new P,Jp(X)){if(_g[X])throw"'"+X+"' already defined";c=bc(X),U.getClassName=function(){return X}}else c=X;if(U.constructor=c,U.getClass=function(){return c},U.getSuperClass=function(){return n},O)for(g in O)Mr[g]&&Mr.hasOwnProperty(g)?Mr[g](U,O):Pd(U,O,g);c.prototype=U,c.superClass=n.prototype},startAnim:function(){var y=function(e){e.duration&&(e.startTime=Ph()),e.timeId=Vo(e.tick,d,d,e.interval)};return function(s){return s=oe(s),s.easing=s.easing||F.animEasing,s.duration||s.frames||(s.duration=F.animDuration),s.t=0,s.duration?s.interval=0:(s.frame=0,s.interval=s.interval||10),s.tick=function(){if(s.duration){var Z=(Ph()-s.startTime)/s.duration;if(Z>1&&(Z=1),s.t=Z,s.action(s.easing(Z),Z),!s.isRunning())return;1===Z?s.stop():s._isPaused||(s.timeId=Vo(s.tick))}else{if(s.frame++,Z=s.t=s.frame/s.frames,s.action(s.easing(Z),Z),!s.isRunning())return;s.frame<s.frames?s._isPaused||(s.timeId=Vo(s.tick,d,d,s.interval)):s.stop()}},s.resume=function(){s._isPaused&&(delete s._isPaused,s.duration?s.t<1&&(s.startTime=Ph()-s.duration*s.t,s.timeId=Vo(s.tick)):s.frame<s.frames&&(s.timeId=Vo(s.tick,d,d,s.interval)))},s.pause=function(){s._isPaused=!0},s.isPaused=function(){return this._isPaused},s.stop=function(r){s.isRunning()&&(In(s.timeId,!s.duration),delete s.timeId,s.duration?s.t<1&&r&&(s.t=1,s.action(s.easing(1),1)):s.frame<s.frames&&r&&(s.frame=s.frames,s.action(s.easing(1),1)),s._37o&&s._37o(),s.finishFunc&&s.finishFunc())
},s.isRunning=function(){return s.timeId!=d},s.delay?Vo(y,d,[s],s.delay):y(s),s}}(),getTextSize:function(){var t={},n=b?Ni().getContext("2d"):d;return function(Y,T){n.font=Y?Y:xr;var c=t[n.font];return c||(c=2*n.measureText("e").width+4,t[n.font]=c),{width:n.measureText(T).width+4,height:c}}}(),drawText:function(j,b,Q,$,G,s,i,E,w,A){if(b!=d){var S=Zj(Q,b),c={};c.y=A&&A!==Pl?A===ai?s+S.height/2:s+E-S.height/2:s+E/2,c.x=w&&w!==Km?w===_i?G+i-S.width/2:G+i/2:G+S.width/2,gn(j,b,c,Q,$)}},getDistance:function(d,q){var M=d.length;return q?3===M?w(x(d[0]-q[0])+x(d[1]-q[1])+x(d[2]-q[2])):2===M?w(x(d[0]-q[0])+x(d[1]-q[1])):d.z===J?w(x(q.x-d.x)+x(q.y-d.y)):w(x(q.x-d.x)+x(q.y-d.y)+x(q.z-d.z)):3===M?w(x(d[0])+x(d[1])+x(d[2])):2===M?w(x(d[0])+x(d[1])):void 0},brighter:function(m,o){return 0>o&&(o=-o),qm(m,o?o:40)},darker:function(N,_){return _>0&&(_=-_),qm(N,_?_:-40)},unionPoint:function(W,n){if(!W)return d;if(2===arguments.length)return W&&n?{x:e(W.x,n.x),y:e(W.y,n.y),width:j(W.x-n.x),height:j(W.y-n.y)}:d;var Y=W;if(Y._as&&(Y=Y._as),Y.length===J)return d;var u=Y.length;if(0>=u)return d;for(var L=1,h=Y[0],U={x:h.x,y:h.y,width:0,height:0};u>L;L++){h=Y[L];var D=e(U.x,h.x),K=T(U.x+U.width,h.x),M=e(U.y,h.y),x=T(U.y+U.height,h.y);U.x=D,U.y=M,U.width=K-D,U.height=x-M}return U},unionRect:function(F,Y){if(F&&!Y)return oe(F);if(!F&&Y)return oe(Y);if(F&&Y){var X={x:e(F.x,Y.x),y:e(F.y,Y.y)};return X.width=T(F.x+F.width,Y.x+Y.width)-X.x,X.height=T(F.y+F.height,Y.y+Y.height)-X.y,X}return d},containsPoint:function(G,o,n,R){if(R!=d&&1!==R){var r=G.x+G.width/2,A=G.y+G.height/2;G={x:r-G.width/2*R,y:A-G.height/2*R,width:G.width*R,height:G.height*R}}if(n){var L=G.width/2,h=G.height/2,S=Z(-n),D=v(-n),f=o.x-G.x-L,Y=o.y-G.y-h;return o={x:D*f-S*Y,y:S*f+D*Y},mb({x:-L,y:-h,width:G.width,height:G.height},o)}return!(!G||o.x<G.x||o.y<G.y||o.x>G.x+G.width||o.y>G.y+G.height)},containsRect:function(H,$){if(!H||!$)return!1;var t=$.x,R=$.y,z=$.width,e=$.height,G=H.width,S=H.height;if(0>(G|S|z|e))return!1;var A=H.x,h=H.y;if(A>t||h>R)return!1;if(G+=A,z+=t,t>=z){if(G>=A||z>G)return!1}else if(G>=A&&z>G)return!1;if(S+=h,e+=R,R>=e){if(S>=h||e>S)return!1}else if(S>=h&&e>S)return!1;return!0},intersectsRect:function(L,B){if(!L||!B)return!1;var k=B.width,F=B.height,e=L.width,A=L.height;if(0>=e||0>=A||0>=k||0>=F)return!1;var M=B.x,d=B.y,y=L.x,X=L.y;return e+=y,A+=X,k+=M,F+=d,e>M&&A>d&&k>y&&F>X},intersection:function(S,H){if(!S||!H)return d;var Q=H.x,u=H.y,g=S.x,T=S.y,k=Q,O=u,U=g,p=T;return k+=H.width,O+=H.height,U+=S.width,p+=S.height,g>Q&&(Q=g),T>u&&(u=T),k>U&&(k=U),O>p&&(O=p),k-=Q,O-=u,0>=k||0>=O?d:{x:Q,y:u,width:k,height:O}},grow:function(n,v,D){D===J&&(D=v),n.x-=v,n.y-=D,n.width=n.width+2*v,n.height=n.height+2*D},getScreenPoint:function(m,d,n,P,Q,S,$){var v=n.getBoundingClientRect(),s=m*(S||1)+v.left-n.scrollLeft+(P||0),k=d*($||1)+v.top-n.scrollTop+(Q||0),R={x:s,y:k},f=zl(n.parentElement);return f?f.applyInverse(R,{}):R},getLogicalPoint:function(O,g,D,$,c,v){var Y,U,a=g.getBoundingClientRect();O.target?(nr(O)?fi?js["91"]=!0:js["17"]=!0:fi?js["91"]=!1:js["17"]=!1,js["16"]=xk(O)?!0:!1,O=Qr?Ok(O):O,Y=O.clientX,U=O.clientY):(Y=O.x,U=O.y);var r=zl(g);if(r){var L=r.apply({x:Y,y:U},{});return L.x=(L.x+g.scrollLeft-(D||0))/(c||1),L.y=(L.y+g.scrollTop-($||0))/(v||1),L}return{x:(Y-a.left+g.scrollLeft-(D||0))/(c||1),y:(U-a.top+g.scrollTop-($||0))/(v||1)}},removeHTML:function(){var s;return function(z){return z&&z.getView&&(z=z.getView()),z&&z.parentNode?s===z?!0:(s=z,z.parentNode.removeChild(z),s=d,!0):!1}}(),getToolTipDiv:function(){if(!Fn){Fn=rp(),cc=rp();var Q=Fn.style;F.baseZIndex!=d&&(Q.zIndex=W(F.baseZIndex)+3+""),Q.whiteSpace="nowrap",Q.color=F.toolTipLabelColor,Q.background=F.toolTipBackground,Q.font=F.toolTipLabelFont,Q.padding="5px",Q.boxShadow="0px 0px 3px "+F.toolTipShadowColor}return Fn},isToolTipShowing:function(){return Fn&&Fn.parentNode?!0:cc&&cc.parentNode?!0:!1},hideToolTip:function(){Hq(Fn),Hq(cc),Wh()},showToolTip:function(j,m){if(!j||m==d)return de(),void 0;F.getToolTipDiv();var t,a;if(m.html?(m=m.html,t=cc,Hq(Fn)):(t=Fn,Hq(cc)),a=t.style,t.innerHTML=m,t.parentNode||P.Default.appendToScreen(t),j.target){j=Rp(j);var v=Xd(),i=j.x,l=j.y,Z=Qr?60:12;if(Qr){var s=t.getBoundingClientRect();a.left=i-s.width/2+Cf,a.top=l-s.height-Z<v.top?l+Z+Cf:l-s.height-Z+Cf}else{a.left=i+Z+Cf,a.top=l+Z+Cf;var s=t.getBoundingClientRect();s.left+s.width>v.width&&(a.left=i-Z-s.width+Cf),s.top+s.height>v.height&&(a.top=l-Z-s.height+Cf),s.left<0&&(a.left=i+Z+Cf),s.top<0&&(a.top=l+Z+Cf)}}else a.left=j.x+Cf,a.top=j.y+Cf;Wh()},startDragging:function(Q,k,j){j==J&&(j=!0),Q!==yd&&(yd?j&&(Qr?yd.handleWindowTouchEnd(k):yd.handleWindowMouseUp(k)):Qr?(H.addEventListener(ap,ri,N),H.addEventListener(Rr,Sr,N)):(H.addEventListener(Br,Wc,N),H.addEventListener(Kf,Tj,N)),yd=Q)},getImageMap:function(){return yf},toBoundaries:function(W,U,O,w){var $=[];return vm(W,U,O,w).forEach(function(M){var v=[];M.forEach(function(R){v.push(R.x,R.y)}),$.push(v)}),$},getCurrentKeyCodeMap:function(){return js},drawCenterImage:function(D,v,o,z,k,R,K,t){var e=li(v,k,R),W=Kn(v,k,R);Pp(D,v,E(o-e/2),E(z-W/2),e,W,k,R,K,t)},drawStretchImage:function(z,l,s,g,K,Z,$,n,y,S,o,w){var W,u=li(l,n,y,Z),j=Kn(l,n,y,$);"uniform"===s?(W=e(Z/u,$/j),u*=W,j*=W,g+=E((Z-u)/2),K+=E(($-j)/2),Z=u,$=j):"centerUniform"===s&&((u>Z||j>$)&&(W=e(Z/u,$/j),u*=W,j*=W),g+=E((Z-u)/2),K+=E(($-j)/2),Z=u,$=j);var v=z.interactiveInfo;if(v){var V;if(V="center"===s?{x:g+Z/2-u/2,y:K+$/2-j/2,width:u,height:j}:{x:g,y:K,width:Z,height:$},v.rect){var J=v.compInfos,m=J.length;m&&(J[m-1].rect.image=l)}else v.rect=V}if("center"===s){var U=o!==!1&&(u>Z||j>$);U&&(z.save(),z.beginPath(),z.rect(g,K,Z,$),z.clip()),Pp(z,l,g+Z/2-u/2,K+$/2-j/2,u,j,n,y,S,w),U&&z.restore()}else Pp(z,l,g,K,Z,$,n,y,S,w)},toCanvas:function(t,i,p,H,C,o,P,I,v){t=Hf(t,P),i=i||li(t,C),p=p||Kn(t,C);var $=Ni(),c=Hr($);return I?(lr($,i,p,I),c.scale(I,I)):lr($,i,p,1),wo(c,t,H,0,0,i,p,C,o,P,v),t&&t.clampToEdge&&($.clampToEdge=t.clampToEdge),c.restore(),$},toGrayColor:function(I){if(!I)return I;var h=Yl(I),Q=.299*h[0]+.587*h[1]+.114*h[2];return"rgba("+Q+","+Q+","+Q+","+h[3]/255+")"},createGradientImage:function(T,S,M,i){for(var Z=["L",0,0,T,0,1,0,0,1,0,0],a=0,z=Math.min(S.length,M.length);z>a;a++)Z.push(M[a],S[a]);var Q=P.Default.toCanvas({width:T,height:T,clampToEdge:!0,comps:[{type:"shape",rotation:i||0,points:[0,0,T,0,T,T,0,T],background:"#ffffff",gradientPack:Z}]});return Q},createElement:function(m,v,R,A){var x=b.createElement(m);return Jb(x,v||s.widgetBorder,2),x.style.font=R?R:xr,A!=d&&(x.value=A),F.onElementCreated&&F.onElementCreated(x),x},containedInView:function(k,O){var R=Wd(O).getBoundingClientRect();return mb({x:R.left,y:R.top,width:R.width,height:R.height},vd(k))},isIsolating:function(){return $m>0},setIsolating:function(b){b?$m++:$m--},getMSMap:function(){return Mr},stringify:function(G,O,X){var n=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var Y=JSON.stringify(G,function(b,G){return"function"==typeof G?"__ht__"+(G.__ht__||G.toString()):nq(G)?$l(G):G instanceof P.List?"__ht__list"+(G.__ht__list||F.stringify(G._as)):G},O==d?2:O);return Date.prototype.toJSON=n,X&&(Y="__ht__encode"+F.encodeString(Y)),Y},parse:function(h){return Jp(h)?"__ht__encode"!=h.substr(0,12)||(h=F.decodeString(h.substr(12)),Jp(h))?JSON.parse(h,function(q,b){if(Jp(b))if("__ht__function"==b.substr(0,14)){var l=b.indexOf("{")+1,N=b.lastIndexOf("}"),z=b.indexOf("(")+1,h=b.indexOf(")");if(l&&N&&z&&h){var m=new Function(b.substring(z,h),b.substring(l,N));return m.__ht__=b.substr(6),m}}else{if("__ht__date"==b.substr(0,10))return new Date(W(b.substr(10)));if("__ht__list"===b.substr(0,10))return new nm(F.parse(b.substr(10)))}return b}):h:h},loadJS:function(O,r){r&&O.push(r);var x=O.shift();if(mo(x))O=x.contact(O),F.loadJS(O);else if(sr(x))x(),F.loadJS(O);else if(Jp(x)){var G=b.createElement("script");G.onload=function(){F.loadJS(O)},G.setAttribute("src",x),b.getElementsByTagName("head")[0].appendChild(G)}else O.length&&F.loadJS(O)},toRoundedCorner:function(f,b){var E=f.size();if(0>=b)return{points:f};var G,P=new nm,H=new nm,K=f.get(0);P.add(K),H.add(1);for(var u=1;E>u;u++)if(E>u+1){var t=f.get(u),I=f.get(u+1),i=K.x,_=K.y,V=t.x,x=t.y,T=x-_,S=V-i,y=k(T,S);G=e(.99*jc(K,t),b),P.add({x:V-G*v(y),y:x-G*Z(y)}),P.add(t),i=t.x,_=t.y,V=I.x,x=I.y,T=x-_,S=V-i,y=k(T,S),G=e(.99*jc(t,I),b),K={x:i+G*v(y),y:_+G*Z(y)},P.add(K),H.addAll([2,3])}else P.add(f.get(u)),H.add(2);return{points:P,segments:H}},toColorData:Yl,setCanvas:lr,createDiv:rp,createDisabledDiv:xs,createView:up,createCanvas:Ni,appendChild:oq,initContext:Hr,checkLoadingImage:kf,translateAndScale:zm,layout:Hi,getPosition:ui,drawPoints:Bs,drawRoundRect:Mq,drawBorder:rl,setFocus:Wr,getter:Be,setter:Hb,isEmptyObject:nf},!0),im(q,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var dc=F.disabledOpacity,Rh=F.toolTipDelay,th=F.devicePixelRatio,Rk=F.autoMakeVisible,lb=F.autoHideScrollBar,Ib=F.imageGradient,oc=F.showToolTip,de=F.hideToolTip,Pm=F.dashPattern,jb=F.lineCap,Sp=F.lineJoin,co=F.labelColor,Oh=F.labelSelectColor,xr=F.labelFont,Lm=F.widgetIndent,ue=F.widgetRowHeight,aj=F.widgetHeaderHeight,wl=F.widgetTitleHeight,Pj=F.scrollBarColor,_p=F.scrollBarSize,vs=F.scrollBarTimeout,ls=F.scrollBarMinLength,Bm=F.scrollBarInteractiveSize,Ki=F.zoomIncrement,yr=F.scrollZoomIncrement,ik=F.pinchZoomIncrement,Gj=F.zoomMax,tr=F.zoomMin,sd=F.createObject,_l=F.preventDefault,Zh=F.setImage,Hf=F.getImage,Hc=F.isImageComplete,dg=F.drawCenterImage,wo=F.drawStretchImage,Wm=F.getId,Vo=F.callLater,kb=F.sortFunc,oe=F.clone,bc=F.getClass,Mc=F.startAnim,iq=F.brighter,rm=F.darker,Kh=F.drawText,Zj=F.getTextSize,fs=F.isLeftButton,Ur=F.isMiddleButton,So=F.getTouchCount,As=F.isDoubleClick,xk=F.isShiftDown,nr=F.isCtrlDown,vd=F.getClientPoint,Rp=F.getPagePoint,jc=F.getDistance,io=F.unionPoint,kr=F.unionRect,mb=F.containsPoint,Hh=F.containsRect,Ri=F.intersectsRect,hh=F.intersection,Xd=F.getWindowInfo,ub=F.grow,Ub=F.getLogicalPoint,Cp=F.getScreenPoint,Pb=F.startDragging,Hq=F.removeHTML,bj=F.createElement,Zn=F.segmentResolution,wm=F.shapeResolution,mk=F.shapeSide,$o=F.def,as=function(H,s,B){$o(l+"."+H,s,B)},Ff=function(E,G){E.childNodes.forEach(function(F){G(F),Ff(F,G)})};im(F,{toolTipLabelColor:co,toolTipLabelFont:xr,toolTipBackground:s.toolTipBackground,toolTipShadowColor:Op,drawBreakableText:ye,setDevicePixelRatio:function($){th=F.devicePixelRatio="number"==typeof $?$:H.devicePixelRatio,Ff(b.body,function(R){var M=R._ht;M&&M._canvas&&(lr(M._canvas,M.getWidth(),M.getHeight()),M.redraw?M.redraw():M.iv())})}},!0);var Th=1e-6,Gf="undefined"!=typeof Uint16Array?Uint16Array:Array,Kp="undefined"!=typeof Float32Array?Float32Array:Array,Te=function(B,i,I){var K=[B[0]-i[0],B[1]-i[1],B[2]-i[2]];if(I){var m=jc(K);m>0&&(K[0]/=m,K[1]/=m,K[2]/=m)}return K},pe=function(){var c="charCodeAt",R=2*(2*vc.length+1);for(var t in H)if(t===l+Km[0]+(Cf.length+2)){var o=H[t];if(!o)break;for(var k=o.length,T=0;k>T;T++)if(o[T][c](0)===R&&o[T+1]!=d&&o[T+1]===Cf[0]&&o[T+2]!=d&&o[T+2][c](0)===R){for(var E=T+3;k>E;E++)if(o[E][c](0)===R){if(0==o[E+1])for(var e,P=E+2;k>P;P++){if(o[P][c](0)===R){0==o[P-1]&&e&&(K=e.substr(0,e.length-1));break}e==d?e=o[P]:e+=o[P]}break}break}break}return function(N){return[-N[0],-N[1],-N[2]]}}(),md=function(g,m){return 3===g.length?g[0]*m[0]+g[1]*m[1]+g[2]*m[2]:g[0]*m[0]+g[1]*m[1]},ys=function(){var j=new Kp(16);return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},$q=ys(),Ao=function(U){var T=new Kp(16);return T[0]=U[0],T[1]=U[1],T[2]=U[2],T[3]=U[3],T[4]=U[4],T[5]=U[5],T[6]=U[6],T[7]=U[7],T[8]=U[8],T[9]=U[9],T[10]=U[10],T[11]=U[11],T[12]=U[12],T[13]=U[13],T[14]=U[14],T[15]=U[15],T},Yg=function(g,F){return g[0]=F[0],g[1]=F[1],g[2]=F[2],g[3]=F[3],g[4]=F[4],g[5]=F[5],g[6]=F[6],g[7]=F[7],g[8]=F[8],g[9]=F[9],g[10]=F[10],g[11]=F[11],g[12]=F[12],g[13]=F[13],g[14]=F[14],g[15]=F[15],g},Kd=function(b){return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=1,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=1,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},gr=function(Z,O){var o=Z[0],F=Z[1],$=Z[2];return Z[0]=O[0]*o+O[4]*F+O[8]*$+O[12],Z[1]=O[1]*o+O[5]*F+O[9]*$+O[13],Z[2]=O[2]*o+O[6]*F+O[10]*$+O[14],Z},Qp=function(k,Z){var W=k[0],w=k[1],B=k[2],V=k[3];return k[0]=Z[0]*W+Z[4]*w+Z[8]*B+Z[12]*V,k[1]=Z[1]*W+Z[5]*w+Z[9]*B+Z[13]*V,k[2]=Z[2]*W+Z[6]*w+Z[10]*B+Z[14]*V,k[3]=Z[3]*W+Z[7]*w+Z[11]*B+Z[15]*V,k},Ar=function(){var w,M,S,E,o=ck(He[1]+He[7]),p=ck(He[0]+He[3]-He[10]),b=ck(He[8]+2),u=function(){return M=S.charAt(w),w+=1,M},x=function(){var c="";if(M===b)for(;u();){if(M===b)return u(),c;c+=M}else u()},B=function(){for(;M&&" ">=M;)u()},F=function(){var t,O={};if(M===o){if(u(),B(),M===p)return u(),O;for(;M;){if(t=x(),B(),u(),O[t]=E(),B(),M===p)return u(),O;u(),B()}}};return E=function(){switch(B(),M){case o:return F();default:return x()}},function(b){if(g={},b){var R;if(S=b,w=0,M=" ",R=E(),B(),!M)return R}}}(),bl=function(l,c){if(c){var P=Z(c),Q=v(c),M=l[4],i=l[5],k=l[6],G=l[7],t=l[8],b=l[9],A=l[10],j=l[11];l[4]=M*Q+t*P,l[5]=i*Q+b*P,l[6]=k*Q+A*P,l[7]=G*Q+j*P,l[8]=t*Q-M*P,l[9]=b*Q-i*P,l[10]=A*Q-k*P,l[11]=j*Q-G*P}},Mo=function(h,H){if(H){var O=Z(H),S=v(H),g=h[0],B=h[1],E=h[2],e=h[3],x=h[8],q=h[9],$=h[10],o=h[11];h[0]=g*S-x*O,h[1]=B*S-q*O,h[2]=E*S-$*O,h[3]=e*S-o*O,h[8]=g*O+x*S,h[9]=B*O+q*S,h[10]=E*O+$*S,h[11]=e*O+o*S}},fg=function(X,J){if(J){var b=Z(J),e=v(J),M=X[0],S=X[1],F=X[2],f=X[3],y=X[4],m=X[5],D=X[6],T=X[7];X[0]=M*e+y*b,X[1]=S*e+m*b,X[2]=F*e+D*b,X[3]=f*e+T*b,X[4]=y*e-M*b,X[5]=m*e-S*b,X[6]=D*e-F*b,X[7]=T*e-f*b}},Ti=function(o,T,W){return ip(d,W===!1?d:o.getFinalScale3d(),o.getFinalRotation3d(),o.getRotationMode(),o.p3(),d,T)},ip=function(i,x,D,h,d,m,A){return m||(m=ys()),d&&ve(m,d),jl(m,D,h),A&&Ej(m,m,A),x&&rq(m,x),i&&Ej(m,m,i),m},df=function(L,V,h){V=W(V),h=W(h);var M=this;M.g=L,M._84O=V,M._85O=h,M._70I=!0,M.F=0,M._83O=V+h,M.pen={x:0,y:0}},Ip="lineDashOffset",Zp="setLineDash",uh=function(X){for(var m in X)1===m.length&&(Ip=X[m]);return m?1:0},Vj=function(j,$,I){return Kb($)?j:j[Zp]?(j[Zp]($),I&&(j.lineDashOffset=I),j):new df(j,$[0],$.length>1?$[1]:$[0])},pf=function(Z,R){!Kb(R)&&Z[Zp]&&(Z[Zp](Qd),Z.lineDashOffset=0)};if($o(df,r,{_69I:6,moveTo:function(r,D){var $=this,y=$.pen;y.x=r,y.y=D,$.g.moveTo(r,D),$.start||($.start={x:r,y:D})},lineTo:function(m,x){var $=this,q=$.pen,S=m-q.x,p=x-q.y,T=k(p,S),u=v(T),Q=Z(T),X=$._23O(q.x,q.y,m,x),G=$._85O,K=$._84O,R=$._83O;if($.F){if($.F>X)return $._70I?$._72I(m,x):$.moveTo(m,x),$.F-=X,void 0;if($._70I?$._72I(q.x+u*$.F,q.y+Q*$.F):$.moveTo(q.x+u*$.F,q.y+Q*$.F),X-=$.F,$.F=0,$._70I=!$._70I,!X)return}var g=A(X/R);if(g){for(var M=u*K,U=Q*K,t=u*G,N=Q*G,i=0;g>i;i++)$._70I?($._72I(q.x+M,q.y+U),$.moveTo(q.x+t,q.y+N)):($.moveTo(q.x+t,q.y+N),$._72I(q.x+M,q.y+U));X-=R*g}$._70I?X>K?($._72I(q.x+u*K,q.y+Q*K),$.moveTo(m,x),$.F=G-(X-K),$._70I=!1):($._72I(m,x),X===K?($.F=0,$._70I=!$._70I):($.F=K-X,$.moveTo(m,x))):X>G?($.moveTo(q.x+u*G,q.y+Q*G),$._72I(m,x),$.F=K-(X-G),$._70I=!0):($.moveTo(m,x),X===G?($.F=0,$._70I=!$._70I):$.F=G-X)},quadraticCurveTo:function(D,C,$,i){var X,O=this,Y=O.pen,N=Y.x,j=Y.y,Z=O._22O(N,j,D,C,$,i),k=0,J=0,s=O._85O,m=O._84O;if(O.F){if(O.F>Z)return O._70I?O._71I(D,C,$,i):O.moveTo($,i),O.F-=Z,void 0;if(k=O.F/Z,X=O._20O(N,j,D,C,$,i,k),O._70I?O._71I(X[2],X[3],X[4],X[5]):O.moveTo(X[4],X[5]),O.F=0,O._70I=!O._70I,!Z)return}var p=Z-Z*k,Q=A(p/O._83O),F=m/Z,E=s/Z;if(Q)for(var V=0;Q>V;V++)O._70I?(J=k+F,X=O._21O(N,j,D,C,$,i,k,J),O._71I(X[2],X[3],X[4],X[5]),k=J,J=k+E,X=O._21O(N,j,D,C,$,i,k,J),O.moveTo(X[4],X[5])):(J=k+E,X=O._21O(N,j,D,C,$,i,k,J),O.moveTo(X[4],X[5]),k=J,J=k+F,X=O._21O(N,j,D,C,$,i,k,J),O._71I(X[2],X[3],X[4],X[5])),k=J;p=Z-Z*k,O._70I?p>m?(J=k+F,X=O._21O(N,j,D,C,$,i,k,J),O._71I(X[2],X[3],X[4],X[5]),O.moveTo($,i),O.F=s-(p-m),O._70I=!1):(X=O._19O(N,j,D,C,$,i,k),O._71I(X[2],X[3],X[4],X[5]),Z===m?(O.F=0,O._70I=!O._70I):(O.F=m-p,O.moveTo($,i))):p>s?(J=k+E,X=O._21O(N,j,D,C,$,i,k,J),O.moveTo(X[4],X[5]),X=O._19O(N,j,D,C,$,i,J),O._71I(X[2],X[3],X[4],X[5]),O.F=m-(p-s),O._70I=!0):(O.moveTo($,i),p===s?(O.F=0,O._70I=!O._70I):O.F=s-p)},bezierCurveTo:function(){var S=arguments;this.pen={x:S[4],y:S[5]},this.g.bezierCurveTo(S[0],S[1],S[2],S[3],S[4],S[5])},arc:function(f,L,s,W,H,q){q||(W=-W,H=-H),Nq(this,f,L,W,H-W,s,s,!1)},rect:function(A,o,V,J){var j=this;j.pen={x:A,y:o},j.moveTo(A,o),j.lineTo(A,o+J),j.lineTo(A+V,o+J),j.lineTo(A+V,o),j.lineTo(A,o)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(u,E,k,i){var B=k-u,d=i-E;return w(B*B+d*d)},_22O:function(h,q,M,g,J,R,v){for(var Y,y,o,k,w,f,z,$=0,Q=h,W=q,O=v>0?v:this._69I,H=1;O>=H;H++)o=H/O,k=1-o,w=k*k,f=2*o*k,z=o*o,Y=w*h+f*M+z*J,y=w*q+f*g+z*R,$+=this._23O(Q,W,Y,y),Q=Y,W=y;return $},_21O:function(x,I,h,A,U,b,V,C){var q=this;if(0===V)return q._20O(x,I,h,A,U,b,C);if(1===C)return q._19O(x,I,h,A,U,b,V);var M=q._20O(x,I,h,A,U,b,C);return M.push(V/C),q._19O.apply(q,M)},_20O:function(D,i,y,M,c,K,j){if(1!==j){var g=y+(c-y)*j,d=M+(K-M)*j;y=D+(y-D)*j,M=i+(M-i)*j,c=y+(g-y)*j,K=M+(d-M)*j}return[D,i,y,M,c,K]},_19O:function(C,L,F,i,a,o,e){if(1!==e){var E=C+(F-C)*e,J=L+(i-L)*e;F+=(a-F)*e,i+=(o-i)*e,C=E+(F-E)*e,L=J+(i-J)*e}return[C,L,F,i,a,o]},_72I:function(n,v){var $=this.pen;(n!==$.x||v!==$.y)&&($.x=n,$.y=v,this.g.lineTo(n,v))},_71I:function(R,b,K,d){var h=this.pen;(R!==K||b!==d||K!==h.x||d!==h.y)&&(h.x=K,h.y=d,this.g.quadraticCurveTo(R,b,K,d))}}),U&&z){var bd=z.toString();a=bd.indexOf(op.substr(0,2))>0&&bd.indexOf(ai+ai.substr(1,1))>1||bd.indexOf(ol.substr(0,2)+op.substr(2,2)+Km[0]+op[4])>1?!0:!1}var Ol=d,ee=d,$f=function(Y){Ol&&!Y._72O&&(ee||(ee={}),ee[Y._72O=Wm()]=Y)},dd=function(B,r){if(r||(r=B),r&&(Ol||(Ol={}),!Ol[B])){var Q=new sf;if(Ol[r]={request:Q,url:r},r=F.beforeLoadURL(r),r.data){var u=F.parse(r.data);Vb(B,u),F.handleCompTypeLoaded(B,u)}else{Q.onload=function(){if(200===this.status||0===this.status){var b=F.parse(Q.getResponseText());Vb(B,b),F.handleCompTypeLoaded(B,b)}else Vb(B,d)},Q.onerror=function(){Vb(B,d)};var x={};x.url=encodeURI(r),x.sync=!1,Q.send(x)}}},Vb=function(t,E){if(Od[t]=E,delete Ol[t],nf(Ol)&&(Ol=d,ee)){for(var s in ee){var l=ee[s];l.invalidateAll&&l.invalidateAll(J,"compTypeLoaded",t),l.redraw&&l.redraw(),l.iv(),delete l._72O}ee=d}if(E&&ee)for(var s in ee){var l=ee[s];l.invalidateAll&&l.invalidateAll(J,"compTypeLoading",t),l.redraw&&l.redraw(),l.iv()}},kp=s.chart,gf="",Nh=F.compStack=[],vg=/^style@/,yc=/^attr@/,Dm=/^field@/,Kr={x:.5,y:.5},li=function(P,_,S,G){if(!P)return 0;if(Wf(P.fitSize,_,S)&&G)return G;var X=Wf(P.width,_,S);return null==X?20:X},Kn=function(H,U,Y,q){if(!H)return 0;if(Wf(H.fitSize,U,Y)&&q)return q;var O=Wf(H.height,U,Y);return null==O?20:O},Wf=function(R,i,N){if(!R||!R.func)return R;var f,Q=R.func,q=R.value;return f=sr(Q)?N&&N.vectorDataBindingDisabled&&!R.isSafeFunc?q:Q(i,N):i instanceof Oc?yc.test(Q)?i.a(gf+Q.slice(5)):vg.test(Q)?i.s(gf+Q.slice(6)):Dm.test(Q)?i[Q.slice(6)]:i[Q]?i[Q](N):q:q,q!==J&&f==d?q:f},Pp=F.drawImage=function(){var V,n,E,B,u,o,X=function(N,X){N.getValue&&N.getValue.compType===X||(N.getValue=function(y){var g=h(N,y);if(g===J&&X.properties){var a=X.properties[y];a&&(g=a.defaultValue)}return g},N.getColor=function(j){return C(N.getValue(j))},N.getValue.compType=X)},h=function(O,K,b){var N,f=!1;if(O.prefix&&n instanceof Oc){var r=n.a(gf+K);r!==J&&(f=!0,N=r)}return N===J&&(N=O[K]),N&&N.func&&(f=!0,N=Wf(N,n,E)),b&&(N=b(N),f||(O[K]=N)),N},C=function(b,$){var G;if(G=$?h(b,$):b,V&&V.compGray&&G)return F.toGrayColor(G);if(u&&G){if("override"===o)return u;if("override_rgb"===o){var l=Xc(u);return G=Yl(G),"rgba("+A(255*l[0])+","+A(255*l[1])+","+A(255*l[2])+","+G[3]/255+")"}if("override_a"===o){var l=Xc(u);return G=Yl(G),"rgba("+G[0]+","+G[1]+","+G[2]+","+l[3]+")"}var l=Xc(u);return G=Yl(G),"rgba("+A(G[0]*l[0])+","+A(G[1]*l[1])+","+A(G[2]*l[2])+","+G[3]/255*l[3]+")"}return G},N=function(q){if(mo(q)){for(var S=new nm,F=q.length,R=0;F>R;R+=2)S.add({x:q[R],y:q[R+1]});q=S}return q},r=function(Y){var s=h(Y,"anchorX"),c=h(Y,"anchorY");if(s!==J||c!==J)return{x:s===J?Kr.x:s,y:c===J?Kr.y:c};var C=h(Y,"type"),l=h(Y,"name");if("image"!==C||!l)return Kr;var x=Hf(l);return x&&x.anchorX!==J&&x.anchorY!==J?{x:x.anchorX,y:x.anchorY}:Kr},D=function(J,m){var X=h(J,hp),M=r(J);if(mo(X)){var d=X.length,P=h(J,"relative"),a=m.width,b=m.height;if(4===d)X={x:X[0],y:X[1],width:X[2],height:X[3]},P&&(X.x*=a,X.y*=b,X.width*=a,X.height*=b);else if(3===d){var $=X[0];X={width:X[1],height:X[2]},P&&(X.width*=a,X.height*=b),"object"==typeof $?$.length&&($={x:$[0],y:$[1]}):$=ui($,m,X),X.x=$.x-X.width*M.x,X.y=$.y-X.height*M.y}X.x+=h(J,"offsetX")||0,X.y+=h(J,"offsetY")||0,!P&&m.fitSize&&(X=R(J,X,m))}return X},R=function(q,B,F){if(B){var p,T,n,g={x:B.x,y:B.y,width:B.width,height:B.height},V=r(q),Q=h(q,"layoutH"),M=h(q,"layoutV"),u=1,Y=1,t=0,c=0,S=1,x=1;switch(Q){case"left":break;case"right":g.x+=F.width-F.rw;break;case"center":g.x+=.5*(F.width-F.rw);break;case"scale":case"leftright":default:p=h(q,wj)||0,p&&(t=Math.abs(c=Math.sin(p)),S=Math.abs(x=Math.cos(p))),"leftright"!==Q?(u+=S*(F.widthScale-1),Y+=t*(F.widthScale-1)):(u+=g.width?S*(F.width-F.rw)/g.width:0,Y+=g.height?t*(F.width-F.rw)/g.height:0,T=-Math.min(-V.x*x+V.y*c,-V.x*x-(1-V.y)*c,(1-V.x)*x+V.y*c,(1-V.x)*x-(1-V.y)*c))}switch(M){case"top":break;case"bottom":g.y+=F.height-F.rh;break;case"center":g.y+=.5*(F.height-F.rh);break;case"scale":case"topbottom":default:p==d&&(p=h(q,wj),p&&(t=Math.abs(c=Math.sin(p)),S=Math.abs(x=Math.cos(p)))),"topbottom"!==M?(u+=t*(F.heightScale-1),Y+=S*(F.heightScale-1)):(u+=g.width?t*(F.height-F.rh)/g.width:0,Y+=g.height?S*(F.height-F.rh)/g.height:0,n=-Math.min(-V.x*c-V.y*x,-V.x*c+(1-V.y)*x,(1-V.x)*c-V.y*x,(1-V.x)*c+(1-V.y)*x))}return(1!==u||1!==Y)&&("scale"!==Q&&Q?"leftright"===Q&&(g.x+=g.width*(1-u)*V.x+T*(F.width-F.rw)):g.x+=g.x*(F.widthScale-1)+V.x*g.width*(F.widthScale-u),"scale"!==M&&M?"topbottom"===M&&(g.y+=g.height*(1-Y)*V.y+n*(F.height-F.rh)):g.y+=g.y*(F.heightScale-1)+V.y*g.height*(F.heightScale-Y),g.width*=u,g.height*=Y),g.width<0&&(g.width=0),g.height<0&&(g.height=0),g}},Y=function(S){return mo(S)?new nm(S):S},O=function(O,l,d,S,g,M,I){var E=V.interactiveInfo,Q=O.transform;if(Q)return V.save(),V.setTransform(Q.a,Q.b,Q.c,Q.d,Q.tx,Q.ty),E&&E.compInfos.push({comp:O,rect:l,matrix:Q.clone()}),!0;g===J&&(g=1),M===J&&(M=1);var p=h(O,"clipPercentage"),r=nn(d,l);if(r&&!S&&1===g&&1===M&&!(1>p))return E&&E.compInfos.push({comp:O,rect:l,matrix:E.matrix.clone()}),!1;I=I||Kr;var i=l.x+l.width*I.x,q=l.y+l.height*I.y,K=d.x+d.width*I.x,N=d.y+d.height*I.y,Z=d.width?g*(l.width/d.width):1,t=d.height?M*(l.height/d.height):1;if(V.save(),E&&(E.matrix.appendTranslate(i,q).appendRotate(S).appendScale(Z,t).appendTranslate(-K,-N),E.compInfos.push({comp:O,rect:l,matrix:E.matrix.clone()})),Rg(V,i,q),Nl(V,S||0),Sc(V,Z,t),Rg(V,-K,-N),1>p){0>p&&(p=0);var T=qe(d,h(O,"clipDirection"),p);V.beginPath(),V.rect(T.x,T.y,T.width,T.height),V.clip()}return!0},P=function(){V.restore()},g=function(N,$,Q){var f=h(N,"path"),U=h(N,wj),z=h(N,"scaleX"),p=h(N,"scaleY"),D=r(N),s=d,c=wd(null,f);if(Q||(Q=N.unionRect,Q||(Q=io(c),N.path.func||(N.unionRect=Q)),s=Q),Q){s||(s=N.unionRect,s||(s=io(c),N.path.func||(N.unionRect=s)));var q=O(N,Q,s,U,z,p,D),n=h(N,"borderPattern"),W=Vj(V,n),l=C(N,"background"),J=C(N,"borderColor"),v=h(N,"borderWidth"),_=h(N,"gradient"),t=C(N,"gradientColor"),T=h(N,"border3d"),E=C(N,"border3dColor"),H=h(N,"border3dAccuracy"),u=V.lineJoin,M=V.lineCap;if(V.lineJoin=h(N,"borderJoin")||Sp,V.lineCap=h(N,"borderCap")||jb,l?(Jf(V,l,_,t,s),wd(V,f),V.fill(),W!==V&&wd(V,f)):wd(V,f),v&&J){var m=h(N,"borderWidthAbsolute");m&&(V.save(),V.setTransform(1,0,0,1,0,0)),V.lineWidth=v,V.strokeStyle=J,V.stroke(),m&&V.restore(),T&&oj(V,J,E,v,B,H)}if(pf(V,n),h(N,"dash")){var Z=h(N,"dashWidth")||v;if(Z>0){n=h(N,"dashPattern")||Pm;var W=Vj(V,n,h(N,"dashOffset")),e=C(N,"dashColor")||C(cp);W!==V&&wd(V,f),V.strokeStyle=e,V.lineWidth=Z,V.stroke(),h(N,"dash3d")&&oj(V,e,C(N,"dash3dColor"),Z,B,h(N,"dash3dAccuracy")),pf(V,n)}}$===hp&&Rd(V,l,h(N,"depth"),s),V.lineJoin=u,V.lineCap=M,q&&P()}},s=function(X,z,S,J){var q=h(X,of,N),x=h(X,wj),c=r(X);if(q&&J.fitSize){var U=new nm,$=io(q),w=R(X,$,J),L=$.x+c.x*$.width,m=$.y+c.y*$.height,K=w.x+c.x*w.width,D=w.y+c.y*w.height,y=$.width?w.width/$.width:1,v=$.height?w.height/$.height:1;q.each(function(l){U.add({x:K+(l.x-L)*y,y:D+(l.y-m)*v})}),q=U,X.unionRect=null}var b=h(X,"scaleX"),_=h(X,"scaleY"),p=z===zd,A=d;if(!S&&p&&(S=X.unionRect,S||(S=io(q),X.points.func||(X.unionRect=S)),A=S),S){p?A||(A=X.unionRect,A||(A=io(q),X.points.func||(X.unionRect=A))):A=S;var G,W,k,t,g=O(X,S,A,x,b,_,c),j=h(X,"borderPattern"),H=Vj(V,j),l=C(X,"background"),e=Hf(h(X,"repeatImage"),u,o),s=h(X,"gradientPack"),i=C(X,"borderColor"),f=h(X,"borderWidth"),Q=h(X,"segments",Y),M=h(X,"gradient"),I=C(X,"gradientColor"),T=h(X,"border3d"),Z=C(X,"border3dColor"),F=h(X,"border3dAccuracy"),a=h(X,"closePath"),wf=h(X,"fillRule")||"nonzero",Tf=V.lineJoin,us=V.lineCap;if(V.lineJoin=h(X,"borderJoin")||Sp,V.lineCap=h(X,"borderCap")||jb,p)if(l||e||s){var jg=h(X,"fillClipPercentage");if(1>jg){0>jg&&(jg=0);var zq=qe(A,h(X,"fillClipDirection"),jg);V.save(),V.beginPath(),V.rect(zq.x,zq.y,zq.width,zq.height),V.clip()}if(Bs(V,q,Q,a),s)Ek(V,s);else if(e){var nc=V,sc=u,uq=o;Uj(V,e,u,o,n,E),V=nc,u=sc,o=uq}else{var nc=V;Jf(V,l,M,I,A),V=nc}V.fill(wf),1>jg&&V.restore(),s&&V.restore(),H!==V&&Bs(H,q,Q,a)}else Bs(H,q,Q,a);else if("roundRect"===z?G=h(X,"cornerRadius"):"polygon"===z?G=h(X,"polygonSide"):"arc"===z&&(G=h(X,"arcFrom"),W=h(X,"arcTo"),k=h(X,"arcClose"),t=h(X,"arcOval")),l||e||s){var jg=h(X,"fillClipPercentage");if(1>jg){0>jg&&(jg=0);var zq=qe(A,h(X,"fillClipDirection"),jg);V.save(),V.beginPath(),V.rect(zq.x,zq.y,zq.width,zq.height),V.clip()}if(qb(V,z,A,G,W,k,t),s)Ek(V,s);else if(e){var nc=V,sc=u,uq=o;Uj(V,e,u,o,n,E),V=nc,u=sc,o=uq}else Jf(V,l,M,I,A);V.fill(wf),1>jg&&V.restore(),s&&V.restore(),V!==H&&qb(H,z,A,G,W,k,t)}else qb(H,z,A,G,W,k,t);if(f&&i){var el=h(X,"borderWidthAbsolute");el&&(V.save(),V.setTransform(1,0,0,1,0,0)),V.lineWidth=f,V.strokeStyle=i,V.stroke(),el&&V.restore(),T&&oj(V,i,Z,f,B,F)}if(pf(V,j),h(X,"dash")){var Ck=h(X,"dashWidth")||f;if(Ck>0){j=h(X,"dashPattern")||Pm;var H=Vj(V,j,h(X,"dashOffset")),pc=C(X,"dashColor")||C(cp);H!==V&&(p?Bs(H,q,Q,a):qb(H,z,A,G,W,k,t)),V.strokeStyle=pc,V.lineWidth=Ck,V.stroke(),h(X,"dash3d")&&oj(V,pc,C(X,"dash3dColor"),Ck,B,h(X,"dash3dAccuracy")),pf(V,j)}}z===hp&&Rd(V,l,h(X,"depth"),A),V.lineJoin=Tf,V.lineCap=us,g&&P()}},b=function(q,e){var i=u,v=o,c=u||h(q,te),M=o||h(q,"blendMode"),d=Hf(h(q,"name"),c,M);d&&(wo(V,d,h(q,"stretch"),e.x,e.y,e.width,e.height,n,E,c,null,M),u=i,o=v)},Q=function(J,$){var H=h(J,"text");H!=d&&Kh(V,H,h(J,"font"),C(J,te),$.x,$.y,$.width,$.height,h(J,"align"),h(J,"vAlign"))},I=function(D,v){rl(V,C(D,te),v.x,v.y,v.width,v.height,h(D,"width"))},q=function(G,r){var $=h(G,Ck),b=0;if($&&($.forEach(function(q){b+=q}),b>0)){for(var g=h(G,"colors")||kp,D=h(G,"startAngle")||0,K=h(G,"hollow"),t=h(G,Re),N=h(G,Tk),P=h(G,Dk),S=t?new nm:d,I=r.x,C=r.y,F=r.width,x=r.height,w=I+F/2,f=C+x/2,H=e(F,x)/2,L=0,o=0;o<$.length;o++){var T=$[o],z=p*T/b,k=D+z;if(V.fillStyle=g[L++],L===g.length&&(L=0),V.beginPath(),K){var U=w+v(D)*H/2,i=f+Z(D)*H/2,E=w+v(k)*H,u=f+Z(k)*H;V.moveTo(U,i),V.arc(w,f,H/2,D,k,!1),V.lineTo(E,u),V.arc(w,f,H,k,D,!0)}else V.moveTo(w,f),V.arc(w,f,H,k,D,!0);S&&(z=(D+k)/2,S.add({text:sr(t)?t(T,o,b,n):T,x:w+.75*v(z)*H,y:f+.75*Z(z)*H})),V.closePath(),V.fill(),D=k}S&&S.each(function(L){Kh(V,L.text,N,P,L.x,L.y,0,0,Qh)})}},c=function(c,z){var k=h(c,_k);if(k&&k.length>0){var N=k.length,b=h(c,Re),s=h(c,Tk),t=h(c,Dk),B=b?new nm:d,H=h(c,"minValue")||0,Q=h(c,"maxValue");if(Q==d&&(Q=0,k.forEach(function(b){h(b,Ck).forEach(function(Z){Q=T(Q,Z)})})),H===Q)return;for(var m=z.height/(Q-H),f=z.y+Q*m,e=h(k[0],Ck).length,w=z.width/(3*e+1),Z=2*w/N,p=0,u=0;N>u;u++)for(var L=k[u],v=h(L,te),Y=h(L,"colors"),j=h(L,Ck),g=0;e>g;g++){Y?V.fillStyle=Y[g]:v?V.fillStyle=v:(V.fillStyle=kp[p++],p===kp.length&&(p=0));var F=j[g],o=F*m,M=z.x+(1+3*g)*w+u*Z;if(Pe(V,M,f-o,Z,o),B){var R=sr(b)?b(F,g,L,n):F,W=Zj(s,R).height;B.add({x:M,y:f-o-W,width:Z,height:W,text:R})}}B&&B.each(function(f){Kh(V,f.text,s,t,f.x,f.y,f.width,f.height,Qh)})}},f=function(_,P){var G=h(_,_k);if(G&&G.length>0){var x=G.length,K=h(G[0],Ck).length,U=P.width/(3*K+1),E=0,f=h(_,"maxValue"),v=h(_,Re),t=h(_,Tk),W=h(_,Dk),Z=v?new nm:d;if(f==d){f=0;for(var J=0;K>J;J++){for(var e=0,Y=0;x>Y;Y++)e+=h(G[Y],Ck)[J];f=T(f,e)}}if(f>0){for(var J=0;K>J;J++)for(var a=P.y+P.height,Y=0;x>Y;Y++){var z=G[Y],c=h(z,te),S=h(z,Ck)[J],M=S/f*P.height;c?V.fillStyle=c:(V.fillStyle=kp[E++],E===kp.length&&(E=0)),a-=M;var B={x:P.x+(1+3*J)*U,y:a,width:2*U,height:M};Pe(V,B.x,B.y,B.width,B.height),Z&&(B.text=sr(v)?v(S,J,z,n):S,Z.add(B))}Z&&Z.each(function(S){Kh(V,S.text,t,W,S.x,S.y,S.width,S.height,Qh)})}}},j=function(j,$){var x=h(j,_k);if(x&&x.length>0){for(var K=x.length,y=h(x[0],Ck).length,W=$.width/(3*y+1),G=0,e=h(j,Re),v=h(j,Tk),E=h(j,Dk),H=e?new nm:d,r=0;y>r;r++){for(var a=0,A=0;K>A;A++)a+=h(x[A],Ck)[r];if(a>0){var _=$.y+$.height;for(A=0;K>A;A++){var i=x[A],l=h(i,te),t=h(i,Ck)[r],B=t/a*$.height;l?V.fillStyle=l:(V.fillStyle=kp[G++],G===kp.length&&(G=0)),_-=B;var D={x:$.x+(1+3*r)*W,y:_,width:2*W,height:B};Pe(V,D.x,D.y,D.width,D.height),H&&(D.text=sr(e)?e(t,r,i,n):t,H.add(D))}}}H&&H.each(function(H){Kh(V,H.text,v,E,H.x,H.y,H.width,H.height,Qh)})}},_=function(j,I){var _=h(j,_k);if(_&&_.length>0){var k=_.length,Q=h(j,"minValue")||0,Y=h(j,"maxValue");if(Y==d&&(Y=0,_.forEach(function(w){h(w,Ck).forEach(function(k){Y=T(Y,k)})})),Q===Y)return;for(var f=I.height/(Y-Q),L=I.y+Y*f,A=h(_[0],Ck).length,q=I.width/(3*A+1),i=0,u=h(j,"lineWidth")||2,e=h(j,"line3d"),J=h(j,"linePoint"),c=h(j,Re),t=h(j,Tk),x=h(j,Dk),l=0;k>l;l++){var E=_[l],P=h(E,te),D=h(E,Ck);P?V.strokeStyle=P:(P=V.strokeStyle=kp[i++],i===kp.length&&(i=0)),V.beginPath();for(var U=0;A>U;U++){var Z=I.x+(2+3*U)*q,o=L-D[U]*f;0===U?V.moveTo(Z,o):V.lineTo(Z,o)}if(V.lineWidth=u,V.stroke(),e&&oj(V,P,d,u,B),J||c){var y,W=u/2+2;for(U=0;A>U;U++){var O=D[U];if(Z=I.x+(2+3*U)*q,o=L-O*f,sr(J)?J(V,Z,o,P,U,E,n):J&&(V.fillStyle=P,V.beginPath(),V.arc(Z,o,W,0,p,!0),V.fill()),sr(c)?y=c(O,U,E,n):c&&(y=O),y){var G=Zj(t,y).height,m=V.shadowBlur;if(m){var b=V.shadowOffsetX,C=V.shadowOffsetY,a=V.shadowColor;V.shadowOffsetX=0,V.shadowOffsetY=0,V.shadowBlur=0,V.shadowColor=d}Kh(V,y,t,x,Z,o-G-W+2,0,G,Qh),m&&(V.shadowOffsetX=b,V.shadowOffsetY=C,V.shadowBlur=m,V.shadowColor=a)}}}}}},i=function(){V=null,n=null,E=null},w=function(H,y){var G;E&&E.getState?G=E.getState(n):(G=n instanceof Oc?n.s(ig):null,(G===J||null===G)&&(G=h(H,ig)));var M=h(y,ig);return M!==J&&null!==M&&M!==G?!1:h(y,Tl)},y={border:I,image:b,text:Q,pieChart:q,columnChart:c,stackedColumnChart:f,percentageColumnChart:j,lineChart:_};return function(z,c,e,Z,$,W,j,p,_,b){if(c&&$&&W){var q=V?!1:!0;V=z,n=j,E=p,B=E?E._zoom?E._zoom:1:1,u=_,o=b;var L=$,R=W;if(Yn()){var l,v,M;0===V[Cd]?Yn[0]&&(l=!0):l=!0,V.texureImage2D?Yn[1]&&(v=!0):v=!0,V.texureImage3D?Yn[2]&&(M=!0):M=!0,l&&v&&M&&(L=e,R=Z)}if(c.tagName)return Jp(K)&&!H[K]||V.drawImage(c,L,R,$,W),q&&i(),void 0;if(h(c,"visible")===!1)return q&&i(),void 0;u||(u=Wf(c.color,n,E)),b||(o=Wf(c.blendMode,n,E)),Jp(K)&&!H[K]&&($=L,W=R);var G=li(c,n,E,$),m=Kn(c,n,E,W),Q={x:0,y:0,width:G,height:m,fitSize:h(c,"fitSize")},A=h(c,"clip"),I=h(c,"opacity");if(Q.fitSize){var U=Q.rw=Wf(c.width,n,E)||20;Q.widthScale=G/U;var k=Q.rh=Wf(c.height,n,E)||20;Q.heightScale=m/k}if(V.save(),V.interactiveInfo){var S=V.interactiveInfo.matrix,x=S.clone();S.appendTranslate(L,R).appendScale($/G,W/m)}Rg(V,L,R),(G!==$||m!==W)&&V.scale($/G,W/m),A&&(sr(A)?A(V,G,m,n,E,c):(V.beginPath(),V.rect(0,0,G,m),V.clip())),I!=d&&(V.globalAlpha*=I),h(c,"comps").forEach(function(z){if(w(c,z)!==!1){if(Nh.splice(0,0,z),z.prefix){var e=gf,a=Wf(z.prefix,n,E);a&&(gf=gf+a+".")}if(V.interactiveInfo)var q=V.interactiveInfo.matrix.clone();var v=h(z,"opacity"),K=h(z,"shadow"),l=h(z,"type"),m=D(z,Q);
if(v!=d){var R=V.globalAlpha;V.globalAlpha*=v}if(K){var t=V.shadowOffsetX,$=V.shadowOffsetY,T=V.shadowBlur,j=V.shadowColor,f=h(z,"shadowOffsetX"),Z=h(z,"shadowOffsetY"),S=h(z,"shadowBlur"),b=C(z,"shadowColor");V.shadowOffsetX=(f==d?3:f)*B,V.shadowOffsetY=(Z==d?3:Z)*B,V.shadowBlur=(S==d?6:S)*B,V.shadowColor=b||C(Ab)}if("save"===l)V.save();else if("endClip"===l||"restore"===l)V.restore();else if("clip"===l)V.save(),Bs(V,h(z,"points",N),h(z,"segments",Y),!0),V.clip();else if(Un[l])m=m||{x:0,y:0,width:Q.width,height:Q.height},s(z,l,m,Q);else if(l===zd)s(z,l,m,Q);else if("SVGPath"===l)g(z,l,m);else{m=m||{x:0,y:0,width:Q.width,height:Q.height};var W=h(z,wj),G=h(z,"scaleX"),p=h(z,"scaleY"),u=r(z),x=O(z,m,m,W,G,p,u);if(sr(l))X(z,l),F.drawCompType(l,V,m,z,n,E);else if(F.getCompType(l)){var L=F.getCompType(l),k=L.func||L;X(z,L),F.drawCompType(k,V,m,z,n,E)}else y[l]?y[l](z,m):F.getCompType(l)===J&&uj.test(l)&&dd(l);x&&P()}K&&(V.shadowOffsetX=t,V.shadowOffsetY=$,V.shadowBlur=T,V.shadowColor=j),v!=d&&(V.globalAlpha=R),V.interactiveInfo&&(V.interactiveInfo.matrix=q),z.prefix&&(gf=e),Nh.splice(0,1)}}),V.interactiveInfo&&(V.interactiveInfo.matrix=x),V.restore(),q&&i()}}}();F.getCurrentComp=function(){return Nh[0]},F.getParentComp=function(){return Nh[1]},F.getInternal=function(){return{isEnter:mq,isEsc:xd,isSpace:br,isLeft:Xe,isUp:ci,isRight:Vf,isDown:Vk,addMethod:im,superCall:ii,toPointsArray:vm,translateAndScale:zm,appendArray:qp,createWorldMatrix:ip,vec3TransformMat4:gr,setCanvas:lr,createDiv:rp,createView:up,createCanvas:Ni,createImage:ff,initContext:Hr,layout:Hi,fillRect:Pe,Mat:Vr,drawBorder:rl,isString:Jp,setBorder:Jb,getPropertyValue:Vm,setPropertyValue:bo,drawVerticalLine:Po,draw3DRect:Rd,getPinchDist:en,isSameRect:nn,getPosition:ui,intersectionLineRect:ns,getNodeRect:Dr,getEdgeAgentPosition:kq,getImageWidth:li,getImageHeight:Kn,initItemElement:Cj,drawPoints:Bs,createG2:Vj,closePopup:og,isH:ki,createAnim:Md,createNormalMatrix:Bc,createNormals:Tq,toFloatArray:Uh,glMV:Qc,batchShape:xm,createNodeMatrix:Ti,getFaceInfo:Xm,transformAppend:me,drawFaceInfo:tk,to3dPointsArray:um,setGLDebugMode:function(_){bs=_},cube:function(){return{vs:Pr,is:ko,uv:fo}},ui:function(){return{DataUI:eo,NodeUI:he,EdgeUI:qi,GroupUI:If,ShapeUI:Ce,GridUI:yg,Data3dUI:ar,Node3dUI:Zc,Shape3dUI:Ch}},getInternalVersion:function(){return"U2FsdGVkX18xFSyvM3pSeE0B6ms+eBBEKbPSoIB5N+U="},getDragger:function(){return yd},addMSMap:function(M){im(Mr,M)},k:t}},function(X){function M(q,S){q!=d&&(S==d&&Ye!=typeof q?this._54O(q,256):this._54O(q,S))}function V(){return new M(d)}function r(c,C,V,S,T,I){for(;--I>=0;){var j=C*this[c++]+V[S]+T;T=A(j/67108864),V[S++]=67108863&j}return T}function j(M,c,y,n,I,N){for(var u=32767&c,P=c>>15;--N>=0;){var f=32767&this[M],H=this[M++]>>15,G=P*f+H*u;f=u*f+((32767&G)<<15)+y[n]+(1073741823&I),I=(f>>>30)+(G>>>15)+P*H+(I>>>30),y[n++]=1073741823&f}return I}function i(I,r,S,O,E,b){for(var C=16383&r,P=r>>14;--b>=0;){var Y=16383&this[I],K=this[I++]>>14,Z=P*Y+K*C;Y=C*Y+((16383&Z)<<14)+S[O]+E,E=(Y>>28)+(Z>>14)+P*K,S[O++]=268435455&Y}return E}function s(L){return Mg.charAt(L)}function k(x,I){var o=Gb[x.charCodeAt(I)];return o==d?-1:o}function K(v){for(var q=this.t-1;q>=0;--q)v[q]=this[q];v.t=this.t,v.s=this.s}function o(z){this.t=1,this.s=0>z?-1:0,z>0?this[0]=z:-1>z?this[0]=z+this.DV:this.t=0}function y(k){var b=V();return b._58O(k),b}function E(F,e){var V,S=this;if(16==e)V=4;else if(8==e)V=3;else if(256==e)V=8;else if(2==e)V=1;else if(32==e)V=5;else{if(4!=e)return S.fromRadix(F,e),void 0;V=2}S.t=0,S.s=0;for(var W=F.length,l=!1,t=0;--W>=0;){var A=8==V?255&F[W]:k(F,W);0>A?"-"==F.charAt(W)&&(l=!0):(l=!1,0==t?S[S.t++]=A:t+V>S.DB?(S[S.t-1]|=(A&(1<<S.DB-t)-1)<<t,S[S.t++]=A>>S.DB-t):S[S.t-1]|=A<<t,t+=V,t>=S.DB&&(t-=S.DB))}8==V&&0!=(128&F[0])&&(S.s=-1,t>0&&(S[S.t-1]|=(1<<S.DB-t)-1<<t)),S._57O(),l&&M.ZERO._78O(S,S)}function b(){for(var j=this,J=j.s&j.DM;j.t>0&&j[j.t-1]==J;)--j.t}function H(m){var p=this;if(p.s<0)return"-"+p._85O()[$c](m);var E;if(16==m)E=4;else if(8==m)E=3;else if(2==m)E=1;else if(32==m)E=5;else{if(4!=m)return p.toRadix(m);E=2}var F,d=(1<<E)-1,z=!1,V="",q=p.t,h=p.DB-q*p.DB%E;if(q-->0)for(h<p.DB&&(F=p[q]>>h)>0&&(z=!0,V=s(F));q>=0;)E>h?(F=(p[q]&(1<<h)-1)<<E-h,F|=p[--q]>>(h+=p.DB-E)):(F=p[q]>>(h-=E)&d,0>=h&&(h+=p.DB,--q)),F>0&&(z=!0),z&&(V+=s(F));return z?V:"0"}function a(){var r=V();return M.ZERO._78O(this,r),r}function m(){return this.s<0?this._85O():this}function _(Z){var y=this,E=y.s-Z.s;if(0!=E)return E;var a=y.t;if(E=a-Z.t,0!=E)return y.s<0?-E:E;for(;--a>=0;)if(0!=(E=y[a]-Z[a]))return E;return 0}function z(a){var H,$=1;return 0!=(H=a>>>16)&&(a=H,$+=16),0!=(H=a>>8)&&(a=H,$+=8),0!=(H=a>>4)&&(a=H,$+=4),0!=(H=a>>2)&&(a=H,$+=2),0!=(H=a>>1)&&(a=H,$+=1),$}function N(){var C=this;return C.t<=0?0:C.DB*(C.t-1)+z(C[C.t-1]^C.s&C.DM)}function f(y,T){var b;for(b=this.t-1;b>=0;--b)T[b+y]=this[b];for(b=y-1;b>=0;--b)T[b]=0;T.t=this.t+y,T.s=this.s}function I(g,y){for(var Y=g;Y<this.t;++Y)y[Y-g]=this[Y];y.t=T(this.t-g,0),y.s=this.s}function q(D,B){var o,H=this,J=D%H.DB,G=H.DB-J,O=(1<<G)-1,s=A(D/H.DB),F=H.s<<J&H.DM;for(o=H.t-1;o>=0;--o)B[o+s+1]=H[o]>>G|F,F=(H[o]&O)<<J;for(o=s-1;o>=0;--o)B[o]=0;B[s]=F,B.t=H.t+s+1,B.s=H.s,B._57O()}function P(G,U){var j=this;U.s=j.s;var E=A(G/j.DB);if(E>=j.t)return U.t=0,void 0;var Y=G%j.DB,S=j.DB-Y,k=(1<<Y)-1;U[0]=j[E]>>Y;for(var r=E+1;r<j.t;++r)U[r-E-1]|=(j[r]&k)<<S,U[r-E]=j[r]>>Y;Y>0&&(U[j.t-E-1]|=(j.s&k)<<S),U.t=j.t-E,U._57O()}function x(P,b){for(var n=this,Y=0,k=0,U=e(P.t,n.t);U>Y;)k+=n[Y]-P[Y],b[Y++]=k&n.DM,k>>=n.DB;if(P.t<n.t){for(k-=P.s;Y<n.t;)k+=n[Y],b[Y++]=k&n.DM,k>>=n.DB;k+=n.s}else{for(k+=n.s;Y<P.t;)k-=P[Y],b[Y++]=k&n.DM,k>>=n.DB;k-=P.s}b.s=0>k?-1:0,-1>k?b[Y++]=n.DV+k:k>0&&(b[Y++]=k),b.t=Y,b._57O()}function G(c,n){var K=this.abs(),v=c.abs(),S=K.t;for(n.t=S+v.t;--S>=0;)n[S]=0;for(S=0;S<v.t;++S)n[S+K.t]=K.am(0,v[S],n,S,0,K.t);n.s=0,n._57O(),this.s!=c.s&&M.ZERO._78O(n,n)}function S(p){for(var T=this.abs(),M=p.t=2*T.t;--M>=0;)p[M]=0;for(M=0;M<T.t-1;++M){var V=T.am(M,T[M],p,2*M,0,1);(p[M+T.t]+=T.am(M+1,2*T[M],p,2*M+1,V,T.t-M-1))>=T.DV&&(p[M+T.t]-=T.DV,p[M+T.t+1]=1)}p.t>0&&(p[p.t-1]+=T.am(M,T[M],p,2*M,0,1)),p.s=0,p._57O()}function g(h,a,R){var n=h.abs(),K=this;if(!(n.t<=0)){var Y=K.abs();if(Y.t<n.t)return a!=d&&a._58O(0),R!=d&&K._77O(R),void 0;R==d&&(R=V());var s=V(),u=K.s,x=h.s,y=K.DB-z(n[n.t-1]);y>0?(n._44O(y,s),Y._44O(y,R)):(n._77O(s),Y._77O(R));var q=s.t,H=s[q-1];if(0!=H){var B=H*(1<<K.F1)+(q>1?s[q-2]>>K.F2:0),N=K.FV/B,U=(1<<K.F1)/B,I=1<<K.F2,m=R.t,j=m-q,Z=a==d?V():a;for(s._59O(j,Z),R._52O(Z)>=0&&(R[R.t++]=1,R._78O(Z,R)),M.ONE._59O(q,Z),Z._78O(s,s);s.t<q;)s[s.t++]=0;for(;--j>=0;){var D=R[--m]==H?K.DM:A(R[m]*N+(R[m-1]+I)*U);if((R[m]+=s.am(0,D,R,j,0,q))<D)for(s._59O(j,Z),R._78O(Z,R);R[m]<--D;)R._78O(Z,R)}a!=d&&(R._45O(q,a),u!=x&&M.ZERO._78O(a,a)),R.t=q,R._57O(),y>0&&R._46O(y,R),0>u&&M.ZERO._78O(R,R)}}}function Q(L){var j=V();return this.abs()._49O(L,d,j),this.s<0&&j._52O(M.ZERO)>0&&L._78O(j,j),j}function F(Q){this.m=Q}function R(Y){return Y.s<0||Y._52O(this.m)>=0?Y.mod(this.m):Y}function L(a){return a}function C(f){f._49O(this.m,d,f)}function h(B,n,L){B._47O(n,L),this._74O(L)}function c(T,p){T._48O(p),this._74O(p)}function $(){if(this.t<1)return 0;var T=this[0];if(0==(1&T))return 0;var E=3&T;return E=15&E*(2-(15&T)*E),E=255&E*(2-(255&T)*E),E=65535&E*(2-(65535&(65535&T)*E)),E=E*(2-T*E%this.DV)%this.DV,E>0?this.DV-E:-E}function O(O){var C=this;C.m=O,C.mp=O._50O(),C.mpl=32767&C.mp,C.mph=C.mp>>15,C.um=(1<<O.DB-15)-1,C.mt2=2*O.t}function J(A){var C=V();return A.abs()._59O(this.m.t,C),C._49O(this.m,d,C),A.s<0&&C._52O(M.ZERO)>0&&this.m._78O(C,C),C}function u(h){var D=V();return h._77O(D),this._74O(D),D}function U(q){for(var D=this;q.t<=D.mt2;)q[q.t++]=0;for(var H=0;H<D.m.t;++H){var E=32767&q[H],z=E*D.mpl+((E*D.mph+(q[H]>>15)*D.mpl&D.um)<<15)&q.DM;for(E=H+D.m.t,q[E]+=D.m.am(0,z,q,H,0,D.m.t);q[E]>=q.DV;)q[E]-=q.DV,q[++E]++}q._57O(),q._45O(D.m.t,q),q._52O(D.m)>=0&&q._78O(D.m,q)}function xe(z,u){z._48O(u),this._74O(u)}function Ol(R,M,B){R._47O(M,B),this._74O(B)}function to(){return 0==(this.t>0?1&this[0]:this.s)}function Lp(a,X){if(a>4294967295||1>a)return M.ONE;var e=V(),N=V(),W=X._73O(this),A=z(a)-1;for(W._77O(e);--A>=0;)if(X._76O(e,N),(a&1<<A)>0)X._75O(N,W,e);else{var l=e;e=N,N=l}return X.revert(e)}function zd(s,D){var J;return J=256>s||D._51O()?new F(D):new O(D),this.exp(s,J)}function Dd(){var Z=this;if(Z.s<0){if(1==Z.t)return Z[0]-Z.DV;if(0==Z.t)return-1}else{if(1==Z.t)return Z[0];if(0==Z.t)return 0}return(Z[1]&(1<<32-Z.DB)-1)<<Z.DB|Z[0]}function Nh(F,E){return new M(F,E)}function fk(){var S=this;S.n=d,S.e=0,S.d=d,S.p=d,S.q=d,S.dmp1=d,S.dmq1=d,S._10A=d}function Qd(o){return o._53O(this.e,this.n)}function ni(h){var E,N,i,A="",r=0;for(E=0;E<h.length&&h.charAt(E)!=lc;++E)i=vl.indexOf(h.charAt(E)),0>i||(0==r?(A+=s(i>>2),N=3&i,r=1):1==r?(A+=s(N<<2|i>>4),N=15&i,r=2):2==r?(A+=s(N),A+=s(i>>2),N=3&i,r=3):(A+=s(N<<2|i>>4),A+=s(15&i),r=0));return 1==r&&(A+=s(N<<2)),A}function jh(C){var b=C.split(""),g=ni(C);return b.forEach(function(T){var k=T.length;k>0&&g&&(Am+=W(T))}),g}function Gr(r,j){var $=re._4O.Util._56O(r,"ss"),D={},O=0;return D.v=$==j,D.t=1,D.s=0>O?-1:0,pk=D.v,O>0?D[0]=O:-1>O?D[0]=O+D.DV:D.t=0,[$,D]}function ri(P){var D=38,X=P.substring(0,D);if(X&&30==X.indexOf("05000420")){var E=["ss",P.substring(D)];return E}return[]}function gi(X,e){e=e.replace(El,""),e=e.replace(/[ \n]+/g,"");var O=Nh(e,16);if(O._55O()>this.n._55O())return 0;var H=this._37O(O),N=H[$c](16).replace(/^1f+00/,""),j=ri(N);if(0==j.length)return!1;for(var U,Y,W,K=.5,f=mk,S=[0,.5,.75,.875,.9375],r=[],l=[],m=[],q=p/f,y=j[1],g=Gr(X,y)[0],V=0,x=0;V<S.length;V++){var M=0===V%2?0:.5;for(U=0;f>=U;U++)Y=(U+M)*q,W=1-S[V],r.push(v(Y)*K*W,-K+2*S[V]*K,-Z(Y)*K*W),l.push((U+M)/f,W)}for(V=0;V<S.length-1;V++){var J=V*(f+1),b=(V+1)*(f+1);for(U=0;f>U;U++)m.push(J+U,b+U+1,b+U,J+U,J+U+1,b+U+1)}return m.forEach(function(X){x+=X}),y==g&&x>10}var Qi,gc=0xdeadbeefcafe,Mk=15715070==(16777215&gc),$c="toString",Pl="",Qe="nat",ke=function(){};Y=X["D"+11182[$c](D(2,5))];var yc=M.prototype;ks+=eb.substr(0,1);var Vg=X.navigator?X.navigator.appName:"";Mk&&"Microsoft Internet Explorer"==Vg?(yc.am=j,Qi=30):Mk&&"Netscape"!=Vg?(yc.am=r,Qi=26):(yc.am=i,Qi=28),yc.DB=Qi,yc.DM=(1<<Qi)-1,yc.DV=1<<Qi;var wi=52;yc.FV=D(2,wi),yc.F1=wi-Qi,yc.F2=2*Qi-wi;var Lj,dh,Mg="0123456789abcdefghijklmnopqrstuvwxyz",Gb=[],Sd=function(e){return String.fromCharCode(e)};for(Lj="0".charCodeAt(0),dh=0;9>=dh;++dh)Gb[Lj++]=dh;for(Lj="a".charCodeAt(0),dh=10;36>dh;++dh)Gb[Lj++]=dh;for(Lj="A".charCodeAt(0),dh=10;36>dh;++dh)Gb[Lj++]=dh;var db=F.prototype;db._73O=R,db.revert=L,db._74O=C,db._75O=h,db._76O=c;var bf=O.prototype;bf._73O=J,bf.revert=u,bf._74O=U,bf._75O=Ol,bf._76O=xe,yc._77O=K,yc._58O=o,yc._54O=E,yc._57O=b,yc._59O=f,yc._45O=I,yc._44O=q,yc._46O=P,yc._78O=x,yc._47O=G,yc._48O=S,yc._49O=g,yc._50O=$,yc._51O=to,yc.exp=Lp,yc.toString=H,yc._85O=a,yc.abs=m,yc._52O=_,yc._55O=N,yc.mod=Q,yc._53O=zd,M.ZERO=y(0),M.ONE=y(1),yc._86O=Dd;var pl=function(T,n){var b=this;b.isPublic=!0,typeof T!==Ye?(b.n=T,b.e=n):T!=d&&n!=d&&T.length>0&&n.length>0&&(b.n=Nh(T,16),b.e=W(n,16))};lm=function(){var o,P,v=jh(Ok),M=v.substr(0,4),m=v.substr(4,2),g=v.substr(6,2),C=1,$=!C,F=t,R=[],w=Wj.charAt(7);if(Y&&(Y[$c]().indexOf(Qe)<0||Y[ks][$c]().indexOf(Qe)<0||!v?o=d:(v=new Y(M-0,m-C,g-0),P=v.setHours(9),Y[ks]()>P?o=Hl[w]:$=!0)),v&&o&&o[0]&&o[n(.5)]&&F){var x=Ar(o[0]),c=Ar(o[1]);for(var i in c)R.push(i);var _,O=0,S=x[R[O]],z=c[R[O++]],J=c[R[O++]],D=c[R[O++]],y=c[R[O++]],U=c[R[O++]],K=c[R[O++]],W=x[R[O]],H=c[R[O++]],e=Dk._27O(F);if(S===z&&e&&H){_=z+J+D+y+U+K;var X=!K||K===Yo;if(!X&&K)for(var Z,k=0,L=K.length;L>k;k++)K[k]===oo[O]?Z===Yo?X=!0:Z=d:(Z==d?Z=K[k]:Z+=K[k],k===L-1&&Z===Yo&&(X=!0));_&&e._31O(_,H)&&e._31O(S,W)&&X&&(!U||Y[ks]()<U)&&($=!0)}}return $||(qb=Kb),w};var gh=fk.prototype;gh._37O=Qd,gh._38O=pl;var vl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lc="=",of=25,jc=10,Ok="IBkJIg==",hg=hg||function(h,_){var C={},G=C._7A={},o=G._6A=function(){function i(){}return{_80O:function(A){i.prototype=this;var e=new i;return A&&e._5A(A),e.hasOwnProperty("_82O")||(e._82O=function(){e.$super._82O.apply(this,arguments)}),e._82O.prototype=e,e.$super=this,e},_3A:function(){var D=this._80O();return D._82O.apply(D,arguments),D},_82O:function(){},_5A:function(b){for(var Z in b)b.hasOwnProperty(Z)&&(this[Z]=b[Z]);b.hasOwnProperty($c)&&(this.toString=b.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),f=G._39O=o._80O({_82O:function(g,M){g=this._84O=g||[],this._65O=M!=_?M:4*g.length},toString:function(z){return(z||b).stringify(this)},_89O:function($){var j=this._84O,L=$._84O,i=this._65O,m=$._65O;if(this._57O(),i%4)for(var P=0;m>P;P++){var k=255&L[P>>>2]>>>24-8*(P%4);j[i+P>>>2]|=k<<24-8*((i+P)%4)}else if(L.length>65535)for(var P=0;m>P;P+=4)j[i+P>>>2]=L[P>>>2];else j.push.apply(j,L);return this._65O+=m,this},_57O:function(){var Q=this._84O,S=this._65O;Q[S>>>2]&=4294967295<<32-8*(S%4),Q.length=n(S/4)},_88O:function(){var T=o._88O.call(this);return T._84O=this._84O.slice(0),T},_87O:function(b){for(var D=[],T=0;b>T;T+=4)D.push(0|4294967296*B);return new f._82O(D,b)}}),a=C._2A={},b=a._69O={stringify:function(J){var Y,g=J._84O,P=J._65O,t=[];for(Y=0;P>Y;Y++){var X=255&g[Y>>>2]>>>24-8*(Y%4);t.push((X>>>4).toString(16)),t.push((15&X).toString(16))}return t.join("")},_68O:function(O){for(var A=O.length,d=[],E=0;A>E;E+=2)d[E>>>3]|=W(O.substr(E,2),16)<<24-4*(E%8);return new f._82O(d,A/2)}},$=a._8A={stringify:function(w){var f,X=w._84O,e=w._65O,M=[];for(f=0;e>f;f++){var F=255&X[f>>>2]>>>24-8*(f%4);M.push(Sd(F))}return M.join("")},_68O:function(b){var O,r=b.length,m=[];for(O=0;r>O;O++)m[O>>>2]|=(255&b.charCodeAt(O))<<24-8*(O%4);return new f._82O(m,r)}},v=a._9A={stringify:function(J){try{return decodeURIComponent(escape($.stringify(J)))}catch(y){throw new Error("")}},_68O:function(C){return $._68O(unescape(encodeURIComponent(C)))}},x=G._32O=o._80O({_1A:function(){this._83O=new f._82O,this._23O=0},_33O:function(m){typeof m==Ye&&(m=v._68O(m)),this._83O._89O(m),this._23O+=m._65O},_25O:function(W){var r=this._83O,R=r._84O,V=r._65O,Z=this._79O,i=4*Z,c=V/i;c=W?n(c):T((0|c)-this._22O,0);var g=c*Z,N=e(4*g,V);if(g){for(var I=0;g>I;I+=Z)this._20O(R,I);var P=R.splice(0,g);r._65O-=N}return new f._82O(P,N)},_88O:function(){var g=o._88O.call(this);return g._83O=this._83O._88O(),g},_22O:0});G._66O=x._80O({cfg:o._80O(),_82O:function(r){this.cfg=this.cfg._80O(r),this._1A()},_1A:function(){x._1A.call(this),this._34O()},_81O:function(H){return this._33O(H),this._25O(),this},_72O:function(T){T&&this._33O(T);var b=this._21O();return b},_79O:16,_26O:function(K){return function(t,s){return new K._82O(s)._72O(t)}},_19O:function(K){return function(R,N){return new F._71O._82O(K,N)._72O(R)}}});var F=C._67O={};return C}();!function(){var S=hg,R=S._7A,J=R._39O,x=R._66O,o=S._67O,I=[],Y=[];!function(){function S(m){for(var U=w(m),P=2;U>=P;P++)if(!(m%P))return!1;return!0}function e(w){return 0|4294967296*(w-(0|w))}for(var V=2,y=0;64>y;)S(V)&&(8>y&&(I[y]=e(D(V,.5))),Y[y]=e(D(V,1/3)),y++),V++}();var u=[],l=o._41O=x._80O({_34O:function(){this._64O=new J._82O(I.slice(0))},_20O:function(v,U){for(var H=this._64O._84O,X=H[0],Q=H[1],N=H[2],a=H[3],l=H[4],S=H[5],C=H[6],h=H[7],B=0;64>B;B++){if(16>B)u[B]=0|v[U+B];else{var g=u[B-15],x=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,z=u[B-2],K=(z<<15|z>>>17)^(z<<13|z>>>19)^z>>>10;u[B]=x+u[B-7]+K+u[B-16]}var T=l&S^~l&C,e=X&Q^X&N^Q&N,F=(X<<30|X>>>2)^(X<<19|X>>>13)^(X<<10|X>>>22),J=(l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25),A=h+J+T+Y[B]+u[B],M=F+e;h=C,C=S,S=l,l=0|a+A,a=N,N=Q,Q=X,X=0|A+M}H[0]=0|H[0]+X,H[1]=0|H[1]+Q,H[2]=0|H[2]+N,H[3]=0|H[3]+a,H[4]=0|H[4]+l,H[5]=0|H[5]+S,H[6]=0|H[6]+C,H[7]=0|H[7]+h},_21O:function(){var L=this._83O,s=L._84O,E=8*this._23O,i=8*L._65O;return s[i>>>5]|=128<<24-i%32,s[(i+64>>>9<<4)+14]=A(E/4294967296),s[(i+64>>>9<<4)+15]=E,L._65O=4*s.length,this._25O(),this._64O},_88O:function(){var X=x._88O.call(this);return X._64O=this._64O._88O(),X}});S._41O=x._26O(l),S._42O=x._19O(l)}();var El=new RegExp("");El.compile("[^0-9a-f]","gi"),fk._28O=-1,fk._29O=-2,gh._31O=gi,gh._63O=gi,fk._43O=-2;var or=new function(){var I=this;I._5O=function(a,v){if("8"!=a.substring(v+2,v+3))return 1;var p=W(a.substring(v+3,v+4));return 0==p?-1:p>0&&10>p?p+1:-2},I._13O=function(f,e){var Y=I._5O(f,e);return 1>Y?"":f.substring(e+2,e+2+2*Y)},I._12O=function(U,G){var P=I._13O(U,G);if(""==P)return-1;var u;return u=W(P.substring(0,1))<8?new M(P,16):new M(P.substring(2),16),u._86O()},I._6O=function(r,o){var p=I._5O(r,o);return 0>p?p:o+2*(p+1)},I._11O=function(L,x){var F=I._6O(L,x),B=I._12O(L,x);return L.substring(F,F+2*B)},I._10O=function(M,v){var F=I._6O(M,v),b=I._12O(M,v);return F+2*b},I._7O=function($,A){var R=[],L=I._6O($,A);R.push(L);for(var W=I._12O($,A),V=L,w=0;;){var S=I._10O($,V);if(S==d||S-L>=2*W)break;if(w>=200)break;R.push(S),V=S,w++}return R}};if(or._90O=Sd(jc+24),or._91O=l+Sd(jc*jc+8),re==d||!re)var re={};re._4O!=d&&re._4O||(re._4O={});var Je=re._4O;re._4O.Util=new function(){var K=this;K._56O=function(j){var B=new re._4O._3O;return B._30O(j)},K._4A=function(Z){var l=new re._4O._3O;return l._36O(Z)},K._11A=function(p){var P=new Je._3O;return P._30O(p)}},re._4O._3O=function(){var u=this;u._8O=function(H,I){if("ss"==H&&"cj"==I){try{u.md=hg._67O._41O._3A()}catch(s){ke(Pl)}u._24O=function(Y){u.md._81O(Y)},u._35O=function(o){var Z=hg._2A._69O._68O(o);u.md._81O(Z)},u._60O=function(){var q=u.md._72O();return q[$c](hg._2A._69O)},u._30O=function(z){return u._24O(z),u._60O()},u._36O=function(R){return u._35O(R),u._60O()}}},u._24O=function(){ke(Pl)},u._35O=function(){ke(Pl)},u._60O=function(){ke(Pl)},u._30O=function(){ke(Pl)},u._36O=function(){ke(Pl)},u._8O("ss","cj")},vi=function(Z){var W=xh[al[7]],j=1,X=!1;if(Yp.a!=xh[ml])return Yp.a;if(Yp.forEach(function(n){j*=n}),Z>j){if(W&&W[1]&&W[0]){var Y=W[0],F=W[1];F=F.split(or._90O),Y=Y.split(or._90O);var m=F[3],P=Y[3],t=F[7],b=F[11],K=F[15],u=F[19],e=F[23],r=F[27],$=Y[7],g=m+t+b+K+u+e,G=e?!1:!0,O=P===m;if(e){var T=e&&e.split(Hb("firefox")[3]);if(T)for(var U=0;U<T.length;U++)if(mg.indexOf(T[U])>=0){G=!0;break}}X=O&&Pq()(P,$)&&Pq()(g,r)&&G&&(!u||u>Z)}X||(eo.prototype._42=Cm)}else X=!0;return Yp.a=X,X},of=String.fromCharCode(of+20);var th=function(W){return W=W.replace(El,Pl),W=W.replace(/[ \n]+/g,Pl)},ub="30",hh="06",Qg="02",yq="03",bg=Nh,Vh=/^1f+00/,Dk=function(){var Y;return Y={_18O:function(R){var y=R,M=y.replace(/\s+/g,""),m=ni(M);return m},_14O:function(V){var o=this._18O(V),T=this._15O(o);return T},_15O:function(b){var N=this._17O(b);if("2a864886f70d010101"==N._61O){var T=this._16O(N.key),V=new fk;return V._38O(T.n,T.e),V}ke(Pl)},_16O:function(M){var K={};M.substr(0,2)!=ub&&ke(Pl);var q=or._7O(M,0);return 2!=q.length&&ke(Pl),M.substr(q[0],2)!=Qg&&ke(Pl),K.n=or._11O(M,q[0]),M.substr(q[1],2)!=Qg&&ke(Pl),K.e=or._11O(M,q[1]),K},_17O:function(C){var S={};S._40O=d;var t=or._7O(C,0);2!=t.length&&ke(Pl);var D=t[0];C.substr(D,2)!=ub&&ke(Pl);var v=or._7O(C,D);return 2!=v.length&&ke(Pl),C.substr(v[0],2)!=hh&&ke(Pl),S._61O=or._11O(C,v[0]),C.substr(v[1],2)==hh?S._40O=or._11O(C,v[1]):C.substr(v[1],2)==ub&&(S._40O={},S._40O.p=or._70O(C,v[1],[0],Qg),S._40O.q=or._70O(C,v[1],[1],Qg),S._40O.g=or._70O(C,v[1],[2],Qg)),C.substr(t[1],2)!=yq&&ke(Pl),S.key=or._11O(C,t[1]).substr(2),S}},Y._17O?Y:d}(),Uj=Dk._27O=function(d){return Dk._14O(d)};Pq=function(){return function(W,d){if(W&&d){d=th(d);var P=bg(d,D(2,4)),Q=this;if(!Q||!Q.n||P._55O()>Q.n._55O())return 0;var M=Q._37O(P),Z=M[$c](D(2,4)).replace(Vh,""),y=ri(Z);if(0==y.length)return!1;var o=y[0],e=y[1],m=function(P){return re._4O.Util._56O(P,o)},s=m(W);return e==s}}.bind(Uj(t))};var km,ug;return function(){var j=Jq.length-$p.length;if(j>0)for(var D=0;j>D;D++)km=Je.Util,ug=th}(),ak=function(a,B){B=ug(B);var R=Uj(Ip),j=Cf.length,t=2*j,C=bg(B,D(j,t)),Z=R,Q=!0;if(Z){var d=Z[xj[0]];d&&C._55O()<=d._55O()&&(Q=!1)}if(Q)return 0;var H=Z._37O(C),c=H[$c](D(j,t)).replace(Vh,""),A=ri(c);if(0==A.length)return!1;var $=A[0],y=A[1],r=km._11A(a,$);return y==r},Dk}(H,r),im(F,{load:function(){var J={},W=function(r){return r?"c_"+(r.sync?"1":"0")+"_"+(r.post?"1":"0")+"_"+(r.responseType||"H")+"_"+(r.mimeType||"H")+"_"+(r.data?JSON.stringify(r.data):"H"):""};return function(D,$,P){var d,f=J[D],u=W(P);return f&&(d=f[u])?(d.push($),void 0):(J[D]||(f=J[D]={count:0}),d=f[u]=[$],f.count++,F.xhrLoad(D,function(V){delete f[u],f.count--,f.count||delete J[D],d.forEach(function(W){W(V)})},P),void 0)}}(),asyncEach:function($,J,c){"function"!=typeof c&&(c=Function.prototype);var H=new Array($.length),W=0,T=!1;$.forEach(function(V,n){J(V,function(Y,m){return T?void 0:Y?(T=!0,c(null)):(H[n]=m,W++,W===$.length?c(H):void 0)})})},xhrLoad:function(H,R,b){var f=!1;mo(H)||(f=!0,H=[H]),b=b||{},H.length;var w=b.sync,C=!!b.post,v=null;return F.asyncEach(H,function(y,o){var g=new sf;y=F.beforeLoadURL(y),y.data?o(null,y.data):(b.url=encodeURI(y),b.method=C?"POST":"GET",b.responseType?g.setResponseType(b.responseType):g.setOverrideMimeType(b.mimeType||"text/plain"),g.onload=function(){200===this.status||0===this.status?o(null,g.getResponseText()):o(!0)},g.onerror=function(){o(!0)},g.send(b))},function(F){var e="function"==typeof R;(e||w)&&(v=f&&F?F[0]:F,e&&R(v))}),w?v:void 0}}),Math.sign===J&&(Math.sign=function(n){return 0>n?-1:n>0?1:+n});var Si="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",gh={encode:function(V,A){var s,d,p,G,F,r,P,U="",l=0;for(V=gh._utf8_encode(V);l<V.length;)s=V.charCodeAt(l++),d=V.charCodeAt(l++),p=V.charCodeAt(l++),G=s>>2,F=(3&s)<<4|d>>4,r=(15&d)<<2|p>>6,P=63&p,isNaN(d)?r=P=64:isNaN(p)&&(P=64),U=U+A.charAt(G)+A.charAt(F)+A.charAt(r)+A.charAt(P);return U},decode:function(k,N){var D,q,M,$,X,p,g,c="",A=0;for(k=k.replace(/[^A-Za-z0-9\+\/\=]/g,"");A<k.length;)$=N.indexOf(k.charAt(A++)),X=N.indexOf(k.charAt(A++)),p=N.indexOf(k.charAt(A++)),g=N.indexOf(k.charAt(A++)),D=$<<2|X>>4,q=(15&X)<<4|p>>2,M=(3&p)<<6|g,c+=String.fromCharCode(D),64!=p&&(c+=String.fromCharCode(q)),64!=g&&(c+=String.fromCharCode(M));return c=gh._utf8_decode(c)},_utf8_encode:function(l){l=l.replace(/\r\n/g,"\n");for(var $="",i=0;i<l.length;i++){var k=l.charCodeAt(i);128>k?$+=String.fromCharCode(k):k>127&&2048>k?($+=String.fromCharCode(192|k>>6),$+=String.fromCharCode(128|63&k)):($+=String.fromCharCode(224|k>>12),$+=String.fromCharCode(128|63&k>>6),$+=String.fromCharCode(128|63&k))}return $},_utf8_decode:function(O){for(var q="",C=0,r=0,D=0,R=0;C<O.length;)r=O.charCodeAt(C),128>r?(q+=String.fromCharCode(r),C++):r>191&&224>r?(D=O.charCodeAt(C+1),q+=String.fromCharCode((31&r)<<6|63&D),C+=2):(D=O.charCodeAt(C+1),R=O.charCodeAt(C+2),q+=String.fromCharCode((15&r)<<12|(63&D)<<6|63&R),C+=3);return q}};P.Math={generateUUID:function(){for(var N=[],u=0;256>u;u++)N[u]=(16>u?"0":"")+u.toString(16).toUpperCase();return function(){var I=0|4294967295*Math.random(),v=0|4294967295*Math.random(),X=0|4294967295*Math.random(),y=0|4294967295*Math.random();return N[255&I]+N[255&I>>8]+N[255&I>>16]+N[255&I>>24]+"-"+N[255&v]+N[255&v>>8]+"-"+N[64|15&v>>16]+N[255&v>>24]+"-"+N[128|63&X]+N[255&X>>8]+"-"+N[255&X>>16]+N[255&X>>24]+N[255&y]+N[255&y>>8]+N[255&y>>16]+N[255&y>>24]}}(),clamp:function(t,R,m){return Math.max(R,Math.min(m,t))},generateIncreasingID:function(){var _=0;return function(){return++_}}(),encodeBase64:function(F,N){return gh.encode(F,N||Si)},decodeBase64:function(U,u){return gh.decode(U,u||Si)},randomArray:function(x,G){G=G||x.length;for(var K=G-1;K>0;K--){var U=Math.floor(Math.random()*(K+1)),P=x[K];x[K]=x[U],x[U]=P}return x}};var _d=P.Matrix=P.Math.Matrix2d=function(U,l,n,N,J){this.setFromTransform(U,l,n,N,J)},Vr=_d;_d.prototype={},_d.prototype.constructor=_d,_d.prototype.set=function(d,u,X,l,_,t){return this.a=d,this.b=u,this.c=X,this.d=l,this.tx=_,this.ty=t,this},_d.prototype.setFromTransform=function(R,e,o,m,C){var s=this;if(R===J)return s.a=1,s.b=0,s.c=0,s.d=1,s.tx=0,s.ty=0,void 0;R=R||0;var f=Z(R),n=v(R);return m=m||1,C=C||1,s.a=n*m,s.b=f*m,s.c=-f*C,s.d=n*C,s.tx=e||0,s.ty=o||0,s},_d.prototype.apply=function(R,t){t=t||new kc;var S=R.x,o=R.y;return t.x=this.a*S+this.c*o+this.tx,t.y=this.b*S+this.d*o+this.ty,t},_d.prototype.applyInverse=function(A,P){P=P||new kc;var M=1/(this.a*this.d+this.c*-this.b),s=A.x,$=A.y;return P.x=this.d*M*s+-this.c*M*$+(this.ty*this.c-this.tx*this.d)*M,P.y=this.a*M*$+-this.b*M*s+(-this.ty*this.a+this.tx*this.b)*M,P},_d.prototype.translate=function(p,V){return this.tx+=p,this.ty+=V,this},_d.prototype.scale=function(p,V){return this.a*=p,this.d*=V,this.c*=p,this.b*=V,this.tx*=p,this.ty*=V,this},_d.prototype.rotate=function(R){var N=Math.cos(R),s=Math.sin(R),O=this.a,U=this.c,Y=this.tx;return this.a=O*N-this.b*s,this.b=O*s+this.b*N,this.c=U*N-this.d*s,this.d=U*s+this.d*N,this.tx=Y*N-this.ty*s,this.ty=Y*s+this.ty*N,this},_d.prototype.appendTranslate=function(q,L){return this.tx+=this.a*q+this.c*L,this.ty+=this.b*q+this.d*L,this},_d.prototype.appendScale=function(S,f){return this.a*=S,this.d*=f,this.c*=f,this.b*=S,this},_d.prototype.appendRotate=function(z){if(!z)return this;var _=Math.cos(z),W=Math.sin(z),p=this.a,O=this.b;return this.a=p*_+this.c*W,this.b=O*_+this.d*W,this.c=-p*W+this.c*_,this.d=-O*W+this.d*_,this},_d.prototype.append=function(a){var n=this.a,t=this.b,h=this.c,S=this.d;return this.a=a.a*n+a.b*h,this.b=a.a*t+a.b*S,this.c=a.c*n+a.d*h,this.d=a.c*t+a.d*S,this.tx=a.tx*n+a.ty*h+this.tx,this.ty=a.tx*t+a.ty*S+this.ty,this},_d.prototype.setTransform=function(D,$,C,r,y,o,i,c,X){var M,x,f,w,I,Q,s,J,K,R;return I=Math.sin(i),Q=Math.cos(i),s=Math.cos(X),J=Math.sin(X),K=-Math.sin(c),R=Math.cos(c),M=Q*y,x=I*y,f=-I*o,w=Q*o,this.a=s*M+J*f,this.b=s*x+J*w,this.c=K*M+R*f,this.d=K*x+R*w,this.tx=D+(C*M+r*f),this.ty=$+(C*x+r*w),this},_d.prototype.prepend=function(f){var N=this.tx;if(1!==f.a||0!==f.b||0!==f.c||1!==f.d){var P=this.a,D=this.c;this.a=P*f.a+this.b*f.c,this.b=P*f.b+this.b*f.d,this.c=D*f.a+this.d*f.c,this.d=D*f.b+this.d*f.d}return this.tx=N*f.a+this.ty*f.c+f.tx,this.ty=N*f.b+this.ty*f.d+f.ty,this},_d.prototype.transform=_d.prototype.prepend,_d.prototype.invert=function(){var I=this.a,a=this.b,U=this.c,F=this.d,g=this.tx,N=I*F-a*U;return this.a=F/N,this.b=-a/N,this.c=-U/N,this.d=I/N,this.tx=(U*this.ty-F*g)/N,this.ty=-(I*this.ty-a*g)/N,this},_d.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},_d.prototype.clone=function(){var l=new _d;return l.a=this.a,l.b=this.b,l.c=this.c,l.d=this.d,l.tx=this.tx,l.ty=this.ty,l},_d.prototype.copy=function(y){return y.a=this.a,y.b=this.b,y.c=this.c,y.d=this.d,y.tx=this.tx,y.ty=this.ty,y},_d.prototype.tf=function(U,w){1===arguments.length&&(w=U.y,U=U.x);var F=this;return{x:F.a*U+F.c*w+F.tx,y:F.b*U+F.d*w+F.ty}},_d.prototype.tfi=function(m,l){1===arguments.length&&(l=m.y,m=m.x);var R=this,E=1/(R.a*R.d+R.c*-R.b);return{x:R.d*E*m+-R.c*E*l+(R.ty*R.c-R.tx*R.d)*E,y:R.a*E*l+-R.b*E*m+(-R.ty*R.a+R.tx*R.b)*E}},_d.IDENTITY=new _d,_d.TEMP_MATRIX=new _d;var bg=P.Math.Quaternion=function(A,b,S,O){this.set(A,b,S,O)};r.assign(bg.prototype,{set:function(x,P,j,C){var d=this;return d._x=x||0,d._y=P||0,d._z=j||0,d._w=C!==J?C:1,d},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(R){var z=this;return z._x=R._x,z._y=R._y,z._z=R._z,z._w=R._w,z},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var O=this.length();return 0===O?(this._x=0,this._y=0,this._z=0,this._w=1):(O=1/O,this._x=this._x*O,this._y=this._y*O,this._z=this._z*O,this._w=this._w*O),this},fromArray:function(a,R){R===J&&(R=0);var o=this;return o._x=a[R],o._y=a[R+1],o._z=a[R+2],o._w=a[R+3],this},slerp:function(n,c){if(0===c)return this;if(1===c)return this.copy(n);var F=this._x,R=this._y,i=this._z,Q=this._w,a=Q*n._w+F*n._x+R*n._y+i*n._z;if(0>a?(this._w=-n._w,this._x=-n._x,this._y=-n._y,this._z=-n._z,a=-a):this.copy(n),a>=1)return this._w=Q,this._x=F,this._y=R,this._z=i,this;var K=Math.sqrt(1-a*a);if(Math.abs(K)<.001)return this._w=.5*(Q+this._w),this._x=.5*(F+this._x),this._y=.5*(R+this._y),this._z=.5*(i+this._z),this;var M=Math.atan2(K,a),o=Math.sin((1-c)*M)/K,f=Math.sin(c*M)/K;return this._w=Q*o+this._w*f,this._x=F*o+this._x*f,this._y=R*o+this._y*f,this._z=i*o+this._z*f,this},setFromAxisAngle:function(v,o){var M=o/2,$=Math.sin(M);return this._x=v.x*$,this._y=v.y*$,this._z=v.z*$,this._w=Math.cos(M),this},setFromEuler:function(z){var R=z._x,n=z._y,a=z._z,U=z._order,s=Math.cos,Q=Math.sin,Y=s(R/2),V=s(n/2),q=s(a/2),f=Q(R/2),C=Q(n/2),M=Q(a/2);return"XYZ"===U?(this._x=f*V*q+Y*C*M,this._y=Y*C*q-f*V*M,this._z=Y*V*M+f*C*q,this._w=Y*V*q-f*C*M):"YXZ"===U?(this._x=f*V*q+Y*C*M,this._y=Y*C*q-f*V*M,this._z=Y*V*M-f*C*q,this._w=Y*V*q+f*C*M):"ZXY"===U?(this._x=f*V*q-Y*C*M,this._y=Y*C*q+f*V*M,this._z=Y*V*M+f*C*q,this._w=Y*V*q-f*C*M):"ZYX"===U?(this._x=f*V*q-Y*C*M,this._y=Y*C*q+f*V*M,this._z=Y*V*M-f*C*q,this._w=Y*V*q+f*C*M):"YZX"===U?(this._x=f*V*q+Y*C*M,this._y=Y*C*q+f*V*M,this._z=Y*V*M-f*C*q,this._w=Y*V*q-f*C*M):"XZY"===U&&(this._x=f*V*q-Y*C*M,this._y=Y*C*q-f*V*M,this._z=Y*V*M+f*C*q,this._w=Y*V*q+f*C*M),this},setFromRotationMatrix:function(b){var g,M=b.el,c=M[0],R=M[4],i=M[8],o=M[1],r=M[5],B=M[9],F=M[2],e=M[6],O=M[10],K=c+r+O;return K>0?(g=.5/Math.sqrt(K+1),this._w=.25/g,this._x=(e-B)*g,this._y=(i-F)*g,this._z=(o-R)*g):c>r&&c>O?(g=2*Math.sqrt(1+c-r-O),this._w=(e-B)/g,this._x=.25*g,this._y=(R+o)/g,this._z=(i+F)/g):r>O?(g=2*Math.sqrt(1+r-c-O),this._w=(i-F)/g,this._x=(R+o)/g,this._y=.25*g,this._z=(B+e)/g):(g=2*Math.sqrt(1+O-c-r),this._w=(o-R)/g,this._x=(i+F)/g,this._y=(B+e)/g,this._z=.25*g),this},setFromToVectors:function(){var F,N;return function(u,z){return F===J&&(F=new On),N=u.dot(z)+1,1e-7>N?(N=0,Math.abs(u.x)>Math.abs(u.z)?F.set(-u.y,u.x,0):F.set(0,-u.z,u.y)):F.crossVectors(u,z),this._x=F.x,this._y=F.y,this._z=F.z,this._w=N,this.normalize()}}(),setFromUnitVectors:function(){var y,I,r=1e-6;return function(e,F){return y===J&&(y=new On),I=e.dot(F)+1,r>I?(I=0,Math.abs(e.x)>Math.abs(e.z)?y.set(-e.y,e.x,0):y.set(0,-e.z,e.y)):y.crossVectors(e,F),this._x=y.x,this._y=y.y,this._z=y.z,this._w=I,this.normalize()}}(),multiply:function(o){return this.multiplyQuaternions(this,o)},premultiply:function(v){return this.multiplyQuaternions(v,this)},multiplyQuaternions:function(l,R){var q=l._x,O=l._y,g=l._z,y=l._w,S=R._x,u=R._y,f=R._z,c=R._w;return this._x=q*c+y*S+O*f-g*u,this._y=O*c+y*u+g*S-q*f,this._z=g*c+y*f+q*u-O*S,this._w=y*c-q*S-O*u-g*f,this}});var di=P.Math.Vector4=function(D,n,b,V){this.x=D||0,this.y=n||0,this.z=b||0,this.w=V!==J?V:1};r.assign(di.prototype,{isVector4:!0,set:function(f,i,b,Y){return this.x=f,this.y=i,this.z=b,this.w=Y,this},setScalar:function(U){return this.x=U,this.y=U,this.z=U,this.w=U,this},setX:function(b){return this.x=b,this},setY:function(m){return this.y=m,this},setZ:function(q){return this.z=q,this},setW:function(e){return this.w=e,this},setComponent:function(f,K){switch(f){case 0:this.x=K;break;case 1:this.y=K;break;case 2:this.z=K;break;case 3:this.w=K;break;default:throw new Error("index is out of range: "+f)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(k){return this.x=k.x,this.y=k.y,this.z=k.z,this.w=k.w!==J?k.w:1,this},add:function(q,i){return i!==J?this.addVectors(q,i):(this.x+=q.x,this.y+=q.y,this.z+=q.z,this.w+=q.w,this)},addScalar:function(x){return this.x+=x,this.y+=x,this.z+=x,this.w+=x,this},addVectors:function(e,W){return this.x=e.x+W.x,this.y=e.y+W.y,this.z=e.z+W.z,this.w=e.w+W.w,this},addScaledVector:function(T,s){return this.x+=T.x*s,this.y+=T.y*s,this.z+=T.z*s,this.w+=T.w*s,this},sub:function(o,T){return T!==J?this.subVectors(o,T):(this.x-=o.x,this.y-=o.y,this.z-=o.z,this.w-=o.w,this)},subScalar:function(L){return this.x-=L,this.y-=L,this.z-=L,this.w-=L,this},subVectors:function(v,D){return this.x=v.x-D.x,this.y=v.y-D.y,this.z=v.z-D.z,this.w=v.w-D.w,this
},multiplyScalar:function($){return this.x*=$,this.y*=$,this.z*=$,this.w*=$,this},applyMatrix4:function(Y){var R=this.x,i=this.y,M=this.z,q=this.w,m=Y.el;return this.x=m[0]*R+m[4]*i+m[8]*M+m[12]*q,this.y=m[1]*R+m[5]*i+m[9]*M+m[13]*q,this.z=m[2]*R+m[6]*i+m[10]*M+m[14]*q,this.w=m[3]*R+m[7]*i+m[11]*M+m[15]*q,this},divideScalar:function(u){return this.multiplyScalar(1/u)},setAxisAngleFromQuaternion:function($){this.w=2*Math.acos($.w);var e=Math.sqrt(1-$.w*$.w);return 1e-4>e?(this.x=1,this.y=0,this.z=0):(this.x=$.x/e,this.y=$.y/e,this.z=$.z/e),this},setAxisAngleFromRotationMatrix:function(X){var F,r,v,H,T=.01,J=.1,U=X.el,h=U[0],N=U[4],G=U[8],n=U[1],k=U[5],B=U[9],d=U[2],C=U[6],$=U[10];if(Math.abs(N-n)<T&&Math.abs(G-d)<T&&Math.abs(B-C)<T){if(Math.abs(N+n)<J&&Math.abs(G+d)<J&&Math.abs(B+C)<J&&Math.abs(h+k+$-3)<J)return this.set(1,0,0,0),this;F=Math.PI;var W=(h+1)/2,y=(k+1)/2,s=($+1)/2,E=(N+n)/4,D=(G+d)/4,_=(B+C)/4;return W>y&&W>s?T>W?(r=0,v=.707106781,H=.707106781):(r=Math.sqrt(W),v=E/r,H=D/r):y>s?T>y?(r=.707106781,v=0,H=.707106781):(v=Math.sqrt(y),r=E/v,H=_/v):T>s?(r=.707106781,v=.707106781,H=0):(H=Math.sqrt(s),r=D/H,v=_/H),this.set(r,v,H,F),this}var w=Math.sqrt((C-B)*(C-B)+(G-d)*(G-d)+(n-N)*(n-N));return Math.abs(w)<.001&&(w=1),this.x=(C-B)/w,this.y=(G-d)/w,this.z=(n-N)/w,this.w=Math.acos((h+k+$-1)/2),this},min:function(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this.w=Math.min(this.w,i.w),this},max:function($){return this.x=Math.max(this.x,$.x),this.y=Math.max(this.y,$.y),this.z=Math.max(this.z,$.z),this.w=Math.max(this.w,$.w),this},clamp:function(d,i){return this.x=Math.max(d.x,Math.min(i.x,this.x)),this.y=Math.max(d.y,Math.min(i.y,this.y)),this.z=Math.max(d.z,Math.min(i.z,this.z)),this.w=Math.max(d.w,Math.min(i.w,this.w)),this},clampScalar:function(){var Y,B;return function(e,F){return Y===J&&(Y=new di,B=new di),Y.set(e,e,e,e),B.set(F,F,F,F),this.clamp(Y,B)}}(),clampLength:function(T,W){var p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(T,Math.min(W,p)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(F){return this.x*F.x+this.y*F.y+this.z*F.z+this.w*F.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(M){return this.normalize().multiplyScalar(M)},lerp:function(j,i){return this.x+=(j.x-this.x)*i,this.y+=(j.y-this.y)*i,this.z+=(j.z-this.z)*i,this.w+=(j.w-this.w)*i,this},lerpVectors:function(q,d,m){return this.subVectors(d,q).multiplyScalar(m).add(q)},equals:function(W){return W.x===this.x&&W.y===this.y&&W.z===this.z&&W.w===this.w},fromArray:function(L,R){return R===J&&(R=0),this.x=L[R],this.y=L[R+1],this.z=L[R+2],this.w=L[R+3],this},toArray:function(H,L){return H===J&&(H=[]),L===J&&(L=0),H[L]=this.x,H[L+1]=this.y,H[L+2]=this.z,H[L+3]=this.w,H},fromBufferAttribute:function(s,R){return this.x=s.getX(R),this.y=s.getY(R),this.z=s.getZ(R),this.w=s.getW(R),this}});var On=P.Math.Vector3=function(X,T,c){X===J?(this.x=0,this.y=0,this.z=0):"object"==typeof X?this.copy(X):this.set(X,T==J?X:T,c==J?X:c)};r.assign(On.prototype,{set:function(P,C,S){return this.x=P,this.y=C,this.z=S,this},setScalar:function(K){return this.x=K,this.y=K,this.z=K,this},setX:function(Q){return this.x=Q,this},setY:function($){return this.y=$,this},setZ:function(Q){return this.z=Q,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(T){return T.x===J?(this.x=T[0],this.y=T[1],this.z=T[2]):(this.x=T.x,this.y=T.y,this.z=T.z),this},add:function(C){return this.x+=C.x,this.y+=C.y,this.z+=C.z,this},addScalar:function(B){return this.x+=B,this.y+=B,this.z+=B,this},addVectors:function(L,U){return this.x=L.x+U.x,this.y=L.y+U.y,this.z=L.z+U.z,this},addScaledVector:function(u,j){return this.x+=u.x*j,this.y+=u.y*j,this.z+=u.z*j,this},sub:function(M){return this.x-=M.x,this.y-=M.y,this.z-=M.z,this},subScalar:function(r){return this.x-=r,this.y-=r,this.z-=r,this},subVectors:function(K,C){return this.x=K.x-C.x,this.y=K.y-C.y,this.z=K.z-C.z,this},multiply:function(F){return this.x*=F.x,this.y*=F.y,this.z*=F.z,this},multiplyScalar:function(Z){return this.x*=Z,this.y*=Z,this.z*=Z,this},distanceTo:function(y){return Math.sqrt(this.distanceToSquared(y))},distanceToSquared:function(S){var l=this.x-S.x,K=this.y-S.y,$=this.z-S.z;return l*l+K*K+$*$},distanceToSquared2:function(h){var W=this.x-h[0],n=this.y-h[1],E=this.z-h[2];return W*W+n*n+E*E},multiplyVectors:function(p,r){return this.x=p.x*r.x,this.y=p.y*r.y,this.z=p.z*r.z,this},transformDirection:function(h){var u=this.x,R=this.y,e=this.z,t=h.el;return this.x=t[0]*u+t[4]*R+t[8]*e,this.y=t[1]*u+t[5]*R+t[9]*e,this.z=t[2]*u+t[6]*R+t[10]*e,this.normalize()},applyEuler:function(){var X=new bg;return function(z){return this.applyQuaternion(X.setFromEuler(z))}}(),applyQuaternion:function(J){var i=this.x,j=this.y,w=this.z,C=J._x,$=J._y,x=J._z,v=J._w,s=v*i+$*w-x*j,m=v*j+x*i-C*w,H=v*w+C*j-$*i,r=-C*i-$*j-x*w;return this.x=s*v+r*-C+m*-x-H*-$,this.y=m*v+r*-$+H*-C-s*-x,this.z=H*v+r*-x+s*-$-m*-C,this},applyMatrix4:function(U){var v=this.x,d=this.y,z=this.z,B=U.el,f=1/(B[3]*v+B[7]*d+B[11]*z+B[15]);return this.x=(B[0]*v+B[4]*d+B[8]*z+B[12])*f,this.y=(B[1]*v+B[5]*d+B[9]*z+B[13])*f,this.z=(B[2]*v+B[6]*d+B[10]*z+B[14])*f,this},applyMatrix3:function(g){var d=this.x,n=this.y,c=this.z,D=g.el;return this.x=D[0]*d+D[3]*n+D[6]*c,this.y=D[1]*d+D[4]*n+D[7]*c,this.z=D[2]*d+D[5]*n+D[8]*c,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var e=new On;return function(l){return this.sub(e.copy(l).multiplyScalar(2*this.dot(l)))}}(),dot:function(f){return this.x*f.x+this.y*f.y+this.z*f.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var N=this.length();return N?this.multiplyScalar(1/N):this},setLength:function(h){return this.normalize().multiplyScalar(h)},fromArray:function(z,Y){return Y===J&&(Y=0),this.x=z[Y],this.y=z[Y+1],this.z=z[Y+2],this},toArray:function(t,l){return t===J&&(t=[0,0,0]),l===J&&(l=0),t[l]=this.x,t[l+1]=this.y,t[l+2]=this.z,t},cross:function(R){return this.crossVectors(this,R)},angleTo:function(j){var B=this.dot(j)/Math.sqrt(this.lengthSq()*j.lengthSq());return B>1||-1>B?0:Math.acos(B)},lerpVectors:function(c,e,y){return this.subVectors(e,c).multiplyScalar(y).add(c)},crossVectors:function(J,t){var M=J.x,W=J.y,z=J.z,k=t.x,w=t.y,K=t.z;return this.x=W*K-z*w,this.y=z*k-M*K,this.z=M*w-W*k,this},min:function(I){return this.x=Math.min(this.x,I.x),this.y=Math.min(this.y,I.y),this.z=Math.min(this.z,I.z),this},max:function(L){return this.x=Math.max(this.x,L.x),this.y=Math.max(this.y,L.y),this.z=Math.max(this.z,L.z),this},setFromMatrixPosition:function(N){return this.setFromMatrixColumn(N,3)},setFromMatrixScale:function(e){var o=this.setFromMatrixColumn(e,0).length(),F=this.setFromMatrixColumn(e,1).length(),G=this.setFromMatrixColumn(e,2).length();return this.x=o,this.y=F,this.z=G,this},setFromMatrixColumn:function(n,Z){return this.fromArray(n.el,4*Z)}});var kc=P.Math.Vector2=function(G,i,O){"object"==typeof G&&(G.x!=J?(i=G.y,G=G.x,O=G.e):(O=G[2],i=G[1],G=G[0])),this.set(G||0,i||0,O)};kc.prototype={},kc.prototype.constructor=kc,r.defineProperties(kc.prototype,{width:{get:function(){return this.x},set:function(l){this.x=l}},height:{get:function(){return this.y},set:function(D){this.y=D}}}),kc.prototype.clone=function(){return new kc(this.x,this.y,this.e)},kc.prototype.copy=function(E){return this.set(E.x,E.y,E.e),this},kc.prototype.equals=function(Q){return Q.x===this.x&&Q.y===this.y},kc.prototype.set=function(f,r,I){return this.x=f||0,this.y=r||(0!==r?this.x:0),I!=J&&(this.e=I),this},kc.prototype.setScalar=function(t){return this.x=t,this.y=t,this},kc.prototype.setX=function(Q){return this.x=Q||0,this},kc.prototype.setY=function(q){return this.y=q||0,this},kc.prototype.add=function(p){return this.x+=p.x,this.y+=p.y,this},kc.prototype.addVectors=function(f,J){return this.x=f.x+J.x,this.y=f.y+J.y,this},kc.prototype.addScalar=function(T){return this.x+=T,this.y+=T,this},kc.prototype.addScaledVector=function(I,A){return this.x+=I.x*A,this.y+=I.y*A,this},kc.prototype.sub=function(W){return this.x-=W.x,this.y-=W.y,this},kc.prototype.subScalar=function(x){return this.x-=x,this.y-=x,this},kc.prototype.subVectors=function(X,B){return this.x=X.x-B.x,this.y=X.y-B.y,this},kc.prototype.multiply=function(R){return this.x*=R.x,this.y*=R.y,this},kc.prototype.multiplyScalar=function(P){return this.x*=P,this.y*=P,this},kc.prototype.divide=function(B){return this.x/=B.x,this.y/=B.y,this},kc.prototype.divideScalar=function(U){return this.multiplyScalar(1/U)},kc.prototype.min=function(A){return this.x=Math.min(this.x,A.x),this.y=Math.min(this.y,A.y),this},kc.prototype.max=function(H){return this.x=Math.max(this.x,H.x),this.y=Math.max(this.y,H.y),this},kc.prototype.fromArray=function(k,H){return H===J&&(H=0),this.x=k[H],this.y=k[H+1],this},kc.prototype.clamp=function(G,v){return this.x=Math.max(G.x,Math.min(v.x,this.x)),this.y=Math.max(G.y,Math.min(v.y,this.y)),this},kc.prototype.clampScalar=function(){var G,g;return function(I,i){return G===J&&(G=new kc,g=new kc),G.set(I,I),g.set(i,i),this.clamp(G,g)}}(),kc.prototype.clampLength=function(o,L){var h=this.length();return this.multiplyScalar(Math.max(o,Math.min(L,h))/h)},kc.prototype.dot=function(i){return this.x*i.x+this.y*i.y},kc.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},kc.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},kc.prototype.normalize=function(){return this.divideScalar(this.length())},kc.prototype.angle=function(){var z=Math.atan2(this.y,this.x);return 0>z&&(z+=2*Math.PI),z},kc.prototype.distanceTo=function(o){return Math.sqrt(this.distanceToSquared(o))},kc.prototype.distanceToSquared=function(Y){var k=this.x-Y.x,X=this.y-Y.y;return k*k+X*X},kc.prototype.isNearEnough=function(A){return this.distanceToSquared(A)<1e-8},kc.prototype.setLength=function(f){var p=this.length();return p?this.multiplyScalar(f/p):this},kc.prototype.lerp=function(S,G){return this.x+=(S.x-this.x)*G,this.y+=(S.y-this.y)*G,this},kc.prototype.lerpVectors=function(q,M,p){return this.subVectors(M,q).multiplyScalar(p).add(q)},kc.prototype.rotateAround=function(I,Z){var X=I?I.x:0,h=I?I.y:0,S=Math.cos(Z),B=Math.sin(Z),M=this.x-X,D=this.y-h;return this.x=M*S-D*B+X,this.y=M*B+D*S+h,this},r.assign(Q.prototype,{isMatrix3:!0,set:function(B,b,u,H,X,T,C,n,N){var j=this.el;return j[0]=B,j[1]=H,j[2]=C,j[3]=b,j[4]=X,j[5]=n,j[6]=u,j[7]=T,j[8]=N,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(k){var D=this.el,P=k.el;return D[0]=P[0],D[1]=P[1],D[2]=P[2],D[3]=P[3],D[4]=P[4],D[5]=P[5],D[6]=P[6],D[7]=P[7],D[8]=P[8],this},setFromMatrix4:function(Q){var o=Q.el;return this.set(o[0],o[4],o[8],o[1],o[5],o[9],o[2],o[6],o[10]),this},applyToBufferAttribute:function(){var A=new On;return function(F){for(var e=0,C=F.count;C>e;e++)A.x=F.getX(e),A.y=F.getY(e),A.z=F.getZ(e),A.applyMatrix3(this),F.setXYZ(e,A.x,A.y,A.z);return F}}(),multiply:function(v){return this.multiplyMatrices(this,v)},premultiply:function(l){return this.multiplyMatrices(l,this)},multiplyMatrices:function(M,H){var Q=M.el,f=H.el,A=this.el,n=Q[0],Z=Q[3],O=Q[6],G=Q[1],I=Q[4],q=Q[7],L=Q[2],c=Q[5],S=Q[8],m=f[0],d=f[3],x=f[6],t=f[1],N=f[4],R=f[7],P=f[2],T=f[5],B=f[8];return A[0]=n*m+Z*t+O*P,A[3]=n*d+Z*N+O*T,A[6]=n*x+Z*R+O*B,A[1]=G*m+I*t+q*P,A[4]=G*d+I*N+q*T,A[7]=G*x+I*R+q*B,A[2]=L*m+c*t+S*P,A[5]=L*d+c*N+S*T,A[8]=L*x+c*R+S*B,this},multiplyScalar:function(J){var k=this.el;return k[0]*=J,k[3]*=J,k[6]*=J,k[1]*=J,k[4]*=J,k[7]*=J,k[2]*=J,k[5]*=J,k[8]*=J,this},determinant:function(){var e=this.el,V=e[0],S=e[1],j=e[2],c=e[3],J=e[4],k=e[5],i=e[6],b=e[7],K=e[8];return V*J*K-V*k*b-S*c*K+S*k*i+j*c*b-j*J*i},getInverse:function(g){var q=g.el,W=this.el,n=q[0],A=q[1],N=q[2],v=q[3],k=q[4],d=q[5],b=q[6],o=q[7],U=q[8],e=U*k-d*o,s=d*b-U*v,i=o*v-k*b,u=n*e+A*s+N*i;if(0===u)return this.identity();var B=1/u;return W[0]=e*B,W[1]=(N*o-U*A)*B,W[2]=(d*A-N*k)*B,W[3]=s*B,W[4]=(U*n-N*b)*B,W[5]=(N*v-d*n)*B,W[6]=i*B,W[7]=(A*b-o*n)*B,W[8]=(k*n-A*v)*B,this},transpose:function(){var k,C=this.el;return k=C[1],C[1]=C[3],C[3]=k,k=C[2],C[2]=C[6],C[6]=k,k=C[5],C[5]=C[7],C[7]=k,this},getNormalMatrix:function(d){return this.setFromMatrix4(d).getInverse(this).transpose()},transposeIntoArray:function(r){var P=this.el;return r[0]=P[0],r[1]=P[3],r[2]=P[6],r[3]=P[1],r[4]=P[4],r[5]=P[7],r[6]=P[2],r[7]=P[5],r[8]=P[8],this},setUvTransform:function(x,$,z,T,n,b,k){var i=Math.cos(n),P=Math.sin(n);this.set(z*i,z*P,-z*(i*b+P*k)+b+x,-T*P,T*i,-T*(-P*b+i*k)+k+$,0,0,1)},scale:function(t,e){var n=this.el;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(A){var X=Math.cos(A),x=Math.sin(A),c=this.el,p=c[0],$=c[3],R=c[6],L=c[1],o=c[4],S=c[7];return c[0]=X*p+x*L,c[3]=X*$+x*o,c[6]=X*R+x*S,c[1]=-x*p+X*L,c[4]=-x*$+X*o,c[7]=-x*R+X*S,this},translate:function(u,m){var o=this.el;return o[0]+=u*o[2],o[3]+=u*o[5],o[6]+=u*o[8],o[1]+=m*o[2],o[4]+=m*o[5],o[7]+=m*o[8],this},equals:function(d){for(var J=this.el,s=d.el,H=0;9>H;H++)if(J[H]!==s[H])return!1;return!0},fromArray:function(k,Z){Z===J&&(Z=0);for(var l=0;9>l;l++)this.el[l]=k[l+Z];return this},toArray:function(x,f){x===J&&(x=[]),f===J&&(f=0);var C=this.el;return x[f]=C[0],x[f+1]=C[1],x[f+2]=C[2],x[f+3]=C[3],x[f+4]=C[4],x[f+5]=C[5],x[f+6]=C[6],x[f+7]=C[7],x[f+8]=C[8],x}});var rd=P.Math.Plane=function(u,h){this.normal=u!==J?u:new On(1,0,0),this.constant=h!==J?h:0};r.assign(rd.prototype,{set:function(z,E){return this.normal.copy(z),this.constant=E,this},setComponents:function(i,O,K,m){return this.normal.set(i,O,K),this.constant=m,this},setFromNormalAndCoplanarPoint:function(R,D){return this.normal.copy(R),this.constant=-D.dot(this.normal),this},setFromCoplanarPoints:function(){var H=new On,F=new On;return function(X,s,v){var R=H.subVectors(v,s).cross(F.subVectors(X,s)).normalize();return this.setFromNormalAndCoplanarPoint(R,X),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(R){return this.normal.copy(R.normal),this.constant=R.constant,this},normalize:function(){var X=1/this.normal.length();return this.normal.multiplyScalar(X),this.constant*=X,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(k){return this.normal.dot(k)+this.constant},distanceToSphere:function(F){return this.distanceToPoint(F.center)-F.radius},projectPoint:function(l,q){return q===J&&(q=new On),q.copy(this.normal).multiplyScalar(-this.distanceToPoint(l)).add(l)},intersectLine:function(){var U=new On;return function(x,D){D===J&&(D=new On);var l=x.delta(U),Z=this.normal.dot(l);if(0===Z)return 0===this.distanceToPoint(x.start)?D.copy(x.start):J;var $=-(x.start.dot(this.normal)+this.constant)/Z;return 0>$||$>1?J:D.copy(l).multiplyScalar($).add(x.start)}}(),intersectsLine:function(H){var P=this.distanceToPoint(H.start),B=this.distanceToPoint(H.end);return 0>P&&B>0||0>B&&P>0},intersectsBox:function(U){return U.intersectsPlane(this)},intersectsSphere:function(U){return U.intersectsPlane(this)},coplanarPoint:function(b){return b===J&&(b=new On),b.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var P=new On,y=new Q;return function(G,p){var w=p||y.getNormalMatrix(G),U=this.coplanarPoint(P).applyMatrix4(G),h=this.normal.applyMatrix3(w).normalize();return this.constant=-U.dot(h),this}}(),translate:function(d){return this.constant-=d.dot(this.normal),this},equals:function(m){return m.normal.equals(this.normal)&&m.constant===this.constant}});var Qi=P.Math.Ray=function(N,o){this.origin=N!==J?N.clone():new On,this.direction=o!==J?o.clone():new On};r.assign(Qi.prototype,{set:function(q,z){return this.origin.copy(q),this.direction.copy(z),this},clone:function(){return(new this.constructor).copy(this)},copy:function(v){return this.origin.copy(v.origin),this.direction.copy(v.direction),this.maxHitLen=v.maxHitLen,this},at:function(j,P){var M=P||new On;return M.copy(this.direction).multiplyScalar(j).add(this.origin)},setMaxHitLength:function(s){this.maxHitLen=s},lookAt:function(q){return this.direction.copy(q).sub(this.origin).normalize(),this},applyMatrix4:function(e){var D=this.maxHitLen;if(D){var J=this.direction.clone().multiplyScalar(D).add(this.origin);J.applyMatrix4(e)}return this.origin.applyMatrix4(e),this.direction.transformDirection(e),D&&(this.maxHitLen=this.origin.distanceTo(J)),this},intersectBox:function(k,W){var b,o,J,q,Q,m,Z=1/this.direction.x,X=1/this.direction.y,w=1/this.direction.z,s=this.origin;if(Z>=0?(b=(k.min.x-s.x)*Z,o=(k.max.x-s.x)*Z):(b=(k.max.x-s.x)*Z,o=(k.min.x-s.x)*Z),X>=0?(J=(k.min.y-s.y)*X,q=(k.max.y-s.y)*X):(J=(k.max.y-s.y)*X,q=(k.min.y-s.y)*X),b>q||J>o)return null;if((J>b||b!==b)&&(b=J),(o>q||o!==o)&&(o=q),w>=0?(Q=(k.min.z-s.z)*w,m=(k.max.z-s.z)*w):(Q=(k.max.z-s.z)*w,m=(k.min.z-s.z)*w),b>m||Q>o)return null;if((Q>b||b!==b)&&(b=Q),(o>m||o!==o)&&(o=m),0>o)return null;var f=b>=0?b:o,M=this.maxHitLen;return M&&f>M?null:this.at(f,W)},intersectTriangle:function(){var h=new On,q=new On,N=new On,U=new On;return function(f,F,P,n,m){q.subVectors(F,f),N.subVectors(P,f),U.crossVectors(q,N);var L,i=this.direction.dot(U);if(i>0){if(n)return null;L=1}else{if(!(0>i))return null;L=-1,i=-i}h.subVectors(this.origin,f);var y=L*this.direction.dot(N.crossVectors(h,N));if(0>y)return null;var Z=L*this.direction.dot(q.cross(h));if(0>Z||y+Z>i)return null;var b=-L*h.dot(U);if(0>b)return null;var x=b/i,w=this.maxHitLen;return w&&x>w?null:this.at(x,m)}}()});var qf=P.Math.Box3=function(W,K){this.min=W!==J?W:new On(1/0,1/0,1/0),this.max=K!==J?K:new On(-1/0,-1/0,-1/0)};r.assign(qf.prototype,{set:function(O,R){return this.min.copy(O),this.max.copy(R),this},setFromArray:function(z){for(var C=1/0,o=1/0,E=1/0,w=-1/0,r=-1/0,P=-1/0,s=0,e=z.length;e>s;s+=3){var U=z[s],y=z[s+1],g=z[s+2];C>U&&(C=U),o>y&&(o=y),E>g&&(E=g),U>w&&(w=U),y>r&&(r=y),g>P&&(P=g)}return this.min.set(C,o,E),this.max.set(w,r,P),this},setFromPoints:function(j){this.makeEmpty();for(var E=0,X=j.length;X>E;E++)this.expandByPoint(j[E]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(j){return j.max.x<this.min.x||j.min.x>this.max.x||j.max.y<this.min.y||j.min.y>this.max.y||j.max.z<this.min.z||j.min.z>this.max.z?!1:!0},copy:function(r){return this.min.copy(r.min),this.max.copy(r.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(y){return this.min.min(y),this.max.max(y),this}});var $h=P.Math.Sphere=function(R,z){this.center=R!==J?R:new On,this.radius=z!==J?z:0};r.assign($h.prototype,{set:function(T,M){return this.center.copy(T),this.radius=M,this},setFromPoints:function(){var R=new qf;return function(w,q){var c=this.center;q!==J?c.copy(q):R.setFromPoints(w).getCenter(c);for(var t=0,Q=0,e=w.length;e>Q;Q++)t=Math.max(t,c.distanceToSquared(w[Q]));return this.radius=Math.sqrt(t),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(I){return this.center.copy(I.center),this.radius=I.radius,this},empty:function(){return this.radius<=0},containsPoint:function(o){return o.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(I){return I.distanceTo(this.center)-this.radius},intersectsSphere:function(z){var k=this.radius+z.radius;return z.center.distanceToSquared(this.center)<=k*k},intersectsBox:function(q){return q.intersectsSphere(this)},intersectsPlane:function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius},clampPoint:function(f,b){var w=this.center.distanceToSquared(f);return b===J&&(b=new On),b.copy(f),w>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b},getBoundingBox:function(T){return T===J&&(T=new qf),T.set(this.center,this.center),T.expandByScalar(this.radius),T},applyMatrix4:function(c){return this.center.applyMatrix4(c),this.radius=this.radius*c.getMaxScaleOnAxis(),this},translate:function(l){return this.center.add(l),this},equals:function(K){return K.center.equals(this.center)&&K.radius===this.radius}});var Ad=P.Math.Frustum=function(i,j,W,D,_,L){this.planes=[i!==J?i:new rd,j!==J?j:new rd,W!==J?W:new rd,D!==J?D:new rd,_!==J?_:new rd,L!==J?L:new rd]};r.assign(Ad.prototype,{set:function(P,W,R,n,r,k){var Q=this.planes;return Q[0].copy(P),Q[1].copy(W),Q[2].copy(R),Q[3].copy(n),Q[4].copy(r),Q[5].copy(k),this},clone:function(){return(new this.constructor).copy(this)},copy:function(Z){for(var $=this.planes,Q=0;6>Q;Q++)$[Q].copy(Z.planes[Q]);return this},setFromMatrix:function(R){var Z=this.planes,U=R.el,l=U[0],m=U[1],D=U[2],e=U[3],M=U[4],L=U[5],c=U[6],G=U[7],S=U[8],a=U[9],p=U[10],o=U[11],q=U[12],P=U[13],d=U[14],X=U[15];return Z[0].setComponents(e-l,G-M,o-S,X-q).normalize(),Z[1].setComponents(e+l,G+M,o+S,X+q).normalize(),Z[2].setComponents(e+m,G+L,o+a,X+P).normalize(),Z[3].setComponents(e-m,G-L,o-a,X-P).normalize(),Z[4].setComponents(e-D,G-c,o-p,X-d).normalize(),Z[5].setComponents(e+D,G+c,o+p,X+d).normalize(),this},intersectsObject:function(){var V=new $h;return function(E){var Q=E.geometry;return null===Q.boundingSphere&&Q.computeBoundingSphere(),V.copy(Q.boundingSphere).applyMatrix4(E.matrixWorld),this.intersectsSphere(V)}}(),intersectsSprite:function(){var i=new $h;return function(g){return i.center.set(0,0,0),i.radius=.7071067811865476,i.applyMatrix4(g.matrixWorld),this.intersectsSphere(i)}}(),intersectsSphere:function(n){for(var y=this.planes,E=n.center,H=-n.radius,G=0;6>G;G++){var j=y[G].distanceToPoint(E);if(H>j)return!1}return!0},intersectsBox:function(){var C=new On;return function(A){for(var J=this.planes,W=0;6>W;W++){var u=J[W];if(C.x=u.normal.x>0?A.max.x:A.min.x,C.y=u.normal.y>0?A.max.y:A.min.y,C.z=u.normal.z>0?A.max.z:A.min.z,u.distanceToPoint(C)<0)return!1}return!0}}(),containsPoint:function(h){for(var C=this.planes,f=0;6>f;f++)if(C[f].distanceToPoint(h)<0)return!1;return!0}});var vk=P.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};r.assign(vk.prototype,{set:function(L,G,X,k,t,E,w,O,y,p,Z,a,T,o,I,H){var _=this.el;return _[0]=L,_[4]=G,_[8]=X,_[12]=k,_[1]=t,_[5]=E,_[9]=w,_[13]=O,_[2]=y,_[6]=p,_[10]=Z,_[14]=a,_[3]=T,_[7]=o,_[11]=I,_[15]=H,this},clone:function(){return(new vk).fromArray(this.el)},fromArray:function(n,d){d===J&&(d=0);for(var I=this.el,m=0;16>m;m++)I[m]=n[m+d];return this},scale:function(U){var l=this.el,h=U.x,Y=U.y,B=U.z;return l[0]*=h,l[4]*=Y,l[8]*=B,l[1]*=h,l[5]*=Y,l[9]*=B,l[2]*=h,l[6]*=Y,l[10]*=B,l[3]*=h,l[7]*=Y,l[11]*=B,this},makeRotationFromEuler:function(h){var Q=this.el,o=h._x,$=h._y,j=h._z,K=h._order,T=Math.cos(o),S=Math.sin(o),n=Math.cos($),B=Math.sin($),m=Math.cos(j),_=Math.sin(j);if("XYZ"===K){var g=T*m,x=T*_,U=S*m,Y=S*_;Q[0]=n*m,Q[4]=-n*_,Q[8]=B,Q[1]=x+U*B,Q[5]=g-Y*B,Q[9]=-S*n,Q[2]=Y-g*B,Q[6]=U+x*B,Q[10]=T*n}else if("YXZ"===K){var D=n*m,G=n*_,P=B*m,s=B*_;Q[0]=D+s*S,Q[4]=P*S-G,Q[8]=T*B,Q[1]=T*_,Q[5]=T*m,Q[9]=-S,Q[2]=G*S-P,Q[6]=s+D*S,Q[10]=T*n}else if("ZXY"===K){var D=n*m,G=n*_,P=B*m,s=B*_;Q[0]=D-s*S,Q[4]=-T*_,Q[8]=P+G*S,Q[1]=G+P*S,Q[5]=T*m,Q[9]=s-D*S,Q[2]=-T*B,Q[6]=S,Q[10]=T*n}else if("ZYX"===K){var g=T*m,x=T*_,U=S*m,Y=S*_;Q[0]=n*m,Q[4]=U*B-x,Q[8]=g*B+Y,Q[1]=n*_,Q[5]=Y*B+g,Q[9]=x*B-U,Q[2]=-B,Q[6]=S*n,Q[10]=T*n}else if("YZX"===K){var a=T*n,b=T*B,V=S*n,L=S*B;Q[0]=n*m,Q[4]=L-a*_,Q[8]=V*_+b,Q[1]=_,Q[5]=T*m,Q[9]=-S*m,Q[2]=-B*m,Q[6]=b*_+V,Q[10]=a-L*_}else if("XZY"===K){var a=T*n,b=T*B,V=S*n,L=S*B;Q[0]=n*m,Q[4]=-_,Q[8]=B*m,Q[1]=a*_+L,Q[5]=T*m,Q[9]=b*_-V,Q[2]=V*_-b,Q[6]=S*m,Q[10]=L*_+a}return Q[3]=0,Q[7]=0,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,this},makeRotationFromQuaternion:function(A){var p=this.el,J=A._x,L=A._y,O=A._z,b=A._w,t=J+J,H=L+L,q=O+O,X=J*t,j=J*H,D=J*q,I=L*H,i=L*q,U=O*q,Z=b*t,x=b*H,$=b*q;return p[0]=1-(I+U),p[4]=j-$,p[8]=D+x,p[1]=j+$,p[5]=1-(X+U),p[9]=i-Z,p[2]=D-x,p[6]=i+Z,p[10]=1-(X+I),p[3]=0,p[7]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(q){var y=this.el,$=q.el,P=$[0],m=$[1],K=$[2],F=$[3],Y=$[4],N=$[5],C=$[6],b=$[7],E=$[8],h=$[9],x=$[10],f=$[11],k=$[12],w=$[13],n=$[14],O=$[15],T=h*n*b-w*x*b+w*C*f-N*n*f-h*C*O+N*x*O,i=k*x*b-E*n*b-k*C*f+Y*n*f+E*C*O-Y*x*O,L=E*w*b-k*h*b+k*N*f-Y*w*f-E*N*O+Y*h*O,e=k*h*C-E*w*C-k*N*x+Y*w*x+E*N*n-Y*h*n,B=P*T+m*i+K*L+F*e;if(0===B)return this.identity();var D=1/B;return y[0]=T*D,y[1]=(w*x*F-h*n*F-w*K*f+m*n*f+h*K*O-m*x*O)*D,y[2]=(N*n*F-w*C*F+w*K*b-m*n*b-N*K*O+m*C*O)*D,y[3]=(h*C*F-N*x*F-h*K*b+m*x*b+N*K*f-m*C*f)*D,y[4]=i*D,y[5]=(E*n*F-k*x*F+k*K*f-P*n*f-E*K*O+P*x*O)*D,y[6]=(k*C*F-Y*n*F-k*K*b+P*n*b+Y*K*O-P*C*O)*D,y[7]=(Y*x*F-E*C*F+E*K*b-P*x*b-Y*K*f+P*C*f)*D,y[8]=L*D,y[9]=(k*h*F-E*w*F-k*m*f+P*w*f+E*m*O-P*h*O)*D,y[10]=(Y*w*F-k*N*F+k*m*b-P*w*b-Y*m*O+P*N*O)*D,y[11]=(E*N*F-Y*h*F-E*m*b+P*h*b+Y*m*f-P*N*f)*D,y[12]=e*D,y[13]=(E*w*K-k*h*K+k*m*x-P*w*x-E*m*n+P*h*n)*D,y[14]=(k*N*K-Y*w*K-k*m*C+P*w*C+Y*m*n-P*N*n)*D,y[15]=(Y*h*K-E*N*K+E*m*C-P*h*C-Y*m*x+P*N*x)*D,this},makeRotationAxis:function(I,j){var Y=Math.cos(j),l=Math.sin(j),W=1-Y,J=I.x,a=I.y,c=I.z,k=W*J,q=W*a;return this.set(k*J+Y,k*a-l*c,k*c+l*a,0,k*a+l*c,q*a+Y,q*c-l*J,0,k*c-l*a,q*c+l*J,W*c*c+Y,0,0,0,0,1),this},multiply:function(N){return this.multiplyMatrices(this,N)},premultiply:function(d){return this.multiplyMatrices(d,this)},multiplyMatrices:function(T,G){var Q=T.el,f=G.el,b=this.el,F=Q[0],h=Q[4],V=Q[8],s=Q[12],g=Q[1],z=Q[5],l=Q[9],X=Q[13],E=Q[2],J=Q[6],x=Q[10],v=Q[14],I=Q[3],M=Q[7],r=Q[11],D=Q[15],p=f[0],P=f[4],c=f[8],C=f[12],o=f[1],Z=f[5],_=f[9],q=f[13],i=f[2],R=f[6],t=f[10],n=f[14],j=f[3],w=f[7],y=f[11],S=f[15];return b[0]=F*p+h*o+V*i+s*j,b[4]=F*P+h*Z+V*R+s*w,b[8]=F*c+h*_+V*t+s*y,b[12]=F*C+h*q+V*n+s*S,b[1]=g*p+z*o+l*i+X*j,b[5]=g*P+z*Z+l*R+X*w,b[9]=g*c+z*_+l*t+X*y,b[13]=g*C+z*q+l*n+X*S,b[2]=E*p+J*o+x*i+v*j,b[6]=E*P+J*Z+x*R+v*w,b[10]=E*c+J*_+x*t+v*y,b[14]=E*C+J*q+x*n+v*S,b[3]=I*p+M*o+r*i+D*j,b[7]=I*P+M*Z+r*R+D*w,b[11]=I*c+M*_+r*t+D*y,b[15]=I*C+M*q+r*n+D*S,this},lookAt:function(){var $=new On,q=new On,n=new On;return function(T,M,l){var U=this.el;return n.subVectors(T,M),0===n.lengthSq()&&(n.z=1),n.normalize(),$.crossVectors(l,n),0===$.lengthSq()&&(1===Math.abs(l.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),$.crossVectors(l,n)),$.normalize(),q.crossVectors(n,$),U[0]=$.x,U[4]=q.x,U[8]=n.x,U[1]=$.y,U[5]=q.y,U[9]=n.y,U[2]=$.z,U[6]=q.z,U[10]=n.z,this}}(),extractScale:function(){var g;return function(K){g===J&&(g=new On),K===J&&(K=new On);var F=g.setFromMatrixColumn(this,0).length(),$=g.setFromMatrixColumn(this,1).length(),v=g.setFromMatrixColumn(this,2).length();return K.set(F,$,v),K}}(),extractRotation:function(){var l;return function(c){l===J&&(l=new On),c===J&&(c=new vk);var u=this.el,x=c.el,H=1/l.setFromMatrixColumn(c,0).length(),y=1/l.setFromMatrixColumn(c,1).length(),m=1/l.setFromMatrixColumn(c,2).length();return u[0]=x[0]*H,u[1]=x[1]*H,u[2]=x[2]*H,u[4]=x[4]*y,u[5]=x[5]*y,u[6]=x[6]*y,u[8]=x[8]*m,u[9]=x[9]*m,u[10]=x[10]*m,this}}(),multiplyScalar:function(H){var j=this.el;return j[0]*=H,j[4]*=H,j[8]*=H,j[12]*=H,j[1]*=H,j[5]*=H,j[9]*=H,j[13]*=H,j[2]*=H,j[6]*=H,j[10]*=H,j[14]*=H,j[3]*=H,j[7]*=H,j[11]*=H,j[15]*=H,this},getPosition:function($){return $===J&&($=new On),$.setFromMatrixColumn(this,3)},setPosition:function(E){var P=this.el;return P[12]=E.x,P[13]=E.y,P[14]=E.z,this},toArray:function(C,K){C===J&&(C=[]),K===J&&(K=0);var a=this.el;return C[K]=a[0],C[K+1]=a[1],C[K+2]=a[2],C[K+3]=a[3],C[K+4]=a[4],C[K+5]=a[5],C[K+6]=a[6],C[K+7]=a[7],C[K+8]=a[8],C[K+9]=a[9],C[K+10]=a[10],C[K+11]=a[11],C[K+12]=a[12],C[K+13]=a[13],C[K+14]=a[14],C[K+15]=a[15],C}});var Nn=P.Math.Triangle=function(_,E,V){this.a=_!==J?_:new On,this.b=E!==J?E:new On,this.c=V!==J?V:new On};r.assign(Nn,{barycoordFromPoint:function(){var h=new On,m=new On,w=new On;return function(H,o,D,t,g){h.subVectors(t,o),m.subVectors(D,o),w.subVectors(H,o);var B=h.dot(h),C=h.dot(m),$=h.dot(w),Z=m.dot(m),F=m.dot(w),K=B*Z-C*C,s=g||new On;if(0===K)return s.set(-2,-1,-1);var I=1/K,e=(Z*$-C*F)*I,k=(B*F-C*$)*I;return s.set(1-e-k,k,e)}}()});var Ak=P.Math.Euler=function(c,g,x,X,S){this.set(c,g,x,X,S)};Ak.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Ak.DefaultOrder="XYZ",Ak.ReverseOrder=function(w){return w=w[2]+w[1]+w[0],w.toUpperCase()},r.defineProperties(Ak.prototype,{x:{get:function(){return this._x},set:function(p){this._x=p,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(p){this._y=p,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(k){this._z=k,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),r.assign(Ak.prototype,{set:function(g,e,t,h,W){return mo(g)&&(W=t,h=e,t=g[2],e=g[1],g=g[0]),h?W&&(h=Ak.ReverseOrder(h)):h="ZYX",this._x=g||0,this._y=e||0,this._z=t||0,this._order=h||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(K){return this._x=K._x,this._y=K._y,this._z=K._z,this._order=K._order,this.onChangeCallback(),this},setFromRotationMatrix:function(H,E,F){var B=P.Math.clamp,w=H.el||H,v=w[0],C=w[4],t=w[8],S=w[1],m=w[5],Z=w[9],p=w[2],j=w[6],K=w[10];return E=E||this._order,"XYZ"===E?(this._y=Math.asin(B(t,-1,1)),Math.abs(t)<.99999?(this._x=Math.atan2(-Z,K),this._z=Math.atan2(-C,v)):(this._x=Math.atan2(j,m),this._z=0)):"YXZ"===E?(this._x=Math.asin(-B(Z,-1,1)),Math.abs(Z)<.99999?(this._y=Math.atan2(t,K),this._z=Math.atan2(S,m)):(this._y=Math.atan2(-p,v),this._z=0)):"ZXY"===E?(this._x=Math.asin(B(j,-1,1)),Math.abs(j)<.99999?(this._y=Math.atan2(-p,K),this._z=Math.atan2(-C,m)):(this._y=0,this._z=Math.atan2(S,v))):"ZYX"===E?(this._y=Math.asin(-B(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(j,K),this._z=Math.atan2(S,v)):(this._x=0,this._z=Math.atan2(-C,m))):"YZX"===E?(this._z=Math.asin(B(S,-1,1)),Math.abs(S)<.99999?(this._x=Math.atan2(-Z,m),this._y=Math.atan2(-p,v)):(this._x=0,this._y=Math.atan2(t,K))):"XZY"===E?(this._z=Math.asin(-B(C,-1,1)),Math.abs(C)<.99999?(this._x=Math.atan2(j,m),this._y=Math.atan2(t,v)):(this._x=Math.atan2(-Z,K),this._y=0)):console.warn("unsupported order: "+E),this._order=E,F!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var M=new vk;return function(K,b,q){return M.makeRotationFromQuaternion(K),this.setFromRotationMatrix(M,b,q)}}(),setFromVector3:function(j,u){return this.set(j.x,j.y,j.z,u||this._order)},reorder:function(){var d=new bg;return function(j){return d.setFromEuler(this),this.setFromQuaternion(d,j)}}(),equals:function(F){return F._x===this._x&&F._y===this._y&&F._z===this._z&&F._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==J&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(G,Y){return G===J&&(G=[]),Y===J&&(Y=0),G[Y]=this._x,G[Y+1]=this._y,G[Y+2]=this._z,G[Y+3]=this._order,G
},toVector3:function(i){return i?i.set(this._x,this._y,this._z):new On(this._x,this._y,this._z)},onChange:function(h){return this.onChangeCallback=h,this},onChangeCallback:function(){}});var nm=P.List=function(){this._as=[];var X,f,t=arguments.length;if(1===t){var r=arguments[0];if(mc(r)&&(r=r._as),mo(r))for(f=r.length,X=0;f>X;X++)this._as.push(r[X]);else r!=d&&this._as.push(r)}else if(t>1)for(X=0;t>X;X++)this._as.push(arguments[X])};as("List",r,{forEach:function(m,x){this.each(m,x)},push:function(){for(var T=0;T<arguments.length;T++)this.add(arguments[T])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(O,m){return m===J?this._as.push(O):this._as.splice(m,0,O)},addAll:function(z){mc(z)&&(z=z._as),mo(z)?qp(this._as,z):this._as.push(z)},get:function(Q){return this._as[Q]},slice:function(C,S){return new nm(this._as.slice(C,S))},remove:function(q){var L=this._as.indexOf(q);return L>=0&&L<this._as.length&&this.removeAt(L),L},removeAt:function(e){return this._as.splice(e,1)[0]},set:function(R,v){return this._as[R]=v},clear:function(){return this._as.splice(0,this._as.length)},contains:function(B){return this._as.indexOf(B)>=0},indexOf:function(_){return this._as.indexOf(_)},each:function(O,y){for(var t=0,l=this._as.length;l>t;t++){var G=this._as[t];y?O.call(y,G,t,this):O(G,t,this)}},reverseEach:function(k,c){for(var L=this._as.length-1;L>=0;L--){var X=this._as[L];c?k.call(c,X):k(X)}},getArray:function(){return this._as},toArray:function(O,w){if(O){for(var G,H=[],N=0,C=this._as.length;C>N;N++)G=this._as[N],w?O.call(w,G)&&H.push(G):O(G)&&H.push(G);return H}return this._as.concat()},toList:function(s,m){if(s){for(var i,k=new nm,l=0,F=this._as.length;F>l;l++)i=this._as[l],m?s.call(m,i)&&k.add(i):s(i)&&k.add(i);return k}return new nm(this)},reverse:function(){this._as.reverse()},sort:function(a){return this._as.sort(a?a:kb),this},toString:function(){return this._as.toString()}}),r.defineProperties(nm.prototype,{length:{get:function(){return this._as.length},set:function(f){this._as.length=f}}});var pr=new nm;im(pr,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Nk,each:Nk,reverseEach:Nk,toArray:function(){return[]},toList:function(){return new nm},add:sb,addAll:sb,set:sb,remove:sb,removeAt:sb,clear:sb});var Mj=P.Notifier=function(){this._f=0};as("Notifier",r,{contains:function($,H){if(this._ls)for(var W,L=0,U=this._ls.size();U>L;L++)if(W=this._ls.get(L),$===W.l&&H===W.s)return!0;return!1},add:function(i,N,o){var S=this,w={l:i,s:N,a:o};S._ls||(S._ls=new nm),S._f?(S._as||(S._as=new nm),S._as.add(w)):w.a?S._ls.add(w,0):S._ls.add(w)},remove:function(e,z){var Q=this;Q._ls&&(Q._f?(Q._rs||(Q._rs=new nm),Q._rs.add({l:e,s:z})):Q._remove(e,z))},_remove:function(x,l){for(var G,B=this._ls,L=0,F=B.size();F>L;L++)if(G=B.get(L),G.l===x&&G.s===l)return B.removeAt(L),void 0},fire:function(y){var N=this,c=N._ls;if(N._b=1e4,c){++N._f;try{for(var q,W=0,G=c.size();G>W;W++)q=c.get(W),q.s?q.l.call(q.s,y):q.l(y)}catch(y){_(function(){throw y})}finally{if(--N._f)return;if(N._rs){for(G=N._rs.size(),W=0;G>W;W++)q=N._rs.get(W),N._remove(q.l,q.s);delete N._rs}if(N._as){for(G=N._as.size(),W=0;G>W;W++)q=N._as.get(W),q.a?c.add(q,0):c.add(q);delete N._as}}}}});var Oc=P.Data=function(){this._id=Wm()};as("Data",r,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:d,_parent:d,_children:pr,_childMap:d,_styleMap:d,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return d},_22Q:function(){return d},s:function(u,$){var H=this;if(2===arguments.length)H.setStyle(u,$);else{if(!yl(u))return H.getStyle(u);for(var K in u)H.setStyle(K,u[K])}return H},fp:function(a,N,F,P,w){return this.firePropertyChange(a,N,F,P,w)},firePropertyChange:function(y,O,G,Y,n){if(Y){if(Y(O,G))return!1}else if(O===G)return!1;var t=this,m=n||{};return m.property=y,m.oldValue=O,m.newValue=G,m.data=t,t._dataModel&&t._dataModel.handleDataPropertyChange(m),t.onPropertyChanged(m),!0},onPropertyChanged:function(c){var X=this,G=X._parent,s=c.property;if(Cb(G)){var U=X.s(Bg),z="s:ingroup"===s;(U&&ps[s]||s===z)&&G._81I(),(U||z)&&G.fp("childChange",!0,!1)}xc(G)&&ps[s]&&G.updateFromChildren()},_21I:function(B){var L=this;if(B&&L._dataModel)throw"Remove data from dataModel before adding";L._dataModel=B},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var E=0,t=this._children.toArray(),J=t.length;J>E;E++)t[E].removeFromDataModel()},getId:function(){return this._id},setId:function(S){this._id=S},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(I,f){return this._children.toList(I,f)},eachChild:function(g,x){this._children.each(g,x)},addChild:function(x,E){var p=this;x!==p&&(p._children===pr&&(p._children=new nm,p._childMap={}),E>=0||(E=p._children.size()),p._childMap[x._id]||p.isDescendantOf(x)||(x._parent&&x._parent.removeChild(x),(0>E||E>p._children.size())&&(E=p._children.size()),p._children.add(x,E),p._childMap[x._id]=x,x.setParent(p),p.onChildAdded(x,E),p.fp(Gm,d,x)))},onChildAdded:function(){},removeChild:function(z){var u=this;if(u._childMap&&u._childMap[z._id]){var f=u._children.remove(z);delete u._childMap[z._id],u.fp(Gm,z,d),z.setParent(d,f),u.onChildRemoved(z,f)}},onChildRemoved:function(){},getChildAt:function(l){return this._children.get(l)},clearChildren:function(){var X=this;if(!X._children.isEmpty())for(var N=0,D=X._children.toArray(),V=D.length;V>N;N++)X.removeChild(D[N])},getParent:function(){return this._parent},setParent:function(g,G){var y=this;if(!(y._73I||y._parent===g||y===g||g&&g.isDescendantOf(y))){var A,W=y._parent;y._parent=g,y._73I=1,W?(G==d&&(G=W.getChildren().indexOf(y)),W.removeChild(y)):y._dataModel&&G==d&&(G=y._dataModel.getRoots().indexOf(y)),g&&(g.addChild(y),A=g.getChildren().indexOf(y)),delete y._73I,y.fp("parent",W,g,J,{oldIndex:G,newIndex:A}),y.onParentChanged(W,g)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(g){return g?this.isDescendantOf(g)||g.isDescendantOf(this):!1},isParentOf:function(c){return c&&this._childMap?!!this._childMap[c._id]:!1},isDescendantOf:function(X){if(!X||X.isEmpty())return!1;for(var v=this._parent;v;){if(X===v)return!0;v=v._parent}return!1},getStyle:function(Y,t){t===J&&(t=1);var A=this._styleMap?this._styleMap[Y]:J;return A===J&&t?S[Y]:A},setStyle:function(X,D){var e=this;e._styleMap||(e._styleMap={});var A=e._styleMap[X];D===J?delete e._styleMap[X]:e._styleMap[X]=D,e.fp("s:"+X,A,D)&&e.onStyleChanged(X,A,D)},onStyleChanged:function(){},iv:function(P){this.invalidate(P)},invalidate:function(P){this.fp(P||"*",!1,!0)},toString:function(){var H=this;return H._displayName||H._name||H._tag||H._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(j,A){var e=this,g=e.s(zo);g||e.s(zo,g={}),A?g[j]=A:delete g[j],e.fp(zo,d,g)},removeStyleIcon:function(g){var t=this.s(zo);if(t){var D=t[g];delete t[g],this.fp(zo,d,t)}return D},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var e,Y={};for(e in this._styleMap)Y[e]=1;return Y},ca:function(N,f){return N=gf+N,2===arguments.length?this.a(N,f):this.a(N)}});var ac=P.DataModel=function(){var j=this;j._datas=new nm,j._dataMap={},j._roots=new nm,j._rootMap={},j._fsDataMap={},j._78O={},j._36I=new Mj,j._35I=new Mj,j._serializeNotifier=new Mj,j._selectionModel=new Lh(j);var M=j._29Q=[],K=j._scheduleCallback=function(){for(var _=Date.now(),m=0;m<M.length;m++){var $=M[m];$.enabled&&_-$.lastTime>$.interval&&($.beforeAction&&$.beforeAction(),j.each(function(G){$.action(G)}),$.afterAction&&$.afterAction(),$.lastTime=_)}M.length&&(j._30Q=H.requestAnimationFrame(K))}};as("DataModel",r,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:J,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:J,_init:J,_envmap:J,_postProcessingData:J,sm:function(){return this.getSelectionModel()},mm:function(P,t,g){this.addDataModelChangeListener(P,t,g)},umm:function(A,B){this.removeDataModelChangeListener(A,B)},md:function(v,J,W){this.addDataPropertyChangeListener(v,J,W)},umd:function(t,U){this.removeDataPropertyChangeListener(t,U)},mh:function(s,R,n){this.addHierarchyChangeListener(s,R,n)},umh:function(r,x){this.removeHierarchyChangeListener(r,x)},getAttrObject:function(){return this._attrObject},setAttrObject:function(Q){return this._attrObject=Q},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(J){return this._dataMap[J]},removeDataById:function(J){this.remove(this.getDataById(J))},toDatas:function($,z){return this._datas.toList($,z)},each:function(W,g){this._datas.each(W,g)},getDataByTag:function(T){return this._78O[T]},getTagMap:function(){return this._78O},removeDataByTag:function(Z){this.remove(this.getDataByTag(Z))},add:function(s,I,G){var f=this,t=s._id,T=s._tag,h=f._roots;if(f._dataMap[t])throw"'"+t+"' already exists";T!=d&&(f._78O[T]=s),f._dataMap[t]=s,G>=0?f._datas.add(s,G):f._datas.add(s),s._parent||(f._rootMap[t]=s,I>=0?h.add(s,I):h.add(s)),s.s("fullscreen")!==J&&(f._fsDataMap[t]=s),s._21I(f),f.onAdded(s),f._36I.fire({kind:"add",data:s,rootsIndex:I,datasIndex:G})},onAdded:function(){},remove:function(S,B){if(S){var C=this,A=S._id,v=B&&B.keepStructure,b=B&&B.keepChildren,u=S.getTag();if(S._dataModel===C){this.beginTransaction(),v?C._removingData||(C._removingData=S):C.prepareRemove(S),b||S.toChildren().each(function(i){C.remove(i,B)},C),v?C._removingData===S&&(S._parent&&S._parent.removeChild(S),delete C._removingData):S._parent&&S._parent.removeChild(S);var y=C._datas.remove(S);delete C._dataMap[A],u!=d&&delete C._78O[u];var R;C._rootMap[A]&&(delete C._rootMap[A],R=C._roots.remove(S)),C._fsDataMap[A]&&delete C._fsDataMap[A],S._21I(d),C.onRemoved(S),C._36I.fire({kind:hb,data:S,rootsIndex:R,datasIndex:y}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var f=this;if(f._datas.size()){var D=f._historyManager?this.toJSON():J;f._datas.toArray().forEach(function(R){R._21I(d)}),f._datas.clear(),f._dataMap={},f._roots.clear(),f._rootMap={},f._fsDataMap={},f._78O={},f._36I.fire({kind:Ng,json:D})}},contains:function(C){return C&&C._dataModel===this},handleDataPropertyChange:function(s){var x=this,T=s.data,q=s.property;if("parent"===q){var J=T._id,n=x._rootMap,o=x._roots;T._parent?n[J]&&(delete n[J],o.remove(T)):n[J]||(n[J]=T,o.add(T))}else if("tag"===q){var w=s.oldValue,E=s.newValue,f=x._78O;w!=d&&delete f[w],E!=d&&(f[E]=T)}else if("s:fullscreen"===q){var J=T._id,z=x._fsDataMap;s.oldValue!=d&&delete z[J],s.newValue!=d&&(z[J]=T)}this.onDataPropertyChanged(T,s),this._35I.fire(s)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(F,O,n){this._36I.add(F,O,n)},removeDataModelChangeListener:function(V,r){this._36I.remove(V,r)},addSerializeListener:function(l,O,x){this._serializeNotifier.add(l,O,x)},removeSerializeListener:function(h,i){this._serializeNotifier.remove(h,i)},fireSerializeEvent:function(q){this._serializeNotifier.fire(q)},addDataPropertyChangeListener:function(x,M,F){this._35I.add(x,M,F)},removeDataPropertyChangeListener:function(W,$){this._35I.remove(W,$)},_38I:function(Y,B,P){this._37I&&this._37I.fire({data:Y,oldIndex:B,newIndex:P})},addHierarchyChangeListener:function(t,D,q){this._37I||(this._37I=new Mj),this._37I.add(t,D,q)},removeHierarchyChangeListener:function(T,v){this._37I.remove(T,v)},getSiblings:function(g){var r=g._parent;return r?r._children:this._roots},eachByHierarchical:function(M,O,K){if(O)return this._eachByHierarchical(M,O,K);for(var h=0,Q=this._roots,W=Q.size();W>h;h++)if(this._eachByHierarchical(M,Q.get(h),K)===!1)return!1;return!0},_eachByHierarchical:function(i,U,m){if(m){if(i.call(m,U)===!1)return!1}else if(i(U)===!1)return!1;for(var N=U.size(),X=0;N>X;X++)if(this._eachByHierarchical(i,U.getChildAt(X),m)===!1)return!1;return!0},reverseEachByHierarchical:function(_,P,Y){if(P)return this._reverseEachByHierarchical(_,P,Y);for(var g=this._roots,M=g.size(),o=M-1;o>=0;o--)if(this._reverseEachByHierarchical(_,g.get(o),Y)===!1)return!1;return!0},_reverseEachByHierarchical:function(z,s,C){for(var A=s.size(),q=A-1;q>=0;q--)if(this._reverseEachByHierarchical(z,s.getChildAt(q),C)===!1)return!1;if(C){if(z.call(C,s)===!1)return!1}else if(z(s)===!1)return!1;return!0},eachByDepthFirst:function(t,L,f){if(L)return this._11I(t,L,f);for(var q=0,N=this._roots,R=N.size();R>q;q++)if(this._11I(t,N.get(q),f)===!1)return!1;return!0},_11I:function(q,a,W){for(var c=a.size(),u=0;c>u;u++)if(this._11I(q,a.getChildAt(u),W)===!1)return!1;if(W){if(q.call(W,a)===!1)return!1}else if(q(a)===!1)return!1;return!0},eachByBreadthFirst:function(C,_,y){var r=new nm;for(_?r.add(_):this._roots.each(r.add,r);r.size()>0;)if(_=r.removeAt(0),_.eachChild(r.add,r),y){if(C.call(y,_)===!1)return!1}else if(C(_)===!1)return!1;return!0},moveTo:function(q,U){var g=this.getSiblings(q),I=g.indexOf(q);I===U||0>I||U>=0&&U<=g.size()&&(g.remove(q),U>g.size()&&U--,g.add(q,U),this._38I(q,I,U))},moveUp:function(X){this.moveTo(X,this.getSiblings(X).indexOf(X)-1)},moveDown:function(v){this.moveTo(v,this.getSiblings(v).indexOf(v)+1)},moveToTop:function(H){this.moveTo(H,0)},moveToBottom:function(L){this.moveTo(L,this.getSiblings(L).size())},moveSelectionUp:function(f){this.beginTransaction(),f||(f=this.sm());var Y=new nm;zk(f,Y,this._roots),Y.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(t){this.beginTransaction(),t||(t=this.sm());var E=new nm;Om(t,E,this._roots),E.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(B){this.beginTransaction(),B||(B=this.sm());var X=new nm;hj(B,X,this._roots),X.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(s){this.beginTransaction(),s||(s=this.sm());var v=new nm;dk(s,v,this._roots),v.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(f,c,S){var M=this.getDatas();null==S&&(S=M.indexOf(f)),S===c||0>S||c>=0&&c<=M.size()&&(M.remove(f),c>M.size()&&c--,M.add(f,c),this._76I(f,S,c))},bringForward:function(f){this.moveToIndex(f,this.getDatas().indexOf(f)+1)},bringToFront:function(s){this.moveToIndex(s,this.size())},sendBackward:function(A){this.moveToIndex(A,this.getDatas().indexOf(A)-1)},sendToBack:function(y){this.moveToIndex(y,0)},bringSelectionForward:function(G){this.beginTransaction(),G||(G=this.sm());for(var l=new nm,e=this.getDatas(),c=!1,b=0;b<e.size();b++){var x=e.get(e.size()-1-b);G.contains(x)?c&&l.add(x):c=!0}l.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(l){this.beginTransaction(),l||(l=this.sm());for(var Q=new nm,F=this.getDatas(),O=0;O<F.size();O++){var n=F.get(O);l.contains(n)&&Q.add(n)}Q.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(n){this.beginTransaction(),n||(n=this.sm());for(var t=new nm,b=this.getDatas(),Q=!1,k=0;k<b.size();k++){var c=b.get(k);n.contains(c)?Q&&t.add(c):Q=!0}t.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(X){this.beginTransaction(),X||(X=this.sm());for(var i=new nm,K=this.getDatas(),h=0;h<K.size();h++){var c=K.get(K.size()-1-h);X.contains(c)&&i.add(c)}i.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(q){var I=this;I.removeScheduleTask(q),q.enabled==d&&(q.enabled=!0),q.interval==d&&(q.interval=10),q.action==d&&(q.action=Nk),q.lastTime=Date.now(),I._29Q.push(q),I._30Q==d&&(I._30Q=H.requestAnimationFrame(I._scheduleCallback))},removeScheduleTask:function(I){var S=this,g=S._29Q,$=g.indexOf(I);$>=0&&g.splice($,1),g.length||S._30Q==d||(H.cancelAnimationFrame(S._30Q),delete S._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(B){this._historyManager||new P.HistoryManager(this),null!=B&&this._historyManager.setMaxHistoryCount(B),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(q){this._historyManager&&this._historyManager.undo(q)},redo:function(c){this._historyManager&&this._historyManager.redo(c)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(L){this._historyManager&&this._historyManager.addHistory(L)},onHistoryManagerChanged:function(){}});var Lh=P.SelectionModel=function(A){var p=this;p._68O=Pk,p._map={},p._73O=new nm,p._74I=new Mj,p._21I(A)};as("SelectionModel",r,{ms_fire:1,ms_dm:1,ms:function(W,X,y){this.addSelectionChangeListener(W,X,y)},ums:function(q,o){this.removeSelectionChangeListener(q,o)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===gq},co:function(F){return this._map[F._id]!=d},ss:function(p){this.setSelection(p)},as:function(k){this.appendSelection(k)},rs:function(n){this.removeSelection(n)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(x){var R=this;if(R._68O!==x&&(x===xj||x===gq||x===Pk)){R.cs();var J=R._68O;R._68O=x,R.fp("selectionMode",J,x)}},_21I:function(g){var h=this,f=h._dataModel;f!==g&&(f&&(h.cs(),f.umm(h.handleDataModelChange,h)),h._dataModel=g,g.mm(h.handleDataModelChange,h,!0),h.fp(Lr,f,g))},dispose:function(){var z=this;z.cs(),z._dataModel.umm(z.handleDataModelChange,z)},handleDataModelChange:function(x){var j=this;if(x.kind===hb){var F=x.data;j.co(F)&&(j._73O.remove(F),delete j._map[F._id],j._75I(hb,new nm(F)))}else x.kind===Ng&&j.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(w){var S=this;if(S._filterFunc!==w){S.cs();var T=S._filterFunc;S._filterFunc=w,S.fp("filterFunc",T,S._filterFunc)}},_75I:function(e,t,J,m){J&&(this._73O.each(function(T){m[T._id]?J.remove(T):J.add(T)}),t=J.toList()),this._74I.fire({kind:e,datas:new nm(t)})},addSelectionChangeListener:function(V,M,U){this._74I.add(V,M,U)},removeSelectionChangeListener:function(P,u){this._74I.remove(P,u)},_97O:function(N,V){for(var I,x=this,Q=0,k=new nm(N);Q<k.size();Q++)I=k.get(Q),(x._filterFunc&&!x._filterFunc(I)||V&&x.co(I)||!V&&!x.co(I)||!x._dataModel.contains(I))&&(k.removeAt(Q),Q--);return k},appendSelection:function(W){var B=this;if(B._68O!==xj){var m,U,G=B._73O,g=B._97O(W,!0);g.isEmpty()||(B.sg()&&(m=new nm(G),U=B._map,G.clear(),B._map={},g=new nm(g.get(g.size()-1))),g.each(function(I){G.add(I),B._map[I._id]=I}),B._75I("append",g,m,U))}},removeSelection:function(r){var k=this,x=k._97O(r),a=0,C=x.size();if(0!==C){for(;C>a;a++){var L=x.get(a);k._73O.remove(L),delete k._map[L._id]}k._75I(hb,x)}},toSelection:function(r,w){return this._73O.toList(r,w)},getSelection:function(){return this._73O},each:function(R,V){this._73O.each(R,V)},setSelection:function(X){var t=this,o=t._73O;if(t._68O!==xj&&!(o.isEmpty()&&!X||1===o.size()&&t.ld()===X)){var C=new nm(o),_=t._map;o.clear(),t._map={};var P=t._97O(X,!0);t.sg()&&P.size()>1&&(P=new nm(P.get(P.size()-1))),P.each(function(n){o.add(n),t._map[n._id]=n}),t._75I("set",d,C,_)}},clearSelection:function(){var Q=this,u=Q._73O;if(u.size()>0){var m=u.toList();u.clear(),Q._map={},Q._75I(Ng,m)}},selectAll:function(){var b=this;if(b._68O!==xj){var Q,e,B=b._dataModel.toDatas();if(b._filterFunc)for(Q=0;Q<B.size();Q++)e=B.get(Q),b._filterFunc(e)||(B.removeAt(Q),Q--);var U=b._73O,m=new nm(U),w=b._map;U.clear(),b._map={},b.sg()&&B.size()>1&&(B=new nm(B.get(B.size()-1)));var p=B.size();for(Q=0;p>Q;Q++)e=B.get(Q),U.add(e),b._map[e._id]=e;b._75I("all",d,m,w)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(g){return this._map[g._id]!=d},getLastData:function(){var M=this._73O;return M.size()>0?M.get(M.size()-1):d},getFirstData:function(){var f=this._73O;return f.size()>0?f.get(0):d},isSelectable:function(y){var M=this;return y&&M._68O!==xj?M._filterFunc?M._filterFunc(y):!0:!1},getTopSelection:function(){var T=this,U=new nm;return T._73O.each(function(b){for(var X=b.getParent();X;){if(T.contains(X)){b=d;break}X=X.parent}b&&U.add(b)}),U}});var Dr=function(){return Ae(0),function(N,V){var C;if(Vc(V)){var K=N.getDataUI(V);K&&K._88I&&(C=K._88I.rect)}return C?C:V.getRect()}}();im(F,{edgeGroupAgentFunc:d,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:s.rectSelectBorder,graphViewRectSelectBackground:_c,graphViewEditPointSize:Qr?17:7,graphViewEditPointBorderColor:s.editPointBorder,graphViewEditPointBackground:s.editPointBackground,setEdgeType:function(V,E,x){wc[V]=E,Wg[V]=x},getEdgeType:function(X){return wc[X]},getEdgeTypeMap:function(){return wc},getNodeRect:Dr},!0),im(S,{"layout.h":J,"layout.v":J,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":J,interactive:!1,"image.stretch":"fill",icons:J,ingroup:!0,"body.color":J,"2d.gray":!1,fullscreen:J,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:J,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Ab,"select.width":1,"select.padding":2,"select.type":hp,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":J,"border.width":2,"border.padding":2,"border.type":hp,label:J,"label.font":J,"label.color":co,"label.background":J,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":J,"label.max":J,"label.opacity":J,"label.scale":1,"label.align":J,"label.selectable":!0,label2:J,"label2.font":J,"label2.color":co,"label2.background":J,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":J,"label2.max":J,"label2.opacity":J,"label2.scale":1,"label2.align":J,"label2.selectable":!0,note:J,"note.expanded":!0,"note.font":J,"note.color":Oh,"note.background":Ab,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":J,"note.toggleable":!0,"note.border.width":1,"note.border.color":J,"note.opacity":J,"note.scale":1,"note.align":J,note2:J,"note2.expanded":!0,"note2.font":J,"note2.color":Oh,"note2.background":Ab,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":J,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":J,"note2.opacity":J,"note2.scale":1,"note2.align":J,"group.type":J,"group.image":J,"group.image.stretch":"fill","group.repeat.image":J,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":J,"group.title.color":Oh,"group.title.background":s.groupTitleBackground,"group.title.align":Km,"group.title.orientation":ai,"group.background":s.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":J,"group.border.color":rg,"group.border.radius":0,"group.border.cap":jb,"group.border.join":Sp,"group.splitLine":!1,"group.gradient":d,"group.gradient.color":"#FFF",shape:J,"shape.background":rg,"shape.repeat.image":J,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":rg,"shape.border.3d":!1,"shape.border.3d.color":J,"shape.border.3d.accuracy":J,"shape.border.cap":jb,"shape.border.join":Sp,"shape.border.pattern":J,"shape.gradient":d,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Pm,"shape.dash.offset":0,"shape.dash.color":cp,"shape.dash.width":J,"shape.dash.3d":!1,"shape.dash.3d.color":J,"shape.dash.3d.accuracy":J,"shape.polygon.side":6,"shape.arc.from":M,"shape.arc.to":p,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":J,"shape.gradient.pack":J,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":J,"shape.foreground.gradient":d,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":J,"autolayout.hgap":J,"autolayout.vgap":J,"edge.type":J,"edge.points":J,"edge.segments":J,"edge.color":rg,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":J,"edge.3d.accuracy":J,"edge.cap":jb,"edge.join":Sp,"edge.source.position":17,"edge.source.anchor.x":J,"edge.source.anchor.y":J,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":J,"edge.target.anchor.y":J,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":J,"edge.dash":!1,"edge.dash.pattern":Pm,"edge.dash.offset":0,"edge.dash.color":cp,"edge.dash.width":J,"edge.dash.3d":!1,"edge.dash.3d.color":J,"edge.dash.3d.accuracy":J,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":J,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":J,"grid.column.percents":J,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":s.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":s.gridCellBorderColor,"grid.block":J,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":s.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":co,"text.font":xr,"text.shadow":!1,"text.shadow.color":Ab,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:J},!0),im(ac,{_76I:function(U,c,h){this._39I&&this._39I.fire({data:U,oldIndex:c,newIndex:h})},addIndexChangeListener:function(x,M,H){var C=this;C._39I||(C._39I=new Mj),C._39I.add(x,M,H)},removeIndexChangeListener:function(d,V){this._39I.remove(d,V)},prepareRemove:function(M){$k(M)&&(M.setSource(d),M.setTarget(d)),M._70O&&M._70O.toList().each(this.remove,this),M._69O&&M._69O.toList().each(function(l){l.setHost(d)}),M._host&&M.setHost(d)},onAdded:function(Z){this.isAutoAdjustIndex()&&this.adjustIndex(Z)},onDataPropertyChanged:function(S,h){$n[h.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(S)},isAdjustable:function(r){return Mp(r)||$k(r)},isAdjustedToBottom:function(I){return Cb(I)?I.isExpanded()&&Uc(I):!1},adjustIndex:function(s){var F=this;this.isHierarchicalRendering()||(F.isAdjustedToBottom(s)?(F.sendToBottom(s),s.eachChild(F.adjustIndex,F)):F.sendToTop(s))},sendToTop:function(b){var u=this;if(u.contains(b)&&u.isAdjustable(b)){var y=u._datas;if(b!==y.get(u.size()-1)){var g=y.indexOf(b);y.removeAt(g),y.add(b),u._76I(b,g,u.size()-1)}if($k(b)){var i=b._40I;i&&!u.isAdjustedToBottom(i)&&u.sendToTop(i),i=b._41I,i&&!u.isAdjustedToBottom(i)&&u.sendToTop(i)}b._69O&&b._69O.each(function(V){V.isRelatedTo(b)||Mp(b)&&V.isLoopedHostOn(b)||u.sendToTop(V)}),b.ISubGraph||(!Cb(b)||b.isExpanded())&&b._adjustChildrenToTop&&b.eachChild(function(j){$k(j)||u.sendToTop(j)})}},sendToBottom:function(H,A){var p=this;if(H!==A&&p.contains(H)&&p.isAdjustable(H)&&(!A||p.contains(A))){var F=p._datas,U=F.remove(H),e=A?p._datas.indexOf(A):0;if(F.add(H,e),U!==e){p._76I(H,U,e);var n=H._parent;!n||n.ISubGraph||$k(n)||p.sendToBottom(H._parent,H)}}}}),im(Mr,{ms_edit:function(h){h._46O=function(n){var k=this,B=k.gv.dm(),e=k._index,x=k._89I,S=k._node,y=k._shape,Y=k._edge,Z=k._77I;S&&x?(this.fi({kind:"endEditRect",event:n,data:S,direction:x}),B.endTransaction()):y&&e>=0?(k.fi({kind:"endEditPoint",event:n,data:y,index:e}),B.endTransaction()):Y&&e>=0?(k.fi({kind:"endEditPoint",event:n,data:Y,index:e}),B.endTransaction()):Z&&(k.fi({kind:"endEditRotation",event:n,data:Z}),B.endTransaction())},h._78I=function(v){var B=this;B.autoScroll(v);var h=B.gv.lp(v),V=B._index,w=B._89I,o=B._node,c=B._shape,O=B._edge,D=B._77I;if(o&&w)B._80O(h),B.fi({kind:"betweenEditRect",event:v,data:o,direction:w});else if(c&&V>=0)h.e=c.getPoints().get(V).e,c.setPoint(V,h),B.fi({kind:"betweenEditPoint",event:v,data:c,index:V});else if(O&&V>=0){var a=O.s(Zk);h.e=a.get(V).e,a.set(V,h),O.fp(Zk,d,a),B.fi({kind:"betweenEditPoint",event:v,data:O,index:V})}else if(D){var Z=D.p(),n=D.getScale(),g=L+k(h.y-Z.y,h.x-Z.x);n.y<0&&(g+=M),j(g)<.04&&(g=0),D.setRotation(g),B.fi({kind:"betweenEditRotation",event:v,data:D})}},h._80O=function(w){var k=this,K=k._node,S=k._rect,t=S.x,E=S.y,O=S.width,d=S.height,c=k._89I,Z=k._anchor,m=k._matrix,w=m.tfi(w);"northwest"===c?S=io(w,{x:t+O,y:E+d}):c===hq?S=io({x:t,y:w.y},{x:t+O,y:E+d}):"northeast"===c?S=io({x:t,y:w.y},{x:w.x,y:E+d}):c===eb?S=io({x:w.x,y:E},{x:t+O,y:E+d}):c===Oq?S=io({x:t,y:E},{x:w.x,y:E+d}):"southwest"===c?S=io({x:w.x,y:E},{x:t+O,y:w.y}):"south"===c?S=io({x:t,y:E},{x:t+O,y:w.y}):"southeast"===c&&(S=io({x:t,y:E},w)),K.setPosition(m.tf(S.x+S.width*Z.x,S.y+S.height*Z.y)),K.setWidth(S.width),K.setHeight(S.height)},h._80I=function(H,p,a,G){var _=this,c=_.gv._zoom,L=(_.gv.getEditPointSize()+2)/c;return mb({x:p-L/2,y:a-L/2,width:L,height:L},H)?(_._89I!==G&&(_._89I=G),!0):!1},h._79I=function(C,B,s){var l=this,f=l.gv,P=B?f.getDataUI(B):d,L=P?P._55O:d;if(L){var c,Y,R,z,m=f._zoom,F=(f.getEditPointSize()+2)/m,n=f.lp(C);if(Mp(B)){if(L._56O&&Mp(B)&&(Y=L._98o,mb({x:Y.x-F/2,y:Y.y-F/2,width:F,height:F},n)))return l._77I=B,s&&l.fi({kind:"beginEditRotation",event:C,data:B}),l.setCursor("crosshair"),!0;if(L._43O&&B instanceof cf)for(R=B.getPoints(),c=R.size()-1;c>=0;c--)if(Y=R.get(c),mb({x:Y.x-F/2,y:Y.y-F/2,width:F,height:F},n))return l._index=c,l._shape=B,s&&l.fi({kind:"beginEditPoint",event:C,data:B,index:c}),l.setCursor("crosshair"),!0;if(L._42O)for(var b=B.getEditControlPoints(),E=["northwest",-1,-1,eb,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Oq,1,0,"northeast",1,-1,hq,0,-1],c=0,z=b.length;z>c;c++){var k=E[3*c],p=b[c];if(l._80I(n,p.x,p.y,k)){l._node=B;var y=B.getWidth(),g=B.getHeight(),u=B.getAnchor();l._rect={x:-y*u.x,y:-g*u.y,width:y,height:g},l._anchor=u,l._matrix=B.getMatrix();var o=B.getRotation(),e=v(o),V=Z(o),$=E[3*c+1]*uo(B.getScale().x),t=E[3*c+2]*uo(B.getScale().y),K=Math.atan2(-V*$-e*t,e*$-V*t),a=(Math.round(K/(Math.PI/4))+8)%8,T=[lo,"nesw-resize",Wj,"nwse-resize",lo,"nesw-resize",Wj,"nwse-resize"][a];return l.setCursor(T),s&&l.fi({kind:"beginEditRect",event:C,data:B,direction:l._89I}),!0}}}if(L._43O&&$k(B)&&B.s(lc)===of&&(R=B.s(Zk)))for(c=R.size()-1;c>=0;c--)if(Y=R.get(c),mb({x:Y.x-F/2,y:Y.y-F/2,width:F,height:F},n))return l._index=c,l._edge=B,s&&l.fi({kind:"beginEditPoint",event:C,data:B,index:c}),l.setCursor("crosshair"),!0}return!1}},ms_gv:function(o){o._currentSubGraph=d,o._fpsInfo={time:0,fps:0,frames:0},o.upSubGraph=function(){this.setCurrentSubGraph(rb(this._currentSubGraph))},o.isVisible=function(d){var N=this;if(rb(d)!==N._currentSubGraph)return!1;if($k(d)){var I=d._40I,W=d._41I;if(!I||!W)return!1;if(!(d.s("edge.independent")||N.isVisible(I)&&N.isVisible(W)))return!1;if(d.isEdgeGroupHidden())return!1}else for(var O=d._parent;O&&!O.ISubGraph;){if(Cb(O)&&(!O.isExpanded()||!N.isVisible(O)))return!1;
O=O._parent}if(d._parent instanceof Mi&&!N.isVisible(d._parent))return!1;if(d._refGraph instanceof ke&&!N.isVisible(d._refGraph))return!1;if(N instanceof Dq){if(!d.s("3d.visible"))return!1}else{var A=N.getLayersInfo();if(A){var x=A[d._layer];if(x&&x.visible===!1)return!1}if(!d.s("2d.visible"))return!1}return N._visibleFunc?N._visibleFunc(d):!0},o.handleSelectionChange=function(F){var Z=this;F.datas.each(function(S){Z.invalidateData(S);var U=S._parent;Cb(U)&&Mp(S)&&S.s(Bg)&&(Z.invalidateData(U),U._49I&&U._49I.each(function(V){Z.invalidateData(V)}))}),Z.onSelectionChanged(F)},o.onSelectionChanged=function(m){var _=this,e=_.sm();if(1===e.size()&&("set"===m.kind||"append"===m.kind)){var H=e.ld();_.isAutoMakeVisible()&&_.makeVisible(H),_.adjustIndex&&_._dataModel.isAutoAdjustIndex()&&_.adjustIndex(H)}},o.makeVisible=function($){if($){var g=this,z=g.getDataUI?g.getDataUI($):g.getData3dUI($);if(z){var G=$,o=rb($);for(o!==g._currentSubGraph&&g.setCurrentSubGraph(o);(G=G._parent)&&G!==o;)Cb(G)&&G.setExpanded(!0);g._23I=$,g.iv()}}},o.getLabel=function(l){var L=l.getStyle(Re);return L===J?l.getName():L},o.getLabelBackground=function(l){return l.getStyle("label.background")},o.getLabelColor=function(N){return N.getStyle("label.color")},o.getLabel2=function(l){return l.getStyle("label2")},o.getLabel2Background=function(n){return n.getStyle("label2.background")},o.getLabel2Color=function(q){return q.getStyle("label2.color")},o.getNote=function(M){return M.getStyle(tb)},o.getNoteBackground=function(i){return i.getStyle("note.background")},o.getNote2=function(L){return L.getStyle(yp)},o.getNote2Background=function(K){return K.getStyle("note2.background")},o.handleClick=function(c,h,M){var V=this;h?(V.fi({kind:"clickData",event:c,data:h,part:M}),V.onDataClicked(h,c)):(V.fi({kind:"clickBackground",event:c}),V.onBackgroundClicked(c))},o.handleDoubleClick=function(y,d,S){var s=this;fs(y)&&(d?(s.fi({kind:"doubleClickData",event:y,data:d,part:S}),s.onDataDoubleClicked(d,y,S),s.checkDoubleClickOnNote(y,d,S)||s.checkDoubleClickOnRotation&&s.checkDoubleClickOnRotation(y,d,S)||($k(d)?s.onEdgeDoubleClicked(d,y,S):d.ISubGraph?s.onSubGraphDoubleClicked(d,y,S):Cb(d)?s.onGroupDoubleClicked(d,y,S):d.IDoorWindow?s.onDoorWindowDoubleClicked(d,y,S):d.ICSGBox&&s.onCSGBoxDoubleClicked(d,y,S))):(s.fi({kind:"doubleClickBackground",event:y}),s.onBackgroundDoubleClicked(y)))},o.onSubGraphDoubleClicked=function(G){this.setCurrentSubGraph(G)},o.onEdgeDoubleClicked=function(M,Q){M.ISubGraph&&!nr(Q)?this.setCurrentSubGraph(M):M.s("edge.toggleable")&&M.toggle()},o.onGroupDoubleClicked=function(e){e.s("group.toggleable")&&e.toggle()},o.onDoorWindowDoubleClicked=function(T){T.s("dw.toggleable")&&T.toggle(!0)},o.onCSGBoxDoubleClicked=function(F,t){var T=this;if(T instanceof Dq){var o=T.getHitFaceInfo(t);o&&o.face&&F.s(o.face+".toggleable")&&F.toggleFace(o.face,!0)}},o.onBackgroundClicked=function(){},o.onBackgroundDoubleClicked=function(){this.upSubGraph()},o.onDataClicked=function(){},o.onDataDoubleClicked=function(){},o.onAutoLayoutEnded=function(){},o.onMoveEnded=function(){},o.onPanEnded=function(){},o.onPinchEnded=function(){},o.onRectSelectEnded=function(){},o.onZoomEnded=function(){},o.serialize=function(E){return this.dm().serialize(E)},o.toJSON=function(){return this.dm().toJSON()},o.deserialize=function(E,R){var X=this;R=R instanceof Oc?{rootParent:R}:dr(R)?{setId:R}:sr(R)?{finishFunc:R}:R||{},R.view=X;var w=X.dm(),b=R.finishFunc;return R.finishFunc=function(){b&&b.apply(R,arguments),dr(w.a("zoomable"))&&X.setZoomable&&X.setZoomable(w.a("zoomable")),dr(w.a("pannable"))&&X.setPannable&&X.setPannable(w.a("pannable")),dr(w.a("rectSelectable"))&&X.setRectSelectable&&X.setRectSelectable(w.a("rectSelectable")),w.a("fitContent")===!0&&X.fitContent&&X.fitContent(!0,0)},w.deserialize(E,R.rootParent,R)},o.showDebugTip=function(){var S=this,l=S._debugDiv;if(!l){l=S._debugDiv=b.createElement("div"),l.style.position="absolute",l.style.overflow="hidden",l.style.backgroundColor="white",l.style.color="black";var i=S.getView();S._79O?i.insertBefore(l,S._79O):i.appendChild(l);var u=function(){S.redraw();var U="FPS : "+S._fpsInfo.fps+"<br/>"+"Datas : "+S.dm().getDatas().length,p=S.getDebugTip();p&&(U+="<br/>------<br/>"+p),l.innerHTML=U,S._isDebugging&&requestAnimationFrame(u)};requestAnimationFrame(u),S._isDebugging=!0}},o.hideDebugTip=function(){var q=this,y=q._debugDiv;y&&(delete q._debugDiv,q.getView().removeChild(y),q._isDebugging=!1)},o.countFrame=function(){if(this._isDebugging){var q=Date.now(),n=this._fpsInfo;q-n.time>1e3?(n.fps=Math.round(1e5*(n.frames+1)/(q-n.time))/100,n.time=q,n.frames=0):n.frames++}}},ms_icons:function(j){j.getRotation=function(s){return s==d?0:s},j._15O=function(){var D=this,F=D.s(zo);if(F){var u=D,G=D.data||D._data,h=D._38o={icons:F,rects:{}};for(var i in F){var X=F[i],y=Wf(X.shape3d,G,u);if(!(Wf(X.visible,G,u)===!1||Wf(X.for3d,G,u)&&!D.I3d||y&&!D.I3d)){var x=y?[y]:Wf(X.names,G,u),A=x?x.length:0,t=Wf(X.position,G,u)||3,j=Wf(X.offsetX,G,u)||0,L=Wf(X.offsetY,G,u)||0,B=Wf(X.direction,G,u)||Oq,T=Wf(X.gap,G,u),k=T!=d?T:1,J=Wf(X.rotation,G,u),b=Wf(X.keepOrien,G,u),E=Wf(X.rotationFixed,G,u)?J:D.getRotation(J,b,t),f=d,V=h.rects[i]=new Array(A);V.rotation=E;for(var Z=0;A>Z;Z++){var P,a,M,z,I=x[Z];if(y)M=0,z=0;else{var s=Hf(I);M=Wf(X.width,G,u),z=Wf(X.height,G,u),M==d&&(M=li(s,G)),z==d&&(z=Kn(s,G))}if(f?B===Oq?j+=M/2:B===eb?j-=M/2:B===hq?L-=z/2:L+=z/2:f={width:M,height:z},D.I3d){var R=-M/2,e=-z/2;a={width:M,height:z,mat:D._16O(Wf(X.autorotate,G,u),t,f,Wf(X.face,G,u)||Sg,Wf(X.t3,G,u),Wf(X.r3,G,u),Wf(X.rotationMode,G,u),j,L),vs:new Kp([R,-e,0,R,-e-z,0,R+M,-e-z,0,R+M,-e,0])}}else P=D.getPosition(t,j,L,f,Wf(X.positionFixed,G,u)),a={x:P.x-M/2,y:P.y-z/2,width:M,height:z},D._68o(a,E);V[Z]=a,B===Oq?j+=M/2+k:B===eb?j-=M/2+k:B===hq?L-=z/2+k:L+=z/2+k}}}}}}});var xb={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},_e={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},po={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},$n={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ps={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Rl={"edge.type":1,"edge.group":1},yi={rotation:1,rotationX:1,rotationZ:1},gd={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},wq={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Fl={shape:1,thickness:1,position:1,anchor:1,scale:1},rb=function(G){if(!G)return d;if($k(G)){var j=G._40I,x=G._41I;if(!j||!x)return d;var N=rb(j),S=rb(x);return N===S?N:d}for(var L=G._parent;$k(L)&&!L.ISubGraph;)L=L._parent;return L?L.ISubGraph?L:rb(L):d},ic=function(x,j,d,N){var R=j.getStyle(d)*N;R&&ub(x,R),R=j.getStyle(d+".left")*N,R&&(x.x-=R,x.width+=R),R=j.getStyle(d+".right")*N,R&&(x.width+=R),R=j.getStyle(d+".top")*N,R&&(x.y-=R,x.height+=R),R=j.getStyle(d+".bottom")*N,R&&(x.height+=R),x.width<0&&(x.width=-x.width,x.x-=x.width),x.height<0&&(x.height=-x.height,x.y-=x.height)},Uc=function(v){for(var $,M=0,w=v.size();w>M;M++)if($=v.getChildAt(M),Mp($)&&Uc($))return!0;return v.hasAgentEdges()},Cl=function(j){if(!j)return d;for(var S=j._parent;Cb(S);){if(!Cb(S._parent))return S.isExpanded()?j:S;S.isExpanded()||(j=S),S=S._parent}return j},ao=function(n,s){if(!n||!s)return d;var F,P,u,m=rb(n),K=rb(s);if(m!==K){for(;K&&m!==K;)K=rb(K);if(m===K)return n;F=new nm,F.add(n,0);for(var J=n._parent;Mp(J)&&!s.isDescendantOf(J);)F.add(J,0),J=J._parent;for(u=F.size(),P=0;u>P;P++){var b=F.get(P);if(Cb(b)&&!b.isExpanded())return b;if(b.ISubGraph)return b}return n}return n},zf=function(e){if(e.isLooped())return e._source;var D=Cl(e._source),o=Cl(e._target);return D===o?e._source:ao(D,o)},ge=function(x){if(x.isLooped())return x._target;var y=Cl(x._source),d=Cl(x._target);return y===d?x._target:ao(d,y)},Qg=function(k,Y,F){"target"!==F&&(F="source");var B="target"===F?Y.getTargetAgent():Y.getSourceAgent(),_="edge."+F+".";if($k(B)){var I=k.getDataUI(B);I._79o();var f=Y.s(_+"index");if(f!==J){var t=gs(I);return t[Math.max(0,Math.min(f,t.length-1))]}var o=Y.s(_+"percent")||0;o=Math.max(0,Math.min(o,1));var R=zn(I);return qr(R,100*o)}return kq(k,B,Y.s(_+"position"),Y.s(_+"offset.x"),Y.s(_+"offset.y"),Y.s(_+"anchor.x"),Y.s(_+"anchor.y"))},kq=function(k,N,c,e,x,L,E){if(!N)return d;var R,Y=N.getRotation?N.getRotation():0;if(L!==J||E!==J)if(L=L===J?.5:L,E=E===J?.5:E,Y&&!Vc(N,k)){var m=N.getPosition(),W=N.getWidth(),p=N.getHeight(),n=N.getAnchor(),D=N.getScale(),S=new Vr(Y,m.x,m.y,D.x,D.y);c=S.tf((L-n.x)*W,(E-n.y)*p)}else R=Dr(k,N),c={x:R.x+L*R.width,y:R.y+E*R.height};else c=ui(c,Dr(k,N));if(Y){var B=v(Y),U=Z(Y),C=e*B-x*U;x=e*U+x*B,e=C}return c.x+=e,c.y+=x,c},tg=function(R,e){if(!R||!e)return d;var x,A,b,n,o,W;if(R===e){if(n=R.getLoopedEdges(),!n)return d;n=new nm(n)}else{if(o=R.getAgentEdges(),W=e.getAgentEdges(),!o||!W)return d;for(A=o.size(),x=0;A>x;x++)b=o.get(x),W.contains(b)&&(n||(n=new nm),n.add(b))}if(n)for(x=0;x<n.size();x++)b=n.get(x),b.getStyle(lc)===of&&(b._22I(d),n.removeAt(x),x--);return n},vo=function(u,z){var c=tg(u,z);if(c&&!c.isEmpty()){if(1===c.size())return c.get(0)._22I(d),void 0;var o=new nm,T=new nm;c.each(function(y){var g=y.s("edge.group");o.contains(g)||o.add(g)}),o.sort(),o.each(function(D){T.add(new P.EdgeGroup(c.toList(function(x){return D===x.s("edge.group")}),T))}),T.each(function(n){n.each(function(J){J._22I(n)})})}},Fb=function(J,f,z){var F=J._canvas;J._zoom;var C=Ub(f,F),w=Ub(z,F);return{x:C.x-w.x,y:C.y-w.y}},uq=function(f,p){if(p){var C=p.rect,s=p.color,$=p.rotation,J=p.labelWidth,g=p.background,R=p.opacity,P=p.scale,Q=P!=d&&1!==P;if(R!=d){var m=f.globalAlpha;f.globalAlpha*=R}if($||Q){f.save();var N=C.x+C.width/2,r=C.y+C.height/2;Rg(f,N,r),$&&Nl(f,$),Q&&f.scale(P,P),Rg(f,-N,-r)}if(g&&Pe(f,C.x,C.y,C.width,C.height,g),J){var u=C.width,v=f.createLinearGradient(C.x,C.y,C.x+u,C.y);v.addColorStop(0,s),v.addColorStop(.9,s),v.addColorStop(1,Ve),s=v,C.width=J}ye(f,p.ss,C,p.font,s,p.align),J&&(C.width=u),($||Q)&&f.restore(),R!=d&&(f.globalAlpha=m)}},ts=function(I,U){if(U){var C=U.rect,$=C.x,T=C.y,H=C.width,q=C.height,P=U.background,z=U.backgroundImage,Z=U.borderWidth,x=U.borderColor,D=U.labelWidth,v=U.opacity,Q=U.scale,O=Q!=d&&1!==Q;if(v!=d){var m=I.globalAlpha;I.globalAlpha*=v}if(O){I.save();var n=C.x+C.width/2,c=C.y+C.height/2;Rg(I,n,c),I.scale(Q,Q),Rg(I,-n,-c)}if(U.expanded){var b=e(8,H/4),s=T+q-8;if(I.fillStyle=P,I.beginPath(),I.moveTo($,T),I.lineTo($,s),I.lineTo($+H/2,s),I.lineTo($+H/2,T+q),I.lineTo($+H/2+b,s),I.lineTo($+H,s),I.lineTo($+H,T),I.closePath(),I.fill(),Z&&(I.lineWidth=Z,I.lineJoin="round",I.lineCap="round",x?(I.strokeStyle=x,I.stroke()):(I.strokeStyle=rm(P),I.beginPath(),I.moveTo($+H,T),I.lineTo($+H,s),I.lineTo($+H/2+b,s),I.lineTo($+H/2,T+q),I.stroke(),I.strokeStyle=iq(P),I.beginPath(),I.moveTo($+H,T),I.lineTo($,T),I.lineTo($,s),I.lineTo($+H/2,s),I.lineTo($+H/2,T+q),I.stroke())),z)wo(I,Hf(z),Pg,C.x,C.y,C.width,C.height-8,U.data,U.view);else{if(C.height-=8,P=U.color,D){var u=H,V=I.createLinearGradient($,T,$+u,T);V.addColorStop(0,P),V.addColorStop(.9,P),V.addColorStop(1,Ve),P=V,C.width=D}ye(I,U.ss,C,U.font,P,U.align),D&&(C.width=u),C.height+=8}}else if(U.icon)Pp(I,Hf(U.icon),$,T,H,q,U.data,U.view);else{var f=H/2;Z&&(I.lineWidth=Z,I.lineJoin="round",I.lineCap="round",I.strokeStyle=x?x:rm(P),I.beginPath(),I.arc($+f,T+f,f,L,1.6*M,!0),I.moveTo($+f,T+q),I.lineTo($+H-f/5,T+f),I.stroke(),I.strokeStyle=x?x:iq(P),I.beginPath(),I.arc($+f,T+f,f,1.6*M,L,!0),I.moveTo($+f,T+q),I.lineTo($+f/5,T+f),I.stroke()),I.fillStyle=P,I.beginPath(),I.arc($+f,T+f,f,0,p,!0),I.moveTo($+f,T+q),I.lineTo($+H-f/5,T+f),I.lineTo($+f/5,T+f),I.closePath(),I.fill(),I.fillStyle=U.color,I.beginPath(),I.arc($+f,T+f,f/3,0,p,!0),I.fill()}O&&I.restore(),v!=d&&(I.globalAlpha=m)}},Kc=function(p,l){return l>2*p?p:l/2},bf=function(X,T,A,P){if(!X||!T)return 0;var e=k(T.y-X.y,T.x-X.x);return A||(e=T.x<X.x?e+M:e),e+P},Aj=function(U,N,S,Q,_,V,g){g&&(U.x>N.x||U.x===N.x&&U.y>N.y)&&(S=Qf[S],_=-_);var Y=ui(S,{x:0,y:0,width:jc(U,N),height:0},V);return Y.x+=Q,Y.y+=_,Y=new Vr(k(N.y-U.y,N.x-U.x)).tf(Y),Y.x+=U.x,Y.y+=U.y,Y},_j=function(t,J,O,K,U){if(t._19Q=!0,!O.getEdgeGroup())return K?O.s("edge.gap"):0;if($k(O.getSourceAgent())||$k(O.getTargetAgent()))return 0;var o,e=0,g=0,Q=0;if(O.getEdgeGroup().getSiblings().each(function(n){n.each(function(t){if(J.isVisible(t)&&t.s(lc)==U){var X=t.s("edge.gap");o?(g+=Q/2+X/2,Q=X):(o=t,Q=X),t===O&&(e=g)}})}),K)return g-e+Q;var F=e-g/2;return o&&O._40I!==o._40I&&(t._19Q=!1),F},mm=function(){var l=function(G){var X=[];return G.forEach(function(q){X.push({x:q.x,y:q.y}),X.push({x:q.x+q.width,y:q.y+q.height}),X.push({x:q.x+q.width,y:q.y}),X.push({x:q.x,y:q.y+q.height})}),X};return function(n,C,K){if("oval"===n){var Q=0,p=K.height/K.width,W=p*p,T=K.x+K.width/2,S=K.y+K.height/2,g=l(C);g.forEach(function(O){var m=O.x-T,_=O.y-S,z=m*m+_*_/W;z>Q&&(Q=z)}),Q=w(Q);var o=p*Q;return{x:T-Q,y:S-o,width:2*Q,height:2*o}}if("circle"===n){var A=0,T=K.x+K.width/2,S=K.y+K.height/2,g=l(C);return g.forEach(function($){var k=$.x-T,C=$.y-S,l=k*k+C*C;l>A&&(A=l)}),A=w(A),{x:T-A,y:S-A,width:2*A,height:2*A}}return"roundRect"===n?(ub(K,e(K.width,K.height)/16),K):K}}(),vb=P.graph={},bi=function(q,u,m){$o(l+".graph."+q,u,m)};P.layout={};var Cc={},gc=function(I,z,F,u,q,o,E,K){var t=[z.uuid,Math.round(u),Math.round(q),F].join("_");z.cacheRule&&(t+=Wf(z.cacheRule,o,E));var A=E._zoom;A!==E._cacheZoom&&(E._cacheZoom=A,E._cacheImage={});var p=E._cacheImage[t];return p||(p=E._cacheImage[t]=P.Default.toCanvas(z,Math.ceil(u*A),Math.ceil(q*A),F,o,E,K)),p};im(F,{setImageCacheRule:function(H,C){var K;K=C||"object"!=typeof H?{_image:C}:H;for(var r in K){var m=K[r];Jp(r)?($o=Hf(r),$o?$o.cacheRule=m:Cc[r]=m):r.cacheRule=m}}});var Em={comps:[{type:zd,points:[85,50,70,115,100,71,86,107,88,49,57,77,74,118,75,101,98,97,49,77,115,84,53,55,78,84,75,114,77,108,77,67,68,50,85,57,81,115,81,113,106,110,73,61],borderWidth:1,borderColor:d}]};if(Em[ib]=Em[Kq]=160,H.Image){var aq=new H.Image;aq.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Zh("default_blank",aq)}Zh("node_image",ff(30,30,[{type:hp,rect:[4,5,22,16],gradient:Ib,gradientColor:Qe,background:rg},{type:hp,rect:[2,3,26,20],borderWidth:1,borderColor:rg},{type:hp,rect:[11,23,8,4],background:rg},{type:hp,rect:[6,27,18,2],background:rg}])),Zh("node_icon",ff(16,16,[{type:hp,rect:[2,2,12,10],gradient:Ib,gradientColor:Qe,background:rg},{type:Um,rect:[2,2,12,10],width:1,color:rg},{type:hp,rect:[6,12,4,2],background:rg},{type:hp,rect:[4,14,8,1],background:rg}])),Zh("block_icon",ff(16,16,[{type:Um,rect:[1,1,14,14],width:1,color:rg}])),Zh("group_image",ff(66,39,[{type:hp,rect:[44.3,18,18.1,12.8],gradient:Ib,gradientColor:Qe,background:rg},{type:hp,rect:[3.3,17.8,18.1,12.8],gradient:Ib,gradientColor:Qe,background:rg},{type:hp,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:rg,gradient:Ib,gradientColor:Qe,background:rg},{type:hp,rect:[26.2,29.4,12.8,4.2],background:rg},{type:hp,rect:[21.3,33.5,22.5,2.3],background:rg},{type:hp,rect:[5.3,32.7,14.1,2.1],background:rg},{type:hp,rect:[9,30.4,6.7,2.4],background:rg},{type:hp,rect:[50,30.7,6.7,2.4],background:rg},{type:hp,rect:[46.3,33,14.1,2.1],background:rg}])),Zh("group_icon",ff(16,16,[{type:hp,rect:[4,12,4,2],background:rg},{type:hp,rect:[2,13,8,1],background:rg},{type:hp,rect:[12,12,2,1],background:rg},{type:hp,rect:[11,13,4,1],background:rg},{type:hp,rect:[10,7,6,5],gradient:Ib,gradientColor:Qe,background:rg},{type:hp,rect:[1,2,10,10],gradient:Ib,gradientColor:Qe,background:rg},{type:Um,rect:[1,2,10,10],width:1,color:rg}])),Zh("refGraph_icon",ff(16,16,[{type:"shape",borderWidth:1,borderColor:rg,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:rg,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Zh("edge_icon",ff(16,16,[{type:hp,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Ib,gradientColor:Qe,background:rg},{type:hp,rect:[10.8,1,4,4],background:rg},{type:hp,rect:[1,11,4,4],background:rg}])),Zh("subGraph_image",ff(72,45,[{type:zd,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Ib,gradientColor:Qe,background:rg},{type:hp,rect:[29.6,30.7,3.6,1.8],background:rg},{type:hp,rect:[28.4,32.3,6,1.2],background:rg},{type:hp,rect:[37.3,32,10.8,1.8],background:rg},{type:hp,rect:[39.1,29.9,7.2,2.3],background:rg},{type:hp,rect:[26.6,23.7,9.6,7.2],gradient:Ib,gradientColor:Qe,background:rg},{type:hp,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:rg,gradient:Ib,gradientColor:Qe,background:rg}])),Zh("subGraph_icon",ff(17,17,[{type:zd,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Ib,gradientColor:Qe,background:rg}])),Zh("shape_icon",ff(16,16,[{type:zd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:rg}])),Zh("polyline_icon",ff(16,16,[{type:zd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:rg},wh(7.5,.4),wh(7.5,6.3),wh(13.6,6.3),wh(13.6,14),wh(.7,13.9),wh(.7,.3)])),Zh("grid_icon",ff(16,16,[{type:hp,rect:[1,1,4,4],background:rg,gradient:Ib,gradientColor:Qe},{type:hp,rect:[6,1,4,4],background:rg,gradient:Ib,gradientColor:Qe},{type:hp,rect:[11,1,4,4],background:rg,gradient:Ib,gradientColor:Qe},{type:hp,rect:[11,6,4,4],background:rg,gradient:Ib,gradientColor:Qe},{type:hp,rect:[6,6,4,4],background:rg,gradient:Ib,gradientColor:Qe},{type:hp,rect:[1,6,4,4],background:rg,gradient:Ib,gradientColor:Qe},{type:hp,rect:[11,11,4,4],background:rg,gradient:Ib,gradientColor:Qe},{type:hp,rect:[6,11,4,4],background:rg,gradient:Ib,gradientColor:Qe},{type:hp,rect:[1,11,4,4],background:rg,gradient:Ib,gradientColor:Qe}])),Zh("light_icon",ff(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:rg},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:rg,gradient:Ib,gradientColor:Qe,background:{func:function($){var O=$?$.s(hn):d;return mo(O)?"rgb("+W(255*O[0])+","+W(255*O[1])+","+W(255*O[2])+")":O||rg}}}])),Zh("text_icon",ff(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:rg}])),Zh("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Zh("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Zh("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Zh("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Oi=function(D,G,j,r,H,x){var p,s,J,K,X,t,Q,m,k,S,l,y=[];if(Math.abs(r)>2*Math.PI&&(r=2*Math.PI),X=Math.ceil(Math.abs(r)/(Math.PI/4)),p=r/X,s=-p,J=-j,X>0){t=D+Math.cos(j)*H,Q=G+Math.sin(-j)*x,y.push({x:t,y:Q});for(var c=0;X>c;c++)J+=s,K=J-s/2,m=D+Math.cos(J)*H,k=G+Math.sin(J)*x,S=D+Math.cos(K)*(H/Math.cos(s/2)),l=G+Math.sin(K)*(x/Math.cos(s/2)),y.push({x:S,y:l}),y.push({x:m,y:k})}return y},Nj=function(v){if(v){var z=v._data;if(z instanceof P.Shape)return{points:z.getPoints(),segments:z.getSegments()};var U;if(z instanceof P.Edge&&(U=v._78o)){var O,h,j=U.type,B=U.points,L=U.segments,$=U.edgeTypeInfo;if(!j||B){var M=U.sourcePoint,G=M.x,u=M.y,T=U.targetPoint,Q=T.x,t=T.y;if(j)L?(O=new nm({x:G,y:u}),O.addAll(B),O.add({x:Q,y:t}),h=new nm(L._as)):(O=new nm({x:G,y:u}),B.each(function(B){O.add(B)}),O.add({x:Q,y:t}));else if(U.looped){O=new nm(Oi(G,u,0,2*Math.PI,U.radius,U.radius)),h=new nm([1]);for(var n=0;n<(O.size()-1)/2;n++)h.add(3)}else O=new nm,U.center?(O.add({x:U.c1.x,y:U.c1.y}),O.add({x:G,y:u}),O.add({x:Q,y:t}),O.add({x:U.c2.x,y:U.c2.y})):(O.add({x:G,y:u}),O.add({x:Q,y:t}))}else $&&(O=new nm($.points._as),$.segments&&(h=new nm($.segments._as)));return{points:O,segments:h}}}},zn=function(Y,O,S){if(null==O){var b=Nj(Y);if(!b)return;O=b.points,S=b.segments}if(O){if(Array.isArray(O)&&(O=new nm(O)),"number"==typeof O.get(0)){for(var d=new P.List,k=0;k<O.size();k+=2)d.add({x:O.get(k),y:O.get(k+1)});O=d}if(!S){S=[1];for(var c=O.length-1;c>0;c--)S.push(2)}Array.isArray(S)&&(S=new nm(S));for(var D=vm(O._as,S._as,50),Q=D.length,R=[],k=0;Q>k;k++){var J=D[k];J.length>1&&R.push(J)}return R}},Xn=function(N){for(var B=0,S=N.length-1,c=0;S>c;c++){var Q=N[c],m=N[c+1],o=m.x-Q.x,d=m.y-Q.y;B+=Math.sqrt(o*o+d*d)}return B},ld=function(U,g){for(var V=0,n=g.length,l=0;n>l;l++){var q=g[l];if(V+=q,V>U)return l}return Math.min(l,n-1)},Lk=function(R,e){for(var P=0,m=0,g=0,b=R.length-1,s=0;b>s;s++){var Z=R[s],o=R[s+1],j=o.x-Z.x,k=o.y-Z.y;if(g=Math.sqrt(j*j+k*k),P+=g,P>e){P-=g,m=s;break}}var i=R[m],F=R[m+1],A=Math.atan2(F.y-i.y,F.x-i.x),Y=e-P,k=Math.sin(A)*Y,j=Math.cos(A)*Y;return{x:i.x+j,y:i.y+k}},qr=function(n,F){if(n){var U;if(0===F)U=n[0][0];else if(100===F)n=n[n.length-1],U=n[n.length-1];else{for(var e=0,x=[],d=n.length,I=0;d>I;I++){var B=n[I],w=Xn(B);e+=w,x.push(w)}for(var T=e*F/100,f=ld(T,x),W=0,s=0;f>s;s++)W+=x[s];T-=W,U=Lk(n[f],T)}return U}},gs=function(e){var I,A,n,M,d=Nj(e),p=[],r=d.points,D=d.segments,G=-1;for(A=0,n=D?D.length:r.length;n>A;A++){if(I=D?D.get(A):1,3===I)M=2;else if(4===I)M=3;else{if(5===I)continue;M=1}G+=M,p.push(r.get(G))}return p},Zl=function(z,U,L,S){function n(L){if(L>=0&&1>=L){q=U(L);var Z=(z.x-q.x)*(z.x-q.x)+(z.y-q.y)*(z.y-q.y);return i>Z?(i=Z,J=L,!0):!1}}L=L||100,S=S||1e-5;for(var i=1/0,J=0,q=new kc,D=0;L>D;++D)n(D/L);for(var E=1/(2*L);E>S;)n(J-E)||n(J+E)||(E/=2);return J};im(F,{_edgeProtectMethod:{getStraightLinePoints:zn,calculateLineLength:Xn,calcSegmentIndexByDistance:ld,calculatePointAlongLine:Lk,getPercentPosition:qr}});var Xi=function($,t){for(var I=$.vertices,z=0;z<I.length;z++){var g=I[z],h=g.y;g.y=g.z,g.z=-h,t&&(g.y+=t)}},qh=function(g){for(var C,w,P,K,A,H,J=[],j=[],e=[],L=g.faces,b=0,B=0,x=0,Z=L.length;Z>b;b++,B+=6,x+=9){var R=L[b];1===R.i?(C||(C=[],w=[],P=[]),Zg(R,b,B,x,g,C,P,w)):2===R.i?(K||(K=[],A=[],H=[]),Zg(R,b,B,x,g,K,H,A)):Zg(R,b,B,x,g,J,e,j)}return{vs:J,uv:j,ns:e,top_vs:C,top_uv:w,top_ns:P,bottom_vs:K,bottom_uv:A,bottom_ns:H}},Zg=function(V,$,j,E,N,L,p,T){var n=N.vertices,w=N.faceVertexUvs,G=n[V.a],s=n[V.b],f=n[V.c];L[E]=G.x,L[E+1]=G.y,L[E+2]=G.z,L[E+3]=s.x,L[E+4]=s.y,L[E+5]=s.z,L[E+6]=f.x,L[E+7]=f.y,L[E+8]=f.z;var I=V.vertexNormals;if(3===I.length){var q=I[0],S=I[1],J=I[2];p[E]=q.x,p[E+1]=q.y,p[E+2]=q.z,p[E+3]=S.x,p[E+4]=S.y,p[E+5]=S.z,p[E+6]=J.x,p[E+7]=J.y,p[E+8]=J.z}else{var O=V.normal;p[E]=O.x,p[E+1]=O.y,p[E+2]=O.z,p[E+3]=O.x,p[E+4]=O.y,p[E+5]=O.z,p[E+6]=O.x,p[E+7]=O.y,p[E+8]=O.z}var c=w[0][$][0],h=w[0][$][1],a=w[0][$][2];T[j]=c.x,T[j+1]=c.y,T[j+2]=h.x,T[j+3]=h.y,T[j+4]=a.x,T[j+5]=a.y},Il=function(d){var k=d._lineModel;if(k)return k;var f;f=mo(d)?d:[d];var A,B,L,R,S,G,n,a,U,g,M,Z,s=["","top","bottom"];for(k=[],A=0,B=f.length;B>A;A++)for(U=f[A],L=0,R=s.length;R>L;L++)if(n=U[s[L]+"vs"]){a=U[s[L]+"is"],G=a?a.length:n.length/3;for(var S=0;G>S;S+=3)a?(g=a[S],M=a[S+1],Z=a[S+2]):(g=S,M=S+1,Z=S+2),g*=3,M*=3,Z*=3,k.push(n[g],n[g+1],n[g+2],n[M],n[M+1],n[M+2],n[M],n[M+1],n[M+2],n[Z],n[Z+1],n[Z+2],n[Z],n[Z+1],n[Z+2],n[g],n[g+1],n[g+2])}return d._lineModel=k,k},No=function(l,v,k,i,u,p,H,M,m){k==d&&(k=!0),i==d&&(i=!0),H==d&&(H=1),M==d&&(M=0);var S=new ek;return Bs(S,l,v,m),S=S.toShapes(),qh(new lh(S,{top:k,bottom:i,curveSegments:u,amount:H,repeatUVLength:p},-H/2+M))},qq=function(t,N){this.x=t||0,this.y=N||0};qq.prototype={constructor:qq,add:function(y){return this.x+=y.x,this.y+=y.y,this},sub:function(l){return this.x-=l.x,this.y-=l.y,this},equals:function(c){return c.x===this.x&&c.y===this.y},multiplyScalar:function(A){return this.x*=A,this.y*=A,this},distanceTo:function(l){return w(this.distanceToSquared(l))},distanceToSquared:function(V){var Y=this.x-V.x,y=this.y-V.y;return Y*Y+y*y},clone:function(){return new qq(this.x,this.y)}};var fl=function(A,i,f){this.x=A||0,this.y=i||0,this.z=f||0};fl.prototype={constructor:fl,set:function(j,d,r){return this.x=j,this.y=d,this.z=r,this},setY:function(H){return this.y=H,this},copy:function(d){return this.x=d.x,this.y=d.y,this.z=d.z,this},add:function(T){return this.x+=T.x,this.y+=T.y,this.z+=T.z,this},addVectors:function(f,U){return this.x=f.x+U.x,this.y=f.y+U.y,this.z=f.z+U.z,this},sub:function(S){return this.x-=S.x,this.y-=S.y,this.z-=S.z,this},subVectors:function(l,W){return this.x=l.x-W.x,this.y=l.y-W.y,this.z=l.z-W.z,this},multiplyScalar:function(v){return this.x*=v,this.y*=v,this.z*=v,this},applyMatrix4:function(L){var i=this.x,l=this.y,d=this.z,a=L.elements;return this.x=a[0]*i+a[4]*l+a[8]*d+a[12],this.y=a[1]*i+a[5]*l+a[9]*d+a[13],this.z=a[2]*i+a[6]*l+a[10]*d+a[14],this},divideScalar:function(r){if(0!==r){var Y=1/r;this.x*=Y,this.y*=Y,this.z*=Y}else this.x=0,this.y=0,this.z=0;return this},dot:function(O){return this.x*O.x+this.y*O.y+this.z*O.z},length:function(){return w(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(P){var l=this.x,i=this.y,m=this.z;return this.x=i*P.z-m*P.y,this.y=m*P.x-l*P.z,this.z=l*P.y-i*P.x,this},crossVectors:function(I,c){var K=I.x,e=I.y,n=I.z,d=c.x,l=c.y,s=c.z;return this.x=e*s-n*l,this.y=n*d-K*s,this.z=K*l-e*d,this},distanceTo:function(V){return w(this.distanceToSquared(V))},distanceToSquared:function($){var I=this.x-$.x,q=this.y-$.y,s=this.z-$.z;return I*I+q*q+s*s},clone:function(){return new fl(this.x,this.y,this.z)}};var Fe=function(){this.elements=new Float32Array(16)};Fe.prototype={constructor:Fe,set:function($,L,D,w,F,m,N,n,G,P,S,U,T,J,f,d){var R=this.elements;return R[0]=$,R[4]=L,R[8]=D,R[12]=w,R[1]=F,R[5]=m,R[9]=N,R[13]=n,R[2]=G,R[6]=P,R[10]=S,R[14]=U,R[3]=T,R[7]=J,R[11]=f,R[15]=d,this},makeRotationAxis:function(Y,C){var R=v(C),b=Z(C),o=1-R,x=Y.x,l=Y.y,G=Y.z,X=o*x,u=o*l;return this.set(X*x+R,X*l-b*G,X*G+b*l,0,X*l+b*G,u*l+R,u*G-b*x,0,X*G-b*l,u*G+b*x,o*G*G+R,0,0,0,0,1),this}};var qc=function(L){this.repeatUVLength=L};qc.prototype={generateTopUV:function(q,k,Q,A,T,M,m){var W,e,z,Y,S=q.vertices,j=S[A].x,x=S[A].y,I=S[T].x,o=S[T].y,J=S[M].x,i=S[M].y,n=this.repeatUVLength;if(n)W=0,e=0,z=n,Y=n;else{this._bb||(this._bb=k.getBoundingBox());var K=this._bb;W=K.minX,e=K.minY,z=K.maxX-W,Y=K.maxY-e}return m?[new qq((j-W)/z,(x-e)/Y),new qq((I-W)/z,(o-e)/Y),new qq((J-W)/z,(i-e)/Y)]:[new qq((j-W)/z,1-(x-e)/Y),new qq((I-W)/z,1-(o-e)/Y),new qq((J-W)/z,1-(i-e)/Y)]},generateBottomUV:function(j,X,u,t,h,i){return this.generateTopUV(j,X,u,t,h,i,!0)},generateSideWallUV:function(g,x,E,R,n,q,L,T,$,A,D,C){if(!this._cl){for(var b,W,J=[],v=0,_=E.length,y=0;_>y;y++){b=E[y],W=E[(y+1)%_];var K=b.x-W.x,m=b.y-W.y,Q=w(K*K+m*m);J.push(v),v+=Q}for(var y=0;_>y;y++)J[y]/=v;this._cl=J}var J=this._cl,F=1-$/A,p=1-($+1)/A,M=J[D],r=J[C];return r>M&&(M+=1),[new qq(M,F),new qq(r,F),new qq(r,p),new qq(M,p)]}};var mj=function(O,r,F,E,C,G){this.a=O,this.b=r,this.c=F,this.i=G,this.normal=E instanceof fl?E:new fl,this.vertexNormals=E instanceof Array?E:[]};mj.prototype={constructor:mj};var Wl=[-8,13,-1,15,-4,5,-3,6,-1],Yn=function(){if(Yn[ds]!=d)return Yn[ds];for(var y=Id[ds],x=Wl,f=Oc.prototype.getClassName(),g='"',u=0,M="",m=!1,n=+new(H[f.substr(3,3)+lo[u]]),o=u;o<x.length;o++){var L=x.length-o;M+=o%2===u?x[o]+L+"":x[o]-L+""}for(var o=u;4>o;o++)M+=u;if(M=M*M.length/M.length,n>M){if(y&&y[u]&&y[4/hp.length]){for(var S,s,r,X,c,l,E,F,T=y[0],A=y[1],K="",P=0,o=0;o<A.length;o++)A[o]===g?F?(F=!1,0!==P%2&&(S==d?S=K:s==d?s=K:r==d?r=K:X==d?X=K:c==d?c=K:l==d?l=K:E==d&&(E=K)),P++,K=""):F=!0:F&&(K+=A[o]);for(var V,J,R,p="",W=0,o=0;o<T.length;o++)T[o]===g?V?(V=!1,0!==W%2&&(J==d?J=p:R==d&&(R=p)),W++,p=""):V=!0:V&&(p+=T[o]);var z=S+s+r+X+c+l;(m=ak(z,E)&&ak(J,R)&&J===S&&(!l||l.indexOf(Yo)>=0)&&(!c||c>n))&&r.indexOf(gg[0])>=0&&(Yn[gg[0]]=1),m&&r.indexOf(1)>=0&&(Yn[1]=1),m&&r.indexOf(2)>=0&&(Yn[2]=1)}}else m=!0,Yn[gg[0]]=Yn[1]=Yn[2]=1;return Yn[ds]=m,m},Gc=function(){},Ap=Gc.prototype;Ap.getPointAt=function(d){var j=this.getUtoTmapping(d);return this.getPoint(j)},Ap.getPoints=function(F){F||(F=5);var I,u=[];for(I=0;F>=I;I++)u.push(this.getPoint(I/F));return u},Ap.getSpacedPoints=function(w){w||(w=5);var s,V=[];for(s=0;w>=s;s++)V.push(this.getPointAt(s/w));return V},Ap.getLength=function(){var k=this.getLengths();return k[k.length-1]},Ap.getLengths=function(X){if(X||(X=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==X+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var M,Q,b=[],N=this.getPoint(0),Z=0;for(b.push(0),Q=1;X>=Q;Q++)M=this.getPoint(Q/X),Z+=M.distanceTo(N),b.push(Z),N=M;return this.cacheArcLengths=b,b},Ap.getUtoTmapping=function(e,L){var Y,l=this.getLengths(),I=0,h=l.length;Y=L?L:e*l[h-1];for(var v,j=0,d=h-1;d>=j;)if(I=A(j+(d-j)/2),v=l[I]-Y,0>v)j=I+1;else{if(!(v>0)){d=I;break}d=I-1}if(I=d,l[I]==Y){var U=I/(h-1);return U}var c=l[I],$=l[I+1],f=$-c,W=(Y-c)/f,U=(I+W)/(h-1);return U},Ap.getTangent=function(i){var U=1e-4,b=i-U,o=i+U;0>b&&(b=0),o>1&&(o=1);var h=this.getPoint(b),g=this.getPoint(o),v=g.clone().sub(h);return v.normalize()},Ap.getTangentAt=function(m){var K=this.getUtoTmapping(m);return this.getTangent(K)},Gc.create=function(W,b){return W.prototype=$c(Gc.prototype),W.prototype.getPoint=b,W};var zh=function(){this.curves=[],this.autoClose=!1},eq=zh.prototype=$c(Ap);eq.add=function($){this.curves.push($)},eq.closePath=function(){var d=this.curves[0].getPoint(0),z=this.curves[this.curves.length-1].getPoint(1);d.equals(z)||this.curves.push(new on(z,d))},eq.getPoint=function(F){for(var Z,h,Q=F*this.getLength(),E=this.getCurveLengths(),p=0;p<E.length;){if(E[p]>=Q){Z=E[p]-Q,h=this.curves[p];var C=1-Z/h.getLength();return h.getPointAt(C)}p++}return null},eq.getLength=function(){var k=this.getCurveLengths();return k[k.length-1]},eq.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var o,q=[],b=0,Y=this.curves.length;for(o=0;Y>o;o++)b+=this.curves[o].getLength(),q.push(b);return this.cacheLengths=q,q},eq.getTransformedPoints=function(j){return this.getPoints(j)},eq.getBoundingBox=function(){var t,Z,J,q,T,P,m=this.getPoints();
t=Z=Number.NEGATIVE_INFINITY,q=T=Number.POSITIVE_INFINITY;var x,e,i,b,B=m[0]instanceof fl;for(b=B?new fl:new qq,e=0,i=m.length;i>e;e++)x=m[e],x.x>t&&(t=x.x),x.x<q&&(q=x.x),x.y>Z&&(Z=x.y),x.y<T&&(T=x.y),B&&(x.z>J&&(J=x.z),x.z<P&&(P=x.z)),b.add(x);var j={minX:q,minY:T,maxX:t,maxY:Z};return B&&(j.maxZ=J,j.minZ=P),j};var ih=function(f){zh.call(this),this.actions=[],f&&this.fromPoints(f)},pq=ih.prototype=$c(zh.prototype),Hp="moveTo",Xq="lineTo",Up="quadraticCurveTo",ec="bezierCurveTo",jo="arc",ir="ellipse";pq.fromPoints=function(Q){this.moveTo(Q[0].x,Q[0].y);for(var f=1,L=Q.length;L>f;f++)this.lineTo(Q[f].x,Q[f].y)},pq.moveTo=function(){var Y=Array.prototype.slice.call(arguments);this.actions.push({action:Hp,args:Y})},pq.lineTo=function(t,J){var s=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,v=g[g.length-2],x=g[g.length-1],O=new on(new qq(v,x),new qq(t,J));this.curves.push(O),this.actions.push({action:Xq,args:s})},pq.quadraticCurveTo=function(u,L,A,m){var p=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args,G=k[k.length-2],i=k[k.length-1],v=new Eq(new qq(G,i),new qq(u,L),new qq(A,m));this.curves.push(v),this.actions.push({action:Up,args:p})},pq.bezierCurveTo=function(i,f,O,H,S,y){var D=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,G=h[h.length-2],K=h[h.length-1],l=new yj(new qq(G,K),new qq(i,f),new qq(O,H),new qq(S,y));this.curves.push(l),this.actions.push({action:ec,args:D})},pq.arc=function(C,$,j,p,S,Y){var t=this.actions[this.actions.length-1].args,E=t[t.length-2],h=t[t.length-1];this.absarc(C+E,$+h,j,p,S,Y)},pq.absarc=function(r,s,W,Y,Z,e){this.absellipse(r,s,W,W,Y,Z,e)},pq.ellipse=function(n,W,d,H,J,w,c){var A=this.actions[this.actions.length-1].args,F=A[A.length-2],g=A[A.length-1];this.absellipse(n+F,W+g,d,H,J,w,c)},pq.absellipse=function(t,j,U,T,V,Z,D){var y=Array.prototype.slice.call(arguments),k=new Vg(t,j,U,T,V,Z,D);this.curves.push(k);var u=k.getPoint(1);y.push(u.x),y.push(u.y),this.actions.push({action:ir,args:y})},pq.getSpacedPoints=function(k){k||(k=40);for(var P=[],s=0;k>s;s++)P.push(this.getPoint(s/k));return P},pq.getPoints=function(N,b){N=N||12;var f,e,V,d,w,E,l,q,I,P,D,m,K,$,O,c,R,U,A=[];for(f=0,e=this.actions.length;e>f;f++)switch(V=this.actions[f],d=V.action,w=V.args,d){case Hp:A.push(new qq(w[0],w[1]));break;case Xq:A.push(new qq(w[0],w[1]));break;case Up:for(E=w[2],l=w[3],P=w[0],D=w[1],A.length>0?($=A[A.length-1],m=$.x,K=$.y):($=this.actions[f-1].args,m=$[$.length-2],K=$[$.length-1]),O=1;N>=O;O++)c=O/N,R=Yj.b2(c,m,P,E),U=Yj.b2(c,K,D,l),A.push(new qq(R,U));break;case ec:for(E=w[4],l=w[5],P=w[0],D=w[1],q=w[2],I=w[3],A.length>0?($=A[A.length-1],m=$.x,K=$.y):($=this.actions[f-1].args,m=$[$.length-2],K=$[$.length-1]),O=1;N>=O;O++)c=O/N,R=Yj.b3(c,m,P,q,E),U=Yj.b3(c,K,D,I,l),A.push(new qq(R,U));break;case jo:var y,h=w[0],n=w[1],G=w[2],z=w[3],p=w[4],o=!!w[5],C=p-z,g=2*N;for(O=1;g>=O;O++)c=O/g,o||(c=1-c),y=z+c*C,R=h+G*v(y),U=n+G*Z(y),A.push(new qq(R,U));break;case ir:var y,h=w[0],n=w[1],J=w[2],_=w[3],z=w[4],p=w[5],o=!!w[6],C=p-z,g=2*N;for(O=1;g>=O;O++)c=O/g,o||(c=1-c),y=z+c*C,R=h+J*v(y),U=n+_*Z(y),A.push(new qq(R,U))}var Q=A[A.length-1],k=1e-10;return j(Q.x-A[0].x)<k&&j(Q.y-A[0].y)<k&&A.splice(A.length-1,1),b&&A.push(A[0]),A},pq.toShapes=function(S,F){function b(K){var d,e,B,w,n,q=[],S=new ih;for(d=0,e=K.length;e>d;d++)B=K[d],n=B.args,w=B.action,w==Hp&&0!=S.actions.length&&(q.push(S),S=new ih),S[w].apply(S,n);return 0!=S.actions.length&&q.push(S),q}function M(s){for(var i=[],F=0,K=s.length;K>F;F++){var b=s[F],f=new ek;f.actions=b.actions,f.curves=b.curves,i.push(f)}return i}function U(a,d){for(var h=1e-10,M=d.length,i=!1,V=M-1,H=0;M>H;V=H++){var k=d[V],S=d[H],u=S.x-k.x,l=S.y-k.y;if(j(l)>h){if(0>l&&(k=d[H],u=-u,S=d[V],l=-l),a.y<k.y||a.y>S.y)continue;if(a.y==k.y){if(a.x==k.x)return!0}else{var r=l*(a.x-k.x)-u*(a.y-k.y);if(0==r)return!0;if(0>r)continue;i=!i}}else{if(a.y!=k.y)continue;if(S.x<=a.x&&a.x<=k.x||k.x<=a.x&&a.x<=S.x)return!0}}return i}var Y=b(this.actions);if(0==Y.length)return[];if(F===!0)return M(Y);var u,a,D,f=[];if(1==Y.length)return a=Y[0],D=new ek,D.actions=a.actions,D.curves=a.curves,f.push(D),f;var N=!Yj.isClockWise(Y[0].getPoints());N=S?!N:N;var Q,m=[],V=[],E=[],$=0;V[$]=J,E[$]=[];var B,Z;for(B=0,Z=Y.length;Z>B;B++)a=Y[B],Q=a.getPoints(),u=Yj.isClockWise(Q),u=S?!u:u,u?(!N&&V[$]&&$++,V[$]={s:new ek,p:Q},V[$].s.actions=a.actions,V[$].s.curves=a.curves,N&&$++,E[$]=[]):E[$].push({h:a,p:Q[0]});if(!V[0])return M(Y);if(V.length>1){for(var y=!1,L=[],n=0,d=V.length;d>n;n++)m[n]=[];for(var n=0,d=V.length;d>n;n++){V[n];for(var W=E[n],H=0;H<W.length;H++){for(var p=W[H],O=!0,r=0;r<V.length;r++)U(p.p,V[r].p)&&(n!=r&&L.push({froms:n,tos:r,hole:H}),O?(O=!1,m[r].push(p)):y=!0);O&&m[n].push(p)}}L.length>0&&(y||(E=m))}var C,z,T;for(B=0,Z=V.length;Z>B;B++)for(D=V[B].s,f.push(D),C=E[B],z=0,T=C.length;T>z;z++)D.holes.push(C[z].h);return f};var ek=function(){ih.apply(this,arguments),this.holes=[]},ah=ek.prototype=$c(pq);ah.getPointsHoles=function(e){var t,r=this.holes.length,O=[];for(t=0;r>t;t++)O[t]=this.holes[t].getTransformedPoints(e);return O},ah.extractAllPoints=function(Y){return{shape:this.getTransformedPoints(Y),holes:this.getPointsHoles(Y)}},ah.extractPoints=function(b){return this.extractAllPoints(b)};var Yj={triangulateShape:function(f,q){function D(W,x,t){return W.x!=x.x?W.x<x.x?W.x<=t.x&&t.x<=x.x:x.x<=t.x&&t.x<=W.x:W.y<x.y?W.y<=t.y&&t.y<=x.y:x.y<=t.y&&t.y<=W.y}function B(q,e,k,y,u){var m=1e-10,K=e.x-q.x,g=e.y-q.y,Z=y.x-k.x,r=y.y-k.y,S=q.x-k.x,X=q.y-k.y,G=g*Z-K*r,L=g*S-K*X;if(j(G)>m){var d;if(G>0){if(0>L||L>G)return[];if(d=r*S-Z*X,0>d||d>G)return[]}else{if(L>0||G>L)return[];if(d=r*S-Z*X,d>0||G>d)return[]}if(0==d)return!u||0!=L&&L!=G?[q]:[];if(d==G)return!u||0!=L&&L!=G?[e]:[];if(0==L)return[k];if(L==G)return[y];var C=d/G;return[{x:q.x+C*K,y:q.y+C*g}]}if(0!=L||r*S!=Z*X)return[];var t=0==K&&0==g,U=0==Z&&0==r;if(t&&U)return q.x!=k.x||q.y!=k.y?[]:[q];if(t)return D(k,y,q)?[q]:[];if(U)return D(q,e,k)?[k]:[];var P,l,_,z,H,v,Q,h;return 0!=K?(q.x<e.x?(P=q,_=q.x,l=e,z=e.x):(P=e,_=e.x,l=q,z=q.x),k.x<y.x?(H=k,Q=k.x,v=y,h=y.x):(H=y,Q=y.x,v=k,h=k.x)):(q.y<e.y?(P=q,_=q.y,l=e,z=e.y):(P=e,_=e.y,l=q,z=q.y),k.y<y.y?(H=k,Q=k.y,v=y,h=y.y):(H=y,Q=y.y,v=k,h=k.y)),Q>=_?Q>z?[]:z==Q?u?[]:[H]:h>=z?[H,l]:[H,v]:_>h?[]:_==h?u?[]:[P]:h>=z?[P,l]:[P,v]}function W(t,H,d,q){var G=1e-10,C=H.x-t.x,b=H.y-t.y,V=d.x-t.x,F=d.y-t.y,v=q.x-t.x,I=q.y-t.y,m=C*F-b*V,s=C*I-b*v;if(j(m)>G){var l=v*F-I*V;return m>0?s>=0&&l>=0:s>=0||l>=0}return s>0}function H(r,o){function z(J,p){var O=k.length-1,B=J-1;0>B&&(B=O);var Q=J+1;Q>O&&(Q=0);var E=W(k[J],k[B],k[Q],i[p]);if(!E)return!1;var e=i.length-1,S=p-1;0>S&&(S=e);var a=p+1;return a>e&&(a=0),E=W(i[p],i[S],i[a],k[J]),E?!0:!1}function N(d,g){var q,_,t;for(q=0;q<k.length;q++)if(_=q+1,_%=k.length,t=B(d,g,k[q],k[_],!0),t.length>0)return!0;return!1}function p(f,G){var H,C,u,L,g;for(H=0;H<D.length;H++)for(C=o[D[H]],u=0;u<C.length;u++)if(L=u+1,L%=C.length,g=B(f,G,C[u],C[L],!0),g.length>0)return!0;return!1}for(var i,f,U,L,Y,y,s,e,n,C,K,k=r.concat(),D=[],w=[],_=0,j=o.length;j>_;_++)D.push(_);for(var H=0,t=2*D.length;D.length>0&&(t--,!(0>t));)for(U=H;U<k.length;U++){L=k[U],f=-1;for(var _=0;_<D.length;_++)if(y=D[_],s=L.x+":"+L.y+":"+y,w[s]===J){i=o[y];for(var x=0;x<i.length;x++)if(Y=i[x],z(U,x)&&!N(L,Y)&&!p(L,Y)){f=x,D.splice(_,1),e=k.slice(0,U+1),n=k.slice(U),C=i.slice(f),K=i.slice(0,f+1),k=e.concat(C).concat(K).concat(n),H=U;break}if(f>=0)break;w[s]=!0}if(f>=0)break}return k}for(var $,o,l,X,S,_,C={},M=f.concat(),K=0,u=q.length;u>K;K++)Array.prototype.push.apply(M,q[K]);for($=0,o=M.length;o>$;$++)S=M[$].x+":"+M[$].y,C[S]!==J,C[S]=$;var z=H(f,q),m=fe.Triangulate(z,!1);for($=0,o=m.length;o>$;$++)for(X=m[$],l=0;3>l;l++)S=X[l].x+":"+X[l].y,_=C[S],_!==J&&(X[l]=_);return m.concat()},isClockWise:function(g){return fe.Triangulate.area(g)<0},b2p0:function(n,E){var U=1-n;return U*U*E},b2p1:function(S,c){return 2*(1-S)*S*c},b2p2:function(m,t){return m*m*t},b2:function(j,Z,$,I){return this.b2p0(j,Z)+this.b2p1(j,$)+this.b2p2(j,I)},b3p0:function(T,O){var l=1-T;return l*l*l*O},b3p1:function(C,$){var X=1-C;return 3*X*X*C*$},b3p2:function(Y,s){var C=1-Y;return 3*C*Y*Y*s},b3p3:function(r,e){return r*r*r*e},b3:function(A,d,a,H,E){return this.b3p0(A,d)+this.b3p1(A,a)+this.b3p2(A,H)+this.b3p3(A,E)}},fe={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var j=r.keys(this.faces);return j.length?j[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(U){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(y){var p=y.familyName.toLowerCase(),U=this;return U.faces[p]=U.faces[p]||{},U.faces[p][y.cssFontWeight]=U.faces[p][y.cssFontWeight]||{},U.faces[p][y.cssFontWeight][y.cssFontStyle]=y,y},drawText:function(O){var C,H=this.getFace(),r=this.size/H.resolution,X=0,b=String(O).split(""),m=b.length,$=[];for(C=0;m>C;C++){var S=new ih,p=this.extractGlyphPoints(b[C],H,r,X,S);p&&(X+=p.offset*this.spacing,$.push(p.path))}var c=X/2;return{paths:$,offset:c}},extractGlyphPoints:function(i,g,D,_,q){var V,j,T,b,J,B,Q,w,y,F,H,z,I,u,x,c,k,M,Z,v=[],t=g.glyphs[i]||g.glyphs["?"];if(t){if(t.o)for(b=t._cachedOutline||(t._cachedOutline=t.o.split(" ")),B=b.length,Q=D,w=D,V=0;B>V;)switch(J=b[V++]){case"m":y=b[V++]*Q+_,F=b[V++]*w,q.moveTo(y,F);break;case"l":y=b[V++]*Q+_,F=b[V++]*w,q.lineTo(y,F);break;case"q":if(H=b[V++]*Q+_,z=b[V++]*w,x=b[V++]*Q+_,c=b[V++]*w,q.quadraticCurveTo(x,c,H,z),Z=v[v.length-1])for(I=Z.x,u=Z.y,j=1,T=this.divisions;T>=j;j++){var R=j/T;Yj.b2(R,I,x,H),Yj.b2(R,u,c,z)}break;case"b":if(H=b[V++]*Q+_,z=b[V++]*w,x=b[V++]*Q+_,c=b[V++]*w,k=b[V++]*Q+_,M=b[V++]*w,q.bezierCurveTo(x,c,k,M,H,z),Z=v[v.length-1])for(I=Z.x,u=Z.y,j=1,T=this.divisions;T>=j;j++){var R=j/T;Yj.b3(R,I,x,k,H),Yj.b3(R,u,c,M,z)}}return{offset:t.ha*D,path:q}}}};fe.generateShapes=function(O,j){j=j||{};var K=j.font;if(K===J&&(K=fe.getDefaultFont(),!K))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var y=j.size!==J?j.size:1,Y=j.curveSegments!==J?j.curveSegments:4,R=j.spacing!==J?j.spacing:1,W=j.weight!==J?j.weight:"normal",h=j.style!==J?j.style:"normal";fe.size=y,fe.divisions=Y,fe.face=K,fe.weight=W,fe.style=h,fe.spacing=R;for(var n=fe.drawText(O),C=n.paths,F=[],x=0,$=C.length;$>x;x++)Array.prototype.push.apply(F,C[x].toShapes());return F},function(m){var O=1e-10,A=function(z,m){var j=z.length;if(3>j)return null;var f,A,v,x=[],I=[],R=[];if(b(z)>0)for(A=0;j>A;A++)I[A]=A;else for(A=0;j>A;A++)I[A]=j-1-A;var M=j,C=2*M;for(A=M-1;M>2;){if(C--<=0)return m?R:x;if(f=A,f>=M&&(f=0),A=f+1,A>=M&&(A=0),v=A+1,v>=M&&(v=0),w(z,f,A,v,M,I)){var N,S,Z,g,T;for(N=I[f],S=I[A],Z=I[v],x.push([z[N],z[S],z[Z]]),R.push([I[f],I[A],I[v]]),g=A,T=A+1;M>T;g++,T++)I[g]=I[T];M--,C=2*M}}return m?R:x},b=function(u){for(var w=u.length,j=0,P=w-1,e=0;w>e;P=e++)j+=u[P].x*u[e].y-u[e].x*u[P].y;return.5*j},w=function(P,p,j,l,B,X){var J,S,I,u,N,e,Y,L,Q;if(S=P[X[p]].x,I=P[X[p]].y,u=P[X[j]].x,N=P[X[j]].y,e=P[X[l]].x,Y=P[X[l]].y,O>(u-S)*(Y-I)-(N-I)*(e-S))return!1;var c,C,g,G,z,D,f,R,$,k,V,i,T,s,t;for(c=e-u,C=Y-N,g=S-e,G=I-Y,z=u-S,D=N-I,J=0;B>J;J++)if(L=P[X[J]].x,Q=P[X[J]].y,!(L===S&&Q===I||L===u&&Q===N||L===e&&Q===Y)&&(f=L-S,R=Q-I,$=L-u,k=Q-N,V=L-e,i=Q-Y,t=c*k-C*$,T=z*R-D*f,s=g*i-G*V,t>=-O&&s>=-O&&T>=-O))return!1;return!0};return m.Triangulate=A,m.Triangulate.area=b,m}(fe),H._typeface_js={faces:fe.faces,loadFace:fe.loadFace};var Xf=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},dl=Xf.prototype={constructor:Xf,computeFaceNormals:function(){for(var H=new fl,Q=new fl,L=0,P=this.faces.length;P>L;L++){var y=this.faces[L],$=this.vertices[y.a],e=this.vertices[y.b],j=this.vertices[y.c];H.subVectors(j,e),Q.subVectors($,e),H.cross(Q),H.normalize(),y.normal.copy(H)}},computeVertexNormals:function(g){var p,T,f,C,N,t;for(t=new Array(this.vertices.length),p=0,T=this.vertices.length;T>p;p++)t[p]=new fl;if(g){var k,A,D,a=new fl,z=new fl;for(f=0,C=this.faces.length;C>f;f++)N=this.faces[f],k=this.vertices[N.a],A=this.vertices[N.b],D=this.vertices[N.c],a.subVectors(D,A),z.subVectors(k,A),a.cross(z),t[N.a].add(a),t[N.b].add(a),t[N.c].add(a)}else for(f=0,C=this.faces.length;C>f;f++)N=this.faces[f],t[N.a].add(N.normal),t[N.b].add(N.normal),t[N.c].add(N.normal);for(p=0,T=this.vertices.length;T>p;p++)t[p].normalize();for(f=0,C=this.faces.length;C>f;f++)N=this.faces[f],N.vertexNormals[0]=t[N.a].clone(),N.vertexNormals[1]=t[N.b].clone(),N.vertexNormals[2]=t[N.c].clone()},mergeVertices:function(){var R,A,d,Z,t,h,j,N,H={},m=[],o=[],O=4,K=D(10,O);for(d=0,Z=this.vertices.length;Z>d;d++)R=this.vertices[d],A=E(R.x*K)+"_"+E(R.y*K)+"_"+E(R.z*K),H[A]===J?(H[A]=d,m.push(this.vertices[d]),o[d]=m.length-1):o[d]=o[H[A]];var X=[];for(d=0,Z=this.faces.length;Z>d;d++){t=this.faces[d],t.a=o[t.a],t.b=o[t.b],t.c=o[t.c],h=[t.a,t.b,t.c];for(var q=0;3>q;q++)if(h[q]==h[(q+1)%3]){X.push(d);break}}for(d=X.length-1;d>=0;d--){var l=X[d];for(this.faces.splice(l,1),j=0,N=this.faceVertexUvs.length;N>j;j++)this.faceVertexUvs[j].splice(l,1)}var g=this.vertices.length-m.length;return this.vertices=m,g}},Vg=function($,J,e,A,E,T,Q){this.aX=$,this.aY=J,this.xRadius=e,this.yRadius=A,this.aStartAngle=E,this.aEndAngle=T,this.aClockwise=Q};Vg.prototype=$c(Ap),Vg.prototype.getPoint=function(q){var w,Y=this.aEndAngle-this.aStartAngle;0>Y&&(Y+=p),Y>p&&(Y-=p),w=this.aClockwise===!0?this.aEndAngle+(1-q)*(p-Y):this.aStartAngle+q*Y;var _=this.aX+this.xRadius*v(w),K=this.aY+this.yRadius*Z(w);return new qq(_,K)};var on=function(F,Q){this.v1=F,this.v2=Q},$d=on.prototype=$c(Ap);$d.getPoint=function(X){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(X).add(this.v1),e},$d.getPointAt=function(b){return this.getPoint(b)},$d.getTangent=function(){var Y=this.v2.clone().sub(this.v1);return Y.normalize()};var Eq=function(b,Y,u){this.v0=b,this.v1=Y,this.v2=u};Eq.prototype=$c(Ap),Eq.prototype.getPoint=function(i){var E,l;return E=Yj.b2(i,this.v0.x,this.v1.x,this.v2.x),l=Yj.b2(i,this.v0.y,this.v1.y,this.v2.y),new qq(E,l)};var yj=function(R,S,D,v){this.v0=R,this.v1=S,this.v2=D,this.v3=v};yj.prototype=$c(Ap),yj.prototype.getPoint=function(d){var f,u;return f=Yj.b3(d,this.v0.x,this.v1.x,this.v2.x,this.v3.x),u=Yj.b3(d,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new qq(f,u)},Gc.create(function(J,u){this.v1=J,this.v2=u},function(P){var J=new fl;return J.subVectors(this.v2,this.v1),J.multiplyScalar(P),J.add(this.v1),J});var Ll=Gc.create(function(a,N,E){this.v0=a,this.v1=N,this.v2=E},function(G){var k,m,H;return k=Yj.b2(G,this.v0.x,this.v1.x,this.v2.x),m=Yj.b2(G,this.v0.y,this.v1.y,this.v2.y),H=Yj.b2(G,this.v0.z,this.v1.z,this.v2.z),new fl(k,m,H)}),fr=Gc.create(function(c,y,u,D){this.v0=c,this.v1=y,this.v2=u,this.v3=D},function(T){var E,H,u;return E=Yj.b3(T,this.v0.x,this.v1.x,this.v2.x,this.v3.x),H=Yj.b3(T,this.v0.y,this.v1.y,this.v2.y,this.v3.y),u=Yj.b3(T,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new fl(E,H,u)}),cs=function(c,s,E,G,R,d,F,r){Xf.call(this),G=G!==J?G:.5,R=R!==J?R:.5,r=r!==J?r:1,c=c||8,d=d||0,F=F||p;var m,S,Y=1,I=r/2,e=[],$=[],U=this.vertices,Q=this.faces,k=this.faceVertexUvs;for(S=0;Y>=S;S++){var x=[],X=[],u=S/Y,V=u*(R-G)+G;for(m=0;c>=m;m++){var i=m/c,g=new fl,y=-(i*F+d);g.z=V*Z(y),g.y=-u*r+I,g.x=V*v(y),U.push(g),x.push(U.length-1),X.push(new qq(i,u))}e.push(x),$.push(X)}var K,n,l=(R-G)/r;for(m=0;c>m;m++)for(0!==G?(K=U[e[0][m]].clone(),n=U[e[0][m+1]].clone()):(K=U[e[1][m]].clone(),n=U[e[1][m+1]].clone()),K.setY(w(K.x*K.x+K.z*K.z)*l).normalize(),n.setY(w(n.x*n.x+n.z*n.z)*l).normalize(),S=0;Y>S;S++){var q=e[S][m],A=e[S+1][m],P=e[S+1][m+1],B=e[S][m+1],f=K.clone(),b=K.clone(),H=n.clone(),h=n.clone(),t=$[S][m].clone(),C=$[S+1][m].clone(),z=$[S+1][m+1].clone(),D=$[S][m+1].clone();Q.push(new mj(q,A,B,[f,b,h])),k[0].push([t,C,D]),Q.push(new mj(A,P,B,[b.clone(),H,h.clone()])),k[0].push([C.clone(),z,D.clone()])}if(s&&G>0)for(this.vertices.push(new fl(0,I,0)),m=0;c>m;m++){var q=e[0][m],A=e[0][m+1],P=this.vertices.length-1,f=new fl(0,1,0),b=new fl(0,1,0),H=new fl(0,1,0),t=$[0][m].clone(),C=$[0][m+1].clone(),z=new qq(C.x,0);Q.push(new mj(q,A,P,[f,b,H],null,1));var T=m/c*p,L=v(T),W=Z(T),j=(m+1)/c*p,a=v(j),O=Z(j);k[0].push([new qq(.5+.5*L,.5+.5*W),new qq(.5+.5*a,.5+.5*O),new qq(.5,.5)])}if(E&&R>0)for(this.vertices.push(new fl(0,-I,0)),m=0;c>m;m++){var q=e[S][m+1],A=e[S][m],P=U.length-1,f=new fl(0,-1,0),b=new fl(0,-1,0),H=new fl(0,-1,0),t=$[S][m+1].clone(),C=$[S][m].clone();Q.push(new mj(q,A,P,[f,b,H],null,2));var T=m/c*p,L=v(T),W=Z(T),j=(m+1)/c*p,a=v(j),O=Z(j);k[0].push([new qq(.5+.5*a,.5-.5*O),new qq(.5+.5*L,.5-.5*W),new qq(.5,.5)])}};cs.prototype=$c(dl);var An=function(m,f,k,y,C,i,z){Xf.call(this),z=z||.5,m=m||16,f=f||16,k=(k!==J?k:0)-M,y=y!==J?y:p,C=C!==J?C:0,i=i!==J?i:M;var X,U,V=[],g=[],N=this.vertices,h=this.faces,D=this.faceVertexUvs;for(U=0;f>=U;U++){var l=[],c=[];for(X=0;m>=X;X++){var O=X/m,x=U/f,R=new fl;R.x=-z*v(k+O*y)*Z(C+x*i),R.y=z*v(C+x*i),R.z=z*Z(k+O*y)*Z(C+x*i),N.push(R),l.push(N.length-1),c.push(new qq(O,x))}V.push(l),g.push(c)}for(U=0;f>U;U++)for(X=0;m>X;X++){var I=V[U][X+1],s=V[U][X],E=V[U+1][X],A=V[U+1][X+1],L=N[I].clone().normalize(),B=N[s].clone().normalize(),K=N[E].clone().normalize(),Q=N[A].clone().normalize(),d=g[U][X+1].clone(),T=g[U][X].clone(),a=g[U+1][X].clone(),H=g[U+1][X+1].clone();j(N[I].y)===z?(d.x=(d.x+T.x)/2,h.push(new mj(I,E,A,[L,K,Q])),D[0].push([d,a,H])):j(N[E].y)===z?(a.x=(a.x+H.x)/2,h.push(new mj(I,s,E,[L,B,K])),D[0].push([d,T,a])):(h.push(new mj(I,s,A,[L,B,Q])),D[0].push([d,T,H]),h.push(new mj(s,E,A,[B.clone(),K,Q.clone()])),D[0].push([T.clone(),a,H.clone()]))}};An.prototype=$c(dl);var zp=function(g,h,k,l,b,o){Xf.call(this),g=g||.33,h=h||.17,l=l||8,k=k||6,b=b||0,o=o||p;for(var R=new fl,F=[],Q=[],B=0;l>=B;B++)for(var f=B/l*p+M,e=0;k>=e;e++){var O=e/k*o+b;R.x=g*v(O),R.z=-g*Z(O);var I=new fl,c=g+h*v(f);I.x=c*v(O),I.z=-c*Z(O),I.y=h*Z(f),this.vertices.push(I),F.push(new qq(e/k,1-B/l)),Q.push(I.clone().sub(R).normalize())}for(var B=1;l>=B;B++)for(var e=1;k>=e;e++){var D=(k+1)*B+e-1,i=(k+1)*(B-1)+e-1,E=(k+1)*(B-1)+e,W=(k+1)*B+e,y=new mj(D,i,W,[Q[D].clone(),Q[i].clone(),Q[W].clone()]);this.faces.push(y),this.faceVertexUvs[0].push([F[D].clone(),F[i].clone(),F[W].clone()]),y=new mj(i,E,W,[Q[i].clone(),Q[E].clone(),Q[W].clone()]),this.faces.push(y),this.faceVertexUvs[0].push([F[i].clone(),F[E].clone(),F[W].clone()])}this.computeFaceNormals()};zp.prototype=$c(dl);var lh=function(u,U,i){return u?(Xf.call(this),u=u instanceof Array?u:[u],this.addShapeList(u,U),U.convertYZ!==!1&&Xi(this,i),this.computeFaceNormals(),void 0):(u=[],void 0)},Ld=lh.prototype=$c(Xf.prototype);Ld.addShapeList=function(U,K){for(var V=U.length,v=0;V>v;v++){var I=U[v];this.addShape(I,K)}},Ld.addShape=function(k,e){function T(){if(e.bottom)for(var R=0;B>R;R++)c=z[R],Y(c[2],c[1],c[0],!0);if(e.top)for(R=0;B>R;R++)c=z[R],Y(c[0]+u*j,c[1]+u*j,c[2]+u*j,!1)}function x(){var p=0;for(H(S,p),p+=S.length,O=0,d=L.length;d>O;O++)b=L[O],H(b,p),p+=b.length}function H(o,S){for(var y,b,J=o.length;--J>=0;){y=J,b=J-1,0>b&&(b=o.length-1);var A=0,h=j;for(A=0;h>A;A++){var x=u*A,I=u*(A+1),L=S+y+x,_=S+b+x,p=S+b+I,d=S+y+I;M(L,_,p,d,o,A,h,y,b)}}}function t(s,a,C){Z.vertices.push(new fl(s,a,C))}function Y(O,S,u,V){O+=P,S+=P,u+=P,Z.faces.push(new mj(O,S,u,null,null,V?2:1));var _=V?n.generateBottomUV(Z,k,e,O,S,u):n.generateTopUV(Z,k,e,O,S,u);Z.faceVertexUvs[0].push(_)}function M(t,z,a,c,F,h,E,m,_){t+=P,z+=P,a+=P,c+=P,Z.faces.push(new mj(t,z,c)),Z.faces.push(new mj(z,a,c));var j=n.generateSideWallUV(Z,k,F,e,t,z,a,c,h,E,m,_);Z.faceVertexUvs[0].push([j[0],j[1],j[3]]),Z.faceVertexUvs[0].push([j[1],j[2],j[3]])}var _,m,r,Q,v,W=e.amount,y=e.curveSegments||wm,j=e.steps||1,f=e.extrudePath,F=!1,n=new qc(e.repeatUVLength);f&&(_=f.getSpacedPoints(j),F=!0,m=e.frames!==J?e.frames:new eh.FrenetFrames(f,j,!1),r=new fl,Q=new fl,v=new fl);var b,O,d,Z=this,P=this.vertices.length,K=k.extractPoints(y),h=K.shape,L=K.holes,N=!Yj.isClockWise(h);if(N){for(h=h.reverse(),O=0,d=L.length;d>O;O++)b=L[O],Yj.isClockWise(b)&&(L[O]=b.reverse());N=!1}var z=Yj.triangulateShape(h,L),S=h;for(O=0,d=L.length;d>O;O++)b=L[O],h=h.concat(b);for(var E,c,u=h.length,B=z.length,l=0;u>l;l++)E=h[l],F?(Q.copy(m.normals[0]).multiplyScalar(E.x),r.copy(m.binormals[0]).multiplyScalar(E.y),v.copy(_[0]).add(Q).add(r),t(v.x,v.y,v.z)):t(E.x,E.y,0);var i;for(i=1;j>=i;i++)for(l=0;u>l;l++)E=h[l],F?(Q.copy(m.normals[i]).multiplyScalar(E.x),r.copy(m.binormals[i]).multiplyScalar(E.y),v.copy(_[i]).add(Q).add(r),t(v.x,v.y,v.z)):t(E.x,E.y,W/j*i);T(),x()};var eh=function(O,e,N,r,n){function G(o,H,c){return K.vertices.push(new fl(o,H,c))-1}Xf.call(this),e=e||64,N=N||1,r=r||8,n=n||!1;var D,A,W,L,d,z,E,C,h,w,V,$,c,m,I,j,J,S,P,b,s=[],K=this,u=e+1,U=new fl,k=new eh.FrenetFrames(O,e,n),t=k.tangents,B=k.normals,o=k.binormals;for(this.tangents=t,this.normals=B,this.binormals=o,h=0;u>h;h++)for(s[h]=[],L=h/(u-1),C=O.getPointAt(L),D=t[h],A=B[h],W=o[h],w=0;r>w;w++)d=w/r*p,z=-N*v(d),E=N*Z(d),U.copy(C),U.x+=z*A.x+E*W.x,U.y+=z*A.y+E*W.y,U.z+=z*A.z+E*W.z,s[h][w]=G(U.x,U.y,U.z);for(h=0;e>h;h++)for(w=0;r>w;w++)V=n?(h+1)%e:h+1,$=(w+1)%r,c=s[h][w],m=s[V][w],I=s[V][$],j=s[h][$],J=new qq(h/e,w/r),S=new qq((h+1)/e,w/r),P=new qq((h+1)/e,(w+1)/r),b=new qq(h/e,(w+1)/r),this.faces.push(new mj(c,m,j)),this.faceVertexUvs[0].push([J,S,b]),this.faces.push(new mj(m,I,j)),this.faceVertexUvs[0].push([S.clone(),P,b.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};eh.prototype=$c(dl),eh.FrenetFrames=function(T,d,l){function _(){S[0]=new fl,B[0]=new fl,Z=Number.MAX_VALUE,N=j(J[0].x),V=j(J[0].y),i=j(J[0].z),Z>=N&&(Z=N,h.set(1,0,0)),Z>=V&&(Z=V,h.set(0,1,0)),Z>=i&&h.set(0,0,1),n.crossVectors(J[0],h).normalize(),S[0].crossVectors(J[0],n),B[0].crossVectors(J[0],S[0])}var O,Z,N,V,i,R,E,h=new fl,J=[],S=[],B=[],n=new fl,P=new Fe,y=d+1,e=1e-4;for(this.tangents=J,this.normals=S,this.binormals=B,R=0;y>R;R++)E=R/(y-1),J[R]=T.getTangentAt(E),J[R].normalize();for(_(),R=1;y>R;R++)S[R]=S[R-1].clone(),B[R]=B[R-1].clone(),n.crossVectors(J[R-1],J[R]),n.length()>e&&(n.normalize(),O=X(Lf(J[R-1].dot(J[R]),-1,1)),S[R].applyMatrix4(P.makeRotationAxis(n,O))),B[R].crossVectors(J[R],S[R]);if(l)for(O=X(Lf(S[0].dot(S[y-1]),-1,1)),O/=y-1,J[0].dot(n.crossVectors(S[0],S[y-1]))>0&&(O=-O),R=1;y>R;R++)S[R].applyMatrix4(P.makeRotationAxis(J[R],O*R)),B[R].crossVectors(J[R],S[R])};var qd=function(K,w,A,a){Xf.call(this),w=w||18,A=A||0,a=a==d?p:a;for(var l=1/(K.length-1),O=1/w,C=0,c=w;c>=C;C++)for(var Y=A+C*O*a,S=v(Y),Q=Z(Y),s=0,U=K.length;U>s;s++){var k=K[s],T=new fl;T.x=S*k.x-Q*k.y,T.y=Q*k.x+S*k.y,T.z=k.z,this.vertices.push(T)}for(var E=K.length,C=0,c=w;c>C;C++)for(var s=0,U=K.length-1;U>s;s++){var f=s+E*C,W=f,F=f+E,S=f+1+E,h=f+1,r=C*O,i=s*l,e=r+O,y=i+l;this.faces.push(new mj(W,h,F)),this.faceVertexUvs[0].push([new qq(r,i),new qq(r,y),new qq(e,i)]),this.faces.push(new mj(F,h,S)),this.faceVertexUvs[0].push([new qq(e,i),new qq(r,y),new qq(e,y)])}this.mergeVertices(),Xi(this),this.computeFaceNormals(),this.computeVertexNormals()};qd.prototype=$c(dl);var wi=function(y,W){W=W||{};var e=fe.generateShapes(y,W);W.amount=W.amount!==J?W.amount:.5,W.convertYZ=!1,W.fill!==!1&&(W.bottom=!0,W.top=!0),lh.call(this,e,W)};wi.prototype=$c(Ld);var wb=P.Node=function(){ii(wb,this)},dn={X:bl,Y:Mo,Z:fg},zg={X:0,Y:1,Z:2},Dg={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Pi="xzy",jl=function(C,U,o){if(U){var i=U[0],m=U[1],t=U[2];"xzy"===o?(Mo(C,m),fg(C,t),bl(C,i)):"xyz"===o?(fg(C,t),Mo(C,m),bl(C,i)):"yxz"===o?(fg(C,t),bl(C,i),Mo(C,m)):"yzx"===o?(bl(C,i),fg(C,t),Mo(C,m)):"zxy"===o?(Mo(C,m),bl(C,i),fg(C,t)):"zyx"===o?(bl(C,i),Mo(C,m),fg(C,t)):(Mo(C,m),fg(C,t),bl(C,i))}};as("Node",Oc,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Pi,_64O:0,_rotationX:0,_53O:0,_host:d,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return he},_22Q:function(){return Zc},getX:function(){return this.p().x},setX:function(D){this.p(D,this.p().y)},getY:function(){return this.p().y},setY:function(k){this.p(this.p().x,k)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(J){this.setAnchor(J,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(T){this.setAnchor(this.getAnchor().x,T)},getScaleX:function(){return this.getScale().x},setScaleX:function(f){this.setScale(f,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(t){this.setScale(this.getScale().x,t)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(j,W){gr(j,ip(d,d,this.r3(),this.getRotationMode())),this.translate3d(j[0]*W,j[1]*W,j[2]*W)},translateFront:function(X){this.translate3dBy([0,0,1],X)},translateBack:function(q){this.translate3dBy([0,0,-1],q)},translateLeft:function(k){this.translate3dBy([-1,0,0],k)},translateRight:function(I){this.translate3dBy([1,0,0],I)},translateTop:function(E){this.translate3dBy([0,1,0],E)},translateBottom:function(o){this.translate3dBy([0,-1,0],o)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(Q,A,v){1===arguments.length&&(A=Q[1],v=Q[2],Q=Q[0]),this.p(Q,v),this.setElevation(A)},translate3d:function(x,C,y){1===arguments.length&&(C=x[1],y=x[2],x=x[0]),this.translate(x,y),this.setElevation(this._54O+C)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(c,y,V){1===arguments.length&&(y=c[1],V=c[2],c=c[0]),this.setSize(c,V),this.setTall(y)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(I,Z,A){1===arguments.length&&(Z=I[1],A=I[2],I=I[0]),this.setRotationX(I),this.setRotation(-Z),this.setRotationZ(A)},setRotationY:function(L){this.setRotation(-L)},getRotationY:function(){return-this._64O},lookAtDirection:function(G,w){w=w||Sg;var g=this,Y=jc(G);w===Sg?(g.r3([-O(G[1]/Y),-k(G[2],G[0])+L,0]),g.setRotationMode("xzy")):w===_i?(g.r3(0,-k(G[2],G[0]),O(G[1]/Y)),g.setRotationMode("zyx")):w===Km?(g.r3(0,-k(G[2],G[0])+M,-O(G[1]/Y)),g.setRotationMode("zyx")):w===ai?(g.r3([-O(G[1]/Y)+L,-k(G[2],G[0])+L,0]),g.setRotationMode("xzy")):w===el&&(g.r3([-O(G[1]/Y)-L,-k(G[2],G[0])+L,0]),g.setRotationMode("xzy")),w===sl&&(g.r3([-O(G[1]/Y)+M,-k(G[2],G[0])+L,M]),g.setRotationMode("zxy"))},lookAt:function(o,C){return this.lookAtDirection(Te(o,this.p3()),C)},lookAtX:function(){var X=new On,g=new On,T=new On,_=new vk,S=new vk,Q=new Ak;return function(v,V){var e=Ti(this);_.fromArray(e),T.copy(this.p3()),X.copy(v).sub(T).normalize(),V===Sg?g.set(0,0,1):V===sl?g.set(0,0,-1):V===Km?g.set(-1,0,0):V===_i?g.set(1,0,0):V===ai?g.set(0,1,0):V===el&&g.set(0,-1,0),g.applyMatrix4(_).sub(T).normalize();var W=Math.acos(X.dot(g));if(W){var l=X.clone().cross(g).normalize();Q.set(this.r3(),this.getRotationMode(),!0),_.makeRotationFromEuler(Q),S.makeRotationAxis(l,-W),Q.setFromRotationMatrix(S.multiply(_)),this.r3([Q.x,Q.y,Q.z])}}}(),getHost:function(){return this._host},setHost:function(U){var i=this;if(i!==U&&i._host!==U){var w=i._host;w&&w._removeAttach(i),i._host=U,i._host&&i._host._addAttach(i),i.fp("host",w,U),i.onHostChanged(w,U)}},getAttaches:function(){return this._69O},_addAttach:function(s){var K=this;K._69O||(K._69O=new nm),K._69O.add(s),K.fp("attaches",d,s)},_removeAttach:function(n){var Y=this;Y._69O.remove(n),Y._69O.isEmpty()&&delete Y._69O,Y.fp("attaches",n,d)},getImage:function(){if(this._pendingCheckImageJSON){var L=F.getImage(this._image);L&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof ke&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(n){var e=this,B=e._image,L=e.getWidth(),p=e.getHeight();e._image=n,e.fp("image",B,n)&&(null!=n&&(yl(n)||Jp(n)&&/\.json$/i.test(n))&&(this._pendingCheckImageJSON=!0),e.fp(ib,L,e.getWidth()),e.fp(Kq,p,e.getHeight()))},getElevation:function(){return this._54O},setElevation:function(p){var w=this;if(!w._50O){w._50O=1;var A=w._54O;w._54O=p,w.fp(jm,A,p),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(f){var b=this;if(!b._49O){b._49O=1;var z=b._64O;b._64O=f,b.fp(wj,z,f),delete b._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(x){var F=this;if(!F._51O){F._51O=1;var s=F._rotationX;F._rotationX=x,F.fp("rotationX",s,x),delete F._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(o){var z=this;if(!z._52O){z._52O=1;var M=z._53O;z._53O=o,z.fp("rotationZ",M,o),delete z._52O}},getPosition:function(){return this._position},setPosition:function(l,Z){var O=this;if(!O._50I){O._50I=1;var M;if(M=2===arguments.length?{x:l,y:Z}:l,M.x!==O._position.x||M.y!==O._position.y){var t=O._position;O._position=M,O.fp(Or,t,M)}delete O._50I}},translate:function(T,Y){var x=this._position;this.p(x.x+T,x.y+Y)},getWidth:function(){var A=this;if(A._width>=0)return A._width;var V=A.getStyle("shape3d");if(V){var s=Ug(V);if(s&&s.rawS3)return s.rawS3[0];if("billboard"===V||"plane"===V){var P=Hf(A.getStyle("shape3d.image"));return P?li(P,A):20}}var P=Hf(A._image);return P?li(P,A):20},setWidth:function(B){var Y=this,q=Y._width;Y._width=B,Y.fp(ib,q,B)},getHeight:function(){var j=this;if(j._height>=0)return j._height;var K=j.getStyle("shape3d");if(K){var $=Ug(K);if($&&$.rawS3)return $.rawS3[2];if("plane"===K){var C=Hf(j.getStyle("shape3d.image"));return C?Kn(C,j):20}if("billboard"===K)return 2}var C=Hf(j._image);return C?Kn(C,j):20},setHeight:function(k){var z=this,F=z._height;z._height=k,z.fp(Kq,F,k)},getTall:function(){var k=this;if(k._tall>=0)return k._tall;var U=k.getStyle("shape3d");if(U){var d=Ug(U);if(d&&d.rawS3)return d.rawS3[1];if("billboard"===U){var n=Hf(k.getStyle("shape3d.image"));return n?Kn(n,k):20}if("plane"===U)return 2}return 20},setTall:function(L){var n=this,C=n._tall;n._tall=L,n.fp("tall",C,L)},setSize:function(x,t){var g=this;2===arguments.length?(g.setWidth(x),g.setHeight(t)):(g.setWidth(x.width),g.setHeight(x.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(D,g,b,h,A){var c=this,t=c.getAnchor(),l=c.getScale();arguments.length<=2&&(A=g,g=D.y,b=D.width,h=D.height,D=D.x);var T=A&&l.x<0?1-t.x:t.x,V=A&&l.y<0?1-t.y:t.y;c.p(D+b*T,g+h*V),A&&(b/=Math.abs(l.x),h/=Math.abs(l.y)),c.setWidth(b),c.setHeight(h)},getMatrix:function(){var b=this,Q=b._64O,O=b._position,U=b.getScale();return new Vr(Q,O.x,O.y,U.x,U.y)},getAnchorRect:function(){var L=this,F=L.getWidth(),h=L.getHeight(),i=L.getAnchor();return{x:-F*i.x,y:-h*i.y,width:F,height:h}},toLocal:function(R){return this.getMatrix().tfi(R)},toGlobal:function(x){return this.getMatrix().tf(x)},getAttachPosition:function(){var d=new Vr;return function(K,X,R,M){R=R||0,M=M||0;var j=this,x=j.getAnchor(),m=j._64O,T=j._position,Y=j.getScale();return d.setFromTransform(m,T.x,T.y).tf({x:R+Y.x*j.getWidth()*(K-x.x),y:M+Y.y*j.getHeight()*(X-x.y)})}}(),isInRect:function(c){c=this.toLocal(c);var i=this.getWidth(),D=this.getHeight();return c.x+=i*this.getAnchorX(),c.y+=D*this.getAnchorY(),!(c.x<0||c.y<0||c.x>i||c.y>D)},getRect:function(){var o=this,W=o.getWidth(),Y=o.getHeight(),r=o.getAnchor(),w={x:-W*r.x,y:-Y*r.y,width:W,height:Y},k=o.getMatrix();return w=io([k.tf(w.x,w.y),k.tf(w.x+w.width,w.y),k.tf(w.x+w.width,w.y+w.height),k.tf(w.x,w.y+w.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var c=this,V=c.getAnchor(),y=c._anchorElevation;return{x:V.x,y:y,z:V.y}},setAnchorElevation:function(g){var Q=this,F=Q._anchorElevation;
return F!==g?(Q._anchorElevation=g,Q.fp("anchorElevation",F,g),!0):!1},setAnchor3d:function(Q,C,J,q){var P,H=this;"number"==typeof Q?P={x:Q,y:C,z:J}:(P=Q.length?{x:Q[0],y:Q[1],z:Q[2]}:Q,q=C);var z=H.getDataModel();z&&z.beginTransaction();var n=H.getAnchor3d(),Y=H.setAnchor(P.x,P.z);if(H.setAnchorElevation(P.y)&&(Y=!0),Y&&q&&!$m){H.getAnchor3d();var o=Ti(H),e=gr([P.x-n.x,P.y-n.y,P.z-n.z],o);H.p3(e)}return z&&z.endTransaction(),Y},getAnchor:function(){var g=this;if(g.hasOwnProperty("_anchor"))return g._anchor;var C=Hf(g._image);return C&&C.anchorX!==J?{x:C.anchorX,y:C.anchorY}:g._anchor},setAnchor:function(I,V,J){var $,B=this;"number"==typeof I?$={x:I,y:V}:($=I.length?{x:I[0],y:I[1]}:I,J=V);var F=B.getAnchor();if(F.x!==$.x||F.y!==$.y){var Y=B.getDataModel();if(Y&&Y.beginTransaction(),B._anchor=$,B.fp("anchor",F,$),J&&!$m){var S=B.getPosition(),r=B.getSize(),f=B.getRotation(),h=B.getScale(),l=-r.width*(F.x-$.x)*h.x,d=-r.height*(F.y-$.y)*h.y,K=Z(f),E=v(f);B.setPosition(S.x+E*l-K*d,S.y+K*l+E*d)}return Y&&Y.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(I,N){var x,O=this;x=2===arguments.length?{x:I,y:N}:I;var d=O.getScale();(d.x!==x.x||d.y!==x.y)&&(O._scale=x,O.fp("scale",d,x))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var z=this,L=z._scaleTall,C=z.getScale();return[C.x,L,C.y]},getFinalScale3d:function(){var P=this,X=P.s3(),O=P._dynamicScale3d,f=P.getScale3d();return X&&(f[0]*=X[0],f[1]*=X[1],f[2]*=X[2]),O&&(f[0]*=O[0],f[1]*=O[1],f[2]*=O[2]),f},getFinalRotation3d:function(){var Y=this;return Y._dynamicRotation||Y.r3()},setScaleTall:function(Z){var O=this,T=O._scaleTall;T!==Z&&(O._scaleTall=Z,O.fp("scaleTall",T,Z))},setScale3d:function(J,c,V){var Z,N=this;Z="number"==typeof J?{x:J,y:c,z:V}:J.length?{x:J[0],y:J[1],z:J[2]}:J,N.setScaleTall(Z.y),N.setScale(Z.x,Z.z)},getCorners:function(G,v){G==d&&(G=0),v==d&&(v=G);var w=this,a=w.getAnchor(),V=w.getWidth(),P=w.getHeight(),B=-V*a.x-G,$=-P*a.y-v,N=V+2*G,z=P+2*v,r=w.getMatrix();return[r.tf(B,$),r.tf(B,$+z),r.tf(B+N,$+z),r.tf(B+N,$)]},getEditControlPoints:function(G,F,t){F==d&&(F=0),t==d&&(t=F);var W=this,Q=W.getAnchor(),E=W.getWidth(),C=W.getHeight(),M=-E*Q.x-F,I=-C*Q.y-t,e=E+2*F,g=C+2*t;if(G)return[{x:M,y:I},{x:M,y:0},{x:M,y:I+g},{x:0,y:I+g},{x:M+e,y:I+g},{x:M+e,y:0},{x:M+e,y:I},{x:0,y:I}];var D=W.getMatrix();return[D.tf(M,I),D.tf(M,0),D.tf(M,I+g),D.tf(0,I+g),D.tf(M+e,I+g),D.tf(M+e,0),D.tf(M+e,I),D.tf(0,I)]},rotateAt:function(X,g,u){var c=this,N=c._position,R=c._64O,T=new Vr(R,N.x,N.y).tf(X,g),d=w(X*X+g*g),U=k(N.y-T.y,N.x-T.x)+u;c.setRotation(R+u),c.p(T.x+d*v(U),T.y+d*Z(U))},onParentChanged:function(){wb.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var W={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(U){W[U]=!0}),function(i){var R=this;wb.superClass.onPropertyChanged.call(R,i),W[i.property]&&!R._layoutUpdating&&R.updateLayoutParameters(null,i.property),R._69O&&R._69O.each(function(x){x.handleHostPropertyChange(i)}),R._49I&&R._49I.each(function(J){J.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(K){this.updateAttach(K)},onStyleChanged:function(r){wb.superClass.onStyleChanged.apply(this,arguments),wq[r]&&this.updateAttach()},updateAttach:function(M){var l=this;return $m?(l.updateLayoutParameters(),void 0):(l._51I||(l._51I=1,l._71O(M),delete l._51I),void 0)},_71O:function(w){var D,e,p,v,I,C,g=this,K=g._host,j=w?w.property:d,A=w?w.oldValue:d,M=w?w.newValue:d;if(K instanceof P.Grid){if(j===jm)g.setElevation(g._54O+M-A);else if(!w||gd[j]){if(D=g.s("attach.row.index"),e=g.s("attach.column.index"),p=K.getCellRect(D,e),!p)return;v=g.s("attach.row.span"),I=g.s("attach.column.span"),(1!==v||1!==I)&&(p=kr(p,K.getCellRect(D+v-1,e+I-1))),ic(p,g,"attach.padding",1),g.setRect(p)}}else if(K instanceof cf&&(C=g.s("attach.index"))>=0&&(!w||Fl[j])){var L=g.s("attach.thickness");L!=d&&g.setHeight(K.getThickness()*L);var N=g.s("attach.offset"),H=K.getPoints(),$=H.size();if($>C){var t=H.get(C),S=$===C+1?H.get(0):H.get(C+1),y=[S.x-t.x,S.y-t.y],_=jc(y);if(_){g.s("attach.offset.relative")&&(N*=_),g.s("attach.offset.opposite")&&(N=_-N);var V={x:t.x+y[0]/_*N,y:t.y+y[1]/_*N},h=g.s("attach.gap");h&&(g.s("attach.gap.relative")&&(h*=K.getThickness()),V=yq(d,V,S,h)),g.p(V),g.setRotation(k(y[1],y[0]))}}}else w&&(j===Or?g.translate(M.x-A.x,M.y-A.y):j===jm?g.setElevation(g._54O+M-A):yi[j]?g._11Q(K,j,M-A):("anchor"===j||"width"===j||"height"===j||"scale"===j)&&g.layout(K))},_11Q:function(){var F=new P.Math.Euler,W=P.Math.Euler.ReverseOrder,r=new P.Math.Vector2,a=new P.Math.Vector2;return function(N,T,E){var j=this,R=N.p3(),o=N.r3(),B=j.p3(),f=j.r3();if(T===wj&&(T="rotationY",E=-E),(T===wj||"rotationY"===T)&&0===f[0]&&0===f[2]&&0===o[0]&&0===o[2]&&0===B[1]&&0===R[1])return j.setRotation(-f[1]-E),r.set(B[0],B[2]).rotateAround(a.set(R[0],R[2]),-E),j.p(r.x,r.y),void 0;var z=Dg[N.getRotationMode()],m=z[0],J=z[1],C=z[2],x=dn[m],V=dn[J],u=dn[C],e=ys();T===wj+m?(u(e,o[zg[C]]),V(e,o[zg[J]]),x(e,E),V(e,-o[zg[J]]),u(e,-o[zg[C]])):T===wj+J?(u(e,o[zg[C]]),V(e,E),u(e,-o[zg[C]])):T===wj+C&&u(e,E);var w=Te(B,R);gr(w,e),j.p3(R[0]+w[0],R[1]+w[1],R[2]+w[2]);var h=j.getRotationMode();jl(e,j.r3(),h),F.setFromRotationMatrix(e,W(h)),j.r3([F.x,F.y,F.z])}}(),isHostOn:function($){var C=this;if(C._host&&$&&$._69O)for(var D={},z=C._host;z&&z!==C&&!D[z._id];){if(z===$)return!0;D[z._id]=z,z=z._host}return!1},isLoopedHostOn:function(R){return this.isHostOn(R)&&R.isHostOn(this)},getScaledSize:function(){var D=this.getSize(),F=this.getScale();return D.width*=Math.abs(F.x),D.height*=Math.abs(F.y),D},layout:function(N){if(N=N||this.getHost()){var f=this,U=f.s("layout.h")||"center",F=f.s("layout.v")||"center";if("center"!==U||"center"!==F){var g=new P.Math.Vector2,b=N.getPosition(),d=N.getAnchor(),E=N.getScaledSize();f.getPosition();var p,R,T,K,q,G=1,I=1;switch(f._layoutUpdating=!0,U){case"left":g.setX(f._layoutHValue-d.x*E.width);break;case"right":g.setX((1-d.x)*E.width-f._layoutHValue);break;case"leftright":p=E.width-f._layoutHValue[2],T=f.getRotation()-N.getRotation(),K=Math.abs(Math.sin(T)),q=Math.abs(Math.cos(T)),G+=q*p/f._layoutHValue[3],I+=K*p/f._layoutHValue[4],g.setX(f._layoutHValue[1]+(f._layoutHValue[5]-d.x)*E.width);break;case"center":g.setX((.5-d.x)*E.width-f._layoutHValue);break;case"scale":T=f.getRotation()-N.getRotation(),K=Math.abs(Math.sin(T)),q=Math.abs(Math.cos(T)),g.setX((.5-d.x)*E.width-f._layoutHValue[1]*E.width/f._layoutHValue[0]),R=E.width/f._layoutHValue[2]-1,G+=q*R,I+=K*R}switch(F){case"top":g.setY(f._layoutVValue-d.y*E.height);break;case"bottom":g.setY((1-d.y)*E.height-f._layoutVValue);break;case"topbottom":T||(T=f.getRotation()-N.getRotation(),K=Math.abs(Math.sin(T)),q=Math.abs(Math.cos(T))),p=E.height-f._layoutVValue[2],G+=K*p/f._layoutVValue[3],I+=q*p/f._layoutVValue[4],g.setY(f._layoutVValue[1]+(f._layoutVValue[5]-d.y)*E.height);break;case"center":g.setY((.5-d.y)*E.height-f._layoutVValue);break;case"scale":T||(T=f.getRotation()-N.getRotation(),K=Math.abs(Math.sin(T)),q=Math.abs(Math.cos(T))),g.setY((.5-d.y)*E.height-f._layoutVValue[1]*E.height/f._layoutVValue[0]),R=E.height/f._layoutVValue[2]-1,G+=K*R,I+=q*R}if("leftright"===U||"scale"===U||"topbottom"===F||"scale"===F){var Q=this.getScale(),z=Math.abs(Q.x),m=Math.abs(Q.y);"leftright"===U||"scale"===U?f.setSize(f._layoutHValue[3]*G/z,f._layoutHValue[4]*I/m):f.setSize(f._layoutVValue[3]*G/z,f._layoutVValue[4]*I/m)}g.rotateAround(null,N.getRotation()),this.setPosition(g.x+b.x,g.y+b.y),f._layoutUpdating=J}}},updateLayoutParameters:function(L,c){if(L=L||this.getHost()){var z=this,f=z.s("layout.h"),x=z.s("layout.v");if(f||x){var F,l,Z,I,S,K,O=new P.Math.Vector2,X=L.getPosition(),p=L.getAnchor(),y=L.getScaledSize(),Q=z.getPosition(),i=z.getScaledSize();switch(O.set(Q.x-X.x,Q.y-X.y),O.rotateAround(null,-L.getRotation()),f){case"left":z._layoutHValue=O.x+p.x*y.width;break;case"right":z._layoutHValue=-O.x+(1-p.x)*y.width;break;case"center":z._layoutHValue=-O.x+(.5-p.x)*y.width;break;case"leftright":case"scale":"scale"===f?F=-O.x+(.5-p.x)*y.width:(l=z.getAnchor(),Z=z.getRotation()-L.getRotation(),I=Math.cos(Z),S=Math.sin(Z),K=-Math.min(-l.x*I+l.y*S,-l.x*I-(1-l.y)*S,(1-l.x)*I+l.y*S,(1-l.x)*I-(1-l.y)*S),F=O.x-(K-p.x)*y.width),"position"===c&&"object"==typeof z._layoutHValue?(z._layoutHValue[0]=y.width,z._layoutHValue[1]=F):z._layoutHValue=[y.width,F,y.width,i.width,i.height,K]}switch(x){case"top":z._layoutVValue=O.y+p.y*y.height;break;case"bottom":z._layoutVValue=-O.y+(1-p.y)*y.height;break;case"center":z._layoutVValue=-O.y+(.5-p.y)*y.height;break;case"topbottom":case"scale":"scale"===x?F=-O.y+(.5-p.y)*y.height:(Z||(l=z.getAnchor(),Z=z.getRotation()-L.getRotation(),I=Math.cos(Z),S=Math.sin(Z)),K=-Math.min(-l.x*S-l.y*I,-l.x*S+(1-l.y)*I,(1-l.x)*S-l.y*I,(1-l.x)*S+(1-l.y)*I),F=O.y-(K-p.y)*y.height),"position"===c&&"object"==typeof z._layoutVValue?(z._layoutVValue[0]=y.height,z._layoutVValue[1]=F):z._layoutVValue=[y.height,F,y.height,i.width,i.height,K]}}}},getSerializableProperties:function(){var P=wb.superClass.getSerializableProperties.call(this);return im(P,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),P}});var ej=P.Edge=function($,m){var Q=this;ii(ej,Q),Q.setSource($),Q.setTarget(m)};as("Edge",Oc,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return qi},_22Q:function(){return Ec},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(K){if(K===this)return!1;if(Mp(K))return!0;for(var x,A,y,o,t,Q=[this],G=-1,M=0;M>G;)if(G++,x=Q[G],A=x._44I)for(A=A.getArray(),o=0,t=A.length;t>o;o++)if(y=A[o],$k(y)&&!(Q.indexOf(y)>=0)){if(y===K)return!1;Q.push(y),M++}return!0},setSource:function(A){var Y=this;if(Y._source!==A&&Y.canSetSourceTarget(A)){var a=Y._source;Y._source=A,a&&a._16I(Y),A&&A._2I(Y),Y._7I(),Y.fp("source",a,A)}},setTarget:function(O){var U=this;if(U._target!==O&&U.canSetSourceTarget(O)){var y=U._target;U._target=O,y&&y._18I(U),O&&O._4I(U),U._7I(),U.fp("target",y,O)}},isLooped:function(){var k=this;return k._source===k._target&&Mp(k._source)&&Mp(k._target)},onPropertyChanged:function(){var j=this;j._49I&&j._49I.each(function(A){A.fp("agentChange",!0,!1)})},_7I:function(){var I,L=this,h=zf(L);L._40I!==h&&(I=this._40I,I&&I._15I(L),L._40I=h,h&&h._1I(L),L.fp("sourceAgent",I,h),vo(I,L._41I),vo(h,L._41I));var W=ge(L);L._41I!==W&&(I=L._41I,I&&I._17I(L),L._41I=W,W&&W._3I(L),L.fp("targetAgent",I,W),vo(I,L._40I),vo(W,L._40I))},_22I:function(I){this._52I=I,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var r=this;return r._52I&&r._52I.get(0)!==r&&!r.getStyle(Oo)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var n=this,U=n._52I;return U&&!n.getStyle(Oo)&&U.size()>1&&n===U.get(0)},toggle:function(){var n=this._52I,Y=!this.s(Oo);n&&n.size()>1&&(n.each(function(p){p.s(Oo,Y)}),n.getSiblings().each(function(t){t!==n&&t.each(function(g){g.fp("edgeGroup",d,t)})}))},setStyle:function(h,b){(h===Zk||"edge.segments"===h)&&(b=Zm(b)),ej.superClass.setStyle.call(this,h,b)},onStyleChanged:function(c){ej.superClass.onStyleChanged.apply(this,arguments),Rl[c]&&vo(this._41I,this._40I)},getSerializableProperties:function(){var _=ej.superClass.getSerializableProperties.call(this);return im(_,{source:1,target:1}),_}});var Gg=P.Group=function(){ii(Gg,this)};as("Group",wb,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return If},onChildAdded:function(){Gg.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Gg.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var P=this;if(!P._54I&&!$m){var d=P.getChildrenRect();d&&(P._53I=1,P.p(ui(P.s("group.position"),d,P.getSize())),delete P._53I)}},getChildrenRect:function(){var S,X=this;return X.eachChild(function(C){Mp(C)&&(S=kr(S,X.getChildRect(C)))}),S},getChildRect:function(P){var Y;return Mp(P)&&P.s(Bg)&&(Cb(P)&&P.isExpanded()&&P.eachChild(function(j){Y=kr(Y,P.getChildRect(j))}),!Y&&P.getRect&&(Y=P.getRect())),Y},setPosition:function(E,n){var u=this;if(!u._54I){var Z;Z=2===arguments.length?{x:E,y:n}:E,$m||u._53I||(u._54I=1,Xg(u._children,Z.x-u._position.x,Z.y-u._position.y),delete u._54I),Gg.superClass.setPosition.call(this,Z)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(Q){var f=this;if(f._57O!==Q){var q=f._57O;f._57O=Q,f.fp("expanded",q,f._57O),f._fireInvalidateDeep(),f._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(O){Cb(O)?O._fireInvalidateDeep():O.iv()})},_8I:function(){Gg.superClass._8I.call(this),this.eachChild(function(k){Mp(k)&&k._8I()})},onStyleChanged:function(e){Gg.superClass.onStyleChanged.apply(this,arguments),"group.position"===e&&this._81I()},getSerializableProperties:function(){var C=Gg.superClass.getSerializableProperties.call(this);return C.expanded=1,C}});var Mi=P.Block=function(){ii(Mi,this)};as("Block",wb,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return _n},onChildAdded:function(){Mi.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Mi.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var O=this;if(!$m&&!O._updatingToChildren&&O._syncSize&&!O._freezeSyncFromChildren){var a,d,H,I,G,C=[],P=O.getRotation();if(O.eachChild(function(e){Mp(e)&&C.push.apply(C,e.getCorners())}),C.length){O._updatingFromChildren=1;var h=v(-P),K=Z(-P),Y=1/0,Q=-1/0,$=1/0,S=-1/0;for(I=0,G=C.length;G>I;I++)H=C[I],a=H.x,d=H.y,H.x=h*a-K*d,H.y=K*a+h*d,Y=e(Y,H.x),Q=T(Q,H.x),$=e($,H.y),S=T(S,H.y);var x=O.getScale();O.setSize(j((Q-Y)/x.x),j((S-$)/x.y));var u;x.x<0&&(u=Y,Y=Q,Q=u),x.y<0&&(u=$,$=S,S=u),h=v(P),K=Z(P);var y=O.getAnchor();a=Y+(Q-Y)*y.x,d=$+(S-$)*y.y,O.setPosition(h*a-K*d,K*a+h*d),delete O._updatingFromChildren}}},setPosition:function(v,L){var g=this;if(!g._updatingToChildren){var b;b=2===arguments.length?{x:v,y:L}:v,$m||g._updatingFromChildren||(g._updatingToChildren=1,Xg(g._children,b.x-g._position.x,b.y-g._position.y),delete g._updatingToChildren),Mi.superClass.setPosition.call(this,b)}},setWidth:function(S){return this.setSize(S,this.getHeight())},setHeight:function(J){return this.setSize(this.getWidth(),J)},setSize:function(y,d){1>y&&(y=1),1>d&&(d=1);var h=this;if(!h._updatingToChildren){2!==arguments.length&&(d=y.height,y=y.width);var k=h.getWidth(),r=h.getHeight();if(y!==k&&Mi.superClass.setWidth.call(h,y),d!==r&&Mi.superClass.setHeight.call(h,d),!$m&&!h._updatingFromChildren){h._updatingToChildren=1;var n=y/k,E=d/r;h._adjustChildScaleOrSize(n,E,"size"),delete h._updatingToChildren,h.updateFromChildren()}}},_adjustChildScaleOrSize:function(_,f,m){var F=this;if(F._syncSize){var g=F.getPosition(),i=F.getRotation();F.getScale(),F.eachChild(function(Y){if(Mp(Y)){var n=Y.getPosition(),B=Y.getRotation(),S=Y.getWidth(),q=Y.getHeight(),L=Y.getScale(),K=L.x*S,T=L.y*q,X=new Vr(B,n.x,n.y,K,T);X.translate(-g.x,-g.y),X.rotate(-i),B=k(X.b*Math.sign(K),X.a*Math.sign(K)),X.scale(_,f);var d,l,Q,$=v(B);if(Math.abs($)<.001?(d=Z(B),l=X.b/d,Q=-X.c/d):(l=X.a/$,Q=X.d/$),"scale"===m)Y.setScale(l/S,Q/q);else if("size"===m){var c=l/L.x,t=Q/L.y;Y.setScale(uo(l)*Math.abs(L.x),uo(Q)*Math.abs(L.y)),Y instanceof P.Shape?(Y.setWidthForce(Math.max(Math.abs(c),1e-5)),Y.setHeightForce(Math.max(Math.abs(t),1e-5))):Y.setSize(Math.max(.01,Math.abs(c)),Math.max(.01,Math.abs(t)))}X.rotate(i),X.translate(g.x,g.y),Y.setPosition(X.tx,X.ty)}})}},_calcChangeFactor:function(c,m,B,J){var t,V,O,e;return t=j(c),V=j(B),O=t>V?t/V:V/t,t=j(m),V=j(J),e=t>V?t/V:V/t,T(O,e)},setAnchor:function(){var y=this;if(!y._updatingToChildren){var I=y.getAnchor();if(Mi.superClass.setAnchor.apply(y,arguments),!$m&&!y._updatingFromChildren&&y._syncSize){y._updatingToChildren=1;var A=y.getAnchor();y.getPosition();var C=y.getSize(),K=y.getScale(),V=y.getRotation(),J=-C.width*K.x*(I.x-A.x),g=-C.height*K.y*(I.y-A.y),_=Z(V),T=v(V),w=T*J-_*g,q=_*J+T*g;y.eachChild(function(i){if(Mp(i)){var e=i.getPosition();i.setPosition(e.x-w,e.y-q)}}),delete y._updatingToChildren}}},setRotation:function(t){var v=this;if(!v._updatingToChildren){var F=v.getRotation();if(Mi.superClass.setRotation.apply(v,arguments),!$m&&!v._updatingFromChildren){v._updatingToChildren=1;var $=v.getPosition(),x=t-F;v.eachChild(function(R){if(Mp(R)){var u=R.getMatrix();u.translate(-$.x,-$.y),u.rotate(x),u.translate($.x,$.y);var C=Math.sign(R.getScale().x);R.setRotation(k(u.b*C,u.a*C)),R.setPosition(u.tx,u.ty)}}),delete v._updatingToChildren}}},setScale:function(y,F){var L=this;if(!L._updatingToChildren){null==F&&(F=y.y,y=y.x);var m=L.getScale();if(j(y)<.01&&(y=.01*(uo(y)||uo(m.x))),j(F)<.01&&(F=.01*(uo(F)||uo(m.y))),Mi.superClass.setScale.call(L,y,F),!$m&&!L._updatingFromChildren){L._updatingToChildren=1;var c=y/m.x,K=F/m.y;L._adjustChildScaleOrSize(c,K,"size"),delete L._updatingToChildren,L.updateFromChildren()}}},getSerializableProperties:function(){var g=Mi.superClass.getSerializableProperties.call(this);return g.clickThroughEnabled=1,g.syncSize=1,g}});var lf=P.Grid=function(){ii(P.Grid,this)};as("Grid",wb,{IRotatable:!1,_icon:"grid_icon",_image:d,getUIClass:function(){return yg},setRotation:function(){},getCellRect:function(X,g){var W=this,C=W.s("grid.row.count"),F=W.s("grid.column.count");if(0>=C||0>=F||0>X||X>=C||0>g||g>=F)return d;var $,s,G,v=W.getRect(),P=W.s("grid.row.percents"),j=W.s("grid.column.percents");if(ic(v,W,"grid.border",-1),P&&P._as&&(P=P._as),j&&j._as&&(j=j._as),P&&P.length===C){for(G=0,$=0;X>$;$++)G+=v.height*P[$];v.y+=G,v.height=v.height*P[X]}else v.height=v.height/C,v.y+=v.height*X;if(j&&j.length===F){for(s=0,$=0;g>$;$++)s+=v.width*j[$];v.x+=s,v.width=v.width*j[g]}else v.width=v.width/F,v.x+=v.width*g;return ub(v,-W.s("grid.gap")),v}});var bn=P.Text=function(){ii(bn,this),this.setSize(100,50),this.s("text","TEXT")};as("Text",wb,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return dp},setWidth:function(P){P||(P=.001),bn.superClass.setWidth.call(this,P)},setHeight:function(I){I||(I=.001),bn.superClass.setHeight.call(this,I)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Zh("__text__",{width:{value:100,isSafeFunc:!0,func:function(m){return m._width}},height:{value:50,isSafeFunc:!0,func:function(o){return o._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var cf=P.Shape=function(){ii(cf,this),this._59O=new nm};cf.__de__=Em,as("Shape",wb,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Ce},_22Q:function(){return Ch},getLength:function(l){return mh(vm(this._59O,this._58O,l,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var A=this._58O;return A?new nm(A._as.slice(0)):A},setSegments:function($){var W=this._58O;$=$?mo($)?new nm($.slice(0)):new nm($._as.slice(0)):null,(W&&$&&W._as.join(",")!==$._as.join(",")||W!==$)&&(this._58O=$,this.fp("segments",W,$))},getPoints:function(){return this._59O},toPoints:function(){var n=this._59O;return new nm(n._as.slice(0))},setPoints:function(A,P){var R=this,w=R._59O;A=A?mo(A)?new nm(A.slice(0)):new nm(A._as.slice(0)):new nm;var V,o,F,U,b,z;P&&(V=R.getPosition(),z=new Vr(R.getRotation(),0,0,R.getScale().x,R.getScale().y)),(w&&A&&w._as.join(",")!==A._as.join(",")||w!==A)&&(R._59O=A,R.fs(),R.fp("points",w,A)),P&&(o=R.getPosition(),F=o.x-V.x,U=o.y-V.y,b=z.tf(F,U),R.setPosition(o.x-F+b.x,o.y-U+b.y))},addPoint:function($,Y,j){var I=this.toPoints();I.add($,Y),this.setPoints(I,j)},setPoint:function(p,f,y){var Q=this.toPoints();Q.set(p,f),this.setPoints(Q,y)},removePointAt:function(x){var U=this.toPoints();U.removeAt(x),this.setPoints(U)},setWidthForce:function(Z){var R=this;if(!R._55I&&!$m&&R.getWidth()){R._55I=1;var B=R._position.x,i=Z/R.getWidth(),H=R.toPoints(),t=new nm;H.each(function(m){t.add({x:(m.x-B)*i+B,y:m.y,e:m.e})}),R.setPoints(t),Hl(R,[i,0,0,1,B*(1-i),0]),R.fs(),delete R._55I}cf.superClass.setWidth.call(R,Z)},setWidth:function(U){return this.setWidthForce(1>U?1:U)},setHeightForce:function(i){var G=this;if(!G._55I&&!$m&&G.getHeight()){G._55I=1;var F=G._position.y,Y=i/G.getHeight(),K=G.toPoints(),$=new nm;K.each(function(J){$.add({x:J.x,y:(J.y-F)*Y+F,e:J.e})}),G.setPoints($),Hl(G,[1,0,0,Y,0,F*(1-Y)]),G.fs(),delete G._55I}cf.superClass.setHeight.call(G,i)},setHeight:function(M){return this.setHeightForce(1>M?1:M)},setAnchorElevation:function(M){var Y=this;Y._55I=!0;var t=Y._updatingAnchor3d,p=!$m&&!t;if(p){var E,X=M,g=Y.getAnchorElevation(),K=Y.getTall();E=K*(g-X),Y.shiftPointsElevation(E)}var B=cf.superClass.setAnchorElevation.apply(Y,arguments);return t||delete Y._55I,B},getShapeElevation:function(){var k=this,y=k._54O;return y-(k.getTall()||0)*(k._anchorElevation-.5)},setAnchor3d:function(Z,R,r,z){var C,t=this;"number"==typeof Z?C={x:Z,y:R,z:r}:(C=Z.length?{x:Z[0],y:Z[1],z:Z[2]}:Z,z=R),t._55I=!0,t._updatingAnchor3d=!0;var v=t.getDataModel();if(v&&v.beginTransaction(),!$m){var N=t.getAnchor3d(),P=t.getSize(),j=t.getTall(),_=P.width*(N.x-C.x),V=P.height*(N.z-C.z),s=j*(N.y-C.y);z||t.shiftPoints(_,V,s);var U=t.p3()}var p=cf.superClass.setAnchor3d.apply(t,arguments);if(!$m&&z){var K=t.p3();t.shiftPoints(K[0]-U[0]+_,K[2]-U[2]+V,K[1]-U[1]+s)}return v&&v.endTransaction(),delete t._updatingAnchor3d,delete t._55I,p},setAnchor:function(o,P,v){var C=this;C._55I=!0;var j=C._updatingAnchor3d,G=!$m&&!j;if(G){var H,l,E;"number"==typeof o?E={x:o,y:P}:(E=o.length?{x:o[0],y:o[1]}:o,v=P);var B=C.getAnchor(),i=C.getSize();H=i.width*(B.x-E.x),l=i.height*(B.y-E.y),v||C.shiftPoints(H,l);var t=C.getPosition()}var r=cf.superClass.setAnchor.apply(C,arguments);if(G){var T=C.getPosition();v&&C.shiftPoints(T.x-t.x+H,T.y-t.y+l)}return j||delete C._55I,r},shiftPoints:function(Y,o,z){var O=this,G=O.getElevation()||0,A=O.toPoints(),i=new nm;A.each(function(K){var b=K.e;z&&(b=(b==d?G:b)+z),i.add({x:K.x+Y,y:K.y+o,e:b})}),O.setPoints(i),O.fs()},shiftPointsElevation:function(e){return this.shiftPoints(0,0,e)},setPosition:function(s,I){var n,R=this;if(!R._28Q){if(R._28Q=1,!R._55I&&!$m){n=2===arguments.length?{x:s,y:I}:s;var B=n.x-R._position.x,H=n.y-R._position.y;if(0===B&&0===H)return delete R._28Q,void 0;R._55I=1,R.shiftPoints(B,H),Hl(R,[1,0,0,1,B,H]),delete R._55I}cf.superClass.setPosition.apply(R,arguments),delete R._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var y=this;if(2!==y._59O.size())return!1;var p=y._58O;return p?2===p.size()&&1===p.get(0)&&2===p.get(1)?!0:!1:!0},fireShapeChange:function(){var B=this;if(!B._55I&&!$m){var _=io(B._59O);_&&(B._55I=1,B.setRect(_),delete B._55I)}B.fp(zd,!1,!0)},getSerializableProperties:function(){var R=cf.superClass.getSerializableProperties.call(this);return R.segments=1,R.points=1,R.thickness=1,R.closePath=1,R}});var Uo=P.Polyline=function(){ii(Uo,this),this.s({"shape.background":null,"shape.border.width":2})};as("Polyline",cf,{_icon:"polyline_icon",_22Q:function(){return bq},getUIClass:function(){return Wp},setClosePath:function(){},setTall:function(M){var _=this;if(!_._55I&&!_._24Q&&!$m&&_.getTall()){_._24Q=1;var B=_._54O,k=M/_.getTall();_._59O.each(function(V){V.e=V.e==d?B:(V.e-B)*k+B}),_.fs(),delete _._24Q}Uo.superClass.setTall.call(_,M)},setElevation:function(H){var O=this;if(!O._55I&&!O._24Q&&!$m){O._24Q=1;var T=H-O._54O;O._59O.each(function(n){n.e==d?n.e=H:n.e+=T}),O.fs(),delete O._24Q}Uo.superClass.setElevation.apply(O,arguments)},fireShapeChange:function(){var k=this,A=k._59O;if(!k._55I&&!k._24Q&&!$m){var l=A.size();if(l){var G=1,H=A.get(0),I=k._54O;H.e==d&&(H.e=I);for(var K=H.e,V=0;l>G;G++){H=A.get(G),H.e==d&&(H.e=I);var y=e(K,H.e),v=T(K+V,H.e);K=y,V=v-y}k._24Q=1,k.setTall(V),k.setElevation(K+V*k._anchorElevation),delete k._24Q}}Uo.superClass.fireShapeChange.apply(k,arguments)}});var Qb=P.SubGraph=function(){ii(Qb,this)};as("SubGraph",wb,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Qb.superClass._8I.call(this),this.eachChild(function(P){Mp(P)&&P._8I()})}}),F.loadingRefGraph=0;var ke=P.RefGraph=function(){ii(ke,this)};as("RefGraph",Mi,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(O){var z=this._ref;this._ref=O,this.fp("ref",z,O),this.updateRef()},_21I:function(){ke.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var R=this;if(F.loadingRefGraph++,R.clearChildrenFromDataModel(),F.loadingRefGraph--,R._ref&&R._dataModel){R._xhrLoadHandler&&(R._xhrLoadHandler.cancel=!0);var g=$m,l=R._xhrLoadHandler=function(r){if(r&&R._dataModel){F.loadingRefGraph++;var W=R._pendingUpdateInfo={needToRestore:g};g&&(W.position=R.p(),W.width=R.getWidth(),W.height=R.getHeight(),W.rotation=R.getRotation(),W.anchor=R.getAnchor(),W.scale=R.getScale()),R.p(0,0),R.setAnchor(.5,.5),R.setRotation(0),R.setScale(1,1);var j=F.parse(r),m=R._dataModel.deserialize(j,R,{justDatas:!0});m.each(function(o){o._refGraph=R}),R.checkPendingUpdateInfo(),F.loadingRefGraph--,F.handleRefGraphLoaded(R,m,j)}};l.xhrLoadCalled=!1,F.load(R._ref,function(I){l.cancel||(l.xhrLoadCalled?l(I):Vo(function(){l(I)}))}),l.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var b=this,u=b._pendingUpdateInfo;if(!u)return b.onPendingUpdated&&(F.loadingRefGraph++,b.onPendingUpdated(),F.loadingRefGraph--),void 0;var J=!0;this.eachChild(function(k){(k._pendingCheckImageJSON||k._pendingUpdateInfo)&&(J=!1)}),J&&(F.loadingRefGraph++,b._pendingUpdateInfo=null,b.updateFromChildren(),u.needToRestore&&(b.setSize(u.width,u.height),b.setAnchor(u.anchor),b.setRotation(u.rotation),b.setScale(u.scale),b.p(u.position)),this.getParent()instanceof ke&&this.getParent().checkPendingUpdateInfo(),b.onPendingUpdated&&b.onPendingUpdated(),F.loadingRefGraph--)},getSerializableProperties:function(){var u=ke.superClass.getSerializableProperties.call(this);return u.ref=1,u}}),P.EdgeGroup=function(z,j){this._70O=z,this._siblings=j;for(var B,u,U=0,m=z.size(),s=S[Oo];m>U;U++)if(B=z.get(U).getStyle(Oo,!1),B!=d){s=B;break}s==d&&(s=!0);var H=F.edgeGroupAgentFunc;for(H&&(u=H(z),u&&u!==z.get(0)&&(z.remove(u),z.add(u,0))),U=0;m>U;U++)z.get(U).s(Oo,s)},as("EdgeGroup",r,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(z){return this._70O.get(z)},indexOf:function(k){return this._70O.indexOf(k)},each:function(v,i){this._70O.each(v,i)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(C,v){this._siblings.each(function(R){R._70O.each(C,v)})}});var Pn=function(S,t,n){var p=Ym[S]={type:S,action:t};if(n)for(var z in n)p[z]=n[z]};im(F,{setConnectAction:Pn,getConnectAction:function(i,N){if(!N){if(!i)return null;N=i.getCurrentConnectActionType()}return Ym[N]},doConnectAction:function(I,e,R,m){m=m||I.getCurrentConnectActionType();var $=Ym[m];if(!$)return!1;var v=$.action;return v?(e instanceof rj.Group?I.sm().getSelection().each(function(n){v.call(null,I,n,R)}):v.call(null,I,e,R),!0):!1},doDeleteConnectionAction:function(i,F,y){y=y||i.getCurrentConnectActionType();var C=Ym[y];if(!C||!C.delete)return!1;var g=C.delete.action;return g?(F instanceof rj.Group?i.sm().getSelection().each(function(x){g.call(null,i,x)}):g.call(null,i,F),!0):!1}});var tn=P.JSONSerializer=function(g,f){this.dm=this._dataModel=g,this._hierarchical=F.forceHierarchicalSerialization?!0:f==d?g.isHierarchicalRendering():f};as("JSONSerializer",r,{ms_ac:["hierarchical"],serialize:function(h){return F.stringify(this.toJSON(),h)},toJSON:function(){var g=this,x=g.dm,d=x.getRoots(),Q=g.json={v:F.getVersion(),p:{},a:{},d:[]},A=x.getSerializableAttrs();x.getInit()&&(Q.init=x.getInit()),x.getName()&&(Q.p.name=x.getName()),x.getBackground()&&(Q.p.background=x.getBackground()),x.getLayers()&&(Q.p.layers=x.getLayers()),x.getEnvmap()&&(Q.p.envmap=x.getEnvmap()),Q.p.autoAdjustIndex=x.isAutoAdjustIndex(),Q.p.hierarchicalRendering=x.isHierarchicalRendering();for(var c in A){var Z=x.a(c);Z!==J&&g[al](c,Z,Q.a)}return nf(Q.a)&&delete Q.a,g._hierarchical?d.each(g.serializeData,this):x.each(function(W){g.serializeData(W)}),x.fireSerializeEvent({type:"serialize",json:Q}),x.getPostProcessingData()&&(Q.p.postProcessingData=x.getPostProcessingData()),Q},isSerializable:function(){return!0},getProperties:function(B){return B.getSerializableProperties()},getStyles:function(S){return S.getSerializableStyles()},getAttrs:function(d){return d.getSerializableAttrs()},serializeData:function(X){var k=this;if(k.isSerializable(X)&&!X._refGraph){var b,T,A,w,u=bc(X.getClassName())||X.getClass(),C=new u,E={c:X.getClassName(),i:X.getId(),p:{},s:{},a:{}};k.json.d.push(E),b=k.getProperties(X);for(T in b)if(/^_/.test(T)){if(A=X[T],("_width"===T||"_height"===T)&&A===J){var x;((X.s("layout.h")||X.s("layout.v"))&&X.getHost()||X instanceof P.Node&&(x=X.getParent())&&x instanceof P.Block||X.s("fullscreen"))&&(A=X[T]="_width"===T?X.getWidth():X.getHeight())}A!==C[T]&&k[al](T.substr(1),A,E.p)}else w=Be(T),X[w]&&(A=X[w](),A!==C[w]()&&k[al](T,A,E.p));b=k.getStyles(X);for(T in b)A=X.s(T),A!==C.s(T)&&k[al](T,A,E.s);b=k.getAttrs(X);for(T in b)A=X.a(T),A!==C.a(T)&&k[al](T,A,E.a);nf(E.p)&&delete E.p,nf(E.s)&&delete E.s,nf(E.a)&&delete E.a}k._hierarchical&&X.getChildren().each(k.serializeData,k)},serializeValue:function(k,$,I){mc($)?$={__a:$._as}:$ instanceof Oc&&($={__i:$.getId()}),I[k]=$},deserialize:function(K,S,p){var n=this;return Jp(K)&&/.json$/.test(K)?(F.xhrLoad(K,function(r){n.deserializeImpl(r,S,p)}),void 0):n.deserializeImpl(K,S,p)},deserializeImpl:function(i,b,P){var I=this,o=I.dm;P=dr(P)?{setId:P}:sr(P)?{finishFunc:P}:P||{},i=I.json=Jp(i)?F.parse(i):i,i.a&&i.a.onPreDeserialize&&!P.disableOnPreDeserialize&&i.a.onPreDeserialize(i,o,P.view),o.beginTransaction(),$m++,I._82I={};var p=new nm,K=new nm,N=0,_=i.d.length;if(P.justDatas||(sr(i.init)&&i.init(o),o.setInit(i.init)),!P.justDatas){for(var Y in i.a)o.a(Y,I[wr](i.a[Y]));for(var O in i.p)o[Hb(O)](i.p[O])}for(;_>N;N++){var l=i.d[N],R=bc(l.c),G=new R,j=l.i;P.setId&&j!=d&&(G._id=j),I._82I[j]=G,p.add(G),K.add(l)}for(N=0;_>N;N++)I.deserializeData(p.get(N),K.get(N));return p.each(function(Z){b&&!Z.getParent()&&Z.setParent(b),o.add(Z)}),o.fireSerializeEvent({type:"deserialize",json:i}),$m--,o.endTransaction(),i.a&&i.a.onPostDeserialize&&!P.disableOnPostDeserialize&&i.a.onPostDeserialize(i,o,P.view,p),P.finishFunc&&P.finishFunc(i,o,P.view,p),p},deserializeData:function(J,p){for(var F in p.p)J[Hb(F)](this[wr](p.p[F]));for(F in p.s)J.s(F,this[wr](p.s[F]));for(F in p.a)J.a(F,this[wr](p.a[F]))},deserializeValue:function(c){if(yl(c)){var q=c.__i;if(q!=d)return this._82I[q];if(q=c.__a,mo(q))return new nm(q)}return c}}),im(ac,{serialize:function(l,y){return new tn(this,y).serialize(l)},toJSON:function(l){return new tn(this,l).toJSON()},deserialize:function(h,T,M){return new tn(this).deserialize(h,T,M)}});var ti=P.OverlappingBox=function(f){this.gv=f,this.boxes={}};as("OverlappingBox",r,{clear:function(){var t,o,c=this.boxes;for(t in c)o=c[t],o.length=0},isOverlapping:function(N,z){var c,e,S=this,P=S.boxes,w=P[N];w?(c=w.rects,e=w.length):w=P[N]={rects:c=[],length:e=0};var I,L,z;for(I=0;e>I;I++)if(L=c[I],L.x<z.x+z.w&&L.x+L.w>z.x&&L.y<z.y+z.h&&L.h+L.y>z.y)return!0;
return c.length<=e?(c.push(z),w.length++):c[w.length++]=z,!1}}),im(F,{fetch:function(b,y){var p="GET",B=!1,m=null,d="";y&&(p=y.method||"GET",B=y.sync,d=y.url,m=y.data||null),b.open(p,d,!B),y.responseType?b.responseType=y.responseType:y.overrideMimeType&&b.overrideMimeType&&b.overrideMimeType(y.overrideMimeType),b.send(m)},convertImageSrc:function(H,Q){Q&&"function"==typeof Q||(Q=function(){}),Q(H)}});var sf=P.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};as("Request",r,{_responseType:null,_overrideMimeType:"text/plain",send:function(H){var P=this._xhr,$=this.onload,w=this.onerror;this.getResponseType()?H.responseType=this.getResponseType():this.getOverrideMimeType()&&(H.overrideMimeType=this.getOverrideMimeType()),P.onload=$,P.onerror=w,F.fetch(P,H)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(Q){this._responseType=Q},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(_){this._overrideMimeType=_},getResponseText:function(){var E=this._xhr;return E.response||E.responseText}}),vb.GraphView=function(M){var k=this;k._24I={},k._34I=new nm,k._25I={},k._56I={},k._view=up(1,k),k._canvas=Ni(k._view),k.dm(M?M:new ac),this._coreInteractor=new Ud(this),k.setEditable(!1),k.setScrollBarVisible(F.graphViewScrollBarVisible)},bi("GraphView",r,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Rj,Nr,eg,Ui,"resettable","editInteractor",ch,"zoomable","pannable","rectSelectable","autoScrollZone",oo,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:F.graphViewZoomable,_resettable:F.graphViewResettable,_pannable:F.graphViewPannable,_rectSelectable:F.graphViewRectSelectable,_autoScrollZone:F.graphViewAutoScrollZone,_rectSelectBackground:F.graphViewRectSelectBackground,_rectSelectBorderColor:F.graphViewRectSelectBorderColor,_editPointSize:F.graphViewEditPointSize,_editPointBorderColor:F.graphViewEditPointBorderColor,_editPointBackground:F.graphViewEditPointBackground,_scrollBarColor:Pj,_scrollBarSize:_p,_autoHideScrollBar:lb,_autoMakeVisible:Rk,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(W){this._dataModel.setLayers(W)},setEditable:function(K){var g=this,j=g.__interactorMap__;if(!j){var D=vb.XEditInteractor;j=g.__interactorMap__={scrollBar:new bk(g),select:new hm(g),edit:D?new D(g):new Li(g),text:new Ii(g),move:new jg(g),"default":new be(g),touch:new Gn(g,{editable:!1})}}K?(g._uieditable=!0,g.setInteractors([j.scrollBar,j.select,j.edit,j.text,j.move,j.default,j.touch])):(g._uieditable=!1,g.setInteractors([j.scrollBar,j.select,j.move,j.default,j.touch]))},getCanvas:function(){return this._canvas},_33I:function(G){var H=G.getUIClass();return H?new H(this,G):d},getDataUI:function(b){var N=this,w=N._25I[b._id];return w===J&&(w=N._33I(b),N._25I[b._id]=w),w},getNodeRect:function(u){return F.getNodeRect(this,u)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(Y){var o=this.getDataUI(Y);return o?(o._79o(),o._78o):null},getEdgeSourcePosition:function(a){var o=this,n=o.getDataUI(a),H=n.s,S=n._data._40I;return kq(o,S,H("edge.source.position"),H("edge.source.offset.x"),H("edge.source.offset.y"),H("edge.source.anchor.x"),H("edge.source.anchor.y"))},getEdgeTargetPosition:function(G){var K=this,D=K.getDataUI(G),Z=D.s,q=D._data._41I;return kq(K,q,Z("edge.target.position"),Z("edge.target.offset.x"),Z("edge.target.offset.y"),Z("edge.target.anchor.x"),Z("edge.target.anchor.y"))},invalidateAll:function(f){var Y=this;if(f){for(var w in Y._25I){var C=Y._25I[w];C&&C.dispose()}Y._25I={},Y._56I={},Y._24I={},Y._34I.clear(),Y.redraw()}else Y.dm().each(function(C){Y.invalidateData(C)})},invalidateSelection:function(){var e=this;e.sm().each(function(j){e.invalidateData(j)})},invalidateData:function(I){var e=this;e._24I[I._id]=I,e._21Q(I),e.iv()},_21Q:function(Z){var Y=this,p=Y._24I;if($k(Z)&&Wg[Z.s(lc)]){var u=Z.getSourceAgent();u&&u.getAgentEdges().each(function(r){p[r._id]=r}),u=Z.getTargetAgent(),u&&u.getAgentEdges().each(function(G){p[G._id]=G}),Y.iv()}},redraw:function(D){var G=this;G._32I||(D?G._34I.add(D):(G._32I=1,G._34I.clear()),G.iv())},each:function(V,y){var k,Y,F,r=0,b=this.getLayers(),g=this._dataModel,_=g._datas._as,h=_.length;if(b){for(var R=b.length;R>r;r++)if(F=b[r],yl(F)&&(F=F.name),g.isHierarchicalRendering()){var Q=function(n){return n._layer===F?y?V.call(y,n):V(n):void 0};if(this._dataModel.eachByHierarchical(Q)===!1)return}else for(var X=0;h>X;X++)if(k=_[X],k._layer===F&&(Y=y?V.call(y,k):V(k),Y===!1))return}else if(g.isHierarchicalRendering())this._dataModel.eachByHierarchical(V,null,y);else for(;h>r;r++)if(k=_[r],Y=y?V.call(y,k):V(k),Y===!1)return},reverseEach:function(X,N){var i,T,M,C,K=this._dataModel,s=K._layers,h=K._datas._as,q=h.length;if(s){for(i=s.length-1;i>=0;i--)if(C=s[i],yl(C)&&(C=C.name),K.isHierarchicalRendering()){var w=function(Z){return Z._layer===C?N?X.call(N,Z):X(Z):void 0};if(K.reverseEachByHierarchical(w)===!1)return}else for(var l=q-1;l>=0;l--)if(T=h[l],T._layer===C&&(M=N?X.call(N,T):X(T),M===!1))return}else if(K.isHierarchicalRendering())K.reverseEachByHierarchical(X,null,N);else for(i=q-1;i>=0;i--)if(T=h[i],M=N?X.call(N,T):X(T),M===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var d=this,t=d._84I;if(!t){var c=this.dm().a("width"),T=this.dm().a("height");c>0&&T>0?d._84I={x:0,y:0,width:c,height:T}:(d.each(function(q){d.isVisible(q)&&(t=kr(t,d.getDataUIBounds(q)))}),d._84I=t?t:xp)}return d._84I},getScrollRect:function(){return kr(this.getContentRect(),this._29I)},makeCenter:function(H,N,x){var f=this;if(!f.getWidth()||!f.getHeight())return x||Vo(f.centerData,f,[H,N,!0],500),void 0;f.makeVisible(H),f.validate();var c=f.getDataUIBounds(H);if(c){var D=f.getWidth(),g=f.getHeight(),X=c.x+c.width/2,A=c.y+c.height/2,F=-X*f._zoom+D/2,M=-A*f._zoom+g/2;f.setTranslate(F,M,N)}},fitData:function(L,t,o,Y,c){var K=this;if(!K.getWidth()||!K.getHeight())return c||Vo(K.fitData,K,[L,t,o,Y,!0],500),void 0;var W=function(){K.makeVisible(L),K.validate();var b=K.getDataUIBounds(L);b&&(b=oe(b),ub(b,o==d?20:o),K.fitRect(b,t,Y))};t?F.callWhenLoaded(W):W()},fitContent:function(o,S,N,O){var K=this;if(!K.getWidth()||!K.getHeight())return O||Vo(K.fitContent,K,[o,S,N,!0],500),void 0;var q=function(){K.validate();var x=oe(K.getContentRect());ub(x,S==d?20:S),K.fitRect(x,o,N)};o?F.callWhenLoaded(q):q()},fitRect:function(u,x,C){var l=this,Z=l.getWidth(),N=l.getHeight(),P=u.x+u.width/2,Q=u.y+u.height/2,X=e(Z/u.width,N/u.height),w=l._zoom,A=-P*w+Z/2,g=-Q*w+N/2;0===X||isNaN(X)||(C&&(X=e(1,X)),x?(l._65I&&(delete l._65I.finishFunc,l._65I.stop(!0)),l._14o&&l._14o.stop(!0),l.setTranslate(A,g,{finishFunc:function(){l.setZoom(X,x)}})):(l.setTranslate(A,g),l.setZoom(X)))},toCanvas:function(T,y){y=y||this._zoom,this.validateImpl();var v=this,H=v.getContentRect();H.width||(H.width=10),H.height||(H.height=10);var E=Ni(),V=H.x*y,k=H.y*y,e=H.width*y,s=H.height*y;lr(E,e,s,1);var x=Hr(E);return T=T||this._dataModel.getBackground(),T&&Pe(x,0,0,e,s,T),Rg(x,-V,-k),x.scale(y,y),v._42(x),x.restore(),E},toDataURL:function(p,F,f){return this.toCanvas(p,f).toDataURL(F||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(T,I){var a=this,R=a.dm().getBackground();if(R){var U=a.dm().a("width"),n=a.dm().a("height");U>0&&n>0&&Pe(T,0,0,U,n,R)}var s=a.__htmlOrderList,q=[];if(a._93db(T,I),a.each(function(x){var W=a.getDataUI(x);if(W){var y=a._56I[x._id],V=W._htmlView;if(y){var $=W._79o();if(V=W._htmlView,P.HtmlNode&&x instanceof P.HtmlNode)W._42(T);else{var z=a.getViewRect(),h=V&&V.layoutHTML;!I||Ri(I,$)?(h&&(V.layoutHTML(),W.__outerLayout&&delete W.__outerLayout),W._42(T)):Ri(z,$)||!h||W.__outerLayout||(V.layoutHTML(),W.__outerLayout=!0)}}V&&(q.push(V),V.getView&&(V=V.getView()),V.style.display=y?"block":xj)}}),s&&q.length>0){var X=!1;if(s.length!==q.length)X=!0;else for(var M=0;M<q.length;M++)if(q[M]!==s[M]){X=!0;break}X&&(q.forEach(function(P){a.appendHTML(P,!0)}),this.__htmlOrderList=q)}else this.__htmlOrderList=q;a._92db(T,I)},validateImpl:function(){this.tryUpdateRootData();var k,H,R,W,O,s=this,b=s.tx(),F=s.ty(),G=s._zoom,X=s._canvas,v=this.getWidth(),r=this.getHeight(),q=s._29I,$={x:-b/G,y:-F/G,width:v/G,height:r/G},u={},l=s._34I,a=s._24I,S=s._32I,j=s._23I;s._24I={},(v!==X.clientWidth||r!==X.clientHeight)&&(lr(X,v,r),S=1),S||nn($,q)||(S=1),s._29I=$,s.each(function(w){H=w._id;var N=u[H]=s.isVisible(w);N!==s._56I[H]&&(a[H]=w,R=s.getDataUI(a[H]),R&&R._84o(N),s._84o(w,N))},s);for(H in a)R=s.getDataUI(a[H]),R&&(!S&&s._56I[H]&&(O=R._79o(),O&&l.add(O)),R.invalidate()),s._83I=1;if(s._56I=u,!S)for(H in a)u[H]&&(R=s.getDataUI(a[H]),R&&(O=R._79o(),O&&l.add(O)));if(S?W=$:(l.each(function(M){Ri($,M)&&(W=kr(W,M))}),W&&(ub(W,T(1,1/G)),W.x=A(W.x*G)/G,W.y=A(W.y*G)/G,W.width=n(W.width*G)/G,W.height=n(W.height*G)/G,W=hh($,W))),s._74O=W,W){k=Hr(X);var i=W.x,o=W.y,e=W.width,t=W.height;i=Math.floor((i*G+b)*th),o=Math.floor((o*G+F)*th),e=Math.ceil(e*G*th)+1,t=Math.ceil(t*G*th)+1,k.beginPath(),k.rect(i,o,e,t),k.clip(),k.clearRect(i,o,e,t),zm(k,b,F,G),s._42(k,W),k.restore(),delete s._74O}if(l.clear(),delete s._32I,j&&v>0&&r>0){var R=s.getDataUI(j);if(R){var O=R._79o(),L=s._29I,U=L.x,Y=L.y,V=L.width,C=L.height,G=s._zoom;O&&!Ri(O,L)&&(O.x+O.width<U&&s.tx(-O.x*G),O.x>U+V&&s.tx(-(O.x+O.width-V)*G),O.y+O.height<Y&&s.ty(-O.y*G),O.y>Y+C&&s.ty(-(O.y+O.height-C)*G))}delete s._23I}s._83I&&(delete s._83I,delete s._84I),s._98O(),s.countFrame(),nf(s._24I)||Vo(s.iv,s)},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var D,S=this.getFullscreenDatas();for(var q in S)D=S[q],this.scaleRootData(D);this._rootDataUpdating=!1}},scaleRootData:function(X){var r=X.s("fullscreen");if("uniform"===r||"fill"===r){X.getRotation()&&X.setRotation(0);var M,h,U,z=X.s("fullscreen.gap")||0,C=this.getWidth()-2*z,s=this.getHeight()-2*z,A=X.getAnchor(),x=X.getScaledSize(),q=x.width,o=x.height,t=X.s("fullscreen.lock");if(t)return"uniform"===r?C/s>q/o?(M=s/o,q=o*C/s):(M=C/q,o=q*s/C):"v"===t?(M=s/o,q=C/M,X.getWidth()!==q&&X.setWidth(q)):(M=C/q,o=s/M,X.getHeight()!==o&&X.setHeight(o)),this.setZoom(M),h=z-(X.getX()-A.x*q)*M,U=z-(X.getY()-A.y*o)*M,h!==this.tx()&&this.tx(h),U!==this.ty()&&this.ty(U),void 0;h=this.tx(),U=this.ty(),M=this._zoom;var e={x:(-h+z)/M,y:(-U+z)/M,width:C/M,height:s/M};if("uniform"===r){var d=q/o,v=Math.min(e.width,e.height*d),f=v/d;e.x+=.5*(e.width-v),e.y+=.5*(e.height-f),e.width=v,e.height=f}C=e.width/X.getScaleX(),s=e.height/X.getScaleY(),(X.getWidth()!=C||X.getHeight()!==s)&&X.setSize(C,s);var y=e.x+A.x*e.width,F=e.y+A.y*e.height,k=X.getPosition();(y!==k.x||F!==k.y)&&X.setPosition(y,F)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(O){var y=this;O!==y.isScrollBarVisible()&&(O?(oq(y._view,y._79O=rp()),oq(y._79O,y._27I=rp()),oq(y._79O,y._28I=rp())):(Hq(y._79O),delete y._79O,delete y._27I,delete y._28I),y.fp("scrollBarVisible",!O,O))},getDebugTip:function(){return""},showScrollBar:function(){var t=this;t._79O&&(t._85I||(_(function(){t._86I()},vs),t.iv()),t._85I=new Date)},_86I:function(){var z=this;if(z._85I){var U=new Date,N=U.getTime();N-z._85I.getTime()>=vs?(delete z._85I,z.iv()):_(function(){z._86I()},vs)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var f=this,u=this._27I,s=this._28I;if(f._79O){if(f._autoHideScrollBar&&!f._85I)return u.style.visibility=op,s.style.visibility=op,void 0;var D=f.getScrollBarColor(),q=f._zoom,z=f.getScrollBarSize(),k=f.getViewRect(),I=f.getScrollRect(),N=k.height*q,B=I.height*q,S=k.width*q-z-2,i=N*((k.y-I.y)*q/B),y=N*(N/B),w=u.style;B-.5>N?(ls>y&&(i=i+y/2-ls/2,0>i&&(i=0),i+ls>N&&(i=N-ls),y=ls),Hi(u,S,i,z,y),w.visibility=Tl,w.background=D,w.borderRadius=z/2+Cf):w.visibility=op;var b=k.width*q,M=I.width*q,i=k.height*q-z-2,S=b*((k.x-I.x)*q/M),X=b*(b/M),w=s.style;M-.5>b?(ls>X&&(S=S+X/2-ls/2,0>S&&(S=0),S+ls>b&&(S=b-ls),X=ls),Hi(s,S,i,X,z),w.visibility=Tl,w.background=D,w.borderRadius=z/2+Cf):w.visibility=op}},setDataModel:function(x){var b=this,m=b._dataModel,F=b._selectionModel;m!==x&&(m&&(m.ump(b.handleDataModelPropertyChange,b),m.umm(b.handleDataModelChange,b),m.umd(b.handleDataPropertyChange,b),m.removeIndexChangeListener(b._75O,b),m.removeHierarchyChangeListener(b.handleHierarchyChange,b),F||m.sm().ums(b.handleSelectionChange,b)),b._dataModel=x,x.mp(b.handleDataModelPropertyChange,b),x.mm(b.handleDataModelChange,b),x.md(b.handleDataPropertyChange,b),x.addIndexChangeListener(b._75O,b),x.addHierarchyChangeListener(b.handleHierarchyChange,b),F?F._21I(x):x.sm().ms(b.handleSelectionChange,b),b.invalidateAll(!0),b.fp(Lr,m,x),b.updateBackground())},getLayersInfo:function(){if(this._layersInfo===J){var x=this.getLayers();x?(this._layersInfo={},x.forEach(function(x){var l=yl(x)?x.name:x;this._layersInfo[l]=x},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(N,o,E){var I,J,x=this,P=x.getDataUI(N),y=zn(P),S=Zl(o,function(o){return qr(y,100*o)},100,.001),D=qr(y,100*S);if(!E){var G=gs(P),H=new kc(D.x,D.y),X=49/(x._zoom*x._zoom);for(I=0,J=G.length;J>I;I++)if(H.distanceToSquared(G[I])<X)return{index:I,point:G[I],distance:Math.sqrt((G[I].x-o.x)*(G[I].x-o.x)+(G[I].y-o.y)*(G[I].y-o.y))}}return{percent:S,point:D,distance:Math.sqrt((D.x-o.x)*(D.x-o.x)+(D.y-o.y)*(D.y-o.y))}},calculateAttachPoint:function(){var C=new kc,v=new kc,H=new kc;return function(B,X){var M=this.getAttachPoints(B);if(!M||!M.length)return null;H.set(X.x,X.y);for(var _,N,T,G,J=1/0,R=0,d=M.length;d>R;R++)T=M[R],v.x=T.x,v.y=T.y,C.x=T.offsetX||0,C.y=T.offsetY||0,G=kq(this,B,0,C.x,C.y,v.x,v.y),N=H.distanceToSquared(G),J>N&&(_=R,J=N);J=Math.sqrt(J);var r=this.getAttachStyle(B);if("close"===r){var K=B.s("attach.close.threshold")/this._zoom;if(J>K)return null}return{index:_,distance:J,info:M[_]}}}(),getAttachPoints:function(l){var d=l.s("attach.points");if(d)return d;var y=Hf(l._image);return y?Wf(y.attachPoints,l,this)||null:void 0},getAttachStyle:function(z){var H=z.s("attach.style");if(H)return H;var w=Hf(z._image);return w?Wf(w.attachStyle,z,this)||"close":void 0},updateLayers:function(){this._layersInfo=J,this.invalidateSelection(),this.redraw()},updateBackground:function(){var A=this.dm().a("width"),G=this.dm().a("height");this._canvas.style.background=A>0&&G>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(w){if("background"===w.property){var D=this._canvas.style.background,m=w.newValue||"";this.updateBackground(),this.fp("canvasBackground",D,m),this.redraw()}else"a:width"===w.property||"a:height"===w.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===w.property?this.updateLayers():"hierarchicalRendering"===w.property&&this.redraw()},handleDataPropertyChange:function(k){this.dm().isHierarchicalRendering()&&"parent"===k.property&&k.data.hasChildren()&&this.redraw(),this.invalidateData(k.data)},onPropertyChanged:function(g){var t=this,f=g.property;if(t.redraw(),"zoom"===f){var B=t.sm().getSelection();B.size()&&B.each(function(a){a.invalidate()})}po[f]?t.showScrollBar():f===ch&&t.onCurrentSubGraphChanged(g)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(m){var o=this,R=m.kind,i=m.data;if(o._83I=1,"add"===R)o.invalidateData(i),$k(i)&&i.getEdgeGroup()&&i.getEdgeGroup().eachSiblingEdge(o.invalidateData,o);else if(R===hb){o._21Q(i);var _=i._id,J=o._25I[_];if(J){if(o._56I[_]){var x=J._79o();x&&o.redraw(x)}J.dispose(),delete o._25I[_],delete o._24I[_],delete o._56I[_]}i===o._currentSubGraph&&o.setCurrentSubGraph(d)}else R===Ng&&(o.invalidateAll(!0),o.setCurrentSubGraph(d))},_75O:function(N){this.invalidateData(N.data)},handleHierarchyChange:function(Y){this.dm().isHierarchicalRendering()&&Y.data.hasChildren()&&this.redraw(),this.invalidateData(Y.data)},adjustIndex:function(E){var t=this;if(t.isVisible(E)){t.dm().beginTransaction();for(var K=E;K._parent&&t.isVisible(K._parent);)K=K._parent;K&&K!==E&&t._dataModel.adjustIndex(K),t._dataModel.adjustIndex(E),t.dm().endTransaction()}},getImage:function(F){return F.getImage?F.getImage():J},getSelectWidth:function(A){var j=Hf(this.getImage(A));return j&&Wf(j.disableSelectedBorder,A,this)?0:A.s("select.width")},getSelectColor:function(r){return r.s("select.color")},isSelectable:function(X,f){if(this.isSelected(X))return!0;if(!f&&X.getParent()instanceof Mi&&this.isSelectable(X.getParent(),!0)&&X.getParent().isSyncSize())return!1;var W=this.getLayersInfo();if(W){var C=W[X._layer];if(C&&C.selectable===!1)return!1}return X.s("2d.selectable")&&this.sm().isSelectable(X)},isMovable:function(U){var g=this;if($k(U)&&U.getStyle(lc)!==of)return!1;var t=this.getLayersInfo();if(t){var C=t[U._layer];if(C&&C.movable===!1)return!1}return U.s("2d.movable")?g._movableFunc?g._movableFunc(U):!0:!1},isEditable:function(n){var X=this;if(P._uiSerializing)return X._uieditable;if(!X._editInteractor||!X.isSelected(n))return!1;if(Cb(n)){var L=X.getDataUI(n);if(!L||L._88I)return!1}if($k(n)&&n.getStyle(lc)!==of)return!1;var R=this.getLayersInfo();if(R){var p=R[n._layer];if(p&&p.editable===!1)return!1}return n.s("2d.editable")?X._editableFunc?X._editableFunc(n):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(Y){return Mp(Y)&&0!==Y.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(Y):!0},isRectEditable:function(x){return this._rectEditableFunc?this._rectEditableFunc(x):!0},isAnchorEditable:function(S){return this._anchorEditableFunc?this._anchorEditableFunc(S):!0},isRotationEditable:function(A){return A.setRotation&&A.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(A):!0:!1},getRotationPoint:function(y){var Z=y.getAnchor(),L=y.getScale(),x=this._zoom,N=cb(y.getRotation(),0,-y.getHeight()*L.y*Z.y-(L.y<0?-1:1)*(Qr?32:16)/x),I=y.p();return N.x+=I.x,N.y+=I.y,N},getLogicalPoint:function(R){var i=this;return Ub(R,i._canvas,i.tx(),i.ty(),i._zoom,i._zoom)},getScreenPoint:function(b,m){var y,$=this;return"object"==typeof b?b.x!==J?(y=b.x,m=b.y):(y=b[0],m=b[1]):y=b,Cp(y,m,$._canvas,$.tx(),$.ty(),$._zoom,$._zoom)},getSelectedDataAt:function(e){var i=this;return this.getDataAt(e,function(K){return i.isSelected(K)})},getDataInfoAt:function($,s,o){var a,l=this.lp($),_=this.getDataAt(l,s,o);if(_){var J=this.getDataUI(_);a={data:_,ui:J,point:l};var p=J._38o;if(p){var m=p.icons;for(var D in m){var U=m[D],x=p.rects[D];if(x)for(var u=Wf(U.names,_,this),T=u?u.length:0,B=x.rotation,g=T-1;g>=0;g--){var R=u[g],K=x[g];if(mb(K,l,B))return a.part="icons",a.name=D,a.icon=R,a.rect=K,a.index=g,a.rotation=B,a}}}if(this.isNoteVisible(_)){if(J.note2Info&&mb(J.note2Info.clickRect,l,d,J.note2Info.scale))return a.part="note2",a;if(J.noteInfo&&mb(J.noteInfo.clickRect,l,d,J.noteInfo.scale))return a.part="note",a}if(this.isLabelVisible(_)){if(J.label2Info&&mb(J.label2Info.rect,l,J.label2Info.rotation,J.label2Info.scale))return a.part="label2",a;if(J.labelInfo&&mb(J.labelInfo.rect,l,J.labelInfo.rotation,J.labelInfo.scale))return a.part="label",a}if(_.isInRect&&_.isInRect(l))return a.part="body",a}return a},getDataAt:function(m,B,D){m.target&&(m=this.lp(m));var I,S=this._zoom;return this.reverseEach(function(L){return(B?B(L):this.isSelectable(L))&&this.rectIntersects(L,Wn(m.x,m.y,D,S))?(I=L,!1):void 0},this),I},getIconInfoAt:function(u,C){var W=this;if(u.target&&(u=W.lp(u)),C||(C=W.getDataAt(u)),C){var T=W.getDataUI(C);if(T&&T._38o){var $,t=T._38o,q=new nm;for($ in t.icons)q.add($);for(var S=q.size()-1;S>=0;S--){$=q.get(S);for(var Z=t.rects[$],Q=Z.rotation,N=Z.length-1;N>=0;N--){var M=Z[N],L=M.width,O=M.height,g={x:u.x-M.x-L/2,y:u.y-M.y-O/2};Q!=d&&(g=cb(-Q,g.x,g.y));var M={x:-L/2,y:-O/2,width:L,height:O};if(mb(M,g))return{key:$,index:N,name:t.icons[$].names[N],rect:Z[N],point:u,rotation:Q,relativeRect:M,relativePoint:g,data:C}}}}}return d},getDatasInRect:function(j,u,w){w===J&&(w=1);var v=this,n=new nm;return v.reverseEach(function(E){w&&!v.isSelectable(E)||(u?v.rectIntersects(E,j):v.rectContains(E,j))&&n.add(E)}),n},moveSelection:function(l,s){var i=this;i.dm().beginTransaction(),Xg(i.sm().toSelection(i.isMovable,i),l,s),i.dm().endTransaction()},moveDatas:function(F,I,l){var Z=this;Z.dm().beginTransaction(),F instanceof nm||(F=new nm(F)),Xg(F,I,l),Z.dm().endTransaction()},getDataUIBounds:function(D){var t=this.getDataUI(D);return t?t._79o():d},drawData:function(L,i,z){var a=this.getDataUI(i);if(a){var E=a._79o();(!z||Ri(z,E))&&(a._42(L),i instanceof P.Block&&i.eachChild(function(t){this.drawData(L,t,z)},this))}},getBoundsForGroup:function(X){return X.s(Bg)?this.getDataUIBounds(X):d},isPixelPerfect:function(_){return _.s("pixelPerfect")},rectIntersects:function(Z,o){this.validate();var l=d;if(this._56I[Z._id]){var L=this._25I[Z._id];if(L){var R=L._79o();if(Hh(o,R))l=!0;else if((o=hh(o,R))&&(L.rectIntersects&&(l=L.rectIntersects(o)),l==d)){if(!this.isPixelPerfect(Z))return!0;var m=o.x,E=o.y,W=o.width,Q=o.height,K=this._zoom,f=F.hitMaxArea,z=W*Q*K*K;if(z>f){var N=Math.sqrt(f/z);K*=N}W*=K,Q*=K,2>W&&(W=2),2>Q&&(Q=2),m*=K,E*=K;var V=ed(W,Q);Rg(V,-m,-E),V.scale(K,K),this._drawForChecking=!0,this.drawData(V,Z,o),this._drawForChecking=!1;try{for(var A=0,H=V.getImageData(0,0,W,Q).data;A<H.length;A+=4)if(0!==H[A+3]){l=!0;break}V.restore()}catch(C){qs=d,l=!1}}}}return l?!0:!1},rectContains:function(e,Y){if(this._56I[e._id]){var i=this._25I[e._id];if(i)return Hh(Y,i._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(L){if(!F.isInput(L.target)){var W=this,J=W._focusData,j=J&&W._25I[J._id],y=0,Z=W._dataModel._datas;if(!(J&&J._enabled&&J._editable&&j&&j.onKeyDown&&j.onKeyDown(L)===!0))if(9===L.keyCode&&(J&&(y=Z.indexOf(J),xk(L)?-1===--y&&(y=0):++y===Z.size()&&(y=0)),W._focusData=J=Z.get(y),W.sm().setSelection(J)),nd(L)?W.selectAll():br(L)&&W.isResettable()&&W.reset(),W.sm().isEmpty()){if(W._editing)return;var b=W.tx(),o=W.ty(),n=!1,c=xk()?100:10;Xe(L)&&(b-=c,n=!0),ci(L)&&(o-=c,n=!0),Vf(L)&&(b+=c,n=!0),Vk(L)&&(o+=c,n=!0),n&&W.setTranslate(b,o)}else{fd(L)&&W.handleDelete(L);var V=xk()?10:1;Xe(L)&&(W.moveSelection(-V,0),W.fi({kind:"moveLeft"})),ci(L)&&(W.moveSelection(0,-V),W.fi({kind:"moveUp"})),Vf(L)&&(W.moveSelection(V,0),W.fi({kind:"moveRight"})),Vk(L)&&(W.moveSelection(0,V),W.fi({kind:"moveDown"}))}}},handleScroll:function(V,h){if(_l(V),this.isZoomable()){if(!this.getEditInteractor()){var T=this.getDataAt(V);if(T){var $=Hf(this.getImage(T));if($&&Wf($.scrollable,T,this))return}}var d=this.lp(V);h>0?this.scrollZoomIn(d):0>h&&this.scrollZoomOut(d)}},handlePinch:function(M,w,h){this.isZoomable()&&(this._68I||(w>h?this.pinchZoomIn(M):this.pinchZoomOut(M)))},checkDoubleClickOnNote:function(G,c){var R=this,W=R.lp(G),Z=R.getDataUI(c),s=Z.note2Info;return s&&c.s("note2.toggleable")&&mb(s.clickRect,W)?(c.s(tf,!c.s(tf)),R.fi({kind:"toggleNote2",event:G,data:c}),!0):(s=Z.noteInfo,s&&c.s("note.toggleable")&&mb(s.clickRect,W)?(c.s(Ac,!c.s(Ac)),R.fi({kind:"toggleNote",event:G,data:c}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(O,l){var V=this,Q=V.getAutoScrollZone(),M=Q/V.getZoom(),G=Q/4,f=V._29I,t=V.lp(O),X={x:V.tx(),y:V.ty()};return t&&Q>0&&f&&(t.x-f.x<M?V.translate(G,0):f.x+f.width-t.x<M&&V.translate(-G,0),t.y-f.y<M?V.translate(0,G):f.y+f.height-t.y<M&&V.translate(0,-G)),X.x=V.tx()-X.x,X.y=V.ty()-X.y,l&&(l.x+=X.x,l.y+=X.y),X},getMoveMode:function(s,$){var N=$.s("2d.move.mode");return N?N:js["88"]?"x":js["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(P,C,o){var W=this;return"currentSubGraph"===C?{__i:P.getId()}:o.serializeProperty(P,C,W)},deserializeProperty:function(h,w,D){var Y=this;if("currentSubGraph"===w){var U=Y.dm(),Z=U.__idMap;return Z[h.__i]}return D.deserializeProperty(h,w,Y)},setDefaultCursor:function(_,n){this._defaultCursor=_,n!==!1&&this.setCursor(_)},setCursor:function(B){"default"===B&&(B=this._defaultCursor||B);var j=this.getView().style;j.cursor=B,j.cursor="-webkit-"+B,j.cursor="-moz-"+B},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(i){return i===d||F.getConnectAction(null,i)?(this._currentActionType=i,this.redraw(),!0):!1},getEditStyle:function(Q){var M=this.getEditInteractor();return M?M.getStyle(Q):J},setEditStyle:function(D,Q,O){var T=this.getEditInteractor();return T?(T.setStyle(D,Q,O),!0):!1},isConnectActionVisible:function(Z){var S=F.getConnectAction(this);if(!S)return!1;var a=S.visible;return sr(a)&&(a=a(this,Z)),a},isInteractive:function(F){var _=Hf(this.getImage(F));return _&&Wf(_.interactive,F,this)?!0:F.s("interactive")},appendHTML:function(Z,r){var s=this.getView();if(!(r||Z&&Z.parentNode!==s))return!1;var Q=Z.getView&&Z.getView();if(!r&&Q&&Q.parentNode===s)return!1;(Z.getView||Z.isSelfViewEvent)&&(Z=Z.getView());var c=this.getEditInteractor();return c&&c._canvas?s.insertBefore(Z,c._canvas):this.isScrollBarVisible()?s.insertBefore(Z,this.getView().lastChild):oq(s,Z),!0},_layoutHTMLImpl:function(z,F,w){if(arguments.length>1){var y,B=this,v=B._zoom;if(F.getView&&(y=F,F=F.getView()),F.style.position="absolute",w){var R=z.getRect();Hi(y||F,B.tx()+R.x*v,B.ty()+R.y*v,R.width*v,R.height*v)}else{var g=new _d,R=z.getAnchorRect(),m=z.getPosition(),V=z.getScale(),L=F.style;Hi(y||F,R),g.appendTranslate(B.tx(),B.ty()),g.appendScale(v,v),g.append(new _d(z.getRotation(),m.x,m.y,V.x,V.y)),Fg(L,"transform","matrix("+g.a.toFixed(5)+", "+g.b.toFixed(5)+", "+g.c.toFixed(5)+",\n    "+g.d.toFixed(5)+", "+g.tx.toFixed(5)+", "+g.ty.toFixed(5)+")"),Fg(L,"transformOrigin",(-R.x).toFixed(5)+"px "+(-R.y).toFixed(5)+"px"),F._matrixAppend=g.invert().translate(-R.x,-R.y)}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(d){return d instanceof bn?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(n){var v="state",P=n.s(v);if(P)return P;var Q=Hf(n._image);return Q?Wf(Q[v],n,this)||null:void 0}}),r.defineProperties(vb.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(Q){this._layoutHTML=Q}}});var eo=function(O,o){var p=this;p.gv=O,p.s=function(X){return o.getStyle(X)},p._data=o,p._87I=new nm};$o(eo,r,{_6I:d,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var X=this,N=X.gv.isSelected(X._data);return!N||X.isShadowed()?0:X.gv.getSelectWidth(X._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(H){var X=this._data,u=this.gv.getBodyColor(X);return u?u:H?X.getStyle(H):d},_2Q:function(s){return this.s(s)},_1Q:function(A,i,Y,r){var e=this.s,E=e("2d.gray"),b=e(i+".dash.color");if(E&&(b=F.toGrayColor(b)),A.strokeStyle=b,A.lineWidth=Y,A.stroke(),e(i+".dash.3d")){var o=e(i+".dash.3d.color");oj(A,b,E?F.toGrayColor(o):o,Y,this.gv._zoom,e(i+".dash.3d.accuracy"))}pf(A,r)},invalidate:function(){this._6I=d},_79o:function(){var A=this;if(!A._6I){var K=A._data,s=A.gv;A.labelInfo=A.label2Info=A.noteInfo=A.note2Info=A._38o=d,A._87I.clear(),A.interactiveInfo=s.isInteractive(K)?{}:d,A._3O(),A._55O=s.isEditable(K)?{_42O:s.isRectEditable(K),_43O:s.isPointEditable(K),_56O:s.isRotationEditable(K)}:d,A._6I=A._81o()}return A._6I},_3O:function(){},getPosition:function(){return xp},_68o:function(Y,p){Y&&this._87I.add(cl(Y,p))},_81o:function(){var q=this,f=q.s;q._24O(Re,"getLabel"),q._24O(Jj,"getLabel2"),q._26O(tb,"getNote"),q._26O(yp,"getNote2"),q._15O(),q._55O&&q._48O();var k;if(q._87I.each(function(H){k=kr(k,H)}),k&&q.isShadowed()){var Q=oe(k);Q.x+=f("shadow.offset.x"),Q.y+=f("shadow.offset.y"),ub(Q,f("shadow.blur")),k=kr(k,Q)}return q._87I.clear(),k},_42:function(w){var f=this,I=f._data,F=f.gv,H=f.s,e=H("opacity"),X=this.isShadowed();if(X){var V=w.shadowOffsetX,s=w.shadowOffsetY,B=w.shadowBlur,D=w.shadowColor,P=F.getZoom();w.shadowOffsetX=H("shadow.offset.x")*P,w.shadowOffsetY=H("shadow.offset.y")*P,w.shadowBlur=H("shadow.blur")*P,w.shadowColor=f.getSelectColor()}if(e!=d){var _=w.globalAlpha;w.globalAlpha=e}f._80o(w),F.isLabelVisible(I)&&((!F._drawForChecking||H("label.selectable"))&&uq(w,f.labelInfo),(!F._drawForChecking||H("label2.selectable"))&&uq(w,f.label2Info)),F.isNoteVisible(I)&&(ts(w,f.noteInfo),ts(w,f.note2Info)),f._99O(w),e!=d&&(w.globalAlpha=_),X&&(w.shadowOffsetX=V,w.shadowOffsetY=s,w.shadowBlur=B,w.shadowColor=D)},_80o:function(){},_47O:function(){},_24O:function(g,z){var b=this,s=b._data,I=b.gv,E=b.s,e=I[z](s);if(e!=d){var u=E(g+".scale"),Z=E(g+".max"),A=E(g+".position"),M=b[g+"Info"]={label:e,scale:u,color:I[z+"Color"](s),font:E(g+".font"),opacity:E(g+".opacity"),align:E(g+".align"),rotation:b.getRotation(E(g+".rotation"),!1,A),background:I[z+"Background"](s)},q=pg(M,e);Z>0&&Z<q.width&&(M.labelWidth=q.width,q.width=Z),1!==u&&(q.width*=u,q.height*=u);var G=b.getPosition(A,E(g+".offset.x"),E(g+".offset.y"),q,E(g+".position.fixed"));if(q.x=G.x-q.width/2,q.y=G.y-q.height/2,b._68o(M.rect=q,M.rotation),1!==u){var r=q.width/u,k=q.height/u;M.rect={x:G.x-r/2,y:G.y-k/2,width:r,height:k}}}},_26O:function(s,U){var A=this,T=A.gv,z=A._data,I=A.s,H=T[U](z);if(H!=d){var Z,x,M=I(s+".scale"),e=A[s+"Info"]={note:H,scale:M,data:z,view:T,expanded:I(s+".expanded"),font:I(s+".font"),color:I(s+".color"),opacity:I(s+".opacity"),align:I(s+".align"),icon:I(s+".icon"),backgroundImage:I(s+".backgroundImage"),borderWidth:I(s+".border.width"),borderColor:I(s+".border.color"),background:T[U+"Background"](z)},B=A.getPosition(I(s+".position"),I(s+".offset.x"),I(s+".offset.y")),Q=B.x,O=B.y;if(e.expanded){var c,C=I(s+".max"),E=I(s+".backgroundImage");E?(E=Hf(E),c={width:li(E,z),height:Kn(E,z)}):c=pg(e,H),c.width+=6,c.height+=2,C>0&&C<c.width&&(e.labelWidth=c.width,c.width=C),Z=c.width,x=c.height+8,e.clickRect={x:Q-Z*M/2,y:O-x*M,width:Z*M,height:x*M*c.height/x}}else{var L=I(s+".icon");L?(L=Hf(L),Z=li(L,z),x=Kn(L,z)):(Z=12,x=18),e.clickRect={x:Q-Z*M/2,y:O-x*M,width:Z*M,height:x*M}}e.rect={x:Q-Z/2,y:O-x*M/2-x/2,width:Z,height:x};var v=n(e.borderWidth/2)*M;A._68o({x:Q-Z*M/2-v,y:O-x*M-v,width:Z*M+2*v,height:x*M+2*v})}},_48O:function(){},_99O:function(R){var W=this,l=W._38o;if(l){var p=W.gv,P=W._data,G=l.icons,i=W.interactiveInfo;i&&(i._38o={});for(var y in G){var s=G[y],K=l.rects[y];if(K){i&&(i._38o[y]=[]);var V=Wf(s.opacity,P,p),j=Wf(s.names,P,p),b=j?j.length:0,$=K.rotation;if(V!=d){var D=R.globalAlpha;R.globalAlpha*=V}for(var F=0;b>F;F++){var A=j[F],E=Hf(A),n=K[F];if($){var x=n.x+n.width/2,M=n.y+n.height/2;R.save(),Rg(R,x,M),Nl(R,$),Rg(R,-x,-M)}i&&i._38o[y].push(R.interactiveInfo={compInfos:[],matrix:$?new _d($,x,M).appendTranslate(-x,-M):new _d}),wo(R,E,Wf(s.stretch,P,p),n.x,n.y,n.width,n.height,W._data,W.gv),R.interactiveInfo=d,$&&R.restore()}V!=d&&(R.globalAlpha=D)}}}}});var he=function(G,z){ii(he,this,[G,z])};$o(he,eo,{_checkEmptyRect:!0,_40O:function(Q,U){var y=this,u=y.s,E=Q.rect;
(Q.borderColor=y.gv.getBorderColor(y._data))&&(Q.borderType=u("border.type"),Q.borderWidth=u("border.width"),Q.borderPadding=u("border.padding"),U=T(U,Q.borderPadding+Q.borderWidth/2));var b=y._data.getScale(),B=T(1,T(j(b.x),j(b.y)));if(Q.selectWidth=y.getSelectWidth()){var G=y.gv._zoom;Q.selectType=u("select.type"),Q._97o=y.getSelectColor(),Q.selectPadding=u("select.padding"),U=T(U,(Q.selectPadding+Q.selectWidth/2/G)/B)}U>0&&(U*=B,E=oe(E),ub(E,U)),y._68o(E)},_39O:function(f,Q){var Z,N=this,U=Q.rect;if(Q.borderWidth>0&&(Z=Q.borderPadding,f.strokeStyle=Q.borderColor,f.lineWidth=Q.borderWidth,qb(f,Q.borderType,{x:U.x-Z,y:U.y-Z,width:U.width+2*Z,height:U.height+2*Z}),f.stroke()),Q.selectWidth>0){var o=N.gv._zoom;if(Z=Q.selectPadding,f.strokeStyle=Q._97o,f.lineWidth=Q.selectWidth/o,Q.rotation!=d){f.save(),f.translate(Q.position.x,Q.position.y),f.rotate(Q.rotation);var D=N._data,X=D.getWidth(),e=D.getHeight(),v=Q.scale,B=Q.anchor;U={x:v.x*-X*B.x,y:v.y*-e*B.y,width:v.x*X,height:v.y*e}}qb(f,Q.selectType,{x:U.x-Z,y:U.y-Z,width:U.width+2*Z,height:U.height+2*Z}),Q.rotation!=d&&f.restore(),f.stroke()}},dispose:function(){var i=this,M=i._htmlView;he.superClass._3O.call(i),M&&(M.onHTMLRemoved&&M.onHTMLRemoved(),Hq(M))},_3O:function(){var m=this,f=m.s,e=m._data,u=m.gv,c=e.getStyle(zd),C=m.getBodyColor(),B=m._83o=c?{shape:c,_53o:m.getBodyColor("shape.background"),_27Q:Hf(f("shape.repeat.image"),C),shapeGradientPack:f("shape.gradient.pack"),_54o:f("shape.border.width"),_55o:f("shape.border.color"),_56o:f("shape.border.3d"),_57o:f("shape.border.3d.color"),_58o:f("shape.border.3d.accuracy"),shapeGradient:f("shape.gradient"),_59o:f("shape.gradient.color"),_60o:f("shape.border.pattern"),_61o:f("shape.border.cap"),_62o:f("shape.border.join"),shapeForeground:f("shape.foreground"),bodyColor:C,gray:f("2d.gray")}:{img:Hf(u.getImage(e),C),bodyColor:C,gray:f("2d.gray"),stretch:f("image.stretch")};if(U&&!a);else{var Y,F=B.img;F&&F.renderHTML?(m._htmlInfo&&m._htmlInfo.img!==F&&(m._htmlInfo=d),m._htmlInfo||(m._htmlInfo={img:F,cache:{}}),Y=F.renderHTML(e,u,m._htmlInfo.cache)):m._htmlInfo=d,m._htmlView&&m._htmlView!==Y&&(m._htmlView.onHTMLRemoved&&m._htmlView.onHTMLRemoved(),Hq(m._htmlView.getView?m._htmlView.getView():m._htmlView)),(m._htmlView=Y)&&u.appendHTML(Y)&&(Y.onHTMLAddedSync&&Y.onHTMLAddedSync(),Y.onHTMLAdded&&Vo(Y.onHTMLAdded)),B.rect=e.getRect(),B.position=e.p(),B.scale=e.getScale(),B.anchor=e.getAnchor(),B.rotation=e.getRotation(),c===hp&&(B._63o=f("shape.depth"));var g=0;if(c)g=Id(d,B._54o/2,B._62o),m.s("shape.dash")&&(g=T(g,(m.s("shape.dash.width")||B._54o)/2));else if(F&&F.boundExtend)if(g=Wf(F.boundExtend,e,u),F.boundExtendAbsolute){var h=e.getScale();g/=u._zoom*T(1,T(j(h.x),j(h.y)))}else if(!Wf(F.fitSize,e,u)){var E=Wf(F.width,e,u),K=Wf(F.height,e,u);g*=T(e.getWidth()/E,e.getHeight()/K)}m._40O(B,g);var s=f("clip.percentage");if(1>s&&(0>s&&(s=0),B.clipRect=qe(e.getAnchorRect(),f("clip.direction"),s)),c){var A=f("shape.fill.clip.percentage");1>A&&(0>A&&(A=0),B.shapeClipRect=qe(e.getAnchorRect(),f("shape.fill.clip.direction"),A));var J=f("shape.foreground.clip.percentage");1>J&&(0>J&&(J=0),B.shapeForegroundClipRect=qe(e.getAnchorRect(),f("shape.foreground.clip.direction"),J))}}},getPosition:function(_,m,O,C){var n=ui(_,this._83o.rect,C);return n.x+=m,n.y+=O,n},_80o:function(q){var l=this,i=l.s,y=l.gv,D=l._data,N=l._83o,v=N.rect,G=N.position,b=N.rotation,O=N.anchor,f=N.scale,I=N.shape,J=N.clipRect;if(!l._checkEmptyRect||v.width>0&&v.height>0){var Z=D.getSize();if(Z.x=-Z.width*O.x,Z.y=-Z.height*O.y,q.save(),Rg(q,G.x,G.y),Nl(q,b),Sc(q,f.x,f.y),J&&(q.beginPath(),q.rect(J.x,J.y,J.width,J.height),q.clip()),y._drawForChecking&&N.img&&Wf(N.img.pixelPerfect,D,y)===!1)Pe(q,Z.x,Z.y,Z.width,Z.height,"#888888");else if(l.freeDraw)l.freeDraw(q,Z,N);else if(I){var C,U,r,o,m=N._60o,E=Vj(q,m),x=N._27Q,g=N._54o,M=N.shapeGradientPack,H=N.gray,R=q.lineJoin,K=q.lineCap,L=function(J){return H?F.toGrayColor(J):J};"roundRect"===I?C=i("shape.corner.radius"):"polygon"===I?C=i("shape.polygon.side"):"arc"===I&&(C=i("shape.arc.from"),U=i("shape.arc.to"),r=i("shape.arc.close"),o=i("shape.arc.oval")),q.lineJoin=N._62o,q.lineCap=N._61o;var t=L(N._53o);if(t||x||M){var V=N.shapeClipRect;V&&(q.save(),q.beginPath(),q.rect(V.x,V.y,V.width,V.height),q.clip()),qb(q,I,Z,C,U,r,o),M?Ek(q,M):x?Uj(q,x,L(N.bodyColor),null,D,y):Jf(q,t,N.shapeGradient,L(N._59o),Z),q.fill(),V&&q.restore(),M&&q.restore(),q!==E&&qb(E,I,Z,C,U,r,o)}else qb(E,I,Z,C,U,r,o);var X=N.shapeForeground;if(X){q.save();var A=N.shapeForegroundClipRect;A&&(q.beginPath(),q.rect(A.x,A.y,A.width,A.height),q.clip()),qb(q,I,Z,C,U,r,o),Jf(q,X,i("shape.foreground.gradient"),L(i("shape.foreground.gradient.color")),Z),q.fill(),q.restore()}if(g>0){var z=i("shape.border.width.absolute");z&&(q.save(),q.setTransform(1,0,0,1,0,0)),q.lineWidth=g;var W=L(N._55o);q.strokeStyle=W,q.stroke(),z&&q.restore(),N._56o&&oj(q,W,L(N._57o),g,y._zoom,N._58o)}if(pf(q,m),i("shape.dash")){var $=i("shape.dash.width")||g;if($>0){m=i("shape.dash.pattern");var E=Vj(q,m,l._2Q("shape.dash.offset"));E!==q&&qb(E,I,Z,C,U,r,o),l._1Q(q,"shape",$,m)}}Rd(q,t,N._63o,Z),q.lineJoin=R,q.lineCap=K}else{var c=l.interactiveInfo;c&&(q.interactiveInfo=c.bodyInfo={compInfos:[],matrix:new _d(b,G.x,G.y,f.x,f.y)}),N.gray&&(q.compGray=!0);var u=N.img;u&&u.cacheRule!=d&&(u=gc(q,u,N.stretch,Z.width,Z.height,D,y,N.bodyColor)),wo(q,u,N.stretch,Z.x,Z.y,Z.width,Z.height,D,y,N.bodyColor),q.compGray=!1,q.interactiveInfo=d}q.restore()}l._39O(q,N)},_48O:function(){},_47O:function(){}});var qi=function(H,s){ii(qi,this,[H,s])},_m=function(z,F,S,j){var Q=jc(z,F);return S=j?e(S,Q):Kc(S,Q),Q?S/=Q:S=0,{x:z.x+(F.x-z.x)*S,y:z.y+(F.y-z.y)*S}};$o(qi,eo,{_3O:function(){var U,R=this,W=R._data,Z=R.gv,B=R.s,a=B(lc),w=W.isLooped(),O=B("edge.width"),c=B("edge.center"),s=B("edge.offset"),P=Z.getBorderColor(W),j=P?B("border.width"):0,z=R.getSelectWidth(),h=W._40I,C=W._41I,E=R._78o=h&&C?{looped:w,type:a,width:O,center:c,color:R.getBodyColor("edge.color"),borderColor:P,borderWidth:j,_97o:z?R.getSelectColor():d,selectWidth:z,pattern:B("edge.pattern"),cap:B("edge.cap"),join:B("edge.join"),is3d:B("edge.3d"),_67o:B("edge.3d.color"),_66o:B("edge.3d.accuracy"),gray:B("2d.gray")}:d;if(E){var G=F.getEdgeType(a);if(G){var m=G(W,_j(R,Z,W,w,a),Z,R._19Q);m.points&&m.points.size()>1?(E.edgeTypeInfo=m,U=io(E.edgeTypeInfo.points)):m[Wo]&&m.rect&&(E.edgeTypeInfo=m,U=m.rect)}else{var Y=B("edge.source.anchor.x"),r=B("edge.source.anchor.y"),K=B("edge.target.anchor.x"),g=B("edge.target.anchor.y"),N=Qg(Z,W,"source"),p=Qg(Z,W,"target");if(a===of){var v=E.points=B(Zk)||pr,q=v.size();E.segments=B("edge.segments");var A=Y!==J||r!==J||$k(h),L=K!==J||g!==J||$k(C);if(!c)if(s)A||(N=_m(N,q?v.get(0):p,s,q)),L||(p=_m(p,q?v.get(q-1):N,s,q));else{var V;A||(V=ns(N,q?v.get(0):p,Dr(Z,h)),V&&(N={x:V[0],y:V[1]})),L||(V=ns(q?v.get(q-1):N,p,Dr(Z,C)),V&&(p={x:V[0],y:V[1]}))}U=kr(io(E.points),io(N,p))}else{var e=_j(R,Z,W,w,a);if(R._19Q||(e=-e),w)N=oe(N),N.x=Z.getNodeRect(h).x,E.radius=e,U={x:N.x-e,y:N.y-e,width:2*e,height:2*e};else{var x=jc(N,p),I=Kc(s,x),S={x:I,y:e},y={x:x-I,y:e},Q=k(p.y-N.y,p.x-N.x),n=E.mat=new Vr(Q);if(E.orienAngle=Q,E.angle=p.x<N.x?Q+M:Q,E.rect={x:S.x,y:S.y,width:y.x-S.x,height:0},E.origin=N,S=n.tf(S),S.x+=N.x,S.y+=N.y,y=n.tf(y),y.x+=N.x,y.y+=N.y,c){var D={x:x,y:0};D=n.tf(D),D.x+=N.x,D.y+=N.y,U=io([N,S,y,D]),E.c1=N,E.c2=D}else U=io(S,y);N=S,p=y}}E.sourcePoint=N,E.targetPoint=p,W._lastSourcePoint=N,W._lastTargetPoint=p}var f=0;B("edge.dash")&&(f=B("edge.dash.width")||O);var u="square"===E.cap?.71:.5;Id(U,T(f*u,O*u+j+z),E.join),R._68o(U)}},getRotation:function(W,s,r){W=W||0;var k=this._78o;if(k){var P,j=k.angle,N=k.points,u=k.edgeTypeInfo;if(j!=d)return s?k.orienAngle+W:j+W;if(u&&u[Wo])return u.getRotation?u.getRotation(this,W,s,r):0;if(u&&u.points){var e=u.points;return P=e.size(),_e[r]?P&&0===P%2?bf(e.get(P/2-1),e.get(P/2),s,W):W:xb[r]?bf(e.get(0),e.get(1),s,W):bf(e.get(P-2),e.get(P-1),s,W)}if(N)return P=N.size(),_e[r]?P&&0===P%2?bf(N.get(P/2-1),N.get(P/2),s,W):W:xb[r]?bf(k.sourcePoint,P?N.get(0):k.targetPoint,s,W):bf(P?N.get(P-1):k.sourcePoint,k.targetPoint,s,W)}return W},getPosition:function(P,Y,e,j,Q){var t=this._78o;if(t){var d,K=t.type,U=t.points,X=t.edgeTypeInfo,w=t.sourcePoint,l=t.targetPoint;if(!K)return t.looped?{x:w.x-t.radius+Y,y:w.y+e}:(Q&&w&&l&&(w.x>l.x||w.x===l.x&&w.y>l.y)&&(P=Qf[P],e=-e),d=ui(P,t.rect,j),d.x+=Y,d.y+=e,d=t.mat.tf(d),d.x+=t.origin.x,d.y+=t.origin.y,d);if(X&&X[Wo])return X.getPosition?X.getPosition(this,P,Y,e,j,Q):{x:(w.x+l.x)/2,y:(w.y+l.y)/2};if(U){var d,n=U.size();if(_e[P]){if(n){var u=n%2;if(0===u)return Aj(U.get(n/2-1),U.get(n/2),P,Y,e,j,Q);d=U.get((n-u)/2)}else d={x:(w.x+l.x)/2,y:(w.y+l.y)/2};return d=ui(P,{x:d.x,y:d.y,width:0,height:0},j),d.x+=Y,d.y+=e,d}return xb[P]?Aj(w,n?U.get(0):l,P,Y,e,j,Q):Aj(n?U.get(n-1):w,l,P,Y,e,j,Q)}if(X){var m=X.points,n=m.size();if(_e[P]){var u=n%2;return 0===u?Aj(m.get(n/2-1),m.get(n/2),P,Y,e,j,Q):(d=m.get((n-u)/2),d=ui(P,{x:d.x,y:d.y,width:0,height:0},j),d.x+=Y,d.y+=e,d)}return xb[P]?Aj(m.get(0),m.get(1),P,Y,e,j,Q):Aj(m.get(n-2),m.get(n-1),P,Y,e,j,Q)}}return xp},_42:function(b){this._78o&&qi.superClass._42.call(this,b)},drawPath:function(s,$){s.beginPath();var A=$.type,q=$.points,j=$.segments,e=$.edgeTypeInfo;if(!A||q){var v=$.sourcePoint,o=v.x,u=v.y,F=$.targetPoint,f=F.x,Y=F.y;if(A)if(j){var a=new nm({x:o,y:u});a.addAll(q),a.add({x:f,y:Y}),Bs(s,a,j)}else s.moveTo(o,u),q.each(function(x){s.lineTo(x.x,x.y)}),s.lineTo(f,Y);else $.looped?s.arc(o,u,$.radius,0,p,!0):$.center?(s.moveTo($.c1.x,$.c1.y),s.lineTo(o,u),s.lineTo(f,Y),s.lineTo($.c2.x,$.c2.y)):(s.moveTo(o,u),s.lineTo(f,Y))}else e&&(e.points?Bs(s,e.points,e.segments):e[Wo]&&e[Wo](s,e))},_80o:function(h){var t=this,z=t.s,H=t._78o,i=H.width,y=H.selectWidth,D=H.borderWidth,p=h.lineJoin,e=h.lineCap,x=H.gray,v=H.pattern;h.lineJoin=H.join,h.lineCap=H.cap,t.drawPath(Vj(h,v),H);var k=z("edge.width.absolute");k&&(h.save(),h.setTransform(1,0,0,1,0,0)),y&&(h.strokeStyle=H._97o,h.lineWidth=i+2*(D+y),h.stroke()),D&&(h.strokeStyle=x?F.toGrayColor(H.borderColor):H.borderColor,h.lineWidth=i+2*D,h.stroke());var R=x?F.toGrayColor(H.color):H.color,m=x?F.toGrayColor(H._67o):H._67o;if(h.strokeStyle=R,h.lineWidth=i,h.stroke(),H.is3d&&oj(h,R,m,i,t.gv._zoom,H._66o),k&&h.restore(),pf(h,v),z("edge.dash")){v=z("edge.dash.pattern");var O=Vj(h,v,t._2Q("edge.dash.offset"));O!==h&&t.drawPath(O,H),t._1Q(h,"edge",z("edge.dash.width")||i,v)}h.lineJoin=p,h.lineCap=e},_48O:function(){},_47O:function(){}});var If=function(Z,x){ii(If,this,[Z,x])};$o(If,he,{_3O:function(){var m,U,l=this,a=l.s,f=l._data,k=l.gv;if(l._88I=d,f.isExpanded()&&f.eachChild(function(J){if(Mp(J)){var S=k.getBoundsForGroup(J);S&&(U||(U=[]),U.push(S),m=kr(m,S))}}),m){var N=k.getLabel(f),F=a("group.type");m=mm(F,U,m),ic(m,f,"group.padding",1);var A=l._88I={type:F,rect:m,_64o:m};if(!F&&N!=d){var M,$=l.labelInfo={label:N,color:a("group.title.color"),font:a("group.title.font"),align:a("group.title.align")},x=pg($,N),D=x.width,K=x.height,X=a("group.title.align"),B=a("group.title.orientation");if((B===ai||B===el)&&D>m.width?m.width=D:(B===Km||B===_i)&&D>m.height&&(m.height=D),$.rect={y:m.y-K,width:x.width,height:K},M=X===Km?m.x:X===_i?m.x+m.width-D:m.x+m.width/2-D/2,$.rect.x=M,B===el)A.titleRect={x:m.x,y:m.y+m.height,width:m.width,height:K},A.rect={x:m.x,y:m.y,width:m.width,height:m.height+K},$.rect={x:M,y:m.y+m.height,width:D,height:K};else if(B===Km){var S=A.titleRect={x:m.x-K,y:m.y,width:K,height:m.height};A.rect={x:m.x-K,y:m.y,width:m.width+K,height:m.height},$.rect={x:S.x+K/2-m.height/2,y:S.y+m.height/2-K/2,width:m.height,height:K},$.rotation=-Math.PI/2}else if(B===_i){var S=A.titleRect={x:m.x+m.width,y:m.y,width:K,height:m.height};A.rect={x:m.x,y:m.y,width:m.width+K,height:m.height},$.rect={x:S.x+K/2-m.height/2,y:S.y+m.height/2-K/2,width:m.height,height:K},$.rotation=Math.PI/2}else A.titleRect={x:m.x,y:m.y-K,width:m.width,height:K+1},A.rect={x:m.x,y:m.y-K,width:m.width,height:m.height+K}}l._40O(A,a("group.border.width")/2)}else If.superClass._3O.call(l)},getPosition:function(U,B,c,J){var n=this._88I;if(n){var s=ui(U,n.rect,J);return s.x+=B,s.y+=c,s}return If.superClass.getPosition.apply(this,arguments)},_24O:function(Z,c){var E=this._88I;(!E||E.type||"label2"===Z)&&If.superClass._24O.call(this,Z,c)},_80o:function(X){var i=this,y=i._88I;if(y){var Z=i._data,t=i.s,o=i.gv,N=y.type,r=y.rect,w=y._64o,h=y.titleRect,D=i.getBodyColor(),B=Hf(t("group.image"),D),v=t("group.image.stretch"),c=i.getBodyColor("group.background"),p=Hf(t("group.repeat.image"),D),q=t("group.gradient.pack"),z=t("group.gradient"),j=t("group.gradient.color"),$=t("group.border.width"),a=t("group.border.color"),_=t("group.border.pattern"),l=t("group.title.orientation"),G=t("group.depth");if(N){var f=X.lineJoin,P=X.lineCap;if(X.lineJoin=t("group.border.join"),X.lineCap=t("group.border.cap"),B){if(X.save(),qb(X,N,r),X.clip(),wo(X,B,v,r.x,r.y,r.width,r.height,Z,o,D),X.restore(),$>0){var K=Vj(X,_);qb(K,N,r),X.lineWidth=$,X.strokeStyle=a,X.stroke(),pf(X,_)}}else{var K=Vj(X,_);c||p||q?(qb(X,N,r),q?Ek(X,q):p?Uj(X,p,D,null,Z,o):Jf(X,c,z,j,r),X.fill(),q&&X.restore(),X!==K&&qb(K,N,r)):qb(K,N,r),$>0&&(X.lineWidth=$,X.strokeStyle=t("group.border.color"),X.stroke()),pf(X,_),N===hp&&Rd(X,c,G,r)}X.lineJoin=f,X.lineCap=P}else{var V=t("group.title.background"),A=t("group.border.radius");if(B)wo(X,B,v,w.x,w.y,w.width,w.height,Z,o,i.getBodyColor());else if(c||p)if(p?Uj(X,p,D,null,Z,o):Jf(X,c,z,j,w),0===$)qb(X,hp,w),X.fill(),Rd(X,c,G,w);else{switch(X.beginPath(),l){case el:Mq(X,w.x,w.y,w.width,w.height,A,A,0,0);break;case Km:Mq(X,w.x,w.y,w.width,w.height,0,A,0,A);break;case _i:Mq(X,w.x,w.y,w.width,w.height,A,0,A,0);break;case ai:Mq(X,w.x,w.y,w.width,w.height,0,0,A,A)}X.fill()}if(h&&V)if(0===$)Pe(X,h.x,h.y,h.width,h.height,V),Rd(X,V,G,h);else{switch(X.beginPath(),X.fillStyle=V,l){case el:Mq(X,h.x,h.y,h.width,h.height,0,0,A,A);break;case Km:Mq(X,h.x,h.y,h.width,h.height,A,0,A,0);break;case _i:Mq(X,h.x,h.y,h.width,h.height,0,A,0,A);break;case ai:Mq(X,h.x,h.y,h.width,h.height,A,A,0,0)}X.fill()}if($>0){var K=Vj(X,_);if(qb(K,"roundRect",r,A),X.lineWidth=$,X.strokeStyle=a,h&&t("group.splitLine")){var I=h.x,E=h.y,n=h.width,R=h.height;l===el?(X.moveTo(I,E),X.lineTo(I+n,E)):l===Km?(X.moveTo(I+n,E),X.lineTo(I+n,E+R)):l===_i?(X.moveTo(I,E),X.lineTo(I,E+R)):(X.moveTo(I,E+R),X.lineTo(I+n,E+R))}X.stroke(),pf(X,_)}}i._39O(X,y)}else If.superClass._80o.call(i,X)}});var _n=function(v,q){ii(_n,this,[v,q])};$o(_n,he,{_80o:function(g){this._39O(g,this._83o)}});var Ce=function(j,Z){ii(Ce,this,[j,Z])};$o(Ce,he,{_3O:function(){var t=this,G=t._data,F=t.s,R=t.gv,w=G.getPoints(),i=R.getBorderColor(G),g=i?F("border.width"):0,m=t.getSelectWidth(),Q=F("shape.border.width"),u=G.getRect(),C=G.getAnchorRect(),c=R.getBodyColor(G),b=t._99o=w.isEmpty()?d:{rect:u,rotation:G.getRotation(),fillRule:F("shape.fill.rule"),scale:G.getScale(),position:G.p(),points:w,segments:G.getSegments(),bodyColor:c,borderColor:i,borderWidth:g,_94o:F("shape.border.3d"),_95o:F("shape.border.3d.color"),_96o:F("shape.border.3d.accuracy"),_97o:m?t.getSelectColor():d,selectWidth:m,_53o:F("shape.background"),_27Q:Hf(F("shape.repeat.image"),c),shapeGradientPack:F("shape.gradient.pack"),_54o:Q,_55o:F("shape.border.color"),shapeGradient:F("shape.gradient"),_59o:F("shape.gradient.color"),_60o:F("shape.border.pattern"),_61o:F("shape.border.cap"),_62o:F("shape.border.join"),shapeForeground:F("shape.foreground"),gray:F("2d.gray")};if(b){C.x+=b.position.x,C.y+=b.position.y,b.gradientRect=C;var W=G.getScale(),L=T(1,T(j(W.x),j(W.y)));F("shape.dash")&&F("shape.dash.width")>Q&&(Q=F("shape.dash.width"));var K=Q*("square"===b._61o?.71:.5)+g+m/t.gv._zoom/L;K&&(K*=L,u=oe(u),Id(u,K,b._62o)),t._68o(u);var J=F("clip.percentage");1>J&&(0>J&&(J=0),b.clipRect=qe(G.getAnchorRect(),F("clip.direction"),J));var A=F("shape.fill.clip.percentage");1>A&&(0>A&&(A=0),b.shapeClipRect=qe(G.getAnchorRect(),F("shape.fill.clip.direction"),A));var h=F("shape.foreground.clip.percentage");1>h&&(0>h&&(h=0),b.shapeForegroundClipRect=qe(G.getAnchorRect(),F("shape.foreground.clip.direction"),h))}},getPosition:function(v,i,O,Z){var q=this._99o;if(q){var T=ui(v,q.rect,Z);return T.x+=i,T.y+=O,T}return xp},_42:function(p){this._99o&&Ce.superClass._42.call(this,p)},_80o:function(W){var _,P=this,G=P.s,g=P._99o,b=g.position,t=g.scale,U=g.rotation,I=g.borderWidth,w=g.selectWidth/P.gv._zoom,O=g._27Q,d=g.shapeGradientPack,H=g._54o,x=g.clipRect,s=g.shapeClipRect,L=g.points,Q=g.segments,m=P._data.isClosePath(),T=g.fillRule,S=g.gray,e=function(U){return S?F.toGrayColor(U):U},E=e(g._53o),n=E||O||d;W.save(),Rg(W,b.x,b.y),Nl(W,U),Sc(W,t.x,t.y),x&&(W.beginPath(),W.rect(x.x,x.y,x.width,x.height),W.clip()),n&&s&&(W.save(),W.beginPath(),W.rect(s.x,s.y,s.width,s.height),W.clip()),Rg(W,-b.x,-b.y);var o=g._60o,y=Vj(W,o),r=W.lineJoin,$=W.lineCap;W.lineJoin=g._62o,W.lineCap=g._61o;var u=e(g.bodyColor);n?(Bs(W,L,Q,m),d?Ek(W,d):O?Uj(W,O,u,null,P._data,P.gv):(_=u?u:E,Jf(W,_,g.shapeGradient,e(g._59o),g.gradientRect)),W.fill(T),s&&(W.restore(),Rg(W,-b.x,-b.y)),d&&W.restore(),y!==W&&Bs(y,L,Q,m)):Bs(y,L,Q,m);var z=g.shapeForeground;if(z){W.save();var D=g.shapeForegroundClipRect;D&&(Rg(W,b.x,b.y),W.beginPath(),W.rect(D.x,D.y,D.width,D.height),W.clip(),Rg(W,-b.x,-b.y)),Bs(W,L,Q,m),Jf(W,z,G("shape.foreground.gradient"),e(G("shape.foreground.gradient.color")),g.gradientRect),W.fill(T),W.restore()}var j=G("shape.border.width.absolute");if(j&&(W.save(),W.setTransform(1,0,0,1,0,0)),w&&(W.strokeStyle=g._97o,W.lineWidth=H+2*(I+w),W.stroke()),I&&(W.strokeStyle=e(g.borderColor),W.lineWidth=H+2*I,W.stroke()),H&&(_=e(g._55o),!E&&u&&(_=u),W.strokeStyle=_,W.lineWidth=H,W.stroke(),g._94o&&oj(W,_,e(g._95o),H,P.gv._zoom,g._96o)),j&&W.restore(),pf(W,o),G("shape.dash")){var f=G("shape.dash.width")||H;if(f>0){o=G("shape.dash.pattern");var y=Vj(W,o,P._2Q("shape.dash.offset"));y!==W&&Bs(y,L,Q,m),P._1Q(W,"shape",f,o)}}W.lineJoin=r,W.lineCap=$,W.restore()},_48O:function(){},_47O:function(){}});var Wp=function(d,Z){ii(Wp,this,[d,Z])};$o(Wp,Ce,{getRotation:function(I,j,k){I=I||0;var D=this._data.getPoints(),i=D.size();return i>1?_e[k]?i&&0===i%2?bf(D.get(i/2-1),D.get(i/2),j,I):I:xb[k]?bf(D.get(0),D.get(1),j,I):bf(D.get(i-2),D.get(i-1),j,I):I},getPosition:function(S,K,E,d,h){var C=this._data.getPoints(),t=C.size();if(t>1){if(_e[S]){var b=t%2;if(0===b)return Aj(C.get(t/2-1),C.get(t/2),S,K,E,d,h);var o=C.get((t-b)/2),z={x:o.x,y:o.y,width:0,height:0};return o=ui(S,z,d),o.x+=K,o.y+=E,o}return xb[S]?Aj(C.get(0),C.get(1),S,K,E,d,h):Aj(C.get(t-2),C.get(t-1),S,K,E,d,h)}return xp}});var yg=function(d,o){ii(yg,this,[d,o])};$o(yg,he,{_3O:function(){var t=this;yg.superClass._3O.call(t);var H=t.s,n=t._83o;t._82o=n.img||n.shape?d:{background:t.getBodyColor("grid.background"),depth:H("grid.depth"),rect:n.rect,_88o:H("grid.cell.depth"),cellBorderColor:H("grid.cell.border.color"),_89o:H("grid.row.count"),_90o:H("grid.column.count"),block:H("grid.block"),_91o:H("grid.block.color"),_92o:H("grid.block.padding"),_93o:H("grid.block.width")}},_80o:function(C){var l=this,T=l._82o;if(!T)return yg.superClass._80o.call(l,C),void 0;var v,f,h=l._data,x=T.background,I=T.rect,p=T.block,o=T._91o,t=T._92o,Y=T._93o,$=T._88o,j=T.cellBorderColor,E=T._89o,N=T._90o;if(x)if(Pe(C,I.x,I.y,I.width,I.height,x),Rd(C,x,T.depth,I),$)for(v=0;E>v;v++)for(f=0;N>f;f++)I=h.getCellRect(v,f),I&&Rd(C,x,$,I);else if(j){for(C.beginPath(),v=0;E>v;v++)for(f=0;N>f;f++)I=h.getCellRect(v,f),I&&C.rect(I.x,I.y,I.width,I.height);C.strokeStyle=j,C.lineWidth=1,C.stroke()}if("h"===p)for(v=0;E>v;v++)I=kr(h.getCellRect(v,0),h.getCellRect(v,N-1)),ub(I,t),rl(C,o,I.x,I.y,I.width,I.height,Y);else if("v"===p)for(f=0;N>f;f++)I=kr(h.getCellRect(0,f),h.getCellRect(E-1,f)),ub(I,t),rl(C,o,I.x,I.y,I.width,I.height,Y);l._39O(C,l._83o)}});var dp=function(A,o){ii(dp,this,[A,o])};$o(dp,he,{_checkEmptyRect:!1,_81o:function(){var A=this._data,u=dp.superClass._81o.call(this),x=A.s("text");if(x!=d){var V,k,N=A.s("text.font"),c=A.s("text.align"),q=A.s("text.vAlign"),a=Zj(N,x),P=a.width,l=a.height,O=A.getAnchor(),M=A.getWidth(),o=A.getHeight();"left"===c?V=-M*O.x:"center"===c?V=-M*O.x+(M-P)/2:"right"===c&&(V=M*(1-O.x)-a.width),"top"===q?k=-o*O.y:"middle"===q?k=-o*O.y+(o-l)/2:"bottom"===q&&(k=o*(1-O.y)-a.height);var $,w=A.getMatrix();if($=io([w.tf(V,k),w.tf(V+P,k),w.tf(V+P,k+l),w.tf(V,k+l)]),u=kr(u,$),u&&A.s("text.shadow")){var f=oe(u);f.x+=A.s("text.shadow.offset.x"),f.y+=A.s("text.shadow.offset.y"),ub(f,A.s("text.shadow.blur")),u=kr(u,f)}}return u}});var vf=vb.Interactor=function(n){this.gv=this._graphView=n};bi("Interactor",r,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(B){this.gv.fi(B)},setCursor:function(c){Qr||this.gv.setCursor(c)},startDragging:function(p){var Y=this;Y._lastClientPoint=vd(p),Y._lastLogicalPoint=Y.gv.lp(p),Pb(Y,p)},clearDragging:function(){var X=this;X._lastClientPoint=X._lastLogicalPoint=X._logicalPoint=d},autoScroll:function(c){return this.gv.autoScroll(c,this._lastClientPoint)}});var Lb=d,oh=function(G){Lb.handleWindowTouchMove(G)},Bp=function(k){Lb.handleWindowTouchEnd(k),H.removeEventListener(ap,oh,N),H.removeEventListener(Rr,Bp,N),Lb=d},Di=function(k){Lb.handleWindowMouseMove(k)},Sn=function(t){Lb.handleWindowMouseUp(t),H.removeEventListener(Br,Di,N),H.removeEventListener(Kf,Sn,N),Lb=d},pi=function(A,u){A!==Lb&&(Lb?Qr?Lb.handleWindowTouchEnd(u):Lb.handleWindowMouseUp(u):Qr?(H.addEventListener(ap,oh,N),H.addEventListener(Rr,Bp,N)):(H.addEventListener(Br,Di,N),H.addEventListener(Kf,Sn,N)),Lb=A)},Ud=function(O){var G=this;G.gv=O,G._is2d=O instanceof vb.GraphView,G._is2d&&(G.filter=function(R){return O.isSelectable(R)&&O.isInteractive(R)}),O.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",db].forEach(function(A){G.addListener(A)}),G.initImageResource()};$o(Ud,vf,{enableVR:function(o){var F=this;if(!!F._vrEnable!==o)if(F._vrEnable=o,o)F.gv.vr.mp(F.onVRControllerChange,F);else if(F.gv.vr.ump(F.onVRControllerChange,F),F._vrRayPolyline){var L=F.gv.dm();L.remove(F._vrRayPolyline),L.remove(F._vrRayHitPoint),F._vrRayPolyline=J,F._vrRayHitPoint=J}},onVRControllerChange:function(f){var C=this,n=f.property,Q=f.newValue,S=C.gv.vr.getController(Q.id),N=S.getRay();N&&("gamepad.button.trigger"===n?"down"===Q._62O?C.handle_mousedown(N):C.handleWindowMouseUp(N):"gamepad.pose"===n&&(C.handle_mousemove(N),C.handleWindowMouseMove(N)))},drawVRRay:function(r,U,I){var h,l=this,W=l.gv,Q=l._vrRayPolyline,b=!1;if(Q)h=l._vrRayHitPoint;else{var g=W.dm();l._vrRayPolyline=Q=new P.Polyline,l._vrRayHitPoint=h=new P.Node,h.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),h.setAnchor3d(.5,.5,.499);var N=.2/W.vr.measureOflength;h.s3(N,N,N),Q.s("intersect",!1),h.s("intersect",!1),g.add(Q),g.add(h),b=!0}if(U){var B=I.world,A=I.worldNormal,J=B.x,i=B.y,F=B.z;Q.s("shape.border.color","red"),Q.setPoints([{x:r.origin.x,y:r.origin.z,e:r.origin.y},{x:J,y:F,e:i}]),h.s("3d.visible",!0),h.p3(J,i,F),h.lookAtDirection([A.x,A.y,A.z],"front")}else{Q.s("shape.border.color","blue");var k=new P.Math.Vector3;k.copy(r.direction).setLength(1e3/l.gv.vr.measureOflength).add(r.origin),Q.setPoints([{x:r.origin.x,y:r.origin.z,e:r.origin.y},{x:k.x,y:k.z,e:k.y}]),h.s("3d.visible",!1)}W.fi({kind:"vrRayIntersect",ray:r,data:U,intersect:I,polyline:Q,hitNode:h,begin:b})},addListener:function(c){var t=this;t.gv.getView().addEventListener(c,function(G){F.preventDefault(G),t.disabled||t["handle_"+c](G)},N)},handleWindowTouchMove:function(A){this.handleWindowMouseMove(A)},handleWindowMouseMove:function(n){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",n):(this.handleDownInfo("onBeginDrag",n),this.isDragging=!0))},handleWindowTouchEnd:function(i){this.handleWindowMouseUp(i)},handleWindowMouseUp:function(B){if(this.isDragging&&(this.handleDownInfo("onEndDrag",B),this.isDragging=!1),this.downInfo){var I=this.handle("onUp",B);if(I&&I.data===this.downInfo.data){this.handleMissingUp(B);var T=this,p=2===B.button?"onContextMenu":"onClick";if(!T._dbclickTimer)return T._dbclickTimer=_(function(){delete T._dbclickTimer,T.handleClick(B,p,I),this.downInfo=d},F.clickDelay),void 0;i(T._dbclickTimer),delete T._dbclickTimer,p="onDoubleClick",T.handleClick(B,p,I)}else this.handleDownInfo("onUp",B);this.downInfo=d}},handle_mouseleave:function(H){var w=this,F=w.gv,n=w.currentInfo?w.currentInfo.data:d;if(n){n.s("onLeave")&&n.s("onLeave")(H,n,F),w.fire("data","onLeave",H,n);var D=w.currentInfo?w.currentInfo.hits:d;if(D)for(var j in D)w.handleLeave(H,j);w.currentInfo=d}},handle_mousewheel:function(W){W.scrollDelta=W.wheelDelta/40,this.handle("onScroll",W)},handle_DOMMouseScroll:function(V){V.scrollDelta=2===V.axis?-V.detail:0,this.handle("onScroll",V)},handle_touchstart:function(T){this.handle_mousedown(T)},handle_touchmove:function(H){this.handle("onMove",H)},handle_mousedown:function(X){this.isDragging&&(this.handleDownInfo("onEndDrag",X),this.isDragging=!1),this.downInfo=this.handle("onDown",X),this.downInfo&&pi(this,X)},handle_mousemove:function(k){var n=this,r=n.gv;n._hoverTimer&&(i(n._hoverTimer),delete n._hoverTimer);var S,I,E,v=n.handle("onMove",k),u=this.currentInfo?this.currentInfo.data:d,j=this.currentInfo?this.currentInfo.hits:d;if(v&&(I=v.data,E=v.hits,n._hoverTimer=_(function(){i(n._hoverTimer),delete n._hoverTimer,n.handle("onHover",k,v)},r.getHoverDelay()||F.hoverDelay)),I!==u){if(u&&(u.s("onLeave")&&u.s("onLeave")(k,u,r),this.fire("data","onLeave",k,u)),I&&(I.s("onEnter")&&I.s("onEnter")(k,I,r),this.fire("data","onEnter",k,I)),j)for(S in j)this.handleLeave(k,S);if(E)for(S in E){var z=E[S];z.target.onEnter&&z.target.onEnter(k,I,r,z.point,z.width,z.height),this.fire(z.type,"onEnter",z.event,z.data,z.image,z.comp,z.point,z)}}else{if(j)for(S in j)E&&E[S]||this.handleLeave(k,S);if(E)for(S in E)if(!j||!j[S]){var z=E[S];z.target.onEnter&&z.target.onEnter(k,I,r,z.point,z.width,z.height),this.fire(z.type,"onEnter",z.event,z.data,z.image,z.comp,z.point,z)}}this.currentInfo=v},handle:function(G,o,x){var E,L=this,W=L.gv;if(L._is2d){if(x=x||W.getDataInfoAt(o,this.filter),!x)return;if(E=x.ui.interactiveInfo){var i,C=x.data;if(C.s(G)&&C.s(G)(o,C,W),this.fire("data",G,o,C),"body"===x.part&&E.bodyInfo)i="body",x.hits=this.handleImage(i,W.getImage(C),G,o,C,x.point,E.bodyInfo);else if("icons"===x.part&&E._38o){var N=E._38o[x.name];N&&N[x.index]&&(i="icons|"+x.name+"|"+x.index,x.hits=this.handleImage(i,x.icon,G,o,C,x.point,N[x.index]))}}return x}var C,$;if(!x)if(o&&o instanceof P.Math.Ray){var f=W.vr.intersectWorld(o);if(C=f.data,$=f.intersect,L.drawVRRay(o,C,$),!C)return;var d=W.getData3dUI(C);if(E=d.interactiveInfo,!E)return;x={data:C,part:$.part,ui:d}}else{if(x=W.getDataInfoAt(o),!x)return;x&&(x={data:x.data,part:x.part})}if(!$){C=x.data;var d=W.getData3dUI(C);if(x.ui=d,E=d.interactiveInfo,!E)return x;if($=W.intersectObject(o,C),!$)return}C.s(G)&&C.s(G)(o,C,W),this.fire("data",G,o,C);var J,c=$.part;return"body"!==c&&(J=C.s(c+".image")||C.s("shape3d."+c+".image")),J||(J=C.s("all.image")||C.s("shape3d.image")),E="object"==typeof J?E[J.uuid]:E[J],E&&E.bodyInfo?(x.part="body",x.interactiveInfo=E,x.point=$.uv.multiply({x:E.bodyInfo.rect.width,y:E.bodyInfo.rect.height}),x.image=J,x.hits=this.handleImage("body",J,G,o,C,x.point,E.bodyInfo),x):x},_handleLeaveOrMissing:function(j,z,K){var h="leave"===j?this.currentInfo:this.downInfo;if(h){var u=h.interactiveInfo||h.ui.interactiveInfo;if(u){var N,n,Y=h.data;if(this._is2d){if(n=this.gv.lp(z),"body"===h.part&&u.bodyInfo)N="body","leave"===j?this.handleLeaveImage(K,N,this.gv.getImage(Y),z,Y,n,u.bodyInfo):this.handleMissingUpImage(N,this.gv.getImage(Y),z,Y,n,u.bodyInfo);else if("icons"===h.part&&u._38o){var F=u._38o[h.name];F&&F[h.index]&&(N="icons|"+h.name+"|"+h.index,"leave"===j?this.handleLeaveImage(K,N,h.icon,z,Y,n,F[h.index]):this.handleMissingUpImage(N,h.icon,z,Y,n,F[h.index]))}}else{if(!u.bodyInfo)return;var w=this.gv.intersectObject(z,Y);n=w?w.uv.multiply({x:u.bodyInfo.rect.width,y:u.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===j?this.handleLeaveImage(K,"body",h.image,z,Y,n,u.bodyInfo):this.handleMissingUpImage("body",h.image,z,Y,n,u.bodyInfo)}}}},handleClick:function(m,x,a){var d=this,u=this.downInfo;if(u&&a){var v,A=a.interactiveInfo||a.ui.interactiveInfo,M=a.data,O=this.gv;if(M.s(x)&&M.s(x)(m,M,O),d.fire("data",x,m,M),A)if(this._is2d){if(u.part===a.part){var B=O.lp(m);"body"===a.part&&A.bodyInfo&&(v="body",this.handleClickImage(v,O.getImage(M),x,m,M,B,A.bodyInfo,a))}}else{if(!A.bodyInfo)return;var k=O.intersectObject(m,M);if(!k)return;B=k.uv.multiply({x:A.bodyInfo.rect.width,y:A.bodyInfo.rect.height}),this.handleClickImage("body",u.image,x,m,M,B,A.bodyInfo,a)}}},handleDownInfo:function(x,I){if(this.downInfo){var y=this.downInfo,M=this.gv,i=y.interactiveInfo||y.ui.interactiveInfo;if(i){var L,p=y.data;if(p.s(x)&&p.s(x)(I,p,M),this.fire("data",x,I,p),this._is2d){var o=M.lp(I);if("body"===y.part&&i.bodyInfo)L="body",this.handleDownInfoImage(L,M.getImage(p),x,I,p,o,i.bodyInfo);else if("icons"===y.part&&i._38o){var F=i._38o[y.name];F&&F[y.index]&&(L="icons|"+y.name+"|"+y.index,this.handleDownInfoImage(L,y.icon,x,I,p,o,F[y.index]))}}else{if(!i.bodyInfo)return;var Y=M.intersectObject(I,p);if(!Y)return;o=Y.uv.multiply({x:i.bodyInfo.rect.width,y:i.bodyInfo.rect.height}),this.handleDownInfoImage("body",y.image,x,I,p,o,i.bodyInfo)}}}},fire:function(v,O,j,b,n,V,c,u){this.gv.fi({kind:O,type:v,event:j,data:b,image:n,comp:V,view:this.gv,point:c,width:u?u.width:J,height:u?u.height:J})},handleImage:function(T,X,o,S,f,C,V){var M={};if(X&&(X=Hf(X))){var E=this.gv,e=V.rect,c=this.convertPoint(C,V);c.inRect&&(X[o]&&X[o](S,f,E,c,e.width,e.height),this.fire("image",o,S,f,X,J,c,e),M[T+"|image"]={target:X,type:"image",image:X,data:f,event:S,point:c,width:e.width,height:e.height});for(var R=V.compInfos,L=X,x=R.length-1;x>=0;x--){var O=R[x],h=O.comp;c=this.convertPoint(C,O,L,h,E,f),c.inRect&&(e=O.rect,h[o]&&h[o](S,f,E,c,e.width,e.height),this.fire("comp",o,S,f,X,h,c,e),(X=e.image)&&(X[o]&&X[o](S,f,E,c,e.width,e.height),this.fire("image",o,S,f,X,J,c,e)),M[T+"|"+x]={target:h,type:"comp",comp:h,image:X,data:f,event:S,point:c,width:e.width,height:e.height},X&&(M[T+"|"+x+"|image"]={target:X,type:"image",image:X,data:f,event:S,point:c,width:e.width,height:e.height}))}}return M},handleLeave:function(D,c){return this._handleLeaveOrMissing("leave",D,c)},handleMissingUp:function(k){return this._handleLeaveOrMissing("missing",k)},handleLeaveImage:function(S,N,f,i,A,r,Z){if(f&&(f=Hf(f))){var C=this.gv,P=Z.rect,l=this.convertPoint(r,Z);S===N+"|image"&&(f.onLeave&&f.onLeave(i,A,C,l,P.width,P.height),this.fire("image","onLeave",i,A,f,J,l,P));for(var V=Z.compInfos,$=f,y=V.length-1;y>=0;y--){var U=V[y],m=U.comp;l=this.convertPoint(r,U,$,m,C,A),P=U.rect,S===N+"|"+y&&(m.onLeave&&m.onLeave(i,A,C,l,P.width,P.height),this.fire("comp","onLeave",i,A,f,m,l,P)),(f=P.image)&&S===N+"|"+y+"|image"&&(f.onLeave&&f.onLeave(i,A,C,l,P.width,P.height),this.fire("image","onLeave",i,A,f,J,l,P))}}},handleMissingUpImage:function(P,E,M,L,y,F){var g="onUp",x=this.downInfo.hits;if(x&&E&&(E=Hf(E))){var d=this.gv,X=F.rect,N=this.convertPoint(y,F);!N.inRect&&x[P+"|image"]&&(E[g]&&E[g](M,L,d,N,X.width,X.height),this.fire("image",g,M,L,E,J,N,X));for(var H=F.compInfos,l=E,K=H.length-1;K>=0;K--){var A=H[K],k=A.comp;N=this.convertPoint(y,A,l,k,d,L),N.inRect||(X=A.rect,x[P+"|"+K]&&(k[g]&&k[g](M,L,d,N,X.width,X.height),this.fire("comp",g,M,L,E,k,N,X)),(E=X.image)&&x[P+"|"+K+"|image"]&&(E[g]&&E[g](M,L,d,N,X.width,X.height),this.fire("image",g,M,L,E,J,N,X)))}}},handleDownInfoImage:function(X,D,C,R,A,V,j){var Y=this.downInfo.hits;if(Y&&D&&(D=Hf(D))){var r=this.gv,I=j.rect,n=this.convertPoint(V,j);Y[X+"|image"]&&(D[C]&&D[C](R,A,r,n,I.width,I.height),this.fire("image",C,R,A,D,J,n,I));for(var H=j.compInfos,g=D,P=H.length-1;P>=0;P--){var G=H[P],Z=G.comp;n=this.convertPoint(V,G,g,Z,r,A),I=G.rect,Y[X+"|"+P]&&(Z[C]&&Z[C](R,A,r,n,I.width,I.height),this.fire("comp",C,R,A,D,Z,n,I)),(D=I.image)&&Y[X+"|"+P+"|image"]&&(D[C]&&D[C](R,A,r,n,I.width,I.height),this.fire("image",C,R,A,D,J,n,I))
}}},handleClickImage:function(k,s,H,N,l,h,y,G){var Q=this.downInfo.hits,n=G.hits;if(Q&&s&&(s=Hf(s))){var f=this.gv,W=y.rect,Z=this.convertPoint(h,y);Q[k+"|image"]&&(s[H]&&s[H](N,l,f,Z,W.width,W.height),this.fire("image",H,N,l,s,J,Z,W));for(var P=y.compInfos,E=s,g=P.length-1;g>=0;g--){var I=P[g],F=I.comp;Z=this.convertPoint(h,I,E,F,f,l),W=I.rect,Q[k+"|"+g]&&n[k+"|"+g]&&(F[H]&&F[H](N,l,f,Z,W.width,W.height),this.fire("comp",H,N,l,s,F,Z,W)),(s=W.image)&&Q[k+"|"+g+"|image"]&&(s[H]&&s[H](N,l,f,Z,W.width,W.height),this.fire("image",H,N,l,s,J,Z,W))}}},initImageResource:function(){F.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(E,H,U,Q,T,z){var m=H.rect,r=H.matrix.applyInverse(E).sub(m),S=r.x>=0&&r.y>=0&&r.x<=m.width&&r.y<=m.height;if(!S)return r;if(Q&&Wf(Q.pixelPerfect,z,T)){var m,D=1;this._is2d?(D=T.getZoom(),m=Wn(E.x,E.y,J,D)):m=Wn(E.x,E.y);var K=!1,O=m.x,A=m.y,R=m.width,n=m.height,h=F.hitMaxArea,$=R*n*D*D;if($>h){var l=Math.sqrt(h/$);D*=l}R*=D,n*=D,2>R&&(R=2),2>n&&(n=2),O*=D,A*=D;var f=ed(R,n),W=new _d(0,-O,-A,D,D);W.append(H.matrix),T._drawForChecking=!0,Q.transform=W;var C=U.comps;U.comps=[Q],Pp(f,U,0,0,R,n,z,self),U.comps=C,delete Q.transform,T._drawForChecking=!1;try{for(var L=0,V=f.getImageData(0,0,R,n).data;L<V.length;L+=4)if(0!==V[L+3]){K=!0;break}f.restore()}catch(M){qs=d,K=!1}r.inRect=K}else r.inRect=!0;return r}});var be=vb.DefaultInteractor=function(Y){ii(be,this,[Y])};bi("DefaultInteractor",vf,{handle_mousedown:function(g){_l(g);var Q=this,V=Q.gv,j=V.getDataAt(g);if(V.setFocus(g)&&!V._editing&&!V._scrolling){As(g)?V.handleDoubleClick(g,j):V.handleClick(g,j);var U=Ur(g);!br()&&!U&&j&&(V.isMovable(j)||V.isInteractive(j))||!V.isPannable()||!fs(g)&&!U||nr(g)||(Q._tx=V.tx(),Q._ty=V.ty(),Q.startDragging(g))}},handleWindowMouseUp:function(W){var h=this,A=h.gv;A._panning&&(delete A._panning,A.onPanEnded(),h.fi({kind:"endPan",event:W})),delete h._tx,delete h._ty,h.clearDragging()},handle_mousemove:function(P){var O=this,d=O.gv;O._hoverTimer&&(i(O._hoverTimer),delete O._hoverTimer),O._hoverTimer=_(function(){O.fi({kind:"hover",event:P}),i(O._hoverTimer),delete O._hoverTimer},d.getHoverDelay()||F.hoverDelay)},handle_touchmove:function(z){this.handle_mousemove(z)},handleWindowMouseMove:function(d){var P=this,n=P.gv;P.fi({kind:n._panning?"betweenPan":"beginPan",event:d}),n._panning=1;var x=Fb(n,d,P._lastClientPoint);n.setTranslate(P._tx+x.x,P._ty+x.y)},handle_mousewheel:function(U){this.gv.handleScroll(U,U.wheelDelta)},handle_DOMMouseScroll:function(C){2===C.axis&&this.gv.handleScroll(C,-C.detail)},handle_keydown:function(F){this.gv.handleKeyDown(F)}});var hm=vb.SelectInteractor=function(r){ii(hm,this,[r])};bi("SelectInteractor",vf,{_42:function(){var C=this,U=C.gv,X=U.getZoom(),Q=C.mark,H=C.div;H||(H=C.div=rp(),oq(C.getView(),H));var v={};v.x=Q.x*X+U.tx(),v.y=Q.y*X+U.ty(),v.width=Q.width*X,v.height=Q.height*X,Hi(H,v),this.intersects()?(H.style.border="",H.style.background=U.getRectSelectBackground()):(H.style.background="",H.style.border="1px solid "+U.getRectSelectBorderColor())},handle_mousedown:function(W){var J=this,u=J.gv;if(J._57I=d,J.pendingClickThrough=d,!(u._editing||u._scrolling||br()||Ur(W))){var y=u.getDataAt(W),G=u.sm();y?nr(W)?G.co(y)?G.rs(y):G.as(y):G.co(y)?y instanceof Mi&&y.isClickThroughEnabled()&&fs(W)&&(J.pendingClickThrough=vd(W)):G.ss(y):nr(W)||!u.isPannable()?fs(W)&&(nr(W)||G.cs(),u.isRectSelectable()&&(J.startDragging(W),u._77O=1)):fs(W)&&(J._57I=vd(W))}},handle_mouseup:function(p){var I=this,W=I.gv,g=I._57I;if(g&&(jc(g,vd(p))<=1&&W.sm().cs(),I._57I=d),I.pendingClickThrough){if(jc(I.pendingClickThrough,vd(p))<=1){var M=W.getDataAt(p);if(M instanceof Mi&&M.isClickThroughEnabled()){var e=W.getDataAt(p,function(e){var $=e.getParent()===M&&W.isSelectable(e,!0);return $});e&&(p.clickThrough=!0,W.sm().ss(e))}}I.pendingClickThrough=d}},handleWindowMouseUp:function(D){this.clear(D)},handleWindowMouseMove:function(F){var G=this,R=G.gv;G._logicalPoint=R.lp(F),G.mark?(G.fi({kind:"betweenRectSelect",event:F}),R.isPannable()&&G.autoScroll(F),G.redraw()):G.fi({kind:"beginRectSelect",event:F}),G.mark=io(G._lastLogicalPoint,G._logicalPoint),G.redraw()},intersects:function(){var V=this,c=V._lastLogicalPoint,L=V._logicalPoint;return c.x>L.x||c.y>L.y},clear:function(q){var I=this,S=I.gv,V=I.mark;if(I._57I=d,I.pendingClickThrough=d,I._lastLogicalPoint){if(V){if(0!==V.width&&0!==V.height){var $=S.getDatasInRect(V,I.intersects());if(!$.isEmpty()){var b=S.sm(),f=b.toSelection();$.each(function(W){b.co(W)?f.remove(W):f.add(W)}),b.ss(f)}}Hq(I.div),delete I.div,delete I.mark,I.redraw(),I.fi({kind:"endRectSelect",event:q}),S.onRectSelectEnded()}I.clearDragging(),delete S._77O}},redraw:function(){var e=this;e._draw||(e._draw=1,_(function(){e.mark&&e._42(),delete e._draw},16))}});var jg=vb.MoveInteractor=function(x){ii(jg,this,[x])};bi("MoveInteractor",vf,{handle_mousedown:function(H){var z=this,T=z.gv;if(fs(H)&&!T._editing&&!T._scrolling&&!br()){var _=T.getSelectedDataAt(H);!_||T.isInteractive(_)&&!T.isMovable(_)?T._focusData=d:(z._data=_,T.handleMouseDown&&T.handleMouseDown(H,_),z.startDragging(H),T.isMovable(_)&&(T._moving=1))}},handleWindowMouseUp:function(z){var r=this,R=r.gv;R.handleMouseUp&&R.handleMouseUp(z,r._data),r.clear(z)},handleWindowMouseMove:function(Q){var L=this,j=L._data,S=L.gv;if((!S._93O||!S._93O(Q,j))&&S._moving){L._logicalPoint||L.fi({kind:"prepareMove",event:Q});var T=L._logicalPoint?"betweenMove":"beginMove",C={kind:T,event:Q},I=L._logicalPoint=S.lp(Q);"beginMove"!==T||L._alreadyBeginTransaction||(L._alreadyBeginTransaction=!0,S.getDataModel().beginTransaction());var _=L._calcShift(T,Q),H=_.x,m=_.y,O=L.gv.getMoveMode(Q,j);O&&("x"===O?m=0:"y"===O?H=0:"xy"!==O&&(H=m=0)),S.moveSelection(H,m),L._lastLogicalPoint=I,L.autoScroll(Q),L.fi(C)}},_calcShift:function(){var c=this,B=c._logicalPoint,U=c._lastLogicalPoint,y=B.x-U.x,m=B.y-U.y;return{x:y,y:m}},clear:function(k){var r=this,L=r.gv;r._lastLogicalPoint&&(r._lastLogicalPoint=r._data=L._moving=d,r._logicalPoint&&(r.fi({kind:"endMove",event:k}),L.onMoveEnded()),r.clearDragging()),r._alreadyBeginTransaction&&(r._alreadyBeginTransaction=!1,L.getDataModel().endTransaction())}});var Ii=vb.TextEditInteractor=function(F){ii(Ii,this,[F]),this.init()};bi("TextEditInteractor",vf,{init:function(){var G=this,u=this.input=b.createElement("input"),N=u.style;u.text="text",N.border="1px solid #d8d8d8",N.position="absolute",N.padding="2px 3px",N.outline="none",N.marginLeft="-90px",N.marginTop="-16px",N.backgroundColor="rgba(255,255,255, 0.9)",N.fontSize="14px",N.width="180px",N.height="32px",N.boxShadow="0 0 13px rgba(16,142,233, 0.5)",N.textAlign="center",N.boxSizing="border-box",u.addEventListener("keyup",function(V){mq(V)&&G.endTextEdit()}),u.addEventListener("focus",function(){u.select()});var m=this.textarea=b.createElement("textarea"),n=this.wrap=b.createElement("div");n.appendChild(m),N=m.style,N.margin=0,N.padding="4px",N.overflow="hidden",N.boxSizing="border-box",N.position="absolute",N.outline="none",N.backgroundColor="transparent",N.resize="none",N.textAlign="center",N.fontSize="14px",N.border="none",N.borderWidth=0,N.width="100%",N.top="50%",N=n.style,N.boxSizing="border-box",N.margin=0,N.padding=0,N.position="absolute",N.boxShadow="0 0 13px rgba(16,142,233, 0.5)",N.border="1px solid #d8d8d8",N.backgroundColor="rgba(255,255,255, 0.9)",N.width="180px",N.marginLeft="-90px",m.addEventListener("keydown",function(S){return(xk()||nr())&&mq(S)?(G.endTextEdit(),void 0):(G.calculateTextareaHeight(String.fromCharCode(S.keyCode)),void 0)}),m.addEventListener("focus",function(){m.select()});var x=function(A){A.stopPropagation()};u.addEventListener("mousedown",x),u.addEventListener("touchstart",x),m.addEventListener("mousedown",x),m.addEventListener("touchstart",x),G.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],G.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",G.handleWindowClick=function(Y){var w=G._editingDOM,c=w.getBoundingClientRect(),m=vd(Y);mb(c,m)||G.endTextEdit()}},handle_mousedown:function(r){var y=this,D=y.gv;if(As(r)&&!D._editing){var X=D.getDataAt(r);if(X){var i=D.getTextEditInfo(X);i&&(this._editInfo=i,this._editTarget=X,D._editing=!0,i.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var O=this,A=O.gv,e=O._editTarget,l=O.getTargetValue(),q=O.textarea,Z=O.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===l||l===J)&&(l=""),q.value=l,O._editingDOM=q,A.getView().appendChild(Z),this.layoutHTML(Z,e),this.calculateTextareaHeight(),_(function(){q.focus(),H.addEventListener("mousedown",O.handleWindowClick),H.addEventListener("touchstart",O.handleWindowClick)},10)},handleTextEdit:function(){var j=this,v=j.gv,p=j._editTarget,n=j.getTargetValue(),z=j.input;(null===n||n===J)&&(n=""),z.value=n,j._editingDOM=z,v.getView().appendChild(z),this.layoutHTML(z,p),_(function(){z.focus(),H.addEventListener("mousedown",j.handleWindowClick),H.addEventListener("touchstart",j.handleWindowClick)},10)},layoutHTML:function(d,V){var g=this.gv,z=g.getZoom();if(V instanceof P.Node){var q=V.getRect();d.style.left=(q.x+q.width/2)*z+g.tx()+"px",d.style.top=(q.y+q.height/2)*z+g.ty()+"px"}else if(V instanceof P.Edge){var I=g.getDataUI(V),q=I._6I;d.style.left=(q.x+q.width/2)*z+g.tx()+"px",d.style.top=(q.y+q.height/2)*z+g.ty()+"px"}},endTextEdit:function(){var I=this,m=I._editInfo.isMultiline?I.wrap:I.input,j=I._editInfo.isMultiline?I.textarea:I.input;I.setTargetValue(j.value),I.gv.getView().removeChild(m),I.gv._editing=!1,delete I._editingDOM,H.removeEventListener("mousedown",I.handleWindowClick),H.removeEventListener("touchstart",I.handleWindowClick)},setTargetValue:function(z){var L=this,A=L._editTarget,q=L._editInfo,s=q.accessType,W=q.name;if(W&&s||(s="p",W="name"),"p"===s){var p=P.Default.setter(W);A[p](z)}else"a"===s?A.a(W,z):A.s(W,z)},getTargetValue:function(){var d=this,o=d._editTarget,L=d._editInfo,V=L.accessType,D=L.name;if(D&&V||(V="p",D="name"),"p"===V){var Z=P.Default.getter(D);return o[Z]()}return"a"===V?o.a(D):o.s(D)},createHiddenTextarea:function(){this.hiddenTextarea=b.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(k,X){if(X&&this.computedStyleCache)return this.computedStyleCache;var n=this,l=H.getComputedStyle(k),r=l.getPropertyValue("box-sizing")||l.getPropertyValue("-moz-box-sizing")||l.getPropertyValue("-webkit-box-sizing"),J=parseFloat(l.getPropertyValue("padding-bottom"))+parseFloat(l.getPropertyValue("padding-top")),B=parseFloat(l.getPropertyValue("border-bottom-width"))+parseFloat(l.getPropertyValue("border-top-width")),R=n.SIZING_STYLE.map(function(X){return X+":"+l.getPropertyValue(X)}).join(";"),Q={sizingStyle:R,paddingSize:J,borderSize:B,boxSizing:r};return X&&(this.computedStyleCache=Q),Q},calculateTextareaHeight:function(Y){Y=Y||"";var G=this,O=G.textarea,f=G.hiddenTextarea,B=G.wrap,F=32,S=G.calculateHTMLStyle(O,!1),w=S.paddingSize,j=S.borderSize,m=S.boxSizing,y=S.sizingStyle;f.setAttribute("style",y+";"+G.HIDDEN_TEXTAREA_STYLE),f.value=O.value+Y;var p=f.scrollHeight;"border-box"===m?p+=j:"content-box"===m&&(p-=w),O.style.height=p+"px",O.style.marginTop=0-.5*p+"px",B.style.height=Math.max(p,F)+"px",B.style.marginTop=p*-.5+"px"}});var bk=vb.ScrollBarInteractor=function(J){ii(bk,this,[J])};bi("ScrollBarInteractor",vf,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(k){var t=this.gv.getViewRect();return this._41o()&&(t.x+t.width-this.gv.lp(k).x)*this.gv.getZoom()<Bm},isH:function(V){var e=this.gv.getViewRect();return this._40o()&&(e.y+e.height-this.gv.lp(V).y)*this.gv.getZoom()<Bm},handle_mousemove:function(Y){this.handle_touchmove(Y)},handle_touchmove:function(b){if(!yd&&fs(b)&&this.gv.isScrollBarVisible()){var a=this,n=a.isV(b),f=a.isH(b);(n||f)&&a.gv.showScrollBar(),a.gv._scrolling=n||f}},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},handleWindowTouchEnd:function(j){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=d,this.fi({kind:"endScroll",event:j})},handle_mousedown:function(B){this.handle_touchstart(B)},handle_touchstart:function(I){var W=this;if(W.gv.setFocus(I),_l(I),W.handle_touchmove(I),!(So(I)>1)&&W.gv._scrolling&&W.gv.isScrollBarVisible()){W._cp=vd(I),W._tx=W.gv.tx(),W._ty=W.gv.ty();var G=W.isV(I);W._state=G?"vScroll":"hScroll",Pb(W,I),W.fi({kind:"beginScroll",event:I})}},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(D){var w=vd(D),t=this.gv.getViewRect(),u=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-w.y)*u.height/t.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-w.x)*u.width/t.width),this.fi({kind:"betweenScroll",event:D})}});var Gn=vb.TouchInteractor=function(t,c){c=c||{},c.selectable===J&&(c.selectable=!0),c.movable===J&&(c.movable=!0),c.pannable===J&&(c.pannable=!0),c.pinchable===J&&(c.pinchable=!0),c.editable===J&&(c.editable=!0),this.params=c,ii(Gn,this,[t])};bi("TouchInteractor",vf,{ms_edit:1,setUp:function(){var Y=this;Gn.superClass.setUp.call(Y),Qr&&Y.params.editable&&Y.gv.setEditInteractor(Y)},tearDown:function(){var z=this;Gn.superClass.tearDown.call(z),Qr&&z.params.editable&&z.gv.setEditInteractor(d)},clear:function(q){var W=this,Y=W.gv;Y._moving&&(W.fi({kind:"endMove",event:q}),delete Y._moving,Y.onMoveEnded(),Y.dm().endTransaction()),Y._panning&&(W.fi({kind:"endPan",event:q}),delete Y._panning,Y.onPanEnded()),Y._pinching&&(W.fi({kind:"endPinch",event:q}),delete Y._pinching,Y.onPinchEnded()),Y._editing&&(W._46O(q),W._77I=W._node=W._edge=W._shape=W._rect=W._89I=W._index=Y._editing=d),W._moving=W._panning=W._pinching=W._editing=W._57I=W._data=W._beginHistory=d,W.clearDragging()},handle_touchstart:function(p){var S=this;if(!S.gv._editing){_l(p),S._57I=d;var k=S.params,Q=S.gv,K=Q.sm(),y=Q.getDataAt(p),f=So(p);if(1===f){if(As(p))return Q.handleDoubleClick(p,y),void 0;Q.handleClick(p,y),y&&(Q.handleMouseDown&&Q.handleMouseDown(p,y),S._data=y),k.selectable||(y=d),y?(K.co(y)||K.ss(y),k.editable&&Q.isEditable(y)&&S._79I(p,y,!0)?(S._editing=1,S.startDragging(p)):k.movable&&Q.isMovable(y)&&(S._moving=1,S.startDragging(p))):(S._57I=vd(p),k.pannable&&Q.isPannable()&&(S._panning=1,S.startDragging(p),S._translate={x:Q.tx(),y:Q.ty()}))}else if(k.pinchable&&2===f){S._pinching=1,S.startDragging(p);var q=Q.getView(),H=Q.getZoom(),P=q.getBoundingClientRect(),e=p.touches[0],C=p.touches[1],L={x:(e.clientX+C.clientX)/2-P.left,y:(e.clientY+C.clientY)/2-P.top};L.x-=Q.tx(),L.y-=Q.ty(),L.x/=H,L.y/=H,S._p=L,S._d=en(p)}}},handle_touchend:function(r){var g=this,D=g.gv,U=g._57I,G=g._data;U&&(jc(U,vd(r))<=1&&D.sm().cs(),g._57I=d),G&&D.handleMouseUp&&D.handleMouseUp(r,G)},handleWindowTouchEnd:function(a){this.clear(a)},handleWindowTouchMove:function(h){var q=this,z=q.gv,Q=So(h);if(1===Q){if(q._editing&&(q._beginHistory||(q._beginHistory=1,z.dm().beginTransaction()),z._editing=1,q._78I(h)),q._moving)q._beginHistory||(q._beginHistory=1,z.dm().beginTransaction()),q.handleMove(h);else if(q._panning){var k=vd(h),d=Fb(z,k,q._lastClientPoint);z.setTranslate(q._translate.x+d.x,q._translate.y+d.y),q.fi({kind:z._panning?"betweenPan":"beginPan",event:h}),z._panning=1}}else if(2===Q&&q._pinching){var Y=en(h);z.handlePinch(q._p,Y,q._d),q._d=Y,q.fi({kind:z._pinching?"betweenPinch":"beginPinch",event:h}),z._pinching=1}},handleMove:function(Q){var S=this,y=S.gv,j=y.lp(Q);y._93O&&y._93O(Q,S._data)||(y.moveSelection(j.x-S._lastLogicalPoint.x,j.y-S._lastLogicalPoint.y),S._lastLogicalPoint=j,S.autoScroll(Q),S.fi({kind:y._moving?"betweenMove":"beginMove",event:Q}),y._moving=1)}});var P=H.ht,rj=P.graph._editor={Math:P.Math,Guide:{}};rj.getStyle=function(I){var e,H=rj.StyleMap;return H&&(e=H[I],e!==J)?e:rj.DefaultStyleMap[I]},rj.setStyle=function(p,g){var Z=rj.StyleMap;Z||(Z=rj.StyleMap={}),Z[p]=g},rj.inEdit=function(A){return A._inXEdit===!0},rj.startEdit=function(E){E._inXEdit=!0,rj.Inject.doInject(E)},rj._46O=function(O){O._inXEdit=!1,rj.Inject.undoInject(O)},rj.toScreenPosition=function(e,W){var k=e.tx(),o=e.ty(),z=e._zoom;return new rj.Math.Vector2(W.x*z+k,W.y*z+o)},rj.checkHit=function(C,D,k){return C.distanceTo(D)<k?!0:!1},rj.toWorldPosition=function(j,K){var Q=j.tx(),V=j.ty(),i=j._zoom;return{x:(K.x-Q)/i,y:(K.y-V)/i}},rj.setAntialias=function(J,H){for(var x,P=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],C=0,a=P.length;a>C&&(x=P[C],!(x in J));C++);J[x],J[x]=H},rj.getTargetCornersOnScreen=function(I,c){if(!c)return null;var i,J=[];if(Vc(c,I)){var s=Dr(I,c);i=[{x:s.x,y:s.y},{x:s.x+s.width,y:s.y},{x:s.x+s.width,y:s.y+s.height},{x:s.x,y:s.y+s.height}]}else{if(!c.getCorners)return null;i=c.getCorners()}return i.forEach(function(b){var g=rj.toScreenPosition(I,b);J.push(g.x,g.y)}),J},rj.log=function(){};var Kg=rj.Inject={_modules:[]};Kg.registAsModule=function(x,d){var w={},i={};for(var p in x){var c=d.prototype[p];w[p]=c}x.getBackup=function(V){return w[V]},x.getBackups=function(){return w},i.doInject=function(){for(var Z in x)"getBackup"!==Z&&(d.prototype[Z]=x[Z])},i.undoInject=function(){for(var M in x)"getBackup"!==M&&(d.prototype[M]=w[M])},Kg._modules.push(i)},Kg.doInject=function(n){for(var k,y=Kg._modules,E=0,L=y.length;L>E;E++)k=y[E],k.doInject(n)},Kg.undoInject=function(A){for(var Z,B=Kg._modules,y=0,b=B.length;b>y;y++)Z=B[y],Z.undoInject(A)};var vf=P.graph.EditInteractor=function(F){var W=this,B=b.createElement("canvas");B.className="editCanvas",B.style.position="absolute",W._styleMap={},W._canvas=B,W._context=B.getContext("2d"),vf.superClass.constructor.call(W,F),rj.setAntialias(W._context,!1),W._subModules=[new rj.Anchor(W),new rj.RotateX(W),new rj.MoveDummy(W),new rj.Rect(W),new rj.Curve(W),new rj.MoveHelper(W)],W._gridGuide=new rj.Guide.Grid(W),W._rectGuide=new rj.Guide.Rect(W),W._hoverGuide=new rj.Guide.Hover(W)},Li=vf;P.Default.def(vf,P.graph.Interactor,{ms_edit:1,ms_fire:1}),r.defineProperties(vf.prototype,{editDetail:{get:function(){var m=!!this._editDetail;return m},set:function(K){var F=this,y=F._editDetail;y!==K&&(F._editDetail=K,F.gv._editing=K,F.fp("editDetail",y,K),F.fp("pointsEditingMode",y,K),F.fi({kind:K?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(H){(!this._editDetail||H)&&(this.gv._editing=H,H||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(z){this._editing=z,this.gvEditing=z}},pointsEditingMode:{get:function(){return this.editDetail},set:function(I){var P=this;P.editDetail!==I&&(I?P._tryEnterEditDetailMode():P._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var m=this._gridEnabled;if(!m)return!1;var g=this.gv;return g?!0:!0},set:function(y){y!==this._gridEnabled&&(this._gridEnabled=y,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(P){P!==this._agEnabled&&(this._agEnabled=P,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),vf.prototype.getSubModule=function(j){var Q,g,B,c=this._subModules;for(g=0,B=c.length;B>g;g++)if(Q=c[g],Q.catalog===j)return Q},vf.prototype.invokeSubModule=function(z,f){var U=this,T=U._subModules;if(T)for(var Y,O,D,y=Array.prototype.slice.call(arguments,2),m=0,x=T.length;x>m;m++)if(Y=T[m],O=Y[z],O&&(D=O.apply(Y,y),D!=J&&f))return Y},vf.prototype.invokeSubModuleInverse=function(W,S){var E=this,p=E._subModules;if(p)for(var X,d,s,V=Array.prototype.slice.call(arguments,2),b=p.length-1;b>=0;b--)if(X=p[b],d=X[W],d&&(s=d.apply(X,V),s!=J&&S))return X},vf.prototype.setUp=function(){rj.log("setUp");var S=this,p=S.gv,u=p.getView(),N=S._canvas;vf.superClass.setUp.call(S),p.setEditInteractor(S),p._79O?u.insertBefore(N,p._79O):u.appendChild(N),rj.startEdit(p),S.invokeSubModule("setUp"),p.dm().mm(S._onDataModelChanged,S),p.dm().md(S._onDataPropertyChanged,S)},vf.prototype.tearDown=function(){rj.log("tearDown");var s=this,F=s.gv,l=F.getView();s._resetCustomCursorStyle(),vf.superClass.tearDown.call(s),F.dm().umm(s._onDataModelChanged,s),F.dm().umd(s._onDataPropertyChanged,s),F.setEditInteractor(null),l.removeChild(s._canvas),s._drawTimer&&(i(s._drawTimer),s._drawTimer=null),rj._46O(F),s.invokeSubModule("tearDown")},vf.prototype._onDataModelChanged=function(E){var I=this;("clear"===E.kind||"remove"===E.kind&&I.editDetail&&E.data===I.getSubModule("Curve").target)&&(I.editDetail=!1,I._42())},vf.prototype._onDataPropertyChanged=function(k){var W=this;if(W.editDetail){var F=W.getSubModule("Curve"),I=k.data;I===F.target&&(I._writing||F._handleDataChanged(k))}},vf.prototype.clear=function(){rj.log("clear")},vf.prototype.redraw=function(){this._42()},vf.prototype._42=function(){var K=this;K._drawTimer||(K._drawTimer=_(function(){K._drawTimer=null,K.drawImpl()},0))},vf.prototype.drawImpl=function(){var U;for(U in{_42:!0})break;return function(){var l=this,s=l._canvas,g=l.gv,M=g.getWidth(),A=g.getHeight(),q=l._context,r=P.Default.getInternal(),k=H.devicePixelRatio;(s.width!==M||s.height!==A)&&r.setCanvas(s,M,A,k),q.clearRect(0,0,s.width,s.height);var w=l._getValidSelection();q.save(),q.scale(k,k),l._gridGuide._42(),l.invokeSubModuleInverse(U,!1,q,g,w),l._rectGuide._42(),l._hoverGuide._42(),q.restore()}}(),vf.prototype._getValidSelection=function(){var F=this,m=F.gv,f=m.sm().getSelection(),E=[];return f.each(function(T){m.isVisible(T)&&m.isEditable(T)&&E.push(T)}),E},vf.prototype.handle_touchmove=function(J){return this.handle_mousemove(J)},vf.prototype.handle_mousemove=function(_){if(!P.Default.isDragging()){var u=this;if(u.editDetail||!br()&&!Ur(_))if(u.gvEditing=!1,u._checkEdit(_))u.gvEditing=!0;else{if(!u.getStyle("hoverGuideEnabled"))return;u.hoverData=u.gv.getDataAt(_),u._42()}}},vf.prototype.handle_touchstart=function(I){return this.handle_mousedown(I)},vf.prototype.handle_mousedown=function(j){_l(j);var g=this;if(g.editDetail||!br()&&!Ur(j)){if(As(j)&&!j.clickThrough){if(g.editDetail){if(g._tryQuitEditDetailMode(j))return}else if(g._tryEnterEditDetailMode())return;g.gv.dm().beginTransaction();var v=g.invokeSubModule("handleDoubleClick",!0,j);if(g.gv.dm().endTransaction(),v)return}var Y=g._checkEdit(j);Y&&(g._downPosition=g._getLogicalPoint(j),g.gv.dm().beginTransaction(),Y.startEdit(g,j),g.editing=!0)}},vf.prototype._checkEdit=function($){var b=this,F=b.gv,U=b._getLogicalPoint($),x=b.invokeSubModule("check",!0,F,$,U)||null;return b._editMod=x,x},vf.prototype.handleWindowTouchMove=function(T){return this.handleWindowMouseMove(T)},vf.prototype.handleWindowMouseMove=function(c){var S=this,n=S._downPosition;if(n){var x=S._getLogicalPoint(c);if(x.distanceTo(n)<S.getStyle("moveSensitivity"))return;delete S._downPosition}var d=S._editMod;d&&d.handleEdit(S.gv,c)},vf.prototype._getLogicalPoint=function(x){var b=this,u=P.Default.getLogicalPoint(x,b._canvas);return new rj.Math.Vector2(u)},vf.prototype.handleWindowTouchEnd=function(i){return this.handleWindowMouseUp(i)},vf.prototype.handleWindowMouseUp=function(){var L;for(L in{_46O:!0})break;return function(W){var S=this;S.editing=!1,S.setCursor("default"),S.invokeSubModule(L,!1,W),S._42(),S.gv.dm().endTransaction()}}(),vf.prototype.handle_mousewheel=function($){var s=this;_l($),s.invokeSubModule("preHandleScroll",!0)||s.gv.handleScroll($,$.wheelDelta)},vf.prototype.handleDelete=function(){var Q=this;if(!Q.editDetail){Q.gv.dm().beginTransaction();var r=Q.invokeSubModule("handleNormalStateDelete",!0);return Q.gv.dm().endTransaction(),r||Q.gv.removeSelection(),void 0}Q.gv.dm().beginTransaction(),Q.invokeSubModule("handleDelete",!0),Q.gv.dm().endTransaction(),Q._42()},vf.prototype.handle_keydown=function(Y){var $=this;if((Y.metaKey||Y.ctrlKey)&&$._42(),br(Y)&&!$.editing)return $.gvEditing=!1,$.setCursor("default"),$._42(),void 0;var E=mq(Y);return $.editDetail?((E||xd(Y))&&($.editDetail=!1,$._42()),$.gv.dm().beginTransaction(),$.invokeSubModule("handle_keydown",!0,Y),$.gv.dm().endTransaction(),void 0):($.gv.dm().beginTransaction(),$.invokeSubModule("handleNormalStateKeyDown",!0,Y),$.gv.dm().endTransaction(),E&&$._tryEnterEditDetailMode(),void 0)},vf.prototype.handle_keyup=function(K){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,K),this.gv.dm().endTransaction()},vf.prototype._tryEnterEditDetailMode=function(){var k=this;return!k.editDetail&&k.invokeSubModule("canEnterEditDetailMode",!0)&&1===k._getValidSelection().length?(k.editDetail=!0,k._42(),!0):void 0},vf.prototype._tryQuitEditDetailMode=function(T){var z=this;return z.editDetail?!T||z.invokeSubModule("canQuitEditDetailMode",!0,T)?(z.editDetail=!1,z._42(),!0):!1:!1},vf.prototype.setStyle=function(w,z,Z){var Q=this;Z?rj.setStyle(w,z):Q._styleMap[w]=z,"baseColor"===w&&(nc=z),Q.fp("styleChanged",null,{key:w,value:z,base:Z}),Q._42()},vf.prototype.getStyle=function(b){var i=this,W=i._styleMap[b];return W!==J?W:rj.getStyle(b)},vf.prototype.setCursor=function(q){this._resetCustomCursorStyle(),P.graph.EditInteractor.superClass.setCursor.call(this,q)},vf.prototype._resetCustomCursorStyle=function(){var f=this;if(f._customStyle){var d=this.gv.getView();d.classList&&d.classList.remove&&d.classList.remove(f._customStyle),f._customStyle=null}},vf.prototype._setRotateCursor=function(b){var Z=this,x=Z._cursorFactory;x||(x=Z._cursorFactory=new rj.CursorFactory(Z));var E=x.getRotateCursor(b),w=Z.gv.getView();Z._resetCustomCursorStyle(),Z._customStyle=E,w.classList&&w.classList.add&&w.classList.add(E)};var zs=rj.Group=function(Y){var Z=this;Z._entities=Y,Z._64O=0,Z._position={x:0,y:0},Z._scale={x:1,y:1},Z._anchor={x:.5,y:.5},Z._anchor2={x:.5,y:.5}};zs.prototype={},zs.prototype.constructor=zs;var Nb=null;zs.findOrCreateGroup=function(j){if(Nb&&Nb.checkIsMe(j))return Nb;var y=new rj.Group(j);return y.getKeyOb()?(Nb=y,y):void 0},zs.prototype.checkIsMe=function(h){var w=this._entities;if(w.length!==h.length)return!1;var F,$={},N=h.length;for(F=0;N>F;F++)$[h[F]._id]=!0;for(F=0;N>F;F++)if(!$[w[F]._id])return!1;return!0},zs.prototype.getRotation=function(){return this._64O},zs.prototype.getPosition=function(){return this._position},zs.prototype.getAnchor=function(){return this._anchor},zs.prototype.getWidth=function(){return this._width},zs.prototype.getScale=function(){return this._scale},zs.prototype.getSize=function(){return{width:this._width,height:this._height}},zs.prototype.getHeight=function(){return this._height},zs.prototype.getKeyOb=function(){for(var H=this._entities,p=H.length-1;p>=0;p--){var I=H[p];if(this.isNode(I))return I}},zs.prototype.getAnchor2=function(){var G=this,n=G.rotateCenter;if(n)return n;var f=G.getKeyOb();if(!f)return G._anchor;var k=G._anchor2,y=f.getMatrix();return y.tf({x:f.getWidth()*(k.x-f.getAnchor().x),y:f.getHeight()*(k.y-f.getAnchor().y)})},zs.prototype.setAnchor2=function(B,s){var g=this,h=g.getKeyOb();if(h){var R,$=h.getMatrix();R="number"==typeof B?{x:B,y:s}:B;var S=$.tfi(R);g._anchor2={x:h.getAnchor().x+S.x/h.getWidth(),y:h.getAnchor().y+S.y/h.getHeight()}}},zs.prototype.setRotation=function(){},zs.prototype.beginRotate=function(b){this.rotateCenter=b.pos,this.rotateMode=b.groupRotateMode},zs.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},zs.prototype.addRotation=function(m,c){return"batch"===c?this._addRotationInBatchMode(m):"block"===c?this._addRotationInBlockMode(m):void 0},zs.prototype._addRotationInBlockMode=function(H){var u=this,R=u.rotateCenter||u.getPosition();u._entities.forEach(function(X){if(u.isNode(X)){var M=X.getMatrix();M.translate(-R.x,-R.y),M.rotate(H),M.translate(R.x,R.y);var U=Math.sign(X.getScale().x);X.setRotation(k(M.b*U,M.a*U)),X.setPosition(M.tx,M.ty)}})},zs.prototype._addRotationInBatchMode=function(M){var O=this,c=O._anchor2;O._entities.forEach(function(h){if(O.isNode(h)){var n=h.getAnchor(),V=h.getMatrix(),d=V.tf({x:h.getWidth()*(c.x-n.x),y:h.getHeight()*(c.y-n.y)}),Q=new rj.Math.Matrix2d;Q.set(V.a,V.b,V.c,V.d,V.tx,V.ty),Q.translate(-d.x,-d.y),Q.rotate(M),Q.translate(d.x,d.y);var Z=Math.sign(h.getScale().x);h.setRotation(k(Q.b*Z,Q.a*Z)),h.setPosition(Q.tx,Q.ty)}})},zs.prototype.setPosition=function(z){var n,b,I,u,_=this,W=_._position,K=z.x-W.x,j=z.y-W.y,Z=_._entities;for(b=0,I=Z.length;I>b;b++)n=Z[b],Mp(n)&&(u=n.getPosition(),n.setPosition(u.x+K,u.y+j));_._position=z},zs.prototype.setScale=function(d,l){var S=this,m=d/S._scale.x,y=l/S._scale.y;S._adjustChildScaleOrSize(m,y,"size"),S._scale={x:d,y:l}},zs.prototype.getRect=function(){var D=this,E=D._position,J=D._width,z=D._height;return{x:E.x-J/2,y:E.y-z/2,width:J,height:z}},zs.prototype.setSize=function(S,n){var Z=this,S=Math.max(1,S),n=Math.max(1,n),P=S/Z._width,w=n/Z._height;Z._adjustChildScaleOrSize(P,w,"size"),Z._width=S,Z._height=n},zs.prototype._adjustChildScaleOrSize=function(O,J,D){var s,a,I,x,A,o,M,L,e,g,H,c,F,z,b=this,W=b._position,N=b._entities,f=new rj.Math.Matrix2d;for(a=0,I=N.length;I>a;a++)if(s=N[a],b.isNode(s)){if(x=s.getPosition(),A=s.getRotation(),o=s.getWidth(),M=s.getHeight(),L=s.getScale(),H=L.x*o,c=L.y*M,f.identity().scale(H,c).rotate(A).translate(x.x,x.y).translate(-W.x,-W.y).rotate(-b._64O),A=k(f.b*Math.sign(H),f.a*Math.sign(H)),f.scale(O,J),e=Math.cos(A),g=Math.sin(A),Math.abs(e)<.001?(F=f.b/g,z=-f.c/g):(F=f.a/e,z=f.d/e),"scale"===D)s.setScale(F/o,z/M);else if("size"===D){var h=F/L.x,P=z/L.y;s.setScale(uo(F)*Math.abs(L.x),uo(z)*Math.abs(L.y)),s.setSize(Math.max(.1,Math.abs(h)),Math.max(.1,Math.abs(P)))}f.rotate(b._64O).translate(W.x,W.y),s.setPosition(f.tx,f.ty)}},zs.prototype.getMatrix=function(){var J=this,S=J._position,V=P.Default.getInternal(),z=J._scale;return new V.Mat(J._64O,S.x,S.y,z.x,z.y)},zs.prototype.toGlobal=function(B){return this.getMatrix().tf(B)},zs.prototype.getCorners=function(){var V=this,O=V._width,$=V._height,Z=V._anchor,m=-O*Z.x,L=-$*Z.y,s=V.getMatrix();return[s.tf(m,L),s.tf(m,L+$),s.tf(m+O,L+$),s.tf(m+O,L)]},zs.prototype.calcInfo=function(){var j,k,a,q,V,X,n=this,h=[],A=n._entities,K=n._64O;for(q=0,V=A.length;V>q;q++)X=A[q],n.isNode(X)&&X.getCorners&&h.push.apply(h,X.getCorners());if(h.length){var W=Math.cos(-K),Q=Math.sin(-K),o=1/0,L=-1/0,S=1/0,z=-1/0;for(q=0,V=h.length;V>q;q++)a=h[q],j=a.x,k=a.y,a.x=W*j-Q*k,a.y=Q*j+W*k,o=Math.min(o,a.x),L=Math.max(L,a.x),S=Math.min(S,a.y),z=Math.max(z,a.y);n._width=(L-o)/n._scale.x,n._height=(z-S)/n._scale.y,W=Math.cos(K),Q=Math.sin(K);var O=n._anchor;j=o+(L-o)*O.x,k=S+(z-S)*O.y,n._position={x:W*j-Q*k,y:Q*j+W*k}}},zs.prototype.isNode=function(K){return Mp(K)?Vc(K)?!1:!0:!1},zs.prototype._42=function(e,R,A){var E,n,L,l,$,S,F,o,d=this,s=d._entities,Y=d.rotateMode;for("batch"===Y&&(o=d.getKeyOb()),E=0,n=s.length;n>E;E++)L=s[E],d.isNode(L)&&(S=L.getRect(),l=rj.toScreenPosition(A,{x:S.x,y:S.y}),$=rj.toScreenPosition(A,{x:S.x+S.width,y:S.y+S.height}),F={min:l,max:$},L===o&&(F.isKeyOb=!0),rj.Icons.DrawIcon(e,R,rj.Icons.GroupSubEntityRect,F))};var wf=rj.CurveActiving=function(D,r){this._curve=D,this._interactor=D._interactor;for(var T in r)this[T]=r[T]};wf.prototype={},wf.prototype.constructor=wf,r.defineProperties(wf.prototype,{point:{get:function(){return this._point
},set:function(a){var T=this;T._point=a,T.editingCtrl||T._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(h){var T=this;T._pairs=h,T.editingCtrl&&T._firePointChange()}}}),wf.prototype._firePointChange=function(){var w=this,B=w.getCurrentEditingPoint(),V=w._interactor;if(!B)return V.fi({kind:"selectPoint"}),void 0;var a=this._curve.target;if(a){var M=rj.getDataMatrix(a).invert(),l=B.e;B=M.apply(rj.toWorldPosition(V.gv,B)),B.e=l;var k=w._lastFirePoint;k&&Math.abs(B.x-k.x)<1e-5&&Math.abs(B.y-k.y)<1e-5&&(B.e==J&&k.e==J||Math.abs(B.e-k.e)<1e-5)||(w._lastFirePoint=B,V.fi({kind:"selectPoint",x:B.x,y:B.y,e:B.e}))}},wf.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},wf.prototype.getCurrentEditingPoint=function(){var W=this,Z=W.editingCtrl;if(Z){var f=W.pairs;if(f){var U=f[Z.pairId],r=U[Z.type];if(r)return r}}return W._point};var Hn=rj.CursorFactory=function(G){var H=this;H._interactor=G,H._rotateCursorStyles={}};Hn.prototype={},Hn.prototype.constructor=Hn,Hn.prototype.getRotateCursor=function(H){var d=this;0>H&&(H+=2*Math.PI);var E=d._interactor,l=E.getStyle("rotateCursorSize"),w=E.getStyle("rotateCursorRound"),g=Math.round(180*(H/Math.PI)/w);g*w>=360&&(g=0);var D=d._rotateCursorStyles,J="htCustomRotateStyle_"+l+"_"+w+"_"+g;return D[J]||(d._produceRotateCursor(J,l,w,g),D[J]=!0),J},Hn.prototype._produceRotateCursor=function(f,e,p,m){var N=this;N._interactor;var n=N._canvas;n||(n=N._canvas=b.createElement("canvas")),n.width=n.height=e*devicePixelRatio,n.style.width=n.style.height=e+" px";var _=n.getContext("2d");rj.setAntialias(_,!1),_.scale(devicePixelRatio,devicePixelRatio);var d,Y,L,A,i,G=Math.round(e/2),V=""+G+" "+G+",auto !important;";d=Math.PI/180*m*p,_.clearRect(0,0,e,e),_.save(),_.scale(e/32,e/32),_.translate(16,16),_.rotate(d+Math.PI/2),_.beginPath(),_.moveTo(-8,0),_.lineTo(-8,3),_.lineTo(-5,3),_.moveTo(8,0),_.lineTo(8,3),_.lineTo(5,3),_.moveTo(-8,3),_.quadraticCurveTo(0,-6,8,3),_.restore(),_.strokeStyle="white",_.lineWidth=4,_.stroke(),_.strokeStyle="black",_.lineWidth=2,_.stroke(),Y=JSON.stringify(n.toDataURL()),A="cursor:url("+Y+")"+V,1!==devicePixelRatio&&(L='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+e+'px" height="'+e+'px"><image xlink:href='+Y+' width="'+e+'" height="'+e+'"/></svg>',A+="cursor:url(data:image/svg+xml;base64,"+btoa(L)+")"+V,A+="cursor:-webkit-image-set(url("+Y+")"+devicePixelRatio+"x,url("+Y+")1x)"+V),i=b.createElement("style"),i.textContent="body."+f+" *, ."+f+"{"+A+"}",b.head.appendChild(i)};var lf=rj.Guide.Grid=function(L){var u=this;u._interactor=L,u._alignmentGuideId=0,u._xAlignmentGuide=[],u._yAlignmentGuide=[]};lf.prototype={},lf.prototype.constructor=lf,r.defineProperties(lf.prototype,{gridBlockSize:{get:function(){var j=this;return j._gridBlockSize||j._interactor.getStyle("gridBlockSize")},set:function(w){this._gridBlockSize=w,this._interactor._42()}},gridThickLinesEvery:{get:function(){var _=this;return _._gridThickLinesEvery||_._interactor.getStyle("gridThickLinesEvery")},set:function(o){this._gridThickLinesEvery=o,this._interactor._42()}},gridEnabled:{get:function(){var o=this,V=o._interactor;return V.gridEnabled&&o.isValidGrid()}}}),lf.prototype._42=function(){var v=this,M=v._interactor;v.gridEnabled&&v.drawGrid(),M.alignmentGuideEnabled&&v.drawAlignmentGuide()},lf.prototype.makeMatrix=function(){var G=this,U=G._interactor.getStyle("gridAngle"),J=G._interactor.getStyle("gridRotation"),r=new rj.Math.Matrix2d,x=Math.sin(U),t=Math.cos(U);return r.set(1,0,t,x,0,0),r.rotate(J),r},lf.prototype.isValidGrid=function(){var z=this,L=Math.PI,l=z._interactor,y=l.gv;if(y._zoom<l.getStyle("gridZoomThreshold"))return!1;var A=l.getStyle("gridAngle"),u=Math.abs(180*(A%L/L)),x=1-1e-8;return x>u||u>180-x?!1:!0},lf.prototype.drawAlignmentGuide=function(){var u=this,l=u._interactor,N=l.gv,i=l._canvas,w=l._context,Q=i.width,H=i.height,v=N.tx(),L=N.ty(),j=N._zoom;w.beginPath(),w.strokeStyle=l.getStyle("gridAlignmentGuideColor"),w.lineWidth=1,u._xAlignmentGuide.forEach(function(y){var g=y.p*j+v;w.moveTo(g,0),w.lineTo(g,H)}),u._yAlignmentGuide.forEach(function(m){var P=m.p*j+L;w.moveTo(0,P),w.lineTo(Q,P)}),w.stroke()},lf.prototype.drawGrid=function(){function y(S,z,d,m){var W=rj.toScreenPosition(c,E.apply({x:S,y:z})),r=rj.toScreenPosition(c,E.apply({x:d,y:m}));V.moveTo(W.x,W.y),V.lineTo(r.x,r.y)}var G=this,X=G._interactor,H=G.gridBlockSize,W=G.gridThickLinesEvery,K=X.getStyle("gridThickColor"),P=X.getStyle("gridLightColor"),c=X.gv,h=X._canvas,V=X._context,T=h.width,N=h.height,E=G.makeMatrix(),J=E.applyInverse(rj.toWorldPosition(c,{x:0,y:0})),A=E.applyInverse(rj.toWorldPosition(c,{x:T,y:0})),k=E.applyInverse(rj.toWorldPosition(c,{x:0,y:N})),p=E.applyInverse(rj.toWorldPosition(c,{x:T,y:N})),m=Math.min(J.x,A.x,k.x,p.x),S=Math.max(J.x,A.x,k.x,p.x),F=Math.min(J.y,A.y,k.y,p.y),n=Math.max(J.y,A.y,k.y,p.y);T=S-m,N=n-F;var z=Math.ceil(m/H),t=Math.floor(S/H),M=Math.ceil(F/H),a=Math.floor(n/H);c.tx(),c.ty(),c._zoom;var d,B,i;for(V.save(),V.lineWidth=1,V.beginPath(),V.strokeStyle=K,i=Math.ceil(z/W)*W;t>=i;i+=W)d=i*H,y(d,F,d,n);for(i=Math.ceil(M/W)*W;a>=i;i+=W)B=i*H,y(m,B,S,B);for(V.stroke(),V.beginPath(),V.strokeStyle=P,i=z;t>=i;i++)0!==i%W&&(d=i*H,y(d,F,d,n));for(i=M;a>=i;i++)0!==i%W&&(B=i*H,y(m,B,S,B));V.stroke(),V.restore()},lf.prototype.getAlignmentGuides=function(){var l=this;return{x:l._xAlignmentGuide,y:l._yAlignmentGuide}},lf.prototype.addAlignmentGuide=function(t,w,C){var F=this,i="x"===t?F._xAlignmentGuide:F._yAlignmentGuide,C=C?C:++F._alignmentGuideId,X={p:w,id:C};if(i.length){var k=F._findClosestAlignmentGuide(X.p,i);k.dis<0?i.splice(k.index+1,0,X):i.splice(k.index,0,X)}else i.push(X);return F._interactor._42(),C},lf.prototype.findClosest=function(Z,H,l){var U=this,T=U._interactor,u=T.gv;l&&(Z=rj.toWorldPosition(u,Z));var K,f,E,B=1/0,G=1/0,Y=Z.x,P=Z.y;if(U.gridEnabled){var I=U.gridBlockSize,h=U.makeMatrix(),r=h.applyInverse(Z);r=h.apply({x:Math.round(r.x/I)*I,y:Math.round(r.y/I)*I}),B=r.x-Y,G=r.y-P,E=!0}if(T.alignmentGuideEnabled&&(K=U._findClosestAlignmentGuide(Y,U._xAlignmentGuide).dis,f=U._findClosestAlignmentGuide(P,U._yAlignmentGuide).dis,Math.abs(K)<Math.abs(B)&&(B=K,E=!0),Math.abs(f)<Math.abs(G)&&(G=f,E=!0)),E){E=!1;var o=u._zoom,z=T.getStyle("smartGuideSensitivity")/o,a={};if(Math.abs(B)<z&&"y"!==H&&(a.x=l?B*o:B,E=!0),Math.abs(G)<z&&"x"!==H&&(a.y=l?G*o:G,E=!0),E)return a}},lf.prototype._findClosestAlignmentGuide=function(Z,l){if(!l.length)return{dis:1/0};for(var h,R=0,z=l.length-1;z-R>1;)h=Math.floor((R+z)/2),l[h].p<Z?R=h:z=h;var p=l[R].p-Z,G=l[z].p-Z;return Math.abs(p)<=Math.abs(G)?{line:l[R],dis:p,index:R}:{line:l[z],dis:G,index:z}},lf.prototype.removeAllAlignmentGuide=function(F){var s=this;"y"!==F&&(s._xAlignmentGuide=[]),"x"!==F&&(s._yAlignmentGuide=[]),s._interactor._42()},lf.prototype.removeAlignmentGuide=function(R){for(var L,l,e,X=this,D=X._xAlignmentGuide,d=0;2>d;d++)for(D=0===d?X._xAlignmentGuide:X._yAlignmentGuide,L=0,l=D.length;l>L;L++)if(e=D[L],e.id===R)return D.splice(L,1),X._interactor._42(),{axis:0===d?"x":"y",position:e.p};return!1},lf.prototype.adjustAlignmentGuide=function(e,I){var Q=this,G=Q.removeAlignmentGuide(e);return G?(Q.addAlignmentGuide(G.axis,I,e),!0):!1};var ln=rj.Guide.Rect=function(G){var S=this;S._interactor=G};ln.prototype={},ln.prototype.constructor=ln,ln.prototype.gatherRects=function(){var E,b,X,D,h=this,x=h._interactor.gv,w=[],p=[],A={x:w,y:p},I={},n=x.getDataModel(),k=n.a("width"),S=n.a("height");k&&S&&(E=0,b=0,X=k,D=S,w.push({node:n,type:0,p:E},{node:n,type:1,p:E+X/2},{node:n,type:2,p:E+X}),p.push({node:n,type:0,p:b},{node:n,type:1,p:b+D/2},{node:n,type:2,p:b+D}),I[n._id||0]={x:E,y:b,width:X,height:D}),n.each(function(S){if(Mp(S)&&!x.isSelected(S)&&x.isVisible(S)){var Y=!1;if(x.sm().getSelection().each(function(M){Y||(S.isHostOn(M)?Y=!0:S.isDescendantOf(M)&&(Y=!0))}),!Y){var g=S.getRect();E=g.x,b=g.y,X=g.width,D=g.height,w.push({node:S,type:0,p:E},{node:S,type:1,p:E+X/2},{node:S,type:2,p:E+X}),p.push({node:S,type:0,p:b},{node:S,type:1,p:b+D/2},{node:S,type:2,p:b+D}),I[S._id]=g}}}),w.sort(function(v,p){return v.p-p.p}),p.sort(function(E,H){return E.p-H.p}),h._grid=A,h._87I=I},ln.prototype.gatherLines=function(i,Y,J){var v,N,X,q,b,s,W,Z,R,T,j,p,H=this,z=[H.findClosest({x:i.x,y:i.y},Y),H.findClosest({x:i.x+i.w/2,y:i.y+i.h/2},Y),H.findClosest({x:i.x+i.w,y:i.y+i.h},Y)],d={},w=H._87I;J=J||255;var K,f;for(H._guideLine=[],v=0;2>v;v++)for(d={},0===v?(q="y",Z=i.x,R=Z+i.w):(q="x",Z=i.y,R=Z+i.h),N=0;3>N;N++)b=z[N],b&&isFinite(b[q])&&(K=1<<3*v+N,J&K&&(s=b[q+"Line"],W=s.node,f=W._id||0,d[f]||(d[f]=!0,p=w[f],"y"===q?(T=p.x,j=p.x+p.width):(T=p.y,j=p.y+p.height),X=s.p,H._guideLine.push({type:q,a:Z,b:R,c:T,d:j,p:X,center:1===s.type}))))},ln.prototype._binarySearchClosest=function(r,i){if(!i.length)return{dis:1/0};for(var F,X=0,c=i.length-1;c-X>1;)F=Math.floor((X+c)/2),i[F].p<r?X=F:c=F;var W=i[X].p-r,_=i[c].p-r;return Math.abs(W)<=Math.abs(_)?{line:i[X],dis:W}:{line:i[c],dis:_}},ln.prototype.findClosest=function(Y,V,s){var O=this,C=O._interactor,W=C.gv,_=O._grid;s&&(Y=rj.toWorldPosition(W,Y));var J,y=O._binarySearchClosest(Y.x,_.x),l=O._binarySearchClosest(Y.y,_.y),u=y.dis,B=l.dis,j=W._zoom,d=C.getStyle("smartGuideSensitivity")/j,L={};return Math.abs(u)<d&&"y"!==V&&(L.x=s?u*j:u,L.xLine=y.line,J=!0),Math.abs(B)<d&&"x"!==V&&(L.y=s?B*j:B,L.yLine=l.line,J=!0),J?L:void 0},ln.prototype._42=function(){var l=this,q=l._guideLine;if(q&&!P.Default.isCtrlDown()){var z,Q,_,b,G,K,k,O,$,n,C,u,h,m,M,R,y,A=l._interactor,H=A.gv,F=A._context,Y=H.tx(),D=H.ty(),p=H._zoom,c=A.getStyle("guideLineTextSpacing");for(z=0,Q=q.length;Q>z;z++)_=q[z],O=_.type,$=_.p,n=_.a,C=_.b,u=_.c,h=_.d,m=Math.min(n,u),M=Math.max(C,h),"x"===O?(b=$*p+Y,G=m*p+D,K=b,k=M*p+D):(b=m*p+Y,G=$*p+D,K=M*p+Y,k=G),rj.Icons.DrawIcon(A,F,rj.Icons.MoveLineGuide,{rect:[b,G,K,k],center:_.center}),h>=n&&C>=u||(m=n>h?h:C,M=n>h?n:u,y=M-m,"x"===O?(_.center2center||(b-=c,K=b),G=m*p+D,k=M*p+D,R=rj.Icons.MoveLineGuideDistanceV):"y"===O&&(_.center2center||(G-=c,k=G),b=m*p+Y,K=M*p+Y,R=rj.Icons.MoveLineGuideDistanceH),rj.Icons.DrawIcon(A,F,R,{x0:b,y0:G,x1:K,y1:k,dis:y}))}},ln.prototype.clear=function(){this._guideLine=null};var Fm=rj.Guide.Hover=function(g){var z=this;z._interactor=g};Fm.prototype={},Fm.prototype.constructor=Fm,r.defineProperties(Fm.prototype,{}),Fm.prototype._42=function(){var v=this._interactor;if(v.getStyle("hoverGuideEnabled")&&!v.gvEditing){var g=v.hoverData,V=v.gv;if(!Mp(g)||V.isSelected(g))return v.hoverData=null,void 0;var p=Dr(V,g),$=rj.toScreenPosition(V,{x:p.x,y:p.y}),Q=rj.toScreenPosition(V,{x:p.x+p.width,y:p.y+p.height});rj.Icons.DrawIcon(v,v._context,rj.Icons.HoverDataRect,{min:$,max:Q,color:v.getStyle("hoverGuideColor")||v.getStyle("baseColor")})}},rj.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyVisible:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,guideLineTextSpacing:0,hoverGuideEnabled:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var jp=rj.Icons={},xi=1e4,Al=null,nc=rj.DefaultStyleMap.baseColor,tl="rgb(183,232,135)",_f="rgb(255,204,153)",Hg=6;P.Default.setImage("Icons.RectPoint",{width:Hg,height:Hg,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return nc}},rect:[0,0,Hg,Hg]}]}),jp.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var X=jp.GroupSubEntityRect.data;if(!X)return[];var $=X.min,B=X.max;return[$.x,$.y,$.x,B.y,B.x,B.y,B.x,$.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return jp.GroupSubEntityRect.data.isKeyOb?nc:nc}}}]};var Xj=4;jp.HoverDataRect={comps:[{type:"shape",points:{func:function(){var g=jp.HoverDataRect.data;if(!g)return[];var M=g.min,d=g.max,z=Xj;return M.x-=z,M.y-=z,d.x+=z,d.y+=z,[M.x,M.y,M.x,d.y,d.x,d.y,d.x,M.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return jp.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},jp.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[jp.Line.data.P1.x,jp.Line.data.P1.y],Hg,Hg]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[jp.Line.data.P2.x,jp.Line.data.P2.y],Hg,Hg]}}}]},jp.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return jp.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},jp.Rect={comps:[{type:"shape",points:{func:function(){var X=jp.Rect.data;if(!X)return[];var b=X.LT,w=X.LB,R=X.RB,z=X.RT;return[b.x,b.y,w.x,w.y,R.x,R.y,z.x,z.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return nc}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return jp.Rect.data.rotation}},rect:{func:function(){return[[jp.Rect.data.LT.x,jp.Rect.data.LT.y],Hg,Hg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return jp.Rect.data.rotation}},rect:{func:function(){return[[jp.Rect.data.LB.x,jp.Rect.data.LB.y],Hg,Hg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return jp.Rect.data.rotation}},rect:{func:function(){return[[jp.Rect.data.RB.x,jp.Rect.data.RB.y],Hg,Hg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return jp.Rect.data.rotation}},rect:{func:function(){return[[jp.Rect.data.RT.x,jp.Rect.data.RT.y],Hg,Hg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return jp.Rect.data.rotation}},visible:{func:function(){return jp.Rect.data.L?!0:!1}},rect:{func:function(){return[[jp.Rect.data.L.x,jp.Rect.data.L.y],Hg,Hg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return jp.Rect.data.rotation}},visible:{func:function(){return jp.Rect.data.R?!0:!1}},rect:{func:function(){return[[jp.Rect.data.R.x,jp.Rect.data.R.y],Hg,Hg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return jp.Rect.data.rotation}},visible:{func:function(){return jp.Rect.data.T?!0:!1}},rect:{func:function(){return[[jp.Rect.data.T.x,jp.Rect.data.T.y],Hg,Hg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return jp.Rect.data.rotation}},visible:{func:function(){return jp.Rect.data.B?!0:!1}},rect:{func:function(){return[[jp.Rect.data.B.x,jp.Rect.data.B.y],Hg,Hg]}}}]};var Ed=16;P.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return nc}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return nc}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),jp.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[jp.Anchor.data.POS.x,jp.Anchor.data.POS.y],Ed,Ed]}}}]},jp.TipShiftX=12,jp.TipShiftY=12;var Bf=[8,28];jp.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[jp.TipHelper.data.helperPos.x,jp.TipHelper.data.helperPos.y,Bf[0]*jp.TipHelper.data.size,Bf[1]]}},background:{func:function(){return Al.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return jp.TipHelper.data.text}},rect:{func:function(){return[jp.TipHelper.data.helperPos.x,jp.TipHelper.data.helperPos.y,Bf[0]*jp.TipHelper.data.size,Bf[1]]}},color:{func:function(){return Al.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var _o=7;jp.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!jp.ShapePoint.data.dynamicVisible}},rect:{func:function(){var I=jp.ShapePoint.data.point,y=jp.ShapePoint.data.size||_o;return[I,y+10,y+10]}},background:{func:function(){var E=Date.now(),y=jp.ShapePoint.data.dynamicPeriod||1500,_=Math.sin(E%y/y*Math.PI);return"rgba(27,124,22,"+.5*_+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var n=jp.ShapePoint.data.point,B=jp.ShapePoint.data.size||_o;return[n,B,B]}},background:{func:function(){var w=jp.ShapePoint.data.isEnd;return w?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return jp.ShapePoint.data.color||nc}}},{type:"rect",visible:{func:function(){return!!jp.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return nc}},rect:{func:function(){var I=5;return[jp.ShapePoint.data.point,I,I]}}}]},jp.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!jp.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return jp.ShapeBgCurve.data.P}},segments:{func:function(){return jp.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var t=Date.now(),a=jp.ShapeBgCurve.data.dynamicPeriod||1500,k=Math.sin(t%a/a*Math.PI);return"rgba(27,124,22,"+.3*k+")"}}},{type:"shape",points:{func:function(){return jp.ShapeBgCurve.data.P}},segments:{func:function(){return jp.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return jp.ShapeBgCurve.data.color||nc}}}]};var Bn=8;jp.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var n=jp.ShapeHighlighPoint.data;return[[n.x,n.y],Bn,Bn]}},background:{func:function(){return Al.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Ji=10;jp.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var k=jp.ShapeHighlighRealPoint.data;return[[k.x,k.y],Ji,Ji]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return nc}}}]};var Tr=8;jp.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var b=jp.ShapeHighlighCtrlPoint.data,T=b.x,f=b.y,U=Tr/2;return[T-U,f-U,T-U,f+U,T+U,f+U,T+U,f-U]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Al.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Al.getStyle("shapeCtrlPointBorderColor")||nc}}}]};var hr=3;jp.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return jp.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:hr,borderColor:{func:function(){return Al.getStyle("curveHighlightColor")}}}]},jp.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return jp.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},jp.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return jp.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return jp.MoveLineGuide.data.center?tl:_f}}}]};var fj=5;jp.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var M=jp.MoveLineGuideDistanceH.data,p=M.x0,f=M.y0;return[p,f-fj,p,f+fj]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:_f},{type:"shape",points:{func:function(){var A=jp.MoveLineGuideDistanceH.data,B=A.x1,t=A.y1;return[B,t-fj,B,t+fj]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:_f},{type:"text",text:{func:function(){return Math.round(jp.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var c=jp.MoveLineGuideDistanceH.data;return[[(c.x0+c.x1)/2,c.y0-10],20,20]}},color:_f,font:"12px Arial",align:"center"}]},jp.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var C=jp.MoveLineGuideDistanceV.data,E=C.x0,x=C.y0;return[E-fj,x,E+fj,x]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:_f},{type:"shape",points:{func:function(){var S=jp.MoveLineGuideDistanceV.data,r=S.x1,U=S.y1;return[r-fj,U,r+fj,U]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:_f},{type:"text",text:{func:function(){return Math.round(jp.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var r=jp.MoveLineGuideDistanceV.data;return[[r.x0-10,(r.y0+r.y1)/2],20,20]}},color:_f,font:"12px Arial",align:"center"}]},P.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),jp.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var N=jp.EdgeElevationGuide.data,s=N.x,Y=N.y,b=Al.getStyle("curveElevationIntersectSize"),I=Al.getStyle("curveElevationGuideShift");return s+=I[0],Y+=I[1],[s-b,Y-b,2*b,2*b]}}}]},P.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),P.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),jp.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return jp.ConnectGuide.data.rotation}},rect:{func:function(){var s=jp.ConnectGuide.data.connect;s.x,s.y;var l=Al.getStyle("connectGuideIntersectSize");return[[s.x,s.y],2*l,2*l]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var s=jp.ConnectGuide.data.cursorPos||jp.ConnectGuide.data.connect,N=Al.getStyle("connectGuideIntersectSize");return[[s.x,s.y],2*N-2,2*N-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var R=jp.ConnectGuide.data.connect,g=jp.ConnectGuide.data.cursorPos||R;return[R.x,R.y,R.x+.5*(g.x-R.x),R.y,g.x+.5*(R.x-g.x),g.y,g.x,g.y]}}}]},P.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),P.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),jp.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var j=jp.ConnectGuideGarbage.data.hover;return j?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var M=jp.ConnectGuideGarbage.data,P=Al.getStyle("connectGuideGarbageIntersectsize");return M.hover&&(P+=5),[[M.x,M.y],2*P,2*P]}}}]};var Yh=6;jp.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return jp.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var p=jp.ShapeActivingCtrl.data;return[p.point.x,p.point.y,p.c1.x,p.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return nc}}},{type:"shape",visible:{func:function(){return jp.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var c=jp.ShapeActivingCtrl.data;return[c.point.x,c.point.y,c.c2.x,c.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return nc}}},{type:"shape",visible:{func:function(){return jp.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var I=jp.ShapeActivingCtrl.data.c1,O=I.x,E=I.y,b=Yh/2;return"c1"===jp.ShapeActivingCtrl.data.hl&&(b+=.5),[O-b,E-b,O-b,E+b,O+b,E+b,O+b,E-b]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Al.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===jp.ShapeActivingCtrl.data.hl?Al.getStyle("shapeCtrlPointHighlightBorder")||nc:Al.getStyle("shapeCtrlPointBorderColor")||nc}}},{type:"shape",visible:{func:function(){return jp.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var U=jp.ShapeActivingCtrl.data.c2,Q=U.x,P=U.y,i=Yh/2;return"c2"===jp.ShapeActivingCtrl.data.hl&&(i+=.5),[Q-i,P-i,Q-i,P+i,Q+i,P+i,Q+i,P-i]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Al.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===jp.ShapeActivingCtrl.data.hl?Al.getStyle("shapeCtrlPointHighlightBorder")||nc:Al.getStyle("shapeCtrlPointBorderColor")||nc}}}]},jp.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return nc}},rect:{func:function(){return[[jp.RoundPoint.data.x,jp.RoundPoint.data.y],Hg,Hg]}}}]},jp.AttachPoint={comps:[{type:"rect",background:{func:function(){return jp.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return nc}},rect:{func:function(){var q=jp.AttachPoint.data.isAttach?Hg+4:Hg;return[[jp.AttachPoint.data.x,jp.AttachPoint.data.y],q,q]}}}]},jp.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return jp.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return jp.SimpleRect.data.color||nc}},rect:{func:function(){var J=jp.SimpleRect.data;return[J.x,J.y,J.width,J.height]}}}]},P.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),jp.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var E=jp.MoveDummy.data;return[[E.pos.x,E.pos.y],2*E.size,2*E.size]}}}]},rj.Icons.DrawIcon=function(F,Z,H,S){H.width=H.height=xi,H.data=S,Al=F,P.Default.drawImage(Z,H,0,0,xi,xi)},rj.Icons.MapPoints=function(V,y){for(var w=0,v=V.length;v>w;w++)V[w]/=y},rj.roundTo=function(o,V,f){var h=Math.abs(o%V);return f>h||f>V-h?V*Math.round(o/V):o},rj.toFixed=function(B){return Math.round(100*B)/100},rj.getDataMatrix=function(p){if(p instanceof P.Shape){var Z=new P.Math.Matrix2d,V=p.getPosition();return Z.translate(-V.x,-V.y).scale(p.getScale().x,p.getScale().y).rotate(p.getRotation()).translate(V.x,V.y),Z}return p.getMatrix?p.getMatrix():new P.Math.Matrix2d};var jr=rj.Math.Curve=function(){this._curves=[]};jr.prototype={},jr.prototype.constructor=jr,jr.prototype.createFromHtShape=function(j,L,p){L instanceof P.List&&(L=L.toArray());var V,d,k,K,N,l,T,U=this,B=null,M=null,E=0,y=rj.Math.Vector2,D=rj.Math.CubicBezier,F=function(t){return new y(j[t],j[t+1],p?p[t/2]:J)};for(d=0,k=L.length;k>d;d++){switch(K=L[d],N=null,K){case 1:M=F(E),B=M,E+=2;break;case 2:V=F(E),E+=2,N=new D(M,M.clone(),V.clone(),V),M=V;break;case 3:l=F(E),V=F(E+2),E+=4,N=new D(M,l.clone().sub(M).multiplyScalar(2/3).add(M),l.clone().sub(V).multiplyScalar(2/3).add(V),V),M=V;break;case 4:l=F(E),T=F(E+2),V=F(E+4),E+=6,N=new D(M,l,T,V),M=V;break;case 5:if(!B)break;N=new D(M,M.clone(),B.clone(),B),M=null,B=null}N&&(N._index=U._curves.length,U._curves.push(N))
}},jr.prototype.checkPoint=function(j,E){var x,V,L,S,O,d=this,r=d._curves;for(x=0,V=r.length;V>x;x++)if(S=r[x],O=S.intersectRect(j,E,E),O.length)return L=0,O.forEach(function(r){L+=r.t}),L/=O.length,j=S.getPointAt(L),j.t=L,{bezier:S,intersection:j}},jr.prototype.insertKnot=function(r,L){var W=r.insertKnot(L),Z=this,q=Z._curves;q.splice(r._index,1,W[0],W[1])},jr.prototype._isCloseEnough=function(h,A){return Math.abs(h.x-A.x)<1e-6&&Math.abs(h.y-A.y)<1e-6},jr.prototype._isSamePoint=function(g,c){return g===c},jr.prototype.moveRealPoint=function(a,H){var Y=this,T=Y._curves,g=H.clone().sub(a);T.forEach(function(L){var F=L._p1;L._p2,L._p3;var s=L._p4;Y._isSamePoint(F,a)&&(L._p2.add(g),L._p1=H),Y._isSamePoint(s,a)&&(L._p3.add(g),L._p4=H)})},jr.prototype.moveCtrlDueToRealPointMovement=function(G,J){var _=this,H=_._curves,L=function(s){s.add(J),s.e&&J.e&&(s.e+=J.e)};H.forEach(function(w){var Y=w._p1;w._p2,w._p3;var u=w._p4;_._isSamePoint(Y,G)&&L(w._p2),_._isSamePoint(u,G)&&L(w._p3)})},jr.prototype.moveCtrlPoint=function(H,W,F){var q=H[F];if(q){q.e!==J&&(W.e=q.e);var n=this,w=n._curves;W.clone().sub(q),w.forEach(function(D){var Z;"c2"===F?Z="_p2":"c1"===F&&(Z="_p3"),n._isSamePoint(D[Z],q)&&(D[Z]=W)}),H[F]=W}},jr.prototype.deleteRealPoint=function(u,I){var b,K,Q,J,p,U,h,P=this,v=P._curves,o={},A=[],W=rj.Math.CubicBezier;for(K=0,Q=v.length;Q>K;K++)b=v[K],J=b._p1,p=b._p2,U=b._p3,h=b._p4,(o[K]||!P._isSamePoint(J,u))&&(P._isSamePoint(h,u)?Q>K+1&&P._isSamePoint(v[K+1]._p1,u)&&(I||A.push(new W(J,p,v[K+1]._p3,v[K+1]._p4))):A.push(b));P._curves=A},jr.prototype.findPairs=function(B,w){var T,W,n,V,d,q,_,e,Z=this,z=Z._curves,H={},K=[];for(W=0,n=z.length;n>W;W++)T=z[W],V=T._p1,d=T._p2,q=T._p3,_=T._p4,!H[W]&&Z._isSamePoint(V,B)&&(w?K.push({point:V,r2:_}):K.push({point:V,c2:d})),Z._isSamePoint(_,B)&&(e=w?{point:_,r1:V}:{point:_,c1:q},n>W+1&&Z._isSamePoint(z[W+1]._p1,B)&&(w?e.r2=z[W+1]._p4:e.c2=z[W+1]._p2,H[W+1]=!0),K.push(e));return K},jr.prototype.toHtShape=function(){var G=this,o=G._curves,L=[],W=[],E={x:1/0,y:1/0};return o.forEach(function($){var u=$._p1,q=$._p2,y=$._p3,v=$._p4;return G._isCloseEnough(u,E)||(L.push(1),W.push(u.clone())),E=v,G._isCloseEnough(u,q)&&G._isCloseEnough(y,v)?(L.push(2),W.push(v.clone()),void 0):(L.push(4),W.push(q.clone(),y.clone(),v.clone()),void 0)}),{segments:L,points:W}};var ae=rj.Math.CubicBezier=function(j,e,J,E){var q=this;q._id=rj.Math.CubicBezier._globalId++,q._p1=j,q._p2=e,q._p3=J,q._p4=E};ae._globalId=1,ae.prototype={},ae.prototype.constructor=ae,ae.prototype.toString=function(){return this._id},ae.prototype.intersectRect=function(n,P,y){var L=P/2,$=y/2,p=n.x,H=n.y,q=rj.Math.Vector2,g=new q(-L+p,-$+H),m=new q(L+p,$+H),v=new q(m.x,g.y),o=new q(g.x,m.y),W=this,O=W.intersectLine(g,v),c=W.intersectLine(v,m),s=W.intersectLine(m,o),I=W.intersectLine(o,g),w=O.concat(c).concat(s).concat(I);return w},ae.prototype.intersectLine=function(O,j){var n,z,$,Z,T,M,J,B,w,L,S,f,R,p=this,N=O.clone().min(j),b=O.clone().max(j);Z=p._p1,T=p._p2,M=p._p3,J=p._p4,n=Z.clone().multiplyScalar(-1),z=T.clone().multiplyScalar(3),$=M.clone().multiplyScalar(-3),S=n.add(z).add($).add(J),n=Z.clone().multiplyScalar(3),z=T.clone().multiplyScalar(-6),$=M.clone().multiplyScalar(3),L=n.add(z).add($),n=Z.clone().multiplyScalar(-3),z=T.clone().multiplyScalar(3),w=n.add(z),B=Z.clone(),R=new rj.Math.Vector2(O.y-j.y,j.x-O.x),f=O.x*j.y-j.x*O.y;for(var t=p.getRoots(R.dot(S),R.dot(L),R.dot(w),R.dot(B)+f),q=new Array,Y=0,E=t.length;E>Y;Y++){var U=t[Y];if(!(0>U||U>1)){var Q=Z.clone().lerp(T,U),I=T.clone().lerp(M,U),x=M.clone().lerp(J,U),e=Q.lerp(I,U),C=I.lerp(x,U),X=e.lerp(C,U);X.t=U,O.x==j.x?N.y<=X.y&&X.y<=b.y&&q.push(X):O.y==j.y?N.x<=X.x&&X.x<=b.x&&q.push(X):X.x>=N.x&&X.y>=N.y&&X.x<=b.x&&X.y<=b.y&&q.push(X)}}return q},ae.prototype.solveTForPoint=function(f){var m,E,u,p,o=this;m=o._p1.x-f.x,E=o._p2.x-f.x,u=o._p3.x-f.x,p=o._p4.x-f.x;for(var P=o.getRoots(p-3*u+3*E-m,3*u-6*E+3*m,3*E-3*m,m),T=J,k=1/0,x=0,Z=P.length;Z>x;x++){var C=P[x];if(!(0>C||C>1)){var d=o._p1.clone().lerp(o._p2,C),y=o._p2.clone().lerp(o._p3,C),a=o._p3.clone().lerp(o._p4,C),s=d.lerp(y,C),w=y.lerp(a,C),z=s.lerp(w,C);z.t=C;var Q=Math.abs(z.y-f.y);k>Q&&(k=Q,T=z)}}return T},ae.prototype.getPointAt=function(k){var P=this,V=P._p1,$=P._p2,q=P._p3,L=P._p4,H=V.clone().lerp($,k),K=$.clone().lerp(q,k),p=q.clone().lerp(L,k),o=H.lerp(K,k),D=K.lerp(p,k);return o.lerp(D,k)},ae.prototype.getRoots=function(D,p,t,Y){var O,G,S,k,N,A=new Array;if(Math.abs(D)<1e-6){var O=p,G=t/O,S=Y/O,k=G*G-4*S;if(k>0){var N=Math.sqrt(k);A.push(.5*(-G+N)),A.push(.5*(-G-N))}else 0==k&&A.push(.5*-G)}p/=D,t/=D,Y/=D,O=(3*t-p*p)/3,G=(2*p*p*p-9*t*p+27*Y)/27;var B=p/3,y=G*G/4+O*O*O/27,M=G/2;if(Math.abs(y)<=1e-6&&(y=0),y>0){var u,w,N=Math.sqrt(y);u=-M+N,w=u>=0?Math.pow(u,1/3):-Math.pow(-u,1/3),u=-M-N,u>=0?w+=Math.pow(u,1/3):w-=Math.pow(-u,1/3),A.push(w-B)}else if(0>y){var U=Math.sqrt(-O/3),R=Math.atan2(Math.sqrt(-y),-M)/3,m=Math.cos(R),Q=Math.sin(R),j=Math.sqrt(3);A.push(2*U*m-B),A.push(-U*(m+j*Q)-B),A.push(-U*(m-j*Q)-B)}else{var u;u=M>=0?-Math.pow(M,1/3):Math.pow(-M,1/3),A.push(2*u-B),A.push(-u-B)}return A},ae.prototype._70I=function(){var E=this;return E._p1.distanceToSquared(E._p2)<1e-10&&E._p3.distanceToSquared(E._p4)<1e-10},ae.prototype.insertKnot=function(_){var s=this,h=s._p1,p=s._p2,z=s._p3,c=s._p4,I=h.clone().lerp(p,_),C=p.clone().lerp(z,_),y=z.clone().lerp(c,_),M=I.clone().lerp(C,_),O=C.clone().lerp(y,_),q=M.clone().lerp(O,_);return s._70I()?(h.clone().lerp(c,_),[new rj.Math.CubicBezier(h,h.clone(),q.clone(),q),new rj.Math.CubicBezier(q,q.clone(),c.clone(),c)]):[new rj.Math.CubicBezier(h,I,M,q),new rj.Math.CubicBezier(q,O,y,c)]};var qi=P.Default.getInternal().ui().EdgeUI,Jd={_47O:function(h){var z=this,V=Jd.getBackups()._47O;rj.inEdit(z.gv)||V.call(z,h)}};rj.Inject.registAsModule(Jd,qi);var he=P.Default.getInternal().ui().NodeUI,rf={_47O:function(t){var T=this,U=rf.getBackups()._47O;rj.inEdit(T.gv)||U.call(T,t)},getSelectWidth:function(){var d=this,u=d.gv,R=d._data;if(u.isEditable(R)&&rj.inEdit(u))return 0;var P=rf.getBackup("getSelectWidth");return P.call(d)}};rj.Inject.registAsModule(rf,he);var Zd=P.graph.GraphView,Ze={_editPointSize:function(){var C=P.Default.isTouchable,T=rj.getStyle("pointSize");return T[C?0:1]}(),isPointEditable:function(x){var H=this;if(rj.inEdit(H))return H._pointEditableFunc?H._pointEditableFunc(x):!0;var S=Ze.getBackup("isPointEditable");S.call(H,x)},isEditable:function(p){var j,W=this,d=Ze.getBackup("isEditable");if(j=p instanceof rj.Group?!0:d.call(W,p),!rj.inEdit(W))return j;if(!(p instanceof P.Edge))return j;if(!p.s("2d.editable"))return!1;var $=W.getEditableFunc();return $?$(p):!0},_42:function(Z,v){var T=this,$=Ze.getBackups()._42;if($.call(T,Z,v),rj.inEdit(T)){var r=T.getEditInteractor();r.drawImpl()}}};rj.Inject.registAsModule(Ze,Zd);var Ce=P.Default.getInternal().ui().ShapeUI,Sq={_47O:function(s){var x=this,f=Sq.getBackups()._47O;rj.inEdit(x.gv)||f.call(x,s)}};rj.Inject.registAsModule(Sq,Ce);var be=P.graph.DefaultInteractor,Np={handle_mousewheel:function($){var B=this,A=Np.getBackup("handle_mousewheel");rj.inEdit(B.gv)||A.call(B,$)}};rj.Inject.registAsModule(Np,be);var jg=P.graph.MoveInteractor,Sd={_calcShift:function($,o){var d=this,S=Sd.getBackup("_calcShift"),Q=d.gv;if(!rj.inEdit(Q))return S.call(d,$,o);var t=Q.getEditInteractor(),U=t.getSubModule("Move").calcShift($,o,d);return U||S.call(d,$,o)},clear:function(m){var V=this,I=Sd.getBackup("clear");I.call(V,m);var w=V.gv;if(rj.inEdit(w)){var c=w.getEditInteractor();c.getSubModule("Move").clear(m)}}};rj.Inject.registAsModule(Sd,jg);var ln=rj.Rect=function(U){this.catalog="Rect",this._interactor=U};ln.prototype={},ln.prototype.constructor=ln,ln.prototype.gatherInfo=function(l,t){var T=this;if(1===t.length){var s=t[0];return s instanceof P.Shape&&s._70I()?T.gatherLine(l,s):Vc(s,l)?!1:T.gatherSingleTarget(l,s)}return t.length>1?T.gatherMultiTargets(l,t):!1},ln.prototype.gatherSingleTarget=function(r,W){if(W.getCorners){var i,j=this,u=j.info;j.target=W,i=j.screenInfo={};var m=W.getCorners();u.LT=new rj.Math.Vector2(m[0]),u.LB=new rj.Math.Vector2(m[1]),u.RB=new rj.Math.Vector2(m[2]),u.RT=new rj.Math.Vector2(m[3]),u.T=u.LT.clone().add(u.RT).divideScalar(2),u.B=u.LB.clone().add(u.RB).divideScalar(2),u.L=u.LT.clone().add(u.LB).divideScalar(2),u.R=u.RT.clone().add(u.RB).divideScalar(2);for(var b in u)i[b]=rj.toScreenPosition(r,u[b]);var I=j._interactor,D=I.getStyle("checkSize"),x=function(m,z,t){var Y=z.clone().sub(m).setLength(-D),K=t.clone().sub(m).setLength(-D),h=Y.add(K).add(m);return h};return i.rotLT=x(i.LT,i.RT,i.LB),i.rotLB=x(i.LB,i.LT,i.RB),i.rotRB=x(i.RB,i.LB,i.RT),i.rotRT=x(i.RT,i.LT,i.RB),i.rotT=i.rotLT.clone().add(i.rotRT).divideScalar(2),i.rotB=i.rotLB.clone().add(i.rotRB).divideScalar(2),i.rotL=i.rotLT.clone().add(i.rotLB).divideScalar(2),i.rotR=i.rotRT.clone().add(i.rotRB).divideScalar(2),i.rotation=W.getRotation(),j.gatherConnectInfo(),!0}},ln.prototype.gatherConnectInfo=function(){var J=this,j=J.target,q=J._interactor,N=J.screenInfo,n=q.gv;if(n.isConnectActionVisible(j)&&q.getStyle("connectGuideVisible")){var O;j.s&&(O=j.s("connectGuideShift")),O||(O=q.getStyle("connectGuideShift"));var H=j.getAnchor(),o=j.getSize(),Y=j.toGlobal({x:o.width*(O[0]-H.x),y:o.height*(O[1]-H.y)});Y=rj.toScreenPosition(n,Y),N.P1?Y.add(N.P2.clone().sub(N.P1).setLength(O[2])):(Y.add(N.RT.clone().sub(N.LT).setLength(O[2])),Y.add(N.LB.clone().sub(N.LT).setLength(O[3]))),N.connect=Y}},ln.prototype.gatherMultiTargets=function(Q,w){var Z=rj.Group.findOrCreateGroup(w);if(!Z)return!1;var a=this;return a.editing&&"rotate"!==a.editing.mode||Z.calcInfo(),a.gatherSingleTarget(Q,Z)},ln.prototype.gatherLine=function(c,k){this.target=k;var B=this.screenInfo={},Z=k.getPoints(),G=rj.getDataMatrix(k);return B.P1=rj.toScreenPosition(c,G.apply(Z.get(0))),B.P2=rj.toScreenPosition(c,G.apply(Z.get(1))),this.gatherConnectInfo(),!0},ln.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],ln.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],ln.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],ln.prototype.check=function(i,X,q){if(P.Default.isLeftButton(X)){var R=this;if(R.editing=null,R.tipInfo=null,R.screenInfo){var T=R.target,C=i.isEditable(T),U=R.screenInfo;if(C&&U.connect){var I=R._checkConnect(q);if(I)return I}if(U.P1)return R._checkLine(q);var O,F,G,h=null,s=R._interactor,E=s.getStyle("checkSize");if(C&&i.isRectEditable(T))for(F=0;F<rj.Rect.ResizeKeys.length;F++)if(G=rj.Rect.ResizeKeys[F],rj.checkHit(q,U[G],E)){h=G,O="resize";break}if(!h&&C&&i.isRotationEditable(T)&&!s.getStyle("rotateAsClock")){var S=s.getStyle("rotateCheckSize");for(F=0;F<rj.Rect.RotateKeys.length;F++)if(G=rj.Rect.RotateKeys[F],rj.checkHit(q,U[G],S)){h=G,O="rotate";break}}if(!h)return s.setCursor("default"),void 0;if("rotate"===O){var k,H=i.lp(X);if(T instanceof rj.Group){var J=s.getStyle("groupRotateModeKey");"string"==typeof J&&(J=[J]);for(var d=!1,b=0,t=J.length;t>b;b++)if(X[J[b]]){d=!0;break}var L=s.getStyle("groupRotateModeDefault");k=d?"batch"===L?"block":"batch":L}var Q="batch"===k?T.getAnchor2():T.getPosition(),y=Math.atan2(H.y-Q.y,H.x-Q.x);s._setRotateCursor(y),R.editing={mode:O,key:h,pos:Q,flipY:T.getScale().y<0,rotation:T.getRotation(),hitRot:y},k&&(R.editing.groupRotateMode=k)}else{var e=rj.Rect.ResizeKeys.indexOf(h),Y=rj.Rect.ResizeDirection[e],x=Math.cos(T.getRotation()),p=Math.sin(T.getRotation()),f=Y.x*Math.sign(T.getScale().x),$=Y.y*Math.sign(T.getScale().y),B=Math.atan2(-p*f-x*$,x*f-p*$),N=(Math.round(B/(Math.PI/4))+8)%8,A=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][N];this._interactor.setCursor(A);var D=T.getWidth(),M=T.getHeight(),n=T.getAnchor();R.editing={mode:O,key:h,rect:{x:-D*n.x,y:-M*n.y,width:D,height:M},anchor:n,matrix:T.getMatrix()}}return h}}},ln.prototype._checkLine=function(e){var A=this;A.screenInfo;var f,y=A._interactor.getStyle("checkSize");if(rj.checkHit(e,A.screenInfo.P1,y))f="P1";else{if(!rj.checkHit(e,A.screenInfo.P2,y))return this._interactor.setCursor("default"),void 0;f="P2"}return A.editing={mode:"line",key:f},f},ln.prototype._checkConnect=function(u){var a=this,d=a.screenInfo,x=a._interactor,j=x.getStyle("connectGuideIntersectSize"),O=d.connect,t=u.x,B=O.x;if(B>t&&j>B-t&&Math.abs(O.y-u.y)<j||t>=B&&rj.checkHit(u,O,j)){var p="connect",k=F.getConnectAction(x.gv);if(a.editing={mode:p},k&&k.delete)if(a.target instanceof rj.Group){var R=!0;x.gv.sm().getSelection().each(function(z){k.delete.visible.call(null,x.gv,z)||(R=!1)}),a.editing.hasDeleteAction=R}else k.delete.visible.call(null,x.gv,a.target)&&(a.editing.hasDeleteAction=!0);return x.setCursor("default"),p}},ln.prototype._fireEditEvent=function(Y,d){var g=this._interactor,D=this.editing;if(D){var M=D.mode;M="rotate"===M?"Rotation":"connect"===M?"Connection":M[0].toUpperCase()+M.slice(1),g.fi({kind:Y+"Edit"+M,event:d})}},ln.prototype.startEdit=function(B,t){B.startDragging(t);var i=this;i._interactor.fi({kind:"prepareEdit",event:t});var o=i.editing,A=i.target;if(o){if(i._fireEditEvent("begin",t),"rotate"===o.mode)return o.groupRotateMode&&A.beginRotate(o),void 0;if("connect"!==o.mode)("line"===o.mode||A&&0===A.getRotation())&&(i._inSmartGuide=!0,i._interactor.rectGuide.gatherRects());else if(o.hasDeleteAction){var e=B.gv,P=i._interactor.getStyle("connectGuideGarbageShift");o.garbageInfo={x:e.getWidth()*P[0]+P[2],y:e.getHeight()*P[1]+P[3],size:i._interactor.getStyle("connectGuideGarbageIntersectsize")},B._42()}}},ln.prototype._46O=function(t){var E,Q,H=this,B=H.editing,w=H.target;if(B){if("connect"===B.mode&&!B.canceled&&!B.deleted)try{B.garbageInfo&&B.garbageInfo.hover?F.doDeleteConnectionAction(H._interactor.gv,w):F.doConnectAction(H._interactor.gv,w,B.target)}catch(f){console.error(f)}Q=B.freezeFlag,E=H.editing.groupRotateMode,H._fireEditEvent("end",t),H.editing=null}H.tipInfo=null,H._inSmartGuide&&(H._interactor.rectGuide.clear(),H._inSmartGuide=!1),E&&w&&w.endRotate(),w instanceof P.Block&&(Q===J?delete w._freezeSyncFromChildren:w._freezeSyncFromChildren=Q,w.updateFromChildren())},ln.prototype.handleNormalStateDelete=function(){var Y=this,S=Y.editing;if(S&&"connect"===S.mode&&!S.canceled&&!S.deleted){if(S.garbageInfo){try{F.doDeleteConnectionAction(Y._interactor.gv,Y.target)}catch(P){console.error(P)}S.garbageInfo=null}return S.cursorPos=null,S.targetCorners=null,S.deleted=!0,Y._interactor._42(),!0}},ln.prototype.handleNormalStateKeyDown=function(o){var f=this,N=f.editing;return!N||"connect"!==N.mode||N.canceled||N.deleted?void 0:P.Default.isEsc(o)?(N.cursorPos=null,N.targetCorners=null,N.canceled=!0,f._interactor._42(),!0):void 0},ln.prototype.handleEdit=function(M,V){var p=this,y=p.editing;if(y){var b,x,U,f,O,G=p.target,C=y.key,m=y.mode,W=M.lp(V),j=p._interactor;if("connect"===m){if(y.canceled)return;if(y.deleted)return;y.cursorPos=j._getLogicalPoint(V);var K=y.garbageInfo;return K&&rj.checkHit(y.cursorPos,K,K.size)?(K.hover=!0,y.target=null,y.targetCorners=null):(K&&(K.hover=!1),y.target=M.getDataAt(W,function(z){return M.isSelectable(z)?Mp(z)?!0:!1:!1})||null,y.targetCorners=rj.getTargetCornersOnScreen(M,y.target)),j._42(),void 0}if("rotate"===m){var N,T,$=y.pos,I=Math.atan2(W.y-$.y,W.x-$.x);if(y.groupRotateMode?T=I-y.hitRot:(N=I-y.hitRot,T=y.rotation+N),T%=2*Math.PI,0>T&&(T+=2*Math.PI),!P.Default.isCtrlDown(V)){var q,h;xk(V)?(q=j.getStyle("shiftRotateRound"),h=q/2):(q=j.getStyle("rotateRound"),h=j.getStyle("rotateSensitivity")),T=rj.roundTo(T,q,h)}y.groupRotateMode?(N=T-(y.lastRotation||0),0!==N&&(G.addRotation(N,y.groupRotateMode),y.lastRotation=T)):G.setRotation(T),j._setRotateCursor(I),T>Math.PI&&(T-=2*Math.PI);var d=180*(T/Math.PI);d=d.toFixed(2),b=""+d+"°"}else if("resize"===m){var J=y.rect;U=J.x,f=J.y;var Y,A=J.width,H=J.height,g=y.anchor,s=y.matrix,R=G.s&&G.s("keepAspectRatio")||j.getStyle("keepAspectRatio");xk(V)&&(R=!R);var a=p._unionPointMode1,i=p._unionPointMode2;if(p._inSmartGuide&&!P.Default.isCtrlDown(V)&&!R){var k;"L"===C||"R"===C?k="x":("T"===C||"B"===C)&&(k="y"),p._adsorbedToClosest(W,k),O=!0}Y=s.tfi(W);var e;"LT"===C?(J=a(Y,{x:U+A,y:f+H},A,H,R),e=9):"T"===C?(J=i({x:U,y:Y.y},{x:U+A,y:f+H},A,H,R,"v"),e=1):"RT"===C?(J=a(Y,{x:U,y:f+H},A,H,R),e=33):"L"===C?(J=i({x:Y.x,y:f},{x:U+A,y:f+H},A,H,R,"h"),e=8):"R"===C?(J=i({x:U,y:f},{x:Y.x,y:f+H},A,H,R,"h"),e=32):"LB"===C?(J=a(Y,{x:U+A,y:f},A,H,R),e=12):"B"===C?(J=i({x:U,y:f},{x:U+A,y:Y.y},A,H,R,"v"),e=4):"RB"===C&&(J=a(Y,{x:U,y:f},A,H,R),e=36);var F=s.tf(J.x+J.width*g.x,J.y+J.height*g.y);G instanceof P.Block&&(y.hasOwnProperty("freezeFlag")||(y.freezeFlag=G._freezeSyncFromChildren,G._freezeSyncFromChildren=!0)),G.setPosition(F),G.setSize(J.width,J.height),O&&(x=G.getRect(),j.rectGuide.gatherLines({node:G,x:x.x,y:x.y,w:x.width,h:x.height},k,e)),b=""+Math.round(J.width)+" * "+Math.round(J.height)}else if("line"===m){if(xk(V)){var E=G.getPoints(),l="P1"===C?E.get(1):E.get(0),S={x:W.x-l.x,y:W.y-l.y},o=j.getStyle("shiftLineRotateRound"),L=p._shiftDirList;if(!L||p._shiftRotateRound!==o){p._shiftRotateRound=o,p._shiftDirList=L=[];for(var Q=0;Q<Math.PI;Q+=o)L.push({x:Z(Q),y:v(Q)})}for(var B,w=0,u=0,t=L.length;t>u;u++){var D=L[u],n=D.x*S.x+D.y*S.y;Math.abs(n)>Math.abs(w)&&(w=n,B=D)}W={x:l.x+B.x*w,y:l.y+B.y*w},j.rectGuide.clear()}else p._inSmartGuide&&!P.Default.isCtrlDown(V)&&(p._adsorbedToClosest(W),O=!0);var X=rj.getDataMatrix(G).applyInverse(W);G.setPoint("P1"===C?0:1,X,!0);var r=G.getPoints(),z=r.get(0),_=r.get(1);U=z.x-_.x,f=z.y-_.y,b=" "+Math.round(Math.sqrt(U*U+f*f))+" ",O&&(x=G.getRect(),j.rectGuide.gatherLines({node:G,x:x.x,y:x.y,w:x.width,h:x.height}))}if(b){var c=P.Default.getLogicalPoint(V,j._canvas);c.x+=rj.Icons.TipShiftX,c.y+=rj.Icons.TipShiftY,p.tipInfo={helperPos:c,text:b,size:b.length}}p._fireEditEvent("between",V)}},ln.prototype._unionPointMode1=function(s,V,E,t,v){if(v&&E&&t){var o=s.x-V.x,Y=s.y-V.y;Math.abs(o*t)<Math.abs(Y*E)?(Y=Math.sign(Y)*Math.abs(o*t/E),s.y=V.y+Y):(o=Math.sign(o)*Math.abs(Y*E/t),s.x=V.x+o)}return P.Default.unionPoint(s,V)},ln.prototype._unionPointMode2=function(e,R,M,A,b,t){var H=P.Default.unionPoint(e,R);if(b&&M&&A){var T;"v"===t?(T=H.x+H.width/2,H.width=M*H.height/A,H.x=T-H.width/2):(T=H.y+H.height/2,H.height=A*H.width/M,H.y=T-H.height/2)}return H},ln.prototype._adsorbedToClosest=function(s,l){var p=this,_=p._interactor,R=_.rectGuide.findClosest(s,l),x=_.gridGuide.findClosest(s,l),$=1/0,G=1/0;R&&(isFinite(R.x)&&($=R.x),isFinite(R.y)&&(G=R.y)),x&&(isFinite(x.x)&&Math.abs(x.x)<Math.abs($)&&($=x.x),isFinite(x.y)&&Math.abs(x.y)<Math.abs(G)&&(G=x.y)),isFinite($)&&(s.x+=$),isFinite(G)&&(s.y+=G)},ln.prototype._42=function(t,d,O){var P=this;P.info={},P.screenInfo=null;var _=P._interactor;if(!_.editDetail&&P.gatherInfo(d,O)){var X=P.editing,T=X?X.groupRotateMode:null,c=P.screenInfo;if("block"!==T){if(c.P1?rj.Icons.DrawIcon(_,t,rj.Icons.Line,c):rj.Icons.DrawIcon(_,t,rj.Icons.Rect,c),c.connect&&(rj.Icons.DrawIcon(_,t,rj.Icons.ConnectGuide,{rotation:c.rotation,connect:c.connect,cursorPos:X?X.cursorPos:null}),X)){if(X.targetCorners){for(var Z={x:1/0,y:1/0},p={x:-1/0,y:-1/0},C=0,f=X.targetCorners.length;f>C;C+=2)Z.x=Math.min(Z.x,X.targetCorners[C]),p.x=Math.max(p.x,X.targetCorners[C]),Z.y=Math.min(Z.y,X.targetCorners[C+1]),p.y=Math.max(p.y,X.targetCorners[C+1]);rj.Icons.DrawIcon(_,t,rj.Icons.HoverDataRect,{min:Z,max:p,color:_.getStyle("hoverGuideColor")||_.getStyle("baseColor")})}X.garbageInfo&&rj.Icons.DrawIcon(_,t,rj.Icons.ConnectGuideGarbage,X.garbageInfo)}P.tipInfo&&rj.Icons.DrawIcon(_,t,rj.Icons.TipHelper,P.tipInfo)}P.target instanceof rj.Group&&P.target._42(_,t,d)}};var Tg=rj.Anchor=function(M){this.catalog="Anchor",this._interactor=M};Tg.prototype={},Tg.prototype.constructor=Tg,Tg.prototype.gatherInfo=function(D,f){var b=this;if(1===f.length){var v=f[0];if(!v.getAnchor)return;if(v instanceof P.Shape&&v._70I())return;if(Vc(v,D))return;return b.gatherSingleTarget(D,f[0])}return f.length>1?b.gatherMultiTargets(D,f):!1},Tg.prototype.gatherSingleTarget=function(T,B){var A=this;return A.info.POS=B.getPosition(),A.screenInfo.POS=rj.toScreenPosition(T,A.info.POS),A.target=B,!0},Tg.prototype.gatherMultiTargets=function(f,s){var U=this,E=rj.Group.findOrCreateGroup(s);return E?(U.screenInfo.POS=rj.toScreenPosition(f,E.getAnchor2()),U.target=E,!0):!1},Tg.prototype.isVisible=function(){var K=this,t=K._interactor;if(t.getStyle("anchorVisible")===!1)return!1;var s=K.target;if(s){if(this.editing)return!0;var I=s.getAnchor(),o=t.getStyle("anchorOutsideVisibleThreshold");if(I.x<-o||I.x>1+o||I.y<-o||I.y>1+o)return!0;var O=s.getSize(),C=s.getScale(),Y=Math.min(Math.abs(O.width*C.x),Math.abs(O.height*C.y));if(Y*t.gv._zoom<t.getStyle("anchorHideThreshold"))return!1}return!0},Tg.prototype.check=function(K,G,I){if(P.Default.isLeftButton(G)){var F=this,k=F._interactor;if(F.isVisible()&&k.getStyle("anchorMovable")!==!1){F.editing=null,F.tipInfo=null;var O=F.target;if(O&&K.isAnchorEditable(O)&&K.isEditable(O)){var u;if(F.screenInfo&&(u=F.screenInfo.POS)&&rj.checkHit(I,new rj.Math.Vector2(u),k.getStyle("checkSize"))){if(O instanceof rj.Group)return F.editing={},!0;var s=O.getWidth(),j=O.getHeight(),M=O.getAnchor();return F.editing={rect:{x:-s*M.x,y:-j*M.y,width:s,height:j},anchor:M,matrix:O.getMatrix()},!0}}}}},Tg.prototype.startEdit=function(j,l){j.startDragging(l),j.fi({kind:"beginEditAnchor",event:l})},Tg.prototype._46O=function(Q){var s=this;s.editing&&(s.editing=null,s._interactor.fi({kind:"endEditAnchor",event:Q})),s.tipInfo=null},Tg.prototype.handleEdit=function(y,N){var x=this,n=x.target;if(n){var T=x.editing;if(T){var r=y.lp(N),k=x._interactor;if(n instanceof rj.Group)return n.setAnchor2(r),k._42(),void 0;var j=T.matrix,L=j.tfi(r),B=T.rect,I=(L.x-B.x)/B.width,h=(L.y-B.y)/B.height;if(!P.Default.isCtrlDown(N)){var z=k.getStyle("anchorRound"),W=k.getStyle("anchorSensitivity");I=rj.roundTo(I,z,W),h=rj.roundTo(h,z,W)}n.setAnchor(I,h,!0);var f=P.Default.getLogicalPoint(N,k._canvas);f.x+=rj.Icons.TipShiftX,f.y+=rj.Icons.TipShiftY;var o=""+I.toFixed(2)+", "+h.toFixed(2);x.tipInfo={helperPos:f,text:o,size:o.length},k.fi({kind:"betweenEditAnchor",event:N})}}},Tg.prototype._42=function(x,N,q){var v=this;v.info={},v.screenInfo={};var k=v._interactor;k.editDetail||v.gatherInfo(N,q)&&v.isVisible()&&(rj.Icons.DrawIcon(k,x,rj.Icons.Anchor,v.screenInfo),v.tipInfo&&rj.Icons.DrawIcon(k,x,rj.Icons.TipHelper,v.tipInfo))};var Sl=rj.MoveDummy=function(X){this.catalog="MoveDummy",this._interactor=X};Sl.prototype={},Sl.prototype.constructor=Sl,Sl.prototype.gatherInfo=function(){var A=this,K=this._interactor.getSubModule("Rect");if(K){var W=K.screenInfo;if(W){var D=A._interactor,s=A.getMovableTarget(K.target);if(s){var F=D.getStyle("moveDummyVisible"),b=W.LT||W.P1,w=W.RT||W.P2,B=W.LB||b;if(b){var Z=W.P1,m=Math.min(b.distanceTo(B),b.distanceTo(w));if(!(m>F)){var r=D.getStyle("moveDummyPosition"),N=w.clone().sub(b),e=B.clone().sub(b),k=r[2],J=r[3];if(Z){var C=D.getStyle("moveDummyLineExtraShift");C&&(k+=C[0],J+=C[1])}var U=b.clone().add(N.clone().multiplyScalar(r[0])).add(N.setLength(k)).add(e.clone().multiplyScalar(r[1])).add(e.setLength(J));return A.screenInfo.pos=U,A.screenInfo.size=D.getStyle("moveDummySensitivity"),!0}}}}}},Sl.prototype.getMovableTarget=function(a){var O=this._interactor.gv;if(Mp(a)){if(O.isMovable(a))return a}else if(a instanceof rj.Group)for(var S=a._entities,s=S.length-1;s>=0;s--){var G=S[s];if(Mp(G)&&O.isMovable(G))return G}return null},Sl.prototype.getMoveInteractor=function(){for(var L,N,l,X=this._interactor.gv,m=X.getInteractors(),L=0,N=m.length;N>L;L++)if(l=m.get(L),l instanceof jg)return l},Sl.prototype.startEdit=function(v,J){v.startDragging(J);var t=this.getMoveInteractor();if(t){var N=this.selectedTarget,d=v.gv;d._moving=1,t._data=N,d.handleMouseDown&&d.handleMouseDown(J,N)}},Sl.prototype._46O=function(N){var M=this,l=M.getMoveInteractor();l&&(l.handleWindowMouseUp(N),M.selectedTarget=null)},Sl.prototype.handleEdit=function(C,n){var d=this.getMoveInteractor();d&&d.handleWindowMouseMove(n)},Sl.prototype.check=function(r,A,b){if(this.selectedTarget=null,P.Default.isLeftButton(A)&&!r._scrolling&&!br()){var L=this,q=L.screenInfo.pos;if(q&&!(b.distanceTo(q)>L.screenInfo.size)){var t=L._interactor;return L.selectedTarget=L.getMovableTarget(t.getSubModule("Rect").target),t.setCursor("default"),!0}}},Sl.prototype._42=function(f,N,n){var F=this;F.screenInfo={};var E=F._interactor;E.editDetail||F.gatherInfo(N,n)&&(!E.editing||F.selectedTarget)&&rj.Icons.DrawIcon(E,f,rj.Icons.MoveDummy,F.screenInfo)};var Jm=rj.RotateX=function(d){this.catalog="RotateX",this._interactor=d};Jm.prototype={},Jm.prototype.constructor=Jm,Jm.prototype.gatherInfo=function(S,I){var G=this;if(1===I.length){var U=I[0];return U instanceof P.Shape&&U._70I()||Vc(U,S)?!1:G.gatherSingleTarget(S,U)}return I.length>1?G.gatherMultiTargets(S,I):!1},Jm.prototype.gatherSingleTarget=function(){var e=new P.Math.Vector2,$=new P.Math.Vector2,g=new P.Math.Vector2,J=new P.Math.Vector2,S=function(x,w){var u=x.x-w.x,y=x.y-w.y;return u*u+y*y};return function(m,d){if(d.getCorners){var E=this,j=d.getCorners(),W=15,o=d.getPosition();e.copy(j[0]),g.copy(j[1]),J.copy(j[3]),$.copy(e).add(J).divideScalar(2).add(e.sub(g).setLength(W/m.getZoom()));var s=Math.max(S(o,j[0]),S(o,j[1]),S(o,j[2]),S(o,j[3]));return E.info.POS=$.clone(),E.screenInfo.POS=rj.toScreenPosition(m,E.info.POS),E.screenInfo.LEN=Math.sqrt(s)*m.getZoom()+W,E.screenInfo.CENTER=rj.toScreenPosition(m,o),E.target=d,!0}}}(),Jm.prototype.gatherMultiTargets=function(B,b){var Z=this,g=rj.Group.findOrCreateGroup(b);if(!g)return!1;var Z=this;return Z.gatherSingleTarget(B,g)},Jm.prototype.isVisible=function(){var A=this._interactor;if(!A.getStyle("rotateAsClock"))return!1;var r=this.target;if(!r)return!0;var d=A.gv;return d.isEditable(r)&&d.isRotationEditable(r)?!0:!1},Jm.prototype.check=function(w,$,p){var x=this,H=x._checkImpl(w,$,p);return(H||x._clockPainted)&&x._interactor._42(),H},Jm.prototype._checkImpl=function(v,j,u){if(P.Default.isLeftButton(j)){var q=this;q.editing=null,q.tipInfo=null;var A;if(q.screenInfo&&(A=q.screenInfo.POS)&&q.isVisible()){var G=q._interactor;if(rj.checkHit(u,A,G.getStyle("checkSize"))){var O=q.target,z=v.lp(j),U=O.getPosition(),C=Math.atan2(z.y-U.y,z.x-U.x);return G._setRotateCursor(C),q.editing={pos:U,rotation:O.getRotation(),hitRot:C,groupRotateMode:"block",screenInfo:{CENTER:q.screenInfo.CENTER,LEN:q.screenInfo.LEN}},!0}}}},Jm.prototype.startEdit=function(n,j){n.startDragging(j),n.fi({kind:"beginEditRotation",event:j}),this.target instanceof rj.Group&&this.target.beginRotate(this.editing)},Jm.prototype._46O=function(B){var C=this;C.editing&&(C.editing=null,C._interactor.fi({kind:"endEditRotation",event:B})),C.target instanceof rj.Group&&C.target.endRotate(),C.tipInfo=null},Jm.prototype.handleEdit=function(H,d){var f=this,c=f.editing;if(c){var t,A,Q=f.target,S=H.lp(d),h=f._interactor,n=c.pos,D=Math.atan2(S.y-n.y,S.x-n.x),J=Q instanceof rj.Group;if(J?A=D-c.hitRot:(t=D-c.hitRot,A=c.rotation+t),A%=2*Math.PI,0>A&&(A+=2*Math.PI),!P.Default.isCtrlDown(d)){var X,N;xk(d)?(X=h.getStyle("shiftRotateRound"),N=X/2):(X=h.getStyle("rotateRound"),N=h.getStyle("rotateSensitivity")),A=rj.roundTo(A,X,N)}J?(t=A-(c.lastRotation||0),0!==t&&(Q.addRotation(t,c.groupRotateMode),c.lastRotation=A)):Q.setRotation(A),h._setRotateCursor(D),A>Math.PI&&(A-=2*Math.PI);var e=180*(A/Math.PI),u=""+e.toFixed(2)+"°",R=P.Default.getLogicalPoint(d,h._canvas);R.x+=rj.Icons.TipShiftX,R.y+=rj.Icons.TipShiftY,f.tipInfo={helperPos:R,text:u,size:u.length},h.fi({kind:"betweenEditRotation",event:d})}},Jm.prototype._42=function(N,r,h){var k=this;k._clockPainted=!1,k.info={},k.screenInfo={};var $=k._interactor;$.editDetail||k.gatherInfo(r,h)&&k.isVisible()&&(rj.Icons.DrawIcon($,N,rj.Icons.RoundPoint,k.screenInfo.POS),k.tipInfo&&rj.Icons.DrawIcon($,N,rj.Icons.TipHelper,k.tipInfo),k.editing&&k.drawClock(N))},Jm.prototype.drawClock=function(Q){Q.save();var n=this;n._clockPainted=!0;var z=n.editing||{},k=z.screenInfo||n.screenInfo,$=k.LEN,N=$+8,H=$+18;Q.save(),Q.translate(k.CENTER.x,k.CENTER.y),Q.beginPath(),Q.strokeStyle="rgb(150, 150, 150)";for(var D,I,f,u,R,V=0;360>V;V++)D=V*Math.PI/180,0===V%5&&(I=v(D)*$,f=Z(D)*$,u=v(D)*N,R=Z(D)*N,Q.moveTo(I,f),Q.lineTo(u,R)),0===V%45&&(I=v(D)*$,f=Z(D)*$,u=v(D)*H,R=Z(D)*H,Q.moveTo(I,f),Q.lineTo(u,R));Q.stroke(),Q.rotate(-L);var X=z.lastRotation||n.target.getRotation();Q.beginPath(),Q.fillStyle="rgba(255, 0, 0, 0.1)",Q.strokeStyle="rgb(157, 157, 157)",Q.moveTo(0,0),Q.arc(0,0,H,0,X,!1),Q.fill(),Q.beginPath(),Q.moveTo(0+H,0),Q.arc(0,0,H,0,X,!1),Q.stroke(),Q.restore()};var jr=rj.Curve=function(P){this.catalog="Curve",this._interactor=P};jr.prototype={},jr.prototype.constructor=jr,r.defineProperties(jr.prototype,{activing:{get:function(){return this._activing},set:function(m){var E=this;if(m)E._activing=new rj.CurveActiving(this,m);else{var L=E._activing;L&&L.dispose(),E._activing=null}}}}),jr.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},jr.prototype.setUp=function(){var g=this,N=g._interactor;N&&N.gv.mp(g._onGraphviewPropertyChanged,g)},jr.prototype._onGraphviewPropertyChanged=function(w){("zoom"===w.property||"translateX"===w.property||"translateY"===w.property)&&this._handleDataChanged()},jr.prototype.tearDown=function(){var T=this,M=T._interactor;M&&M.gv.ump(T._onGraphviewPropertyChanged,T)},jr.prototype.canEnterEditDetailMode=function(){var t=this,E=t._interactor,C=E._getValidSelection();if(1===C.length){var W=C[0],L=W instanceof P.Edge;if(W instanceof P.Shape||L){if(L){var m=W.s("edge.type");if(m&&"points"!==m)return}var I=E.gv;if(I.isPointEditable(W)&&I.isEditable(W))return t.target=W,!0}}},jr.prototype.canQuitEditDetailMode=function(M){var Q=this,b=Q._interactor._getLogicalPoint(M);return Q._checkEditRealPoint(b)?void 0:Q._interactor.gv.getDataAt(M)!==Q.target?!0:void 0},jr.prototype.preHandleScroll=function(){var b=this.editing;return b&&b.inEdit?!0:void 0},jr.prototype.getCurrentSelectintStatus=function(){var i=this;if(i.activing&&!i.activing.selections){if(i.activing.status!=J)return i.activing.status;var L=function(L){var u=i.activing.status;i.activing.status=L,i._interactor.fp("shapePointStatus",u,L)},k=rj.Curve.PointType,N=i.activing.point,g=i.activing.pairs;if(!g||1!==g.length)return L(k.Mirrored);var X=g[0],o=X.c1&&X.c1.isNearEnough(N),K=X.c2&&X.c2.isNearEnough(N);if(!X.c1||!X.c2)return o||K?L(k.Straight):L(k.Disconnected);if(o&&K)return L(k.Straight);if(o||K)return L(k.Asymmetric);var b=X.c1.clone().sub(N),P=X.c2.clone().sub(N);return Math.abs(b.x*P.y-b.y*P.x)>1e-5||b.x*P.x>0?L(k.Disconnected):Math.abs(b.length()-P.length())>1e-5?L(k.Asymmetric):L(k.Mirrored)}},jr.prototype.handle_keydown=function(g){var P=this;if(P._interactor.editDetail){var $=rj.Curve.PointType;"1"===g.key?P._setCurrentSelectionStatus($.Straight):"2"===g.key?P._setCurrentSelectionStatus($.Mirrored):"3"===g.key?P._setCurrentSelectionStatus($.Disconnected):"4"===g.key&&P._setCurrentSelectionStatus($.Asymmetric)}},jr.prototype.setCurrentSelectionStatus=function(Y){var M=this,f=M._interactor;if(f){var J=f.gv;J.dm().beginTransaction(),this._setCurrentSelectionStatus(Y),J.dm().endTransaction()}},jr.prototype._setCurrentSelectionStatus=function(u){var Z=this,W=Z.activing;if(W){var $=Z.getCurrentSelectintStatus();if(null!==$&&$!==u){W.status=u;var F=Z.activing.point,i=Z.activing.pairs;if(i&&1===i.length){var f=i[0],O=Z.screenInfo.curve,h=rj.Curve.PointType,J=function(){Z._writeToHt(),Z._interactor.fp("shapePointStatus",$,u)};if(u===h.Straight)return O.moveCtrlPoint(f,F,"c1"),O.moveCtrlPoint(f,F,"c2"),J(),void 0;if($===h.Straight){var A=O.findPairs(F,!0),y=A[0],T=y.r1||F,d=y.r2||F,v=d.clone().sub(T).multiplyScalar(.25);return O.moveCtrlPoint(f,F.clone().sub(v),"c1"),O.moveCtrlPoint(f,F.clone().add(v),"c2"),J(),void 0}var p=f.c1,r=f.c2;if(p&&r){if(u===h.Mirrored)return O.moveCtrlPoint(f,F.clone().multiplyScalar(2).sub(r),"c1"),J(),void 0;if(u===h.Asymmetric&&$===h.Disconnected){var q=p.clone().sub(F).length(),v=F.clone().sub(r).setLength(q).add(F);return O.moveCtrlPoint(f,v,"c1"),J(),void 0
}}W._firePointChange(),Z._interactor.fp("shapePointStatus",$,u)}}}},jr.prototype._handleDataChanged=function(){var z="points,segments,shape,position,rotation,scale".split(",");return function(k){var M=this;if(M.screenInfo&&M.target){if(k&&z.indexOf(k.property)<0)return;var n=M._interactor;M.gatherSingleTarget(n.gv,M.target,!0),M.check(n.gv,null,new rj.Math.Vector2(n._lastClientPoint)),n._42()}}}(),jr.prototype.gatherSingleTarget=function(e,X,z){var i,O,n=this;n.screenInfo&&n.screenInfo.curve&&(O=n.screenInfo.curve._curves);var Y=n.editing;i=Y?n.screenInfo:n.screenInfo={};var f,A,j=X instanceof P.Edge;j?(f=X.s("edge.segments"),A=X.s("edge.points")||new P.List):(f=X._58O,A=X._59O),i.S=f;var M,H=i.P=[],I=rj.getDataMatrix(X);if(X instanceof P.Polyline&&(M=X.getElevation()||0,i.E=[]),A.each(function(Q){i.E&&i.E.push(Q.e||M),Q=I.apply(Q);var L=rj.toScreenPosition(e,Q);H.push(L.x,L.y)}),j){var t=rj.toScreenPosition(e,X._lastSourcePoint),F=rj.toScreenPosition(e,X._lastTargetPoint);H.splice(0,0,t.x,t.y),H.push(F.x,F.y)}if(!i.S||!i.S.size()){i.S=new P.List,i.S.add(1);for(var T=0;T<H.length/2-1;T++)i.S.add(2)}if((!Y||z)&&n.convertToCubicBezier(O),n.activing&&(z||!n.editing||"realPoint"===n.editing.type)){var q=i.curve.findPairs(n.activing.point);n.activing.pairs=q}j&&"points"!==X.s("edge.type")&&n._writeToHt()},jr.prototype._convertToNewPoint=function(t,V,q){var W,i,m;for(W=0,i=V.length;i>W;W++){if(m=V[W],m._p1.isNearEnough(t))return m._p1;if(m._p4.isNearEnough(t))return m._p4}if(q)for(W=0,i=Math.min(q.length,i);i>W;W++){if(m=q[W],m._p1===t)return V[W]._p1;if(m._p4===t)return V[W]._p4}},jr.prototype.convertToCubicBezier=function(K){var R,v,Q=this,$=new rj.Math.Curve,V=Q.screenInfo;if($.createFromHtShape(V.P,V.S,V.E),V.curve=$,Q.activing){var _=$._curves;if(R=Q.activing.point,v=Q._convertToNewPoint(R,_,K),v&&(Q.activing.point=v),Q.activing.selections){var D=-1,n=Q.activing.selections;n.forEach(function(p){D++,v=Q._convertToNewPoint(p,_,K),v&&(n[D]=v)})}}},jr.prototype.check=function(F,p,l){if(!p||fs(p)||Ur(p)){var S=this;if(S._interactor.setCursor("default"),S.editing=null,S.highlight=null,S.tipInfo=null,S.edgeEditResult=null,S.screenInfo){if(br()||Ur(p))return S._interactor._42(),!0;if(S._checkEditCtrlPoint(l))return S._interactor._42(),!0;if(S._checkEditRealPoint(l))return S._interactor._42(),!0;if(S._checkEditElevation(l))return S._interactor._42(),!0;var Q=S.screenInfo.curve,W=Q.checkPoint(l,S._interactor.getStyle("curveIntersectSize"));if(W){var U=S.highlight={};U.type="insertKnot",U.bezier=W.bezier,U.point=W.intersection}return S._interactor._42(),!0}}},jr.prototype._checkEditRealPoint=function(B){var A,L,$,z,N,c,U=this,E=U.screenInfo.curve._curves,s=U._interactor.getStyle("curvePointIntersectSize"),i=1/0;for(s*=s,$=0,z=E.length;z>$;$++)A=E[$],N=A._p1,c=B.distanceToSquared(N),i>c&&(i=c,L=N),N=A._p4,c=B.distanceToSquared(N),i>c&&(i=c,L=N);if(i>s)return!1;var K=U.highlight={};return K.type="changeRealPoint",K.point=L,U.editing={type:"realPoint",point:L,shiftGuide:{point:L.clone(),dir:"x",limit:0}},U._interactor.setCursor("crosshair"),!0},jr.prototype._checkEditElevation=function(w){var d=this;if(!d._interactor.getStyle("curveElevationVisible"))return!1;var C=d.activing;if(!C)return!1;var F=C.getCurrentEditingPoint();if(!F)return!1;var Y=d._interactor,P=Y.getStyle("curveElevationGuideShift"),q=Y.getStyle("curveElevationIntersectSize"),h=w.distanceToSquared({x:F.x+P[0],y:F.y+P[1]});if(!(h>q*q)){var D=d.highlight={};D.type="elevation";var B=new rj.Math.Vector2(w.x,w.y,F.e);return d.editing={type:"elevation",startPoint:B},d._interactor.setCursor("crosshair"),!0}},jr.prototype._checkEditCtrlPoint=function(w){var I=this;if(I.activing&&!I.activing.selections){var l=I.getCurrentSelectintStatus();if(l!==rj.Curve.PointType.Straight){var U=I.activing.pairs;if(U){var j=I._interactor.getStyle("curvePointIntersectSize");j*=j;var B,t,e,f,D,K,q,A,L,E=1/0;for(q=0,L=U.length;L>q;q++)for(f=U[q],A=0;2>A;A++)D=0===A?"c1":"c2",f[D]&&(K=w.distanceToSquared(f[D]),E>K&&(E=K,B=f,t=q,e=D));if(E>j)return!1;I.activing.hlpair=B,I.activing.hltype=e;var H=I.highlight={};return H.type="changeCtrlPoint",H.point=B[e],I.editing={type:"ctrlPoint",pair:B,pairId:t,ctrlType:e,direction:B[e].clone().sub(I.activing.point).normalize()},I._interactor.setCursor("crosshair"),!0}}}},jr.prototype.startEdit=function(s,l){s.startDragging(l);var m=this;m.highlight&&"insertKnot"===m.highlight.type&&(m.insertKnot(),m.gatherSingleTarget(m._interactor.gv,m.target),m.activing=null,m._checkEditRealPoint(m._interactor._getLogicalPoint(l)));var k=m._activing;if(k){var B=m.editing?m.editing.type:null;"ctrlPoint"===B?k.editingCtrl={pairId:m.editing.pairId,type:k.hltype}:"realPoint"===B&&(k.editingCtrl=!1)}var N=m.highlight,y=P.Default.isCtrlDown(l);if(!N||br()||Ur(l)){var r=m._interactor.gv;if(!r.setFocus(l)||r._scrolling)return;return y?m._multiSelect={startPoint:r.lp(l)}:r.isPannable()&&(fs(l)||Ur(l))&&(m._pan={tx:r.tx(),ty:r.ty()},s.fi({kind:"beginPan",event:l})),void 0}if("changeRealPoint"===N.type){var i,a=m.activing?m.activing.point:null,I=m.activing?m.activing.selections:null;if(y&&m.activing)a===N.point?(I?(m.activing={point:I[0]},I.length>1&&(I.splice(0,1),m.activing.selections=I)):m.activing=null,m.editing=null):I&&(i=I.indexOf(N.point))>=0?(I.length>1?I.splice(i,1):delete m.activing.selections,m.editing=null):I?(I.push(a),m.activing={point:N.point,selections:I}):m.activing={point:N.point,selections:[a]};else if(I)a===N.point||((i=I.indexOf(N.point))>=0?(I.splice(i,1,a),m.activing={point:N.point,selections:I}):m.activing={point:N.point});else{var L;a===N.point&&(L=m.activing.status),m.activing={point:N.point},L&&(m.activing.status=L)}s.fi({kind:"beginEditPoint",event:l})}},jr.prototype.insertKnot=function(){var E=this,l=E.highlight,Q=E.screenInfo.curve;Q.insertKnot(l.bezier,l.point.t),E._writeToHt()},jr.prototype._writeToHt=function(){var Q,c,D,w,j=this,U=j.screenInfo.curve,r=U.toHtShape(),H=r.points,C=[],G=r.segments,A=j._interactor.gv,V=j.target,S=V instanceof P.Edge,W=rj.getDataMatrix(V).invert();w=V instanceof P.Polyline,w&&(D=V.getElevation());for(var $=0,K=H.length;K>$;$++)Q=H[$],c=rj.toWorldPosition(A,Q),c=W.apply(c),Q.e!=J&&Q.e!==D&&(c.e=Q.e),C.push(c);if(V._writing=!0,S){V.s("edge.type","points"),V.setStyle("edge.segments",G),V.setStyle("edge.points",C.slice(1,C.length-1)),V.setStyle("edge.source.offset.x",0),V.setStyle("edge.source.offset.y",0),V.setStyle("edge.target.offset.x",0),V.setStyle("edge.target.offset.y",0);var d=j._nextChangeEdgeHost;delete j._nextChangeEdgeHost,d&&("source"===d.type?V.setSource(d.host):V.setTarget(d.host)),j._writeEdgeHostAnchor("source",C[0]),j._writeEdgeHostAnchor("target",C[C.length-1])}else C.length?(V.setSegments(G),V.setPoints(C,!0)):V.removeFromDataModel();delete V._writing},jr.prototype._writeEdgeHostAnchor=function(U,Y){var $=this,c=$.target,b=$._calcHostAnchor(c,U,Y);b.index!==J?(c.setStyle("edge."+U+".index",b.index),c.setStyle("edge."+U+".percent",J),c.setStyle("edge."+U+".anchor.x",J),c.setStyle("edge."+U+".anchor.y",J)):b.percent!==J?(c.setStyle("edge."+U+".percent",b.percent),c.setStyle("edge."+U+".index",J),c.setStyle("edge."+U+".anchor.x",J),c.setStyle("edge."+U+".anchor.y",J)):(c.s("edge."+U+".anchor.x",b.x),c.s("edge."+U+".anchor.y",b.y),b.offsetX||b.offsetY?(c.s("edge."+U+".offset.x",b.offsetX),c.s("edge."+U+".offset.y",b.offsetY)):(c.s("edge."+U+".offset.x",0),c.s("edge."+U+".offset.y",0)))},jr.prototype._calcHostAnchor=function(D,h,u,Z){Z||(Z="source"===h?D.getSource():D.getTarget());var c=this._interactor.gv,F=c.calculateAttachPoint(Z,u);if(F)return F.info;if($k(Z)){var $=c.calculateEdgePosition(Z,u);return $}var J=Z.getRotation(),x=Z.getAnchor();if(Vc(Z,c)&&(J=0),J){var e=Z.getMatrix(),i=e.tfi(u),S=Z.getSize();return{x:i.x/S.width+x.x,y:i.y/S.height+x.y}}var T=Dr(c,Z),y={x:(u.x-T.x)/T.width,y:(u.y-T.y)/T.height};return y},jr.prototype._handlePanning=function(j){var h=this,E=h._pan;if(E){E.started=!0;var K=h._interactor,B=K.gv,N=K._lastClientPoint,b=vd(j),y=Fb(B,b,N);B.setTranslate(E.tx+y.x,E.ty+y.y),h.gatherSingleTarget(K.gv,h.target),K._42(),K.fi({kind:"betweenPan",event:j})}},jr.prototype.handleEdit=function($,b){var H=this,k=H.editing;if(H._pan)return H._handlePanning(b),void 0;if(H._multiSelect)return H._multiSelect.endPoint=$.lp(b),H._interactor.redraw(),void 0;if(k){k.inEdit=!0;var u,o,l,h=H._interactor._getLogicalPoint(b),g=P.Default.isCtrlDown(b),_=P.Default.isShiftDown(b),z=k.type,c=H.activing;if(H._guideInfo=null,"ctrlPoint"===z&&_){var O=H.editing.direction.clone();u=c.point;var d=O.dot(h.clone().sub(u));h=O.setLength(d).add(u)}else if("ctrlPoint"===z||"realPoint"===z){var O;if("realPoint"===z&&_){var R=H.editing.shiftGuide;o=R.point;var W=Math.abs(h.x-o.x),X=Math.abs(h.y-o.y);W>X&&W>R.limit&&"y"===R.dir&&(R.dir="x"),X>W&&X>R.limit&&"x"===R.dir&&(R.dir="y"),O=R.dir,"x"===O?(h.y=o.y,R.limit=Math.max(R.limit,W)):"y"===O&&(h.x=o.x,R.limit=Math.max(R.limit,X))}var p=H._isEditEdgeSourceTarget();if(p){var B=H._editEdgeSourceTarget(p,h,g);B&&(H.edgeEditResult=B,l=B.tipText)}else if(!g){var I=H._guidingToEdit(h,O),m="realPoint"===z?H._interactor.gridGuide.findClosest(h,O,!0):null,q=1/0,S=1/0;m&&(m.x&&(q=m.x),m.y&&(S=m.y));var s=!1;I&&(I.xList&&(Math.abs(I.x)<=Math.abs(q)?(s=!0,q=I.x):delete I.xList),I.yList&&(Math.abs(I.y)<=Math.abs(S)?(s=!0,S=I.y):delete I.yList),s&&(H._guideInfo=I)),isFinite(q)&&(h.x+=q),isFinite(S)&&(h.y+=S),s&&(I.v=h)}}var x=H.screenInfo.curve;if("realPoint"===k.type){u=k.point,u.e!==J&&(h.e=u.e),x.moveRealPoint(u,h),k.point=h,H.highlight.point=h;var t=c.status,v=c.selections;if(H.activing={point:h,status:t},v){var N=h.clone().sub(u),E=0;v.forEach(function(k){var o=k.clone().add(N);x.moveRealPoint(k,o),v[E++]=o}),H.activing.selections=v}}else if("ctrlPoint"===k.type){var Z=c.pairs,j=Z[k.pairId];x.moveCtrlPoint(j,h,k.ctrlType);var Q=c.status,n=rj.Curve.PointType;if((Q===n.Mirrored||Q===n.Asymmetric)&&j.c1&&j.c2){var u=new rj.Math.Vector2(c.point),U="c1"===k.ctrlType?"c2":"c1";if(Q===rj.Curve.PointType.Mirrored)x.moveCtrlPoint(j,u.clone().multiplyScalar(2).sub(h),U);else if(Q===n.Asymmetric){var d=j[U].clone().sub(u).length(),f=u.clone().sub(j[k.ctrlType]).setLength(d).add(u);isNaN(f.x)||x.moveCtrlPoint(j,f,U)}}c._firePointChange()}else if("elevation"===k.type){o=k.startPoint;var M=o.e+(o.y-h.y)/$._zoom;H._setCurrentPointImpl("e",M),c._firePointChange(),l="E: "+rj.toFixed(M)}var e=P.Default.getLogicalPoint(b,H._interactor._canvas);if(e.x+=rj.Icons.TipShiftX,e.y+=rj.Icons.TipShiftY,!l){var V=rj.toWorldPosition($,h);l=""+rj.toFixed(V.x)+", "+rj.toFixed(V.y)}H.tipInfo={helperPos:e,text:l,size:l.length},H._writeToHt(),H._interactor.fi({kind:"betweenEditPoint",event:b})}},jr.prototype._setCurrentPointImpl=function(V,S){var k=this,x=k._activing;if(!x)return!1;var O=k.target;if(!O)return!1;var s=x.getCurrentEditingPoint();if(!s)return!1;var $=x.editingCtrl;if(!$)var Y=s.clone();if("e"===V)s.e=S;else{var m;if("x"===V||"y"===V){var g=x._lastFirePoint;m="x"===V?{x:S,y:g?g.y:0}:{x:g?g.x:0,y:S}}else"object"==typeof V?(m=V,V.e!==J&&(s.e=V.e)):(m={x:arguments[0],y:arguments[1]},arguments[2]!==J&&(s.e=arguments[2]));var L=rj.getDataMatrix(O);m=rj.toScreenPosition(k._interactor.gv,L.apply(m)),s.x=m.x,s.y=m.y}if(!$){var U=Y.multiplyScalar(-1).add(s);s.e&&Y.e&&(U.e=s.e-Y.e),k.screenInfo.curve.moveCtrlDueToRealPointMovement(s,U)}return!0},jr.prototype.setCurrentPoint=function(Z,m){return this._setCurrentPointImpl(Z,m)?(this._writeToHt(),!0):!1},jr.prototype._isEditEdgeSourceTarget=function(){var d=this,U=d.target;if(!(U instanceof P.Edge))return!1;var b=d.editing.point,z=d.screenInfo.curve._curves;return b===z[0]._p1?"source":b===z[z.length-1]._p4?"target":!1},jr.prototype._editEdgeSourceTarget=function(T,x,g){var H,p=this,f=p.target;if(H="source"===T?f.getSource():f.getTarget()){var S,F=p._interactor.gv,D=rj.toWorldPosition(F,x),e=p._calcHostAnchor(f,T,D,H);if(S=e.index!==J||e.percent!==J?e.distance*F.getZoom()>p._interactor.getStyle("edgeHostEdgeMaxDistance"):p._interactor.getStyle("edgeHostDetectPerFrame")?!0:e.x<0||e.x>1||e.y<0||e.y>1?!0:!1){var I=F.getDataAt(D,function(t){return F.isSelectable(t)?t===H?!1:f.canSetSourceTarget(t,T)?!0:!1:!1});if(I){var L=p._calcHostAnchor(f,T,D,I);H=I,p._nextChangeEdgeHost={type:T,host:I},e=L}}var V,R,r;if(g||e.x===J)(e.percent!==J||e.index!==J)&&(R=e.point);else{var O=p._interactor.getStyle("anchorRound"),Y=p._interactor.getStyle("anchorSensitivity");V=F.calculateAttachPoint(H,D),V?e=V.info:(e.x=rj.roundTo(e.x,O,Y),e.y=rj.roundTo(e.y,O,Y)),R=H.getAttachPosition(e.x,e.y,e.offsetX,e.offsetY)}R&&(r=rj.toScreenPosition(F,R),x.x=r.x,x.y=r.y),p._edgeHostGuideInfo={corners:rj.getTargetCornersOnScreen(F,H),attach:V?V.index:-1,host:H};var i;return e.percent!==J?i="percent: "+e.percent.toFixed(2):e.index!==J?i="index: "+e.index:(i=""+e.x.toFixed(2)+", "+e.y.toFixed(2),(e.offsetX||e.offsetY)&&(i+=" offset: "+e.offsetX.toFixed(2)+", "+e.offsetY.toFixed(2))),{host:H,anchor:e,tipText:i}}},jr.prototype._guidingToEdit=function(j,L){var F,V,N=this;if(F=N.screenInfo.curve){V=F._curves;var $,I,a,m,b,e,O,_,p=1/0,A=1/0,z=[];for(N.editing&&"realPoint"===N.editing.type&&(_=N.editing.point),b=0,e=2*V.length;e>b;b++)O=V[Math.floor(b/2)][b%2?"_p4":"_p1"],z.indexOf(O)>=0||(z.push(O),_&&_===O||(a=O.x-j.x,m=O.y-j.y,Math.abs(a)<Math.abs(p)?(p=a,$=[O]):a===p&&$.push(O),Math.abs(m)<Math.abs(A)?(A=m,I=[O]):m===A&&I.push(O)));var y=N._interactor.getStyle("smartGuideSensitivity");if((Math.abs(p)>y||"y"===L)&&($=null),(Math.abs(A)>y||"x"===L)&&(I=null),$||I){var l=!1,M={};if($&&(l=!0,M.xList=$,M.x=p),I&&(l=!0,M.yList=I,M.y=A),l)return M}}},jr.prototype._46O=function(y){var v=this;v.editing&&(v.editing=null,v._interactor.fi({kind:"endEditPoint",event:y})),v._guideInfo=null,v._edgeHostGuideInfo=null,v._pan&&(v._pan=null,v._interactor.fi({kind:"endPan",event:y})),v._multiSelect&&(v._handleMultiSelect(v._multiSelect),v._multiSelect=null),v.tipInfo=null,v.edgeEditResult=null},jr.prototype._handleMultiSelect=function(f){if(f.startPoint&&f.endPoint){var T,E,i,p,O,R=this,Z=R._interactor,K=Z.gv,Y=rj.toScreenPosition(K,f.startPoint),l=rj.toScreenPosition(K,f.endPoint),v=P.Default.unionPoint(Y,l),I=R.screenInfo.curve._curves,S=[],s=function(w){w.x>=v.x&&w.y>=v.y&&w.x<=v.x+v.width&&w.y<=v.y+v.height&&S.indexOf(w)<0&&S.push(w)};for(T=0,E=I.length;E>T;T++)O=I[T],s(O._p1),s(O._p4);if(S.length){var $=R.activing||{},W=$.selections||[];for($.point&&W.push($.point),T=0,E=W.length;E>T;T++)i=W[T],p=S.indexOf(i),p>=0?S[p]=J:S.push(i);var X=S;for(S=[],T=0,E=X.length;E>T;T++)X[T]&&S.push(X[T]);E=S.length,0===E?R.activing=null:1===E?R.activing={point:S[0]}:(i=S[E-1],R.activing={point:i,selections:S.splice(0,E-1)}),Z.redraw()}}},jr.prototype._canDeletePoint=function(U,Y){var W=this.target;if(!(W instanceof P.Edge))return!0;var e=U._curves[0],q=U._curves[U._curves.length-1];return e._p1===Y||q._p4===Y?!1:!0},jr.prototype.handleDelete=function(){var x=this;if(x.activing&&x.screenInfo){var E=P.Default.isShiftDown(),z=x.screenInfo.curve;x._canDeletePoint(z,x.activing.point)&&z.deleteRealPoint(x.activing.point,E),x.activing.selections&&x.activing.selections.forEach(function(C){x._canDeletePoint(z,C)&&z.deleteRealPoint(C,E)}),x.activing=null,delete x.editing,delete x.tipInfo,delete x.edgeEditResult,delete x._pan,delete x._multiSelect,x._writeToHt(),x._interactor.fp("deleteShapePoint",!1,!0)}},jr.prototype.handleDoubleClick=function(t){var J=this,i=J._interactor._getLogicalPoint(t);if(J.screenInfo&&J._checkEditRealPoint(i)){var v=J.getCurrentSelectintStatus(),Z=rj.Curve.PointType;return v=v===Z.Mirrored?Z.Straight:Z.Mirrored,J._setCurrentSelectionStatus(v),J._interactor._42(),!0}},jr.prototype._drawHighlight=function(M){var V=this,v=V.highlight;if(v){var n=v.bezier,x=V._interactor;n&&rj.Icons.DrawIcon(x,M,rj.Icons.ShapeHighlightCurve,[n._p1.x,n._p1.y,n._p2.x,n._p2.y,n._p3.x,n._p3.y,n._p4.x,n._p4.y]);var i=v.point;i&&"insertKnot"===v.type&&rj.Icons.DrawIcon(x,M,rj.Icons.ShapeHighlighPoint,i)}},jr.prototype._drawGuide=function(b){var r=this,$=r._guideInfo;if($){var G,E,K,P,i=$.v;for(G=0;2>G;G++)if(P=0===G?$.xList:$.yList)for(E=0,K=P.length;K>E;E++)rj.Icons.DrawIcon(r._interactor,b,rj.Icons.ShapeGuideLine,[i.x,i.y,P[E].x,P[E].y])}},jr.prototype._drawCurrentPoint=function(t){var I=this;if(I.activing){var L=I.activing,N=I.getCurrentSelectintStatus(),X=I._interactor;if(N!==rj.Curve.PointType.Straight){var j=L.pairs;L.hlpair,L.hltype;var h=L.selections,v=L.editingCtrl;if(j&&!h){var c,b,B;for(b=0,B=j.length;B>b;b++)c=j[b],v&&b===v.pairId&&c[v.type]?rj.Icons.DrawIcon(X,t,rj.Icons.ShapeActivingCtrl,{point:c.point,c1:c.c1,c2:c.c2,hl:v.type}):rj.Icons.DrawIcon(X,t,rj.Icons.ShapeActivingCtrl,c)}}rj.Icons.DrawIcon(X,t,rj.Icons.ShapeHighlighRealPoint,I.activing.point),h&&h.forEach(function(J){rj.Icons.DrawIcon(X,t,rj.Icons.ShapeHighlighRealPoint,J)})}},jr.prototype.clear=function(){var w=this;w.editing=null,w._guideInfo=null,w.activing=null,w.highlight=null},jr.prototype._42=function($){var j=this;j.info={},j.editing||(j.screenInfo=null);var Q=j._interactor;if(!Q.editDetail)return j.clear(),void 0;var O=Q.gv;if(!j.target||!O.isSelected(j.target)||!O.isVisible(j.target))return Q.editDetail=!1,j.clear(),void 0;if(j.gatherSingleTarget(O,j.target),rj.Icons.DrawIcon(Q,$,rj.Icons.ShapeBgCurve,j.screenInfo),j._drawHighlight($),j._drawCurrentPoint($),j._getRealPoint().forEach(function(p){rj.Icons.DrawIcon(Q,$,rj.Icons.ShapePoint,p)}),j._drawGuide($),j.tipInfo&&rj.Icons.DrawIcon(Q,$,rj.Icons.TipHelper,j.tipInfo),j._edgeHostGuideInfo){rj.Icons.DrawIcon(Q,$,rj.Icons.NodeHoverGuide,j._edgeHostGuideInfo.corners);var _=j._edgeHostGuideInfo.host;if(_){var N=O.getAttachPoints(_);if(N&&N.length)for(var g=0,n=N.length;n>g;g++){var z=N[g],F=_.getAttachPosition(z.x,z.y,z.offsetX,z.offsetY);F=rj.toScreenPosition(O,F),F.isAttach=j._edgeHostGuideInfo.attach===g,rj.Icons.DrawIcon(Q,$,rj.Icons.AttachPoint,F)}}}if(j._interactor.getStyle("curveElevationVisible")&&j.target instanceof P.Polyline&&j.activing){var m=j.activing.getCurrentEditingPoint();m&&rj.Icons.DrawIcon(Q,$,rj.Icons.EdgeElevationGuide,m)}if(j.edgeEditResult&&j._drawEdgeHostHighlight($,j.edgeEditResult.host,j.edgeEditResult.anchor),j._multiSelect&&j._multiSelect.endPoint){var X=P.Default.unionPoint(rj.toScreenPosition(O,j._multiSelect.startPoint),rj.toScreenPosition(O,j._multiSelect.endPoint));X.color=O.getRectSelectBorderColor(),$.save(),$.setTransform(1,0,0,1,0,0);var u=H.devicePixelRatio,V=X.borderWidth=Math.round(u);V/=2,X.x=Math.round(X.x*u)+V,X.y=Math.round(X.y*u)+V,X.width=Math.round(X.width*u),X.height=Math.round(X.height*u),rj.Icons.DrawIcon(Q,$,rj.Icons.SimpleRect,X),$.restore()}},jr.prototype._drawEdgeHostHighlight=function($,G,l){this.drawEdgeHostHighlight($,G,l),this._interactor.redraw()},jr.prototype.drawEdgeHostHighlight=function(T,G,g){if($k(G)){var n,$,d,R,D=this,U=D._interactor,C=U.gv,N=C.getDataUI(G),Z=Nj(N),F=[];for(d=0,R=Z.points.length;R>d;d++)$=rj.toScreenPosition(C,Z.points.get(d)),F.push($.x,$.y);Z.segments&&(n=Z.segments.toArray());var l=U.getStyle("edgeHostHighlighPeriod"),j=U.getStyle("edgeHostEdgeHighlighColor");rj.Icons.DrawIcon(U,T,rj.Icons.ShapeBgCurve,{P:F,S:n,color:j,dynamicVisible:g.index===J,dynamicPeriod:l}),j=U.getStyle("edgeHostPointHighlighColor");var O=gs(N);for(d=0,R=O.length;R>d;d++){var h=O[d],A=rj.toScreenPosition(C,h);rj.Icons.DrawIcon(U,T,rj.Icons.ShapePoint,{point:{x:A.x,y:A.y},color:j,size:12,dynamicVisible:d===g.index,dynamicPeriod:l})}}},jr.prototype._getRealPoint=function(){var A,c=this.screenInfo,s=c.P,w=c.S,o=-1,g=[],Y=-1,k=w.length;return w.each(function(E){Y++;var S=1;if(3===E)S=2;else if(4===E)S=3;else if(5===E)return;o+=S,A=Y+1>=k?!0:1===w.get(Y+1)?!0:!1,g.push({point:{x:s[2*o],y:s[2*o+1]},segmentIndex:Y,pointIndex:o,isEnd:A})}),g},jr.prototype.getEditingPointsInfo=function(C){var J=this,X=J.activing;if(!X)return!1;var t=X.point;if(!t)return!1;var $=this._getRealPoint(),N=[{screen:t}];X.selections&&X.selections.forEach(function(A){N.push({screen:A})});var U,L,Y=$.length;return N.forEach(function(V){for(U=0;Y>U;U++)if(L=$[U],V.screen.isNearEnough(L.point)){V.segmentIndex=L.segmentIndex,V.pointIndex=L.pointIndex,V.point=J.target.getPoints().get(L.pointIndex);break}}),C&&N.sort(function(o,z){return o.segmentIndex-z.segmentIndex}),N};var Rf=rj.MoveHelper=function(D){var p=this;p.catalog="Move",p._interactor=D};Rf.prototype={},Rf.prototype.constructor=Rf,Rf.prototype.calcShift=function(E,D,O){var u,w,j=this,N=j._interactor.gv,W=N.lp(D);if("beginMove"===E&&j._gatherGridInfo(O._lastLogicalPoint||W),u=j._target){var v=u.downPosition;if(v){var a=j._interactor.getStyle("moveSensitivity")/N._zoom;if(v.distanceTo(W)<a)return{x:0,y:0};delete u.downPosition}var l;w=P.Default.isShiftDown(D),w&&(W=j._dealShiftDown(W),l=u.shiftGuide.dir);var n,K=u.rawPos={x:u.pos.x+W.x-u.lp.x,y:u.pos.y+W.y-u.lp.y};if(P.Default.isCtrlDown(D)){if(n=j._calcShiftByAddon(),j._target.node instanceof rj.Group){var c=j._target.node;c._position.x+=n.x,c._position.y+=n.y}return n}for(var B,r=u.x+K.x,y=u.y+K.y,p={x:r,y:y},f={x:r+u.w/2,y:y+u.h/2},q={x:r+u.w,y:y+u.h},Z=j._interactor.rectGuide,$=j._interactor.gridGuide,h=[Z.findClosest(p,l),Z.findClosest(f,l),Z.findClosest(q,l),$.findClosest(p,l),$.findClosest(f,l),$.findClosest(q,l)],m=1/0,_=1/0,G=0,H=h.length;H>G;G++)B=h[G],B&&(r=B.x,y=B.y,isFinite(r)&&Math.abs(r)<Math.abs(m)&&(m=r),isFinite(y)&&Math.abs(y)<Math.abs(_)&&(_=y));if(isFinite(m)||(m=0),isFinite(_)||(_=0),n=j._calcShiftByAddon(m,_),j._target.node instanceof rj.Group){var c=j._target.node;c._position.x+=n.x,c._position.y+=n.y}var T=u.node;if(!Vc(T,N)){var k=K.x+m,C=K.y+_;j._interactor.rectGuide.gatherLines({node:T,x:u.x+k,y:u.y+C,w:u.w,h:u.h},l)}return n}},Rf.prototype._calcShiftByAddon=function(o,d){var p=this._target,V=p.rawPos,R=p.node.getPosition();return o=o||0,d=d||0,{x:V.x-R.x+o,y:V.y-R.y+d}},Rf.prototype._dealShiftDown=function(M){var n=this,p=n._target.shiftGuide,N=n._target.lp,h=Math.abs(M.x-N.x),Q=Math.abs(M.y-N.y);h>Q&&h>p.limit&&"y"===p.dir&&(p.dir="x"),Q>h&&Q>p.limit&&"x"===p.dir&&(p.dir="y");var i=p.dir;return"x"===i?(M.y=N.y,p.limit=Math.max(p.limit,h)):"y"===i&&(M.x=N.x,p.limit=Math.max(p.limit,Q)),M},Rf.prototype._gatherGridInfo=function(S){var w,U=this,T=U._interactor,q=T._getValidSelection();if(q.length){if(1===q.length){if(w=q[0],!w.getRect)return U._target=null,void 0}else if(w=rj.Group.findOrCreateGroup(q),!w)return U._target=null,void 0}else{var q=T.gv.sm().getSelection();if(q.length&&(w=q.get(0),!w.getRect))return U._target=null,void 0}var J=w.getPosition(),y=w.getRect();U._target={node:w,x:y.x-J.x,y:y.y-J.y,w:y.width,h:y.height,lp:{x:S.x,y:S.y},pos:{x:J.x,y:J.y},shiftGuide:{dir:"x",limit:0},downPosition:new rj.Math.Vector2(S)},T.rectGuide.gatherRects()},Rf.prototype.clear=function(){var o=this;o._interactor.rectGuide.clear(),o._interactor._42()};var em="directional",Jn="point",Gp="spot",hn="light.color",xo=function(y,T){Jp(T)&&uj.test(T)?je(y,T):yl(T)&&T.modelType?rc(y,T):Bh[y]=T},Ug=function(Y){if(yl(Y))return Y.modelType?Y.uuid?Bh[Y.uuid]:(Y.uuid=P.Math.generateUUID(),rc(Y.uuid,Y),J):Y;var W=Bh[Y];return Y&&W===J&&uj.test(Y)&&(vl&&vl[Y]||je(Y,Y)),W},qj=function(W,J){W.frameStack?W.frameStack.push(J):W.frameStack=[J],W.bindFramebuffer(W.FRAMEBUFFER,J)},cm=function(h){var q=h.frameStack;if(q){if(q.pop(),q.length)return h.bindFramebuffer(h.FRAMEBUFFER,q[q.length-1]),void 0;h.frameStack=null}h.bindFramebuffer(h.FRAMEBUFFER,null)};im(F,{graph3dViewAttributes:d,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:M/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:_c,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:M/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:xo,getShape3dModel:Ug,createMatrix:function(v,Z){mo(v)||(v=[v]);for(var B=v.length-1;B>=0;B--){var T=v[B];Z=ip(T.mat,T.s3,T.r3,T.rotationMode,T.t3,Z)}return Z},transformVec:function(V,U){return gr(V,U)},glBindFrame:qj,glUnbindFrame:cm,createBoxModel:function(){return{vs:Pr,ns:Eb,uv:fo,is:ko}},createRoundRectModel:function(d,T){return Gr.roundRect(d,T)},createStarModel:function(R,M){return Gr.star(R,M)},createRectModel:function(f,m){return Gr.rect(f,m)},createTriangleModel:function(J,P){return Gr.triangle(J,P)},createRightTriangleModel:function(D,r){return Gr.rightTriangle(D,r)},createParallelogramModel:function(I,H){return Gr.parallelogram(I,H)},createTrapezoidModel:function(w,i){return Gr.trapezoid(w,i)},createSmoothSphereModel:function(P,Q,n,v,$,s,Y){return qh(new An(P,Q,n,v,$,s,Y))},createSphereModel:function(P,L,J,s,v,D){return P?hs(P,L,J,s,v,D):F.createSmoothSphereModel()},createSmoothConeModel:function(Y,N,w,d,g){return kn(Y,N,w,d,g)},createConeModel:function(e,q,K,f,F,k){return e?Xp(e,q,K,f,F,k):kn(k)},createSmoothCylinderModel:function(e,G,u,F,Q,s,t,B){return qh(new cs(e,G,u,F,Q,s,t,B))},createCylinderModel:function(u,o,m,k,B,E,f){return u?Dh(u,o,m,k,B,E,f):Dc(E,f)},createSmoothTorusModel:function(K,g,H,o,G,A){return qh(new zp(K,g,H,o,G,A))},createTorusModel:function(D,K,n,Q,P,Y,W){return D?af(D,K,n,Q,P,Y,W):Gi(Y,W)},createExtrusionModel:function(J,w,s,G,v,D,i,N){return Hk(J,w,s,G,v,D,i,N)},createSmoothRingModel:function(g,N,R,I,L,m){for(var M=[],A=0;A<g.length-1;A+=2)M.push({x:g[A],y:g[A+1]});for(g=vm(M,N,R)[0],M=[],A=0;A<g.length;A++){var S=g[A];M.push(new fl(S.x,0,S.y))}return qh(new qd(M,m,I,L))},createTextGeometry:function(Y,e){return qh(new wi(Y,e))},loadFontFace:function(j,M){F.xhrLoad(j,function(m){if(!m)return M();var q;try{q=JSON.parse(m)}catch(t){q=JSON.parse(m.substring(65,m.length-2))}fe.loadFace(q),M&&M(q.familyName.toLowerCase())},M?null:{sync:!0})},createRingModel:function($,n,S,b,Q,k,M,O,A,i){for(var j=[],C=0;C<$.length-1;C+=2)j.push({x:$[C],y:$[C+1]});k=k||F.shapeSide,M=M||0,O=O||k;var W,V,J,U,t,s,q,L,g,o,C,I,p,E,N,u,_,H,P=[],m=[],z=A?[]:d,w=A?[]:d,B=i?[]:d,Y=i?[]:d,f=b?[]:d,K=b?[]:d,c=Q?[]:d,h=Q?[]:d,$=vm(j,n,S),D=mh($),r=0,x=2*Math.PI/k;return $.forEach(function(R){if(J=R.length,J>1){if(U=R[0],b)for(s=U.x,L=U.y,C=M;O>C;C++)I=C+1,p=C*x,E=I*x,N=v(p),u=Z(p),_=v(E),H=Z(E),f.push(N*s,L,-u*s,_*s,L,-H*s,0,L,0),K.push(.5-.5*N,.5-.5*u,.5-.5*_,.5-.5*H,.5,.5);for(o=0;J>o;o++){for(t=R[o],s=U.x,q=t.x,L=U.y,g=t.y,W=r/D,r+=jc(U,t),V=r/D,C=M;O>C;C++)I=C+1,p=C*x,E=I*x,N=v(p),u=Z(p),_=v(E),H=Z(E),P.push(N*q,g,-u*q,_*q,g,-H*q,N*s,L,-u*s,_*q,g,-H*q,_*s,L,-H*s,N*s,L,-u*s),m.push(C/k,V,I/k,V,C/k,W,I/k,V,I/k,W,C/k,W),A&&C===M&&(z.push(0,L,0,0,g,0,N*q,g,-u*q,N*q,g,-u*q,N*s,L,-u*s,0,L,0),w.push(0,.5-L,0,.5-g,2*q,.5-g,2*q,.5-g,2*s,.5-L,0,.5-L)),i&&I===O&&(B.push(0,L,0,_*q,g,-H*q,0,g,0,_*q,g,-H*q,0,L,0,_*s,L,-H*s),Y.push(1,.5-L,1-2*q,.5-g,1,.5-g,1-2*q,.5-g,1,.5-L,1-2*s,.5-L));U=t}if(Q)for(s=U.x,L=U.y,C=M;O>C;C++)I=C+1,p=C*x,E=I*x,N=v(p),u=Z(p),_=v(E),H=Z(E),c.push(_*s,L,-H*s,N*s,L,-u*s,0,L,0),h.push(.5-.5*_,.5+.5*H,.5-.5*N,.5+.5*u,.5,.5)}}),{vs:P,uv:m,bottom_vs:c,bottom_uv:h,top_vs:f,top_uv:K,from_vs:z,from_uv:w,to_vs:B,to_uv:Y}}},!0),im(S,{"3d.move.mode":J,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":J,"edge.gradient.color":J,"edge.source.t3":J,"edge.target.t3":J,"light.type":Jn,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":M/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Ab,"wf.short":!1,"wf.mat":J,"wf.geometry":!1,batch:J,"transparent.mask":!1,brightness:J,"select.brightness":.7,"repeat.uv.length":J,alphaTest:.4,renderTextureSamples:4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":Sg,"label.t3":J,"label.r3":J,"label.texture.scale":2,"label.rotationMode":Pi,"label.light":!1,"label.blend":J,"label.reverse.flip":!1,"label.reverse.color":Kk,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Sg,"label2.t3":J,"label2.r3":J,"label2.texture.scale":2,"label2.rotationMode":Pi,"label2.light":!1,"label2.blend":J,"label2.reverse.flip":!1,"label2.reverse.color":Kk,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Sg,"note.t3":J,"note.r3":J,"note.texture.scale":2,"note.rotationMode":Pi,"note.light":!1,"note.blend":J,"note.reverse.flip":!1,"note.reverse.color":Kk,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Sg,"note2.t3":J,"note2.r3":J,"note2.texture.scale":2,"note2.rotationMode":Pi,"note2.light":!1,"note2.blend":J,"note2.reverse.flip":!1,"note2.reverse.color":Kk,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:J,"shape3d.color":rg,"shape3d.top.color":J,"shape3d.bottom.color":J,"shape3d.from.color":J,"shape3d.to.color":J,"shape3d.image":J,"shape3d.top.image":J,"shape3d.bottom.image":J,"shape3d.from.image":J,"shape3d.to.image":J,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":J,"shape3d.side.to":J,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":J,"shape3d.opacity":J,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Kk,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":J,"shape3d.uv.scale":J,"shape3d.top.uv.offset":J,"shape3d.top.uv.scale":J,"shape3d.bottom.uv.offset":J,"shape3d.bottom.uv.scale":J,"shape3d.from.uv.offset":J,"shape3d.from.uv.scale":J,"shape3d.to.uv.offset":J,"shape3d.to.uv.scale":J,"shape3d.top.cap":J,"shape3d.bottom.cap":J,"shape3d.start.angle":0,"shape3d.sweep.angle":p,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":J,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":rg,"all.image":J,"all.blend":J,"all.opacity":J,"all.reverse.flip":!1,"all.reverse.color":Kk,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":J,"all.uv.offset":J,"all.uv.scale":J,"all.discard.selectable":!0,mat:J,"left.mat":J,"right.mat":J,"top.mat":J,"bottom.mat":J,"front.mat":J,"back.mat":J},!0);var bs,Kj=!1,pc=[0,0,0,0],tj={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Km,2:_i,3:ai,4:el,5:Sg,6:sl}},Tm=function(k,p,W,j){if(p.getFaceVisible(k,W)){Qc(p,Ti(k,p.getFaceMat(k,W)||p.getMat(k)));var V=p._26I;p.getFaceReverseCull(k,W)?V.enable(V.CULL_FACE):V.disable(V.CULL_FACE),Dj(V,p._prg.uFixPickReverseColor,tj[W]),Bb(V),Qj(V,j,6),sn(V),Io(p)}},ur=function(l){return l instanceof om},wp=function(J){return[J.x,J.e||0,J.y]},Fr=function(d,q,T){for(var q=Xc(q),B=q[0],D=q[1],P=q[2];T--;)d.push(B,D,P)},Lg=function(p,l,o){for(var l=Xc(l),O=l[0],U=l[1],K=l[2],b=l[3];o--;)p.push(O,U,K,b)},me=function(J,g,n){if(g)for(var r,S,R,D=g[0],N=g[1],u=g[2],X=g[4],t=g[5],Q=g[6],c=g[8],T=g[9],P=g[10],Y=g[12],e=g[13],K=g[14],d=n.length,H=0,H=0;d>H;H+=3)r=n[H],S=n[H+1],R=n[H+2],J.push(D*r+X*S+c*R+Y,N*r+t*S+T*R+e,u*r+Q*S+P*R+K);
else qp(J,n)},$r=function(u,r){var C=r.s("light.intensity"),Y=Xc(r.s(hn)),g=Y[0],m=Y[1],n=Y[2];1!==C&&(g*=C,m*=C,n*=C),u.push(g,m,n,r.s("light.disabled")?1:0)},Vd=function(Y,p,a){Dj(p,a.uHeadlightRange,Y._headlightRange);var u=Y._headlightIntensity,h=Xc(Y._headlightColor);1!==u&&(h=[h[0]*u,h[1]*u,h[2]*u]),Dj(p,a.uHeadlightColor,[h[0],h[1],h[2],Y._headlightDisabled?1:0]);var K=Y._59O,H=Y._spots,n=Y._dirs;if(K.length){var M=[],$=[],s=[];K.forEach(function(E){$r(M,E),qp($,Y._transformPointToViewSpace(E.p3())),s.push(E.s("light.range"))}),p.uniform4fv(a.uPointColor,M),p.uniform1fv(a.uPointRange,s),p.uniform3fv(a.uPointPosition,$)}if(H.length){var k=[],A=[],t=[],J=[],O=[],G=[];H.forEach(function(c){$r(k,c),qp(A,Y._transformPointToViewSpace(c.p3())),qp(O,Y._transformDirectionToViewSpace(c.p3(),c.s("light.center"))),t.push(c.s("light.range")),J.push(v(c.s("light.angle")/2)),G.push(c.s("light.exponent"))}),p.uniform4fv(a.uSpotColor,k),p.uniform1fv(a.uSpotRange,t),p.uniform1fv(a.uSpotAngle,J),p.uniform1fv(a.uSpotExponent,G),p.uniform3fv(a.uSpotPosition,A),p.uniform3fv(a.uSpotDirection,O)}if(n.length){var L=[],P=[];n.forEach(function(s){$r(L,s),qp(P,Y._transformDirectionToViewSpace(s.p3()))}),p.uniform4fv(a.uDirColor,L),p.uniform3fv(a.uDirDirection,P)}},vn=function(l){return l>0&&0===(l-1&l)},ws=function(n){return n=T(0,e(M,n)),n=T(Th,e(M-Th,n))},ud=function(){return.05+B()/2},le=function(y,i,q,C){var w,F=y.getEye();return y.isOrtho()?(w=Te(y.getCenter(),F),w[0]+=C[0],w[1]+=C[1],w[2]+=C[2]):w=F,uk(i,q,C,w)},uk=function(Z,k,b,r){var T=md(Z,k),R=Te(r,b,!0),Q=md(R,k);if(j(Q)<Th)return d;var w=(T-md(b,k))/Q;return[b[0]+R[0]*w,b[1]+R[1]*w,b[2]+R[2]*w]},Gh=function(g,K){return{x:2*g.x-K.x,y:2*g.y-K.y}},yq=function(U,m,G,V){var M,j;if(!U)return M=k(m.y-G.y,G.x-m.x),{x:m.x+V*Z(M),y:m.y+V*v(M)};if(!G)return M=k(U.y-m.y,m.x-U.x),{x:m.x+V*Z(M),y:m.y+V*v(M)};var o=Te([U.x,U.y,0],[m.x,m.y,0],!0),S=Te([G.x,G.y,0],[m.x,m.y,0],!0),t=-(o[0]+S[0])/2,e=-(o[1]+S[1])/2,L=w(t*t+e*e);if(Th>L)return M=k(U.y-m.y,m.x-U.x),{x:m.x+V*Z(M),y:m.y+V*v(M)};var Y=U.x-m.x,H=U.y-m.y,s=G.x-m.x,n=G.y-m.y,N=w(Y*Y+H*H),C=w(s*s+n*n);M=X(md(o,S))/2,j=o[1]*S[0]-o[0]*S[1]>0?-1:1,t/=L,e/=L;var O=V/Z(M),h=T(N,C)/v(M);L=Math.min(O,h);var J={x:m.x+j*L*t,y:m.y+j*L*e};return G.b&&O>C/v(M)&&(J.adjust=!0),J},nj=function(Q){var T=Q[1],m=Q[2],o=Q[3],F=Q[6],E=Q[7],V=Q[11];Q[1]=Q[4],Q[2]=Q[8],Q[3]=Q[12],Q[4]=T,Q[6]=Q[9],Q[7]=Q[13],Q[8]=m,Q[9]=F,Q[11]=Q[14],Q[12]=o,Q[13]=E,Q[14]=V},jf=function(B){var u=B[0],R=B[1],c=B[2],e=B[3],v=B[4],w=B[5],j=B[6],I=B[7],n=B[8],O=B[9],D=B[10],Z=B[11],G=B[12],H=B[13],K=B[14],L=B[15],N=u*w-R*v,F=u*j-c*v,z=u*I-e*v,l=R*j-c*w,P=R*I-e*w,T=c*I-e*j,i=n*H-O*G,W=n*K-D*G,A=n*L-Z*G,b=O*K-D*H,t=O*L-Z*H,m=D*L-Z*K,x=N*m-F*t+z*b+l*A-P*W+T*i;return x?(x=1/x,B[0]=(w*m-j*t+I*b)*x,B[1]=(c*t-R*m-e*b)*x,B[2]=(H*T-K*P+L*l)*x,B[3]=(D*P-O*T-Z*l)*x,B[4]=(j*A-v*m-I*W)*x,B[5]=(u*m-c*A+e*W)*x,B[6]=(K*z-G*T-L*F)*x,B[7]=(n*T-D*z+Z*F)*x,B[8]=(v*t-w*A+I*i)*x,B[9]=(R*A-u*t-e*i)*x,B[10]=(G*P-H*z+L*N)*x,B[11]=(O*z-n*P-Z*N)*x,B[12]=(w*W-v*b-j*i)*x,B[13]=(u*b-R*W+c*i)*x,B[14]=(H*F-G*l-K*N)*x,B[15]=(n*l-O*F+D*N)*x,void 0):d},ve=function(T,R){if(R){var J=R[0],q=R[1],y=R[2];T[12]=T[0]*J+T[4]*q+T[8]*y+T[12],T[13]=T[1]*J+T[5]*q+T[9]*y+T[13],T[14]=T[2]*J+T[6]*q+T[10]*y+T[14],T[15]=T[3]*J+T[7]*q+T[11]*y+T[15]}},rq=function(m,R){if(R){var W=R[0],b=R[1],e=R[2];m[0]=m[0]*W,m[1]=m[1]*W,m[2]=m[2]*W,m[3]=m[3]*W,m[4]=m[4]*b,m[5]=m[5]*b,m[6]=m[6]*b,m[7]=m[7]*b,m[8]=m[8]*e,m[9]=m[9]*e,m[10]=m[10]*e,m[11]=m[11]*e}},Ej=function(q,n,y){var x=n[0],a=n[1],v=n[2],F=n[3],J=n[4],m=n[5],p=n[6],L=n[7],K=n[8],r=n[9],O=n[10],k=n[11],H=n[12],S=n[13],z=n[14],M=n[15],Q=y[0],Z=y[1],P=y[2],c=y[3];return q[0]=Q*x+Z*J+P*K+c*H,q[1]=Q*a+Z*m+P*r+c*S,q[2]=Q*v+Z*p+P*O+c*z,q[3]=Q*F+Z*L+P*k+c*M,Q=y[4],Z=y[5],P=y[6],c=y[7],q[4]=Q*x+Z*J+P*K+c*H,q[5]=Q*a+Z*m+P*r+c*S,q[6]=Q*v+Z*p+P*O+c*z,q[7]=Q*F+Z*L+P*k+c*M,Q=y[8],Z=y[9],P=y[10],c=y[11],q[8]=Q*x+Z*J+P*K+c*H,q[9]=Q*a+Z*m+P*r+c*S,q[10]=Q*v+Z*p+P*O+c*z,q[11]=Q*F+Z*L+P*k+c*M,Q=y[12],Z=y[13],P=y[14],c=y[15],q[12]=Q*x+Z*J+P*K+c*H,q[13]=Q*a+Z*m+P*r+c*S,q[14]=Q*v+Z*p+P*O+c*z,q[15]=Q*F+Z*L+P*k+c*M,q},ug=function(Z,$,f,q){var p,m,k,P,h,x,O,v,i,l,C=$[0],s=$[1],I=$[2],g=q[0],G=q[1],U=q[2],W=f[0],E=f[1],u=f[2];return j(C-W)<Th&&j(s-E)<Th&&j(I-u)<Th?Kd(Z):(O=C-W,v=s-E,i=I-u,l=1/w(O*O+v*v+i*i),O*=l,v*=l,i*=l,p=G*i-U*v,m=U*O-g*i,k=g*v-G*O,l=w(p*p+m*m+k*k),l?(l=1/l,p*=l,m*=l,k*=l):(p=0,m=0,k=0),P=v*k-i*m,h=i*p-O*k,x=O*m-v*p,l=w(P*P+h*h+x*x),l?(l=1/l,P*=l,h*=l,x*=l):(P=0,h=0,x=0),Z[0]=p,Z[1]=P,Z[2]=O,Z[3]=0,Z[4]=m,Z[5]=h,Z[6]=v,Z[7]=0,Z[8]=k,Z[9]=x,Z[10]=i,Z[11]=0,Z[12]=-(p*C+m*s+k*I),Z[13]=-(P*C+h*s+x*I),Z[14]=-(O*C+v*s+i*I),Z[15]=1,Z)},Xl=function(N,x,e,m,L){var q=1/V(x/2),b=1/(m-L);return N[0]=q/e,N[1]=0,N[2]=0,N[3]=0,N[4]=0,N[5]=q,N[6]=0,N[7]=0,N[8]=0,N[9]=0,N[10]=(L+m)*b,N[11]=-1,N[12]=0,N[13]=0,N[14]=2*L*m*b,N[15]=0,N},pj=function(Q,n,C,R,N,a,p){var Y=1/(n-C),e=1/(R-N),f=1/(a-p);return Q[0]=-2*Y,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*e,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=2*f,Q[11]=0,Q[12]=(n+C)*Y,Q[13]=(N+R)*e,Q[14]=(p+a)*f,Q[15]=1,Q},De=function(u,d){var V=d[0],w=d[1],W=d[2],p=d[3],Z=V*V+w*w+W*W+p*p,B=Z?1/Z:0;return u[0]=-V*B,u[1]=-w*B,u[2]=-W*B,u[3]=p*B,u},Gk=function(E,H){var a=H[0]+H[5]+H[10],Q=0;return a>0?(Q=2*Math.sqrt(a+1),E[3]=.25*Q,E[0]=(H[6]-H[9])/Q,E[1]=(H[8]-H[2])/Q,E[2]=(H[1]-H[4])/Q):H[0]>H[5]&H[0]>H[10]?(Q=2*Math.sqrt(1+H[0]-H[5]-H[10]),E[3]=(H[6]-H[9])/Q,E[0]=.25*Q,E[1]=(H[1]+H[4])/Q,E[2]=(H[8]+H[2])/Q):H[5]>H[10]?(Q=2*Math.sqrt(1+H[5]-H[0]-H[10]),E[3]=(H[8]-H[2])/Q,E[0]=(H[1]+H[4])/Q,E[1]=.25*Q,E[2]=(H[6]+H[9])/Q):(Q=2*Math.sqrt(1+H[10]-H[0]-H[5]),E[3]=(H[1]-H[4])/Q,E[0]=(H[8]+H[2])/Q,E[1]=(H[6]+H[9])/Q,E[2]=.25*Q),E},Yr=function($,J,d){var v=J[0],H=J[1],m=J[2],s=J[3],E=v+v,Y=H+H,C=m+m,S=v*E,O=v*Y,x=v*C,j=H*Y,T=H*C,W=m*C,e=s*E,V=s*Y,t=s*C;return $[0]=1-(j+W),$[1]=O+t,$[2]=x-V,$[3]=0,$[4]=O-t,$[5]=1-(S+W),$[6]=T+e,$[7]=0,$[8]=x+V,$[9]=T-e,$[10]=1-(S+j),$[11]=0,$[12]=d[0],$[13]=d[1],$[14]=d[2],$[15]=1,$},mp=function(){var P=[0,0,0],Q=[0,0,0],M=[0,0,0],L=function(M,l,n){M[0]=l[1]*n[2]-l[2]*n[1],M[1]=l[2]*n[0]-l[0]*n[2],M[2]=l[0]*n[1]-l[1]*n[0]},V=function(K){return K[0]*K[0]+K[1]*K[1]+K[2]*K[2]},f=function(W){var G=Math.sqrt(V(W));W[0]/=G,W[1]/=G,W[2]/=G},s=function(r,a,y){r[0]=a[0]-y[0],r[1]=a[1]-y[1],r[2]=a[2]-y[2]};return function(S,B,I){var b=ys();return s(M,S,B),0===V(M)&&(M[2]=1),f(M),L(P,I,M),0===V(P)&&(1===Math.abs(I[2])?M[0]+=1e-4:M[2]+=1e-4,f(M),L(P,I,M)),f(P),L(Q,M,P),b[0]=P[0],b[4]=Q[0],b[8]=M[0],b[1]=P[1],b[5]=Q[1],b[9]=M[1],b[2]=P[2],b[6]=Q[2],b[10]=M[2],b}}(),ms=function(A,_){if(A.vr.enable){var b=A.vr.getViewMatrix(_);if(b)return b}return ug(_?_:ys(),A._eye,A._center,A._up)},wk=function(v){if(v.vr.enable){var D=v.vr.getProjectMatrix();if(D)return D}var m=v.getAspect(),f=v._near,L=v._far,k=ys();if(v._ortho){var d=v._orthoWidth/2,y=d/m;pj(k,-d,d,-y,y,f,L)}else Xl(k,v._fovy,m,f,L);return k},Tq=function(e,m){if(!e)return d;var C=0,R=1,t=2,$=[],k=0,H=e.length,X=H/3;if(m){for(;H>k;k++)$[k]=0;for(k=0;k<m.length;k+=3){var V=[],j=[],U=[];V[C]=e[3*m[k+1]+C]-e[3*m[k]+C],V[R]=e[3*m[k+1]+R]-e[3*m[k]+R],V[t]=e[3*m[k+1]+t]-e[3*m[k]+t],j[C]=e[3*m[k+2]+C]-e[3*m[k+1]+C],j[R]=e[3*m[k+2]+R]-e[3*m[k+1]+R],j[t]=e[3*m[k+2]+t]-e[3*m[k+1]+t],U[C]=V[R]*j[t]-V[t]*j[R],U[R]=V[t]*j[C]-V[C]*j[t],U[t]=V[C]*j[R]-V[R]*j[C];for(var y=0;3>y;y++)$[3*m[k+y]+C]+=U[C],$[3*m[k+y]+R]+=U[R],$[3*m[k+y]+t]+=U[t]}}else for(k=0;X>k;k+=3){var V=[],j=[],U=[];V[C]=e[3*(k+1)+C]-e[3*k+C],V[R]=e[3*(k+1)+R]-e[3*k+R],V[t]=e[3*(k+1)+t]-e[3*k+t],j[C]=e[3*(k+2)+C]-e[3*(k+1)+C],j[R]=e[3*(k+2)+R]-e[3*(k+1)+R],j[t]=e[3*(k+2)+t]-e[3*(k+1)+t],U[C]=V[R]*j[t]-V[t]*j[R],U[R]=V[t]*j[C]-V[C]*j[t],U[t]=V[C]*j[R]-V[R]*j[C];for(var y=0;3>y;y++)$[3*(k+y)+C]=U[C],$[3*(k+y)+R]=U[R],$[3*(k+y)+t]=U[t]}for(k=0;H>k;k+=3){var Z=[];Z[C]=$[k+C],Z[R]=$[k+R],Z[t]=$[k+t];var q=w(Z[C]*Z[C]+Z[R]*Z[R]+Z[t]*Z[t]);0===q&&(q=Th),Z[C]=Z[C]/q,Z[R]=Z[R]/q,Z[t]=Z[t]/q,$[k+C]=Z[C],$[k+R]=Z[R],$[k+t]=Z[t]}return new Kp($)},Ue=function(i,f,r,T){if(r||(r=i.createTexture()),f){var U=i.TEXTURE_2D,S=i.REPEAT,P=i.CLAMP_TO_EDGE,O=i.TEXTURE_MIN_FILTER;T!==i.NEAREST&&(T=i.LINEAR),vh(i,r),i.texImage2D(U,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,f),zb(i,i.TEXTURE_MAG_FILTER,T);var R=f.naturalWidth||f.width,A=f.naturalHeight||f.height;vn(R)&&vn(A)&&!f.clampToEdge?(zb(i,i.TEXTURE_WRAP_S,S),zb(i,i.TEXTURE_WRAP_T,S),zb(i,O,i.LINEAR_MIPMAP_LINEAR),i.generateMipmap(U)):(zb(i,i.TEXTURE_WRAP_S,P),zb(i,i.TEXTURE_WRAP_T,P),zb(i,O,T)),vh(i,d)}return r},gi=function(z,Z){var s=new Uint8Array(4);return Z=Z||z.createTexture(),vh(z,Z),zb(z,z.TEXTURE_MIN_FILTER,z.LINEAR),z.texImage2D(z.TEXTURE_2D,0,z.RGBA,1,1,0,z.RGBA,z.UNSIGNED_BYTE,s),Z},qg=function(e){e._26I&&e._prg&&(e._26I.deleteProgram(e._prg),e._prg=d)},Wk=function(B,e,R,v){var Z=B.createShader(R);return B.shaderSource(Z,v),B.compileShader(Z),B.attachShader(e,Z),Z},Ik=function(q){return q.createBuffer()},vh=function(F,P){F.bindTexture(F.TEXTURE_2D,P)},zb=function(l,o,i){l.texParameteri(l.TEXTURE_2D,o,i)},Jg=function(t,A){t.enable(t.POLYGON_OFFSET_FILL),t.polygonOffset(A[0],A[1])},zi=function(E){E.disable(E.POLYGON_OFFSET_FILL)},Yb=function(X,q){if(q){var q=Xc(q);X.clearColor(q[0],q[1],q[2],q[3])}},ph=function(P,c){Dj(P,c.uFix,!0),Ee(P,c.aNormal)},Dp=function(y,r){Dj(y,r.uFix,!1),td(y,r.aNormal)},no=function(H,n,E,B,o,M,x,K){H._picking||(E?(Dj(H,n.uBlend,!0),Dj(H,n.uBlendColor,E)):Dj(H,n.uBlend,!1),Dj(H,n.uLight,B==d?!0:B),nq(o)&&1!==o&&Dj(H,n.uPartOpacity,o),Dj(H,n.uReverseFlip,M==d?!1:M),Dj(H,n.uFixPickReverseColor,x||Kk)),K?H.enable(H.CULL_FACE):H.disable(H.CULL_FACE)},Tb=function(f,D){f._picking||Dj(f,D.uPartOpacity,1)},Bb=function(){var z=[0,0,1,1];return function(B,t,y,V,w,X,E,K,D){return y?(Dj(B,t.uTexture,!0),Dj(B,t.uDiscardSelectable,dr(V)?V:!0),td(B,t.aUv),Lc(B,w,X,t.aUv,2),D?(Dj(B,t.uBlendTexture,!0),B.activeTexture(B.TEXTURE1),vh(B,D),B.uniform1i(t.uBlendSampler,1)):(Dj(B,t.uBlendTexture,!1),B.activeTexture(B.TEXTURE1),vh(B,B._emptyBlendTexture)),B.activeTexture(B.TEXTURE0),vh(B,y),B.uniform1i(t.uSampler,0),E?(z[0]=E[0],z[1]=E[1]):(z[0]=0,z[1]=0),K?(z[2]=K[0],z[3]=K[1]):(z[2]=1,z[3]=1),Dj(B,t.uOffsetScale,z),void 0):(B.activeTexture(B.TEXTURE0),vh(B,B._emptyTexture),B.activeTexture(B.TEXTURE1),vh(B,B._emptyBlendTexture),void 0)}}(),sn=function(c,V,y){c.activeTexture(c.TEXTURE0),vh(c,d),c.activeTexture(c.TEXTURE1),vh(c,d),y&&(Ee(c,V.aUv),Dj(c,V.uTexture,!1),Dj(c,V.uBlendTexture,!1))},bb=function(L,p,E,$,R,Z){!E||f||mr||L.lineWidth(E),$&&!L._picking&&Dj(L,p.uFixPickReverseColor,$),R&&Lc(L,R,Z,p.aPosition)},Co=function(R,X,K,J){bs&&(J=R[bs]),R.drawArrays(J==d?R.TRIANGLES:J,X,K);var m=R._renderInfo;m&&(m.calls++,m.vertices+=K,(J==d||J===R.TRIANGLES)&&(m.faces+=K/3),J===R.LINES&&(m.lines+=K/2))},Qj=function(Y,W,L,F){bs&&(F=Y[bs]),Y.drawElements(F==d?Y.TRIANGLES:F,L,Y.UNSIGNED_SHORT,W==d?0:2*W);var C=Y._renderInfo;C&&(C.calls++,C.vertices+=L,(F==d||F===Y.TRIANGLES)&&(C.faces+=L/3),F===Y.LINES&&(C.lines+=L/2))},Cg=function(R,S,$,K,N){var P=R.ARRAY_BUFFER;R.bindBuffer(P,S),$&&R.bufferData(P,$,R.STATIC_DRAW),K!=d&&R.vertexAttribPointer(K,N?N:3,R.FLOAT,!1,0,0)},Lc=function(w,B,M,z,A){return M?(Ci(w,w.ARRAY_BUFFER,B,M),z!=d&&w.vertexAttribPointer(z,A?A:3,w.FLOAT,!1,0,0),void 0):Cg(w,B,M,z,A)},xg=function(o,V,j){var A=o.ELEMENT_ARRAY_BUFFER;o.bindBuffer(A,V),j&&o.bufferData(A,j,o.STATIC_DRAW)},hf=function(y,q,C){Ci(y,y.ELEMENT_ARRAY_BUFFER,q,C)},Ci=function(w,X,Y,p){var F=p._bufId;F||(F=p._bufId=P.Math.generateIncreasingID());var Y,R=w._bufPool;(Y=R[F])&&Y._buf?w.bindBuffer(X,Y._buf):(Y=R[F]={_buf:Ik(w)},w.bindBuffer(X,Y._buf),w.bufferData(X,p,w.STATIC_DRAW)),Y._fid=w._renderInfo.frame},Dj=function(S,b,h){if(h!=d&&b!=d){h=Xc(h);var O=h.length;3===O?S.uniform3fv(b,h):4===O?S.uniform4fv(b,h):16===O?S.uniformMatrix4fv(b,!1,h):dr(h)?S.uniform1i(b,h?1:0):2===O?S.uniform2fv(b,h):S.uniform1f(b,h)}},td=function(R,c){c!=d&&c>=0&&R.enableVertexAttribArray(c)},Ee=function(Q,f){f!=d&&f>=0&&Q.disableVertexAttribArray(f)},Io=function(i,H){var h=i.getGL(),z=i._prg;i._7O=i._8O.pop(),H&&(Dj(h,z.uMVMatrix,i._7O),i._6O=H,Dj(h,z.uNMatrix,H))},Bc=function(r,C){return C||(C=ys()),Yg(C,r),jf(C),nj(C),C},Qc=function(P,h){var K=P.getGL(),x=P._prg,k=P._7O;h&&(P._8O.push(Ao(k)),Dj(K,x.uMMatrix,h),Ej(k,k,h),P._7O=k),Dj(K,x.uMVMatrix,k),Dj(K,x.uNMatrix,Bc(k,P._6O))},Oj=function(H,K,t,Z,p,W){if(t){if(Z){var s=t.value++,h=2147483648|s,f=[(255&h>>16)/255,(255&h>>8)/255,(255&h)/255,(255&h>>24)/255];t[s]={data:p,part:W}}else f=pc;return Dj(H,K.uFixPickReverseColor,f),f}},yk=function(){var O={center:function(t,u,Z,f,h){var a=-u[1]/2,i={x:-u[0]/2,y:a,width:u[0],height:u[1]},T=ui(t,i,Z);return[T.x+f,-T.y-h,ud()]},front:function(Q,U,B,A,p){var k=-U[1]/2,u={x:-U[0]/2,y:k,width:U[0],height:U[1]},N=ui(Q,u,B);return[N.x+A,-N.y-p,U[2]/2+ud()]},back:function(O,j,A,Y,o){var Z=-j[0]/2,P=-j[1]/2,I={x:Z,y:P,width:j[0],height:j[1]},G=ui(O,I,A);return[-G.x-Y,-G.y-o,-j[2]/2-ud()]},left:function(x,Y,M,Q,F){var I=-Y[1]/2,b={x:-Y[2]/2,y:I,width:Y[2],height:Y[1]},G=ui(x,b,M);return[-Y[0]/2-ud(),-G.y-F,G.x+Q]},right:function(S,d,_,A,C){var f=-d[2]/2,O=-d[1]/2,X={x:f,y:O,width:d[2],height:d[1]},$=ui(S,X,_);return[d[0]/2+ud(),-$.y-C,-$.x-A]},top:function(j,L,y,V,d){var M={x:-L[0]/2,y:-L[2]/2,width:L[0],height:L[2]},I=ui(j,M,y);return[I.x+V,L[1]/2+ud(),I.y+d]},bottom:function(Z,z,B,N,a){var P=-z[2]/2,p={x:-z[0]/2,y:P,width:z[0],height:z[2]},E=ui(Z,p,B);return[E.x+N,-z[1]/2-ud(),-E.y-a]}};return function(B,h,N,p,L,U){return O[p](B,h,N,L||0,U||0)}}(),id=function(h,y,n,Y,a,c,Z,z,G,A){if(a&&(y[0]+=a[0],y[1]+=a[1],y[2]+=a[2]),ve(h,n),z){var j=ys();if(jl(j,G,A),gr(y,j),ve(h,y),h.auto=z,h.pos=gr([0,0,0],h),c){var F=h.mat2=ys();jl(F,c,Z)}}else jl(h,G,A),ve(h,y),Y===Km?Mo(h,-L):Y===_i?Mo(h,L):Y===ai?bl(h,-L):Y===el?bl(h,L):Y===sl&&Mo(h,M),jl(h,c,Z);return h},Eo=function(C,c){var P=c.auto,m=c.mat2,b=C.gv;if(P){var o,F=ys(),B=[0,0,0,0];o="string"==typeof P?[P.indexOf("x")<0?b._eye[0]:b._center[0],P.indexOf("y")<0?b._eye[1]:b._center[1],P.indexOf("z")<0?b._eye[2]:b._center[2]]:b._eye,Gk(B,ug(ys(),o,b._center,b._up)),Yr(F,De(B,B),c.pos),m&&Ej(F,F,m),Qc(b,F)}else Qc(b,c)},fb=function(V,c,e,B,K){var m=V.s,f=V.gv,a=f.getGL(),E=f._prg,C=f._buffer,R=f._1O;Ue(a,qs,R),Eo(V,e),no(a,E,m(c+".blend"),m(c+".light"),m(c+".opacity"),m(c+".reverse.flip"),m(c+".reverse.color"),m(c+".reverse.cull")),Bb(a,E,R,K,C.uv,$g),Lc(a,C.vs,B,E.aPosition),Lc(a,C.ns,Of,E.aNormal),hf(a,C.is,pn),Qj(a,0,pn.length),sn(a,E,R),Tb(a,E),Io(f)},Xm=function(U,T,b){var t=U.gv,w=U.data,Z=U[T]={blend:t.getBodyColor(w)||t.getFaceBlend(w,T),light:t.getFaceLight(w,T),color:t.getFaceColor(w,T),opacity:t.getFaceOpacity(w,T),transparent:t.getFaceTransparent(w,T),reverseFlip:t.getFaceReverseFlip(w,T),reverseColor:t.getFaceReverseColor(w,T),reverseCull:t.getFaceReverseCull(w,T),texture:t.getFaceImage(w,T),blendTexture:t.getFaceBlendImage(w,T),discardSelectable:t.getFaceDiscardSelectable(w,T)};if("csg"!==T){Z.uv=t.getFaceUv(w,T)||b&&b[T+"Uv"],Z.uvScale=t.getFaceUvScale(w,T)||b&&b[T+"UvScale"],Z.uvOffset=t.getFaceUvOffset(w,T)||b&&b[T+"UvOffset"];var n=t.getFaceMat(w,T);n&&(Z.mat=Ti(w,n))}return Z},tk=function(d,h,e,r,Z){if(r){if(!Z(r.transparent))return;var A=d.data,R=d.gv,F=R._buffer,M=R.getTexture(r.texture,A),$=R.getTexture(r.blendTexture,A);Bb(h,e,M,r.discardSelectable,F.uv,r.tuv,r.uvOffset,r.uvScale,$),no(h,e,r.blend,r.light,r.opacity,r.reverseFlip,r.reverseColor,r.reverseCull),Dj(h,e.uDiffuse,r.color||S["color.empty"]),Lc(h,F.vs,r.vs,e.aPosition),Lc(h,F.ns,r.ns,e.aNormal),Co(h,0,r.vs.length/3),Tb(h,e),sn(h,e,M)}},so=function(d,F,T,b,e,h){var o,M,$,n,y,G,v,j,I,r,q,c=[b-F,e-T],i=d?d.length:0;for($=0;i>$;$++){for(n=2,o=d[$],y=o[0],G=o[1];n+1<o.length;){if(v=o[n],j=o[n+1],M=Uf(F,T,b,e,y,G,v,j,!0)){I=[v-y,j-G],r=jc(I),I[0]/=r,I[1]/=r,r=md(c,I),r=r>0?h:-h,q=[I[0]*r,I[1]*r];break}y=v,G=j,n+=2}if(q)break}if(q)for(b=F+q[0],e=T+q[1],$=0;i>$;$++)for(n=2,o=d[$],y=o[0],G=o[1];n+1<o.length;){if(v=o[n],j=o[n+1],M=Uf(F,T,b,e,y,G,v,j,!0))return[0,0];y=v,G=j,n+=2}return q?q:[b-F,e-T]},Ir=P.graph3d={},qn=function(r,k,y){$o(l+".graph3d."+r,k,y)},fn="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",ze="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";im(F,{setBatchInfo:function(T,d){Rn[T]=d},getBatchInfo:function(V){return Rn[V]}},!0);var Ln=[1,1,1],cr=[1,0,0,0,0,1,0,1,1,1,1,0],xn=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],rs=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],os=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],ng=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Mm=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Wi=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],fh=function(h,w){Me(h,w,"_batchModelMap","_batchIndexMap"),se(h,w,"_wireframeModelMap","_wireframeIndexMap"),se(h,w,"_polylineModelMap","_polylineIndexMap"),se(h,w,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),se(h,w,"_polylineModelMapSwap","_polylineIndexMapSwap")},Me=function(d,p,J,u){if(!p)return d[J]={},d[u]={},void 0;var C=p._id,L=d[u],b=L[C];if(b){var O=d[J],m=b.batch,K=O[m],n=K.ds,Q=b.index;if(K.invalidate=!0,delete L[C],n.splice(Q,1),Kb(n))return delete O[m],void 0;for(var G=b.begin,i=b.size,t=3*G,B=3*i,W=4*G,E=4*i,U=K.vs,j=K.ps,x=K.uv,A=K.cs,w=K.bs,V=K.rs,P=K.ns,y=K.ls;Q<n.length;Q++)b=L[n[Q]._id],b.index--,b.begin-=i;U.splice(t,B),j.splice(W,E),x&&x.splice(2*G,2*i),A&&A.splice(W,E),w&&w.splice(t,B),V&&V.splice(G,i),P&&P.splice(t,B),y&&y.splice(G,i)}},se=Me,Db=function(S,A,a,w){if(!w)return d;var F=A[w];if(!F){var u=Rn[w]||tp,k=u.image?[]:d;F=A[w]={vs:[],ns:[],uv:k,cs:k?d:u.color?d:[],bs:u.blend?[]:d,ps:[],rs:u.brightness?[]:d,ds:[]}}return F.invalidate=!0,S[a._id]={index:F.ds.length,begin:F.vs.length/3,batch:w},F.ds.push(a),F},sm=function(s,P){return P!=d&&1!==P?[s[0]*P,s[1]*P,s[2]*P,s[3]]:s},Mk=function(e,x,i){var U=e.getBrightness(x),h=Xc(i.color||"white"),r=h[3]<1,s=Math.ceil(i.width)||1,Z=(r?"T":"O")+s,X=e._wireframeIndexMap,D=e._wireframeModelMap,S=D[Z];S||(S=D[Z]={vs:[],cs:[],ps:[],ds:[],T:r,W:s});var m,y=e.getData3dUI(x),O=Eg(y);if(i.geometry){if(!O)return;if(m=Il(O),!m)return}else m=i.short?Sj:lq;S.invalidate=!0;var g=S.vs,A=S.cs,c=S.ds,N=X[x._id]={index:c.length,begin:g.length/3,batch:Z};c.push(x);var z=Ti(x,i.mat),Y=y._calcAnchorMat(x);Y&&Ej(z,z,Y),me(g,z,m);var J=N.size=g.length/3-N.begin;Lg(A,sm(h,U),J)},Vn=function(c,I,u,U,T,G,b,p,y){var g=c.getBrightness(I);g==d&&(g=1);var x=sm(Xc(U),g),W=x[3]<1;G=Math.ceil(G)||1;var w=(W?"T":"O")+G;if(b){var n=b[0],Y=(b[1]||n)+n;w+="-"+n+"-"+Y,y&&(w+="-"+Yl(y)+"-"+g,y=sm(Xc(y),g))}var s=c._polylineIndexMap,j=c._polylineModelMap,f=j[w];f||(f=j[w]={vs:[],cs:[],ps:[],ds:[],ls:b?[]:d,T:W,W:G},b&&(f.D=n,f.G=Y,f.A=y)),f.invalidate=!0;var K,k=f.vs,M=f.cs,V=f.ds,e=f.ls,A=s[I._id]={index:V.length,begin:k.length/3,batch:w};V.push(I),qp(k,u);var Z,o=A.size=k.length/3-A.begin,r=u.length,J=0,N=[];if(b||T)for(K=0;r>K;K+=6)Z=jc([u[K],u[K+1],u[K+2]],[u[K+3],u[K+4],u[K+5]]),N.push(Z),J+=Z;if(J&&T){var L,O=sm(Xc(T),g),F=[O[0]-x[0],O[1]-x[1],O[2]-x[2],O[3]-x[3]],E=0;for(K=0;r>K;K+=6)L=E/J,Lg(M,[x[0]+F[0]*L,x[1]+F[1]*L,x[2]+F[2]*L,x[3]+F[3]*L],1),E+=N[K/6],L=E/J,Lg(M,[x[0]+F[0]*L,x[1]+F[1]*L,x[2]+F[2]*L,x[3]+F[3]*L],1)}else Lg(M,x,o);if(b)for(E=p||0,K=0;r>K;K+=6)e.push(E),E+=N[K/6],e.push(E)},xf=function(z,F,h){if(F)for(var d=4*F.begin,p=h[F.batch].ps,A=0;A<F.size;A++)p[d++]=z[0],p[d++]=z[1],p[d++]=z[2],p[d++]=z[3]},kl=function(A,L){var C=L+["32"],i=A[L],y=A[C];i?y&&y.length===i.length?(y.set(i),y._bufId=null):A[C]=new Kp(i):delete A[C]},Tn=function(k,f,C,m,u,Y,U,S,x){if(mo(C))C.forEach(function(b){Tn(k,f,b,m,u,Y,U,S,x)});else if(Jp(C))Tn(k,f,Eg(m,C),m,u,Y,U,S,x);else if(yl(C)){var r,t=Wf(C.mat,f,k),E=Wf(C.s3,f,k),D=Wf(C.t3,f,k),b=Wf(C.r3,f,k);if((E||b||D||t)&&(r=ip(t,E,b,Wf(C.rotationMode,f,k),D),Y.push(r)),C.shape3d)Tn(k,f,C.shape3d,m,u,Y,U,S,C);else{var y=m.s;x=x||tp;var X=Y[0],J=Y.length,v=y("shape3d.color",C.color,x.color);if(u||(u=y("shape3d.blend",C.blend,x.blend)),J>1){X=Ao(X);for(var _=1;J>_;_++)Ej(X,X,Y[_])}C.vs&&y(fm,C.visible,x.visible)&&xl(X,U,S,C.vs,C.uv,C.is,u,v),C.top_vs&&y(tq,C.topVisible,x.topVisible)&&xl(X,U,S,C.top_vs,C.top_uv,C.top_is,u,y("shape3d.top.color",C.topColor,x.topColor)||v),C.bottom_vs&&y(sj,C.bottomVisible,x.bottomVisible)&&xl(X,U,S,C.bottom_vs,C.bottom_uv,C.bottom_is,u,y("shape3d.bottom.color",C.bottomColor,x.bottomColor)||v),C.from_vs&&y(Fh,C.fromVisible,x.fromVisible)&&xl(X,U,S,C.from_vs,C.from_uv,C.from_is,u,y("shape3d.from.color",C.fromColor,x.fromColor)||v),C.to_vs&&y(sg,C.toVisible,x.toVisible)&&xl(X,U,S,C.to_vs,C.to_uv,C.to_is,u,y("shape3d.to.color",C.toColor,x.toColor)||v)}r&&Y.pop()}},xl=function(R,D,v,q,I,X,i,K){var P,g=D.cs,t=D.uv,z=D.bs;if(X){P=X.length;for(var u=0;P>u;u++){var L=X[u];me(v,R,[q[3*L],q[3*L+1],q[3*L+2]]),t&&qp(t,[I[2*L],I[2*L+1]])}}else P=q.length/3,me(v,R,q),t&&qp(t,I);g&&Lg(g,K,P),z&&(i?Fr(z,i,P):qp(z,Ln,P))},xm=function(g,P,o,M){var U=[];M?Tn(g.gv,g.data,M,g,g.getBodyColor(),[P],o,U):(Oe(g,Km,P,o,U),Oe(g,_i,P,o,U),Oe(g,Sg,P,o,U),Oe(g,sl,P,o,U),Oe(g,ai,P,o,U),Oe(g,el,P,o,U),Oe(g,"csg",P,o,U)),U.length&&(qp(o.vs,U),qp(o.ns,Tq(U)))},Oe=function(X,o,D,$,q){var F=X[o];if(F){var J=F.tuv;if(J){var H,j,e,S,C=F.uvScale,B=F.uvOffset;if(C)for(H=J.length,j=C[0],e=C[1],S=0;H>S;S+=2)J[S]*=j,J[S+1]*=e;if(B)for(H=J.length,j=B[0],e=B[1],S=0;H>S;S+=2)J[S]+=j,J[S+1]+=e}xl(D,$,q,F.vs,J,d,F.blend,F.color)}},jk=function(K,f,T,l,H,e,R,A){var d,E=T.cs,Y=T.uv,w=T.bs;if(K.getFaceVisible(f,e)){var D=K.getFaceMat(f,e);if(D&&(H=Ti(f,D)),me(R,H,A),E&&Lg(E,K.getFaceColor(f,e),6),Y){var t=K.getFaceUv(f,e)||l[e+"Uv"],n=K.getFaceUvScale(f,e)||l[e+"UvScale"],V=K.getFaceUvOffset(f,e)||l[e+"UvOffset"];t=t?[t[6],t[7],t[0],t[1],t[2],t[3],t[2],t[3],t[4],t[5],t[6],t[7]]:cr;var i=t[0],Z=t[1],c=t[2],r=t[3],O=t[4],B=t[5],q=t[6],Q=t[7],J=t[8],v=t[9],W=t[10],j=t[11];if(n){var b=n[0],z=n[1];i*=b,Z*=z,c*=b,r*=z,O*=b,B*=z,q*=b,Q*=z,J*=b,v*=z,W*=b,j*=z}if(V){var g=V[0],P=V[1];i+=g,Z+=P,c+=g,r+=P,O+=g,B+=P,q+=g,Q+=P,J+=g,v+=P,W+=g,j+=P}Y.push(i,Z,c,r,O,B,q,Q,J,v,W,j)}w&&(d=K.getBodyColor(f)||K.getFaceBlend(f,e),d?Fr(w,d,6):qp(w,Ln,6))}},cq=function(r,H,N,v){var z=r.getGL(),Z=r._prg,Y=r._buffer;if(!r.drawFilter&&!nf(H)){Qc(r),ph(z,Z);for(var E in H){var g=H[E];if(!(v&&!g.T||!v&&g.T)){g.invalidate?(g.invalidate=!1,kl(g,"vs"),kl(g,"cs"),kl(g,"ls"),kl(g,"ps")):N&&kl(g,"ps");var P=g.vs32,G=N?g.ps32:g.cs32;bb(z,Z,g.W,d,Y.vs,P);var U=g.D,l=!r._dashDisabled&&U;Dj(z,Z.uAlphaTest,S.alphaTest),l&&(Dj(z,Z.uDash,!0),Dj(z,Z.uDashDistance,U),Dj(z,Z.uDashGapDistance,g.G),td(z,Z.aLineDistance),Lc(z,Y.lineDistance,g.ls32,Z.aLineDistance,1),Dj(z,Z.uDiffuse,g.A||S["color.empty"]));var e=!r._batchColorDisabled;e&&(Dj(z,Z.uBatchColor,!0),td(z,Z.aBatchColor),Lc(z,Y.batchColor,G,Z.aBatchColor,4)),Bb(z),Co(z,0,P.length/3,z.LINES),sn(z),e&&(Dj(z,Z.uBatchColor,!1),Ee(z,Z.aBatchColor)),l&&(Dj(z,Z.uDash,!1),Ee(z,Z.aLineDistance))}}Dp(z,Z)}},Fi=function(L,v,N){var s,k,Y,W,I,p,y,i,x,b,H,B=L.getGL(),Q=L._prg,Z=L._buffer,T=L._batchModelMap;if(!nf(T)){Qc(L);for(s in T)if(k=Rn[s]||tp,!(N&&!k.transparent||!N&&k.transparent)&&(Y=T[s],v||!k.transparentMask)){var q=N&&k.autoSort!==!1&&(L._33Q||Y.invalidate);if(Y.invalidate?(Y.invalidate=!1,kl(Y,"vs"),kl(Y,"ns"),kl(Y,"cs"),kl(Y,"rs"),kl(Y,"ps"),kl(Y,"bs"),kl(Y,"uv")):v&&kl(Y,"ps"),I=Y.vs32,p=v?Y.ps32:Y.cs32,x=Y.uv32,y=Y.bs32,i=Y.rs32,H=I.length/3,q&&(Y.is=Ic(I,L.getEye())),H){W=k.light,b=L.getTexture(k.image),no(B,Q,d,k.light,k.opacity,k.reverseFlip,k.reverseColor,k.reverseCull),p?L._batchColorDisabled||(Dj(B,Q.uBatchColor,!0),td(B,Q.aBatchColor),Lc(B,Z.batchColor,p,Q.aBatchColor,4)):Dj(B,Q.uDiffuse,k.color||S["color.empty"]);var U=k.alphaTest;Dj(B,Q.uAlphaTest,U===J?S.alphaTest:U);var r=y&&!L._batchBlendDisabled;r&&(Dj(B,Q.uBatchBlend,!0),td(B,Q.aBatchBlend),Lc(B,Z.batchBlend,y,Q.aBatchBlend));var F=i&&!L._batchBrightnessDisabled;F&&(Dj(B,Q.uBatchBrightness,!0),td(B,Q.aBatchBrightness),Lc(B,Z.batchBrightness,i,Q.aBatchBrightness,1)),x?Bb(B,Q,b,k.discardSelectable,Z.uv,x,k.uvOffset,k.uvScale):Bb(B),Lc(B,Z.vs,I,Q.aPosition),Lc(B,Z.ns,Y.ns32,Q.aNormal),Y.is?(xg(B,Z.is,Y.is),Qj(B,0,H)):Co(B,0,H),x?sn(B,Q,b):sn(B),p&&!L._batchColorDisabled&&(Dj(B,Q.uBatchColor,!1),Ee(B,Q.aBatchColor)),r&&(Dj(B,Q.uBatchBlend,!1),Ee(B,Q.aBatchBlend)),F&&(Dj(B,Q.uBatchBrightness,!1),Ee(B,Q.aBatchBrightness)),Tb(B,Q)}}}},Ic=function(C,d){for(var c=C.length/3,e=new Array(c),X=c/3,u=new Array(X),W=0;X>W;W++)u[W]=W;u.sort(function(M,s){var x=9*M,O=[(C[x]+C[x+3]+2*C[x+6])/4,(C[x+1]+C[x+4]+2*C[x+7])/4,(C[x+2]+C[x+5]+2*C[x+8])/4];
x=9*s;var g=[(C[x]+C[x+3]+2*C[x+6])/4,(C[x+1]+C[x+4]+2*C[x+7])/4,(C[x+2]+C[x+5]+2*C[x+8])/4],f=jc(d,O)-jc(d,g);return f>0?-1:0>f?1:0});for(var W=0;X>W;W++){var v=3*W,O=3*u[W];e[v]=O,e[v+1]=O+1,e[v+2]=O+2}return new Gf(e)},Vl={obj:function(f,K){var z={mat:f.mat,s3:f.s3,r3:f.r3,rotationMode:f.rotationMode,t3:f.t3,cube:f.cube==d?!0:f.cube,center:f.center==d?!0:f.center,ignoreMtls:f.ignoreMtls,ignoreTransparent:f.ignoreTransparent,ignoreColor:f.ignoreColor,ignoreImage:f.ignoreImage,ignoreNormal:f.ignoreNormal,prefix:f.prefix,flipY:f.flipY,flipFace:f.flipFace,reverseFlipMtls:f.reverseFlipMtls,finishFunc:function(n,w){if(n){var w=[];for(var H in n){var S=n[H];w.rawS3=S.rawS3,w.push(S),f.eachModel&&f.eachModel(H,S)}w.json=f,K(w)}else K()}};F.loadObj(f.obj,f.mtl,z)}};F.getModelTypeHandlers=function(){return Vl},F.setModelTypeHandler=function(e,k){Vl[e]=k},F.getModelTypeHandler=function(w){return Vl[w]},F.handleModelLoaded=function(){},F.handleUnfoundModel=function(){};var vl=d,Sm=d,Cn=function(Z){vl&&!Z._loadingModelView_&&(Sm||(Sm={}),Sm[Z._loadingModelView_=Wm()]=Z)},je=function(K,A){vl||(vl={});var h=vl[K];if(h){if(h.url===A)return;h.request.onload=Nk,h.request.onerror=Nk}var R=new sf;if(vl[K]={request:R,url:A},A=F.beforeLoadURL(A),A.data){var m=F.parse(A.data);rc(K,m,A)}else{R.onload=function(){if(200===this.status||0===this.status){delete vl[K];var g=F.parse(R.getResponseText());rc(K,g,A)}else uc(K,F.handleUnfoundModel(K,A)||d)},R.onerror=function(){uc(K,F.handleUnfoundModel(K,A)||d)};var B={};B.url=encodeURI(A),B.sync=!1,R.send(B)}},rc=function(b,A,k){var s=A.modelType;if(!s)return uc(b,A),F.handleModelLoaded(b,A),void 0;var c=F.getModelTypeHandler(s);if(c){if(vl||(vl={}),vl[b])return;vl[b]=!0;var U=function(L){L?(uc(b,L),F.handleModelLoaded(b,L)):uc(b,F.handleUnfoundModel(b,k)||d)};c(A,U)}else uc(b,F.handleUnfoundModel(b,k)||d)},uc=function(B,t){if(Bh[B]=t,delete vl[B],nf(vl)&&(vl=d,Sm)){for(var Q in Sm){var R=Sm[Q];R.invalidateAll&&R.invalidateAll(J,"modelLoaded",B),R.redraw&&R.redraw(),R.iv(),delete R._loadingModelView_}Sm=d}if(t&&Sm)for(var Q in Sm){var R=Sm[Q];R.invalidateAll&&R.invalidateAll(J,"modelLoading",B),R.redraw&&R.redraw(),R.iv()}},$g=new Kp([0,0,0,1,1,1,1,0]),Of=new Kp([0,0,1,0,0,1,0,0,1,0,0,1]),pn=new Gf([0,1,2,2,3,0]),Pr=new Kp([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),ko=new Gf([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),fo=new Kp([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Eb=Tq(Pr,ko),am=(new Kp([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Gf([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Km,Sg,_i,sl,ai,el]),lq=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Sj=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],hs=function(b,X,n,z,w,a){a=a||16,b=b||16,X=X||0,n=n||b;var C,H,T,t,l,D,W,h,o=.5,I=[],A=[],L=p/b,K=M/a;for(C=0;a>C;C++)for(l=C+1,t=C*K,h=l*K,H=X;n>H;H++)D=H+1,T=H*L,W=D*L,I.push(o*Z(t)*v(T),o*v(t),-o*Z(t)*Z(T),o*Z(h)*v(W),o*v(h),-o*Z(h)*Z(W),o*Z(t)*v(W),o*v(t),-o*Z(t)*Z(W),o*Z(t)*v(T),o*v(t),-o*Z(t)*Z(T),o*Z(h)*v(T),o*v(h),-o*Z(h)*Z(T),o*Z(h)*v(W),o*v(h),-o*Z(h)*Z(W)),A.push(H/b,C/a,D/b,l/a,D/b,C/a,H/b,C/a,H/b,l/a,D/b,l/a);if(z){var m=[],V=[];for(T=X*L,C=0;a>C;C++)l=C+1,t=C*K,h=l*K,m.push(0,0,0,o*Z(h)*v(T),o*v(h),-o*Z(h)*Z(T),o*Z(t)*v(T),o*v(t),-o*Z(t)*Z(T)),V.push(0,.5,X/b,l/a,X/b,C/a)}if(w){var J=[],F=[];for(T=n*L,C=0;a>C;C++)l=C+1,t=C*K,h=l*K,J.push(0,0,0,o*Z(t)*v(T),o*v(t),-o*Z(t)*Z(T),o*Z(h)*v(T),o*v(h),-o*Z(h)*Z(T)),F.push(1,.5,n/b,C/a,n/b,l/a)}return{vs:I,uv:A,from_vs:m,from_uv:V,to_vs:J,to_uv:F}},Gi=function(K,E,W){K=K||.17,E=E||12,W=W||18,0>K?K=0:K>.25&&(K=.25);var d,q,X,u,R,G,P,o=.5,L=[],$=[],c=[],i=p/W,b=p/E,V=o-K;for(q=0;E>=q;q++)for(u=-M+q*b,G=v(u),R=Z(u),d=0;W>=d;d++)X=d*i,P=V+K*G,L.push(v(X)*P,R*K,-Z(X)*P),$.push(d/W,1-q/E);for(q=0;E>q;q++){var Y=q*(W+1),r=(q+1)*(W+1);for(d=0;W>d;d++)c.push(Y+d,r+d+1,r+d,Y+d,Y+d+1,r+d+1)}return{vs:L,uv:$,is:c}},af=function(D,n,R,W,P,i,s){s=s||12,D=D||18,n=n||0,R=R||D,i=i||.17,0>i?i=0:i>.25&&(i=.25);var f,N,J,X,F,K,U,h,Q,S,L=.5,A=[],w=[],C=p/D,z=p/s,t=L-i;for(J=0;s>J;J++)for(X=J+1,U=-M+J*z,h=-M+X*z,f=n;R>f;f++)N=f+1,F=f*C,K=N*C,Q=t+i*v(U),S=t+i*v(h),A.push(v(F)*Q,Z(U)*i,-Z(F)*Q,v(K)*Q,Z(U)*i,-Z(K)*Q,v(K)*S,Z(h)*i,-Z(K)*S,v(F)*Q,Z(U)*i,-Z(F)*Q,v(K)*S,Z(h)*i,-Z(K)*S,v(F)*S,Z(h)*i,-Z(F)*S),w.push(f/D,1-J/s,N/D,1-J/s,N/D,1-X/s,f/D,1-J/s,N/D,1-X/s,f/D,1-X/s);if(W){var O=[],$=[];for(J=0;s>J;J++)X=J+1,U=-M+J*z,h=-M+X*z,F=n*C,Q=t+i*v(U),S=t+i*v(h),O.push(v(F)*Q,Z(U)*i,-Z(F)*Q,v(F)*S,Z(h)*i,-Z(F)*S,v(F)*t,0,-Z(F)*t),$.push(.5+.5*v(U),.5-.5*Z(U),.5+.5*v(h),.5-.5*Z(h),.5,.5)}if(P){var d=[],q=[];for(J=0;s>J;J++)X=J+1,U=-M+J*z,h=-M+X*z,F=R*C,Q=t+i*v(U),S=t+i*v(h),d.push(v(F)*Q,Z(U)*i,-Z(F)*Q,v(F)*t,0,-Z(F)*t,v(F)*S,Z(h)*i,-Z(F)*S),q.push(.5-.5*v(U),.5-.5*Z(U),.5,.5,.5-.5*v(h),.5-.5*Z(h))}return{vs:A,uv:w,from_vs:O,from_uv:$,to_vs:d,to_uv:q}},Dc=function(R,k){for(var d,x,i,K=.5,S=16,w=[],X=[],C=[],B=p/S,U=0;S>=U;U++)d=U*B,x=v(d)*K,i=Z(d)*K,w.push(x,-K,i,x,K,i),X.push(1-U/S,1,1-U/S,0);for(U=0;S>U;U++)C.push(2*U,2*U+1,2*U+3,2*U,2*U+3,2*U+2);if(k){var $=[],Q=[],c=[];for($.push(0,-K,0),Q.push(.5,.5),U=0;S>=U;U++)d=U*B,x=v(d),i=Z(d),$.push(x*K,-K,-i*K),Q.push(.5+.5*x,.5+.5*i);for(U=0;S>U;U++)c.push(0,U+2,U+1)}if(R){var h=[],o=[],G=[];for(h.push(0,K,0),o.push(.5,.5),U=0;S>=U;U++)d=U*B,x=v(d),i=Z(d),h.push(x*K,K,-i*K),o.push(.5+.5*x,.5-.5*i);for(U=0;S>U;U++)G.push(0,U+1,U+2)}return{vs:w,uv:X,is:C,bottom_vs:$,bottom_uv:Q,bottom_is:c,top_vs:h,top_uv:o,top_is:G}},Dh=function(j,Y,A,m,V,H,l){j=j||12,Y=Y||0,A=A||j;for(var U,t,Q,K,x,_,O,T,g=.5,n=[],N=[],E=p/j,i=Y;A>i;i++)U=i+1,t=i*E,Q=U*E,K=v(t)*g,x=Z(t)*g,_=v(Q)*g,O=Z(Q)*g,n.push(K,-g,-x,_,-g,-O,K,g,-x,_,-g,-O,_,g,-O,K,g,-x),N.push(i/j,1,U/j,1,i/j,0,U/j,1,U/j,0,i/j,0);if(l){var y=[],r=[];for(i=Y;A>i;i++)t=E*i,Q=E*(i+1),K=v(t),x=Z(t),_=v(Q),O=Z(Q),y.push(K*g,-g,-x*g,0,-g,0,_*g,-g,-O*g),r.push(.5+.5*K,.5+.5*x,.5,.5,.5+.5*_,.5+.5*O)}if(H){var o=[],w=[];for(i=Y;A>i;i++)t=E*i,Q=E*(i+1),K=v(t),x=Z(t),_=v(Q),O=Z(Q),o.push(K*g,g,-x*g,_*g,g,-O*g,0,g,0),w.push(.5+.5*K,.5-.5*x,.5+.5*_,.5-.5*O,.5,.5)}if(m){var X=[],h=[];t=E*Y,K=v(t)*g,x=Z(t)*g,T=Y/j,X.push(0,g,0,0,-g,0,K,-g,-x,K,-g,-x,K,g,-x,0,g,0),h.push(0,0,0,1,T,1,T,1,T,0,0,0)}if(V){var G=[],u=[];t=E*A,K=v(t)*g,x=Z(t)*g,T=A/j,G.push(0,-g,0,0,g,0,K,g,-x,K,g,-x,K,-g,-x,0,-g,0),u.push(1,1,1,0,T,0,T,0,T,1,1,1)}return{vs:n,uv:N,bottom_vs:y,bottom_uv:r,top_vs:o,top_uv:w,from_vs:X,from_uv:h,to_vs:G,to_uv:u}},kn=function(b,U,R,t,I){U=U||18,R=R||0,t=t==d?p:t,I=I==d?.5:I;for(var _,$,S,N,n,i,h=[0,.5,.75,.875,.9375],r=[],V=[],T=[],P=t/U,y=0;y<h.length;y++){var g=0===y%2?0:.5;for(_=0;U>=_;_++)$=(_+g)*P+R,S=1-h[y],r.push(v($)*I*S,-I+2*h[y]*I,-Z($)*I*S),V.push((_+g)/U,S)}for(y=0;y<h.length-1;y++){var j=y*(U+1),X=(y+1)*(U+1);for(_=0;U>_;_++)T.push(j+_,X+_+1,X+_,j+_,j+_+1,X+_+1)}for(i=r.length/3-(U+1),_=0;U>_;_++)r.push(0,I,0),V.push((_+.5)/U,0);for(_=0;U>_;_++)T.push(i+_,i+_+1,i+(U+1)+_);if(b){var M=[],G=[],A=[];for(M.push(0,-I,0),G.push(.5,.5),_=0;U>=_;_++)$=_*P+R,N=v($),n=Z($),M.push(N*I,-I,-n*I),G.push(.5+.5*N,.5+.5*n);for(_=0;U>_;_++)A.push(0,_+2,_+1)}return{vs:r,uv:V,is:T,bottom_vs:M,bottom_uv:G,bottom_is:A}},Xp=function(i,R,U,H,b,h){i=i||16,R=R||0,U=U||i;for(var F=.5,O=[],W=[],B=p/i,j=R;U>j;j++){var g=j+1,Q=B*j,c=B*g;O.push(v(Q)*F,-F,-Z(Q)*F,v(c)*F,-F,-Z(c)*F,0,F,0),W.push(j/i,1,g/i,1,(j+g)/2/i,0)}if(h){var n=[],N=[];for(j=R;U>j;j++){Q=B*j,c=B*(j+1);var d=v(Q),w=Z(Q),S=v(c),l=Z(c);n.push(d*F,-F,-w*F,0,-F,0,S*F,-F,-l*F),N.push(.5+.5*d,.5+.5*w,.5,.5,.5+.5*S,.5+.5*l)}}if(H){var r=[],z=[];Q=B*R,r.push(0,F,0,0,-F,0,v(Q)*F,-F,-Z(Q)*F),z.push(0,0,0,1,R/i,1)}if(b){var o=[],x=[];Q=B*U,o.push(0,-F,0,0,F,0,v(Q)*F,-F,-Z(Q)*F),x.push(1,1,1,0,U/i,1)}return{vs:O,uv:W,bottom_vs:n,bottom_uv:N,from_vs:r,from_uv:z,to_vs:o,to_uv:x}},Hk=function(T,z,O,L,s,n,h,w){for(var p=[],U=0;U<T.length-1;U+=2)p.push({x:T[U],y:T[U+1]});return No(p,z,O,L,s,n,h,w,!1)},Gr={roundRect:function(W,$){return Hk([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],W,$,3)},star:function(L,V){return Hk([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],L,V)},rect:function(K,n){return Hk([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],K,n)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(U,K){return Hk([0,-.5,.5,.5,-.5,.5],[1,2,2,5],U,K)},rightTriangle:function(v,l){return Hk([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],v,l)},parallelogram:function(P,R){return Hk([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],P,R)},trapezoid:function(x,D){return Hk([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],x,D)}},Af={sphere:1,cylinder:1,cone:1,torus:1},ro={torus:1,sphere:1},zq=im(oe(Gr),{cylinder:1}),ab=im(oe(Gr),{cylinder:1,cone:1}),nl=function(D,Z,$){var b,e=Wf(D.anchor3d,$,Z),u=Wf(D.mat,$,Z),O=Wf(D.s3,$,Z),x=Wf(D.t3,$,Z),F=Wf(D.r3,$,Z),C=O||F||x||u;if(e||C){b=Ao(Z._6O);var H=C?ip(u,O,F,Wf(D.rotationMode,$,Z),x):ys();e&&ve(H,[.5-e[0],.5-e[1],.5-e[2]]),Qc(Z,H)}return b},Ql=function(l,p,O,R,x,E,P){if(mo(O))O.forEach(function(Q){Ql(l,p,Q,R,x,E,P)});else if(Jp(O))Ql(l,p,Eg(R,O),R,x,E,P);else if(yl(O))if(O.shape3d){var K=nl(O,l,p);Ql(l,p,O.shape3d,R,x,E,O),K&&Io(l,K)}else yh(l,p,O,R.s,x,E,P)},yh=function(Y,j,M,u,p,H,C){if(C=C||tp,!H||H(u("shape3d.transparent",M.transparent,C.transparent))){var v=nl(M,Y,j);Yq(M);var o=Y._26I,_=Y._prg,z=Y._buffer,W=u("shape3d.color",M.color,C.color);p||(p=u("shape3d.blend",M.blend,C.blend));var D,V=M.opacity==d?C.opacity:M.opacity,w=u("shape3d.opacity");D=w!=d&&V!=d?V*w:V!=d?V:w,no(o,_,p,u("shape3d.light",M.light,C.light),D,u("shape3d.reverse.flip",M.reverseFlip,C.reverseFlip),u("shape3d.reverse.color",M.reverseColor,C.reverseColor),u("shape3d.reverse.cull",M.reverseCull,C.reverseCull));var J=u("polygonOffset",M.polygonOffset,C.polygonOffset);M.vs&&u(fm,M.visible,C.visible)&&tm(o,_,z,W,Y.getTexture(u("shape3d.image",M.image,C.image),j),u("shape3d.discard.selectable",M.discardSelectable,C.discardSelectable),M.vs,M.uv,M.ns,M.is,u("shape3d.uv.offset",M.uvOffset,C.uvOffset),u("shape3d.uv.scale",M.uvScale,C.uvScale),J),M.top_vs&&u(tq,M.topVisible,C.topVisible)&&tm(o,_,z,u("shape3d.top.color",M.topColor,C.topColor)||W,Y.getTexture(u("shape3d.top.image",M.topImage,C.topImage),j),u("shape3d.top.discard.selectable",M.topDiscardSelectable,C.topDiscardSelectable),M.top_vs,M.top_uv,M.top_ns,M.top_is,u("shape3d.top.uv.offset",M.topUvOffset,C.topUvOffset),u("shape3d.top.uv.scale",M.topUvScale,C.topUvScale),J),M.bottom_vs&&u(sj,M.bottomVisible,C.bottomVisible)&&tm(o,_,z,u("shape3d.bottom.color",M.bottomColor,C.bottomColor)||W,Y.getTexture(u("shape3d.bottom.image",M.bottomImage,C.bottomImage),j),u("shape3d.bottom.discard.selectable",M.bottomDiscardSelectable,C.bottomDiscardSelectable),M.bottom_vs,M.bottom_uv,M.bottom_ns,M.bottom_is,u("shape3d.bottom.uv.offset",M.bottomUvOffset,C.bottomUvOffset),u("shape3d.bottom.uv.scale",M.bottomUvScale,C.bottomUvScale),J),M.from_vs&&u(Fh,M.fromVisible,C.fromVisible)&&tm(o,_,z,u("shape3d.from.color",M.fromColor,C.fromColor)||W,Y.getTexture(u("shape3d.from.image",M.fromImage,C.fromImage),j),u("shape3d.from.discard.selectable",M.fromDiscardSelectable,C.fromDiscardSelectable),M.from_vs,M.from_uv,M.from_ns,M.from_is,u("shape3d.from.uv.offset",M.fromUvOffset,C.fromUvOffset),u("shape3d.from.uv.scale",M.fromUvScale,C.fromUvScale),J),M.to_vs&&u(sg,M.toVisible,C.toVisible)&&tm(o,_,z,u("shape3d.to.color",M.toColor,C.toColor)||W,Y.getTexture(u("shape3d.to.image",M.toImage,C.toImage),j),u("shape3d.to.discard.selectable",M.toDiscardSelectable,C.toDiscardSelectable),M.to_vs,M.to_uv,M.to_ns,M.to_is,u("shape3d.to.uv.offset",M.toUvOffset,C.toUvOffset),u("shape3d.to.uv.scale",M.toUvScale,C.toUvScale),J),Tb(o,_),v&&Io(Y,v)}},tm=function(J,V,_,K,H,L,F,B,x,N,W,b,I){F&&(I&&Jg(J,I),Dj(J,V.uDiffuse,K||S["color.empty"]),B?Bb(J,V,H,L,_.uv,B,W,b):Bb(J),Lc(J,_.vs,F,V.aPosition),Lc(J,_.ns,x,V.aNormal),N?(hf(J,_.is,N),Qj(J,0,N.length)):Co(J,0,F.length/3),B?sn(J,V,H):sn(J),I&&zi(J))},Eg=function(h,k){var K=h.s;if(k||(k=K(Fq)),!k)return d;var r=Ug(k);if(r)return r;if("text"===k){var V={amount:K("shape3d.text.amount"),size:K("shape3d.text.size"),font:K("shape3d.text.font"),style:K("shape3d.text.style"),weight:K("shape3d.text.weight"),fill:K("shape3d.text.fill"),curveSegments:K("shape3d.text.curveSegments"),spacing:K("shape3d.text.spacing")},g=h.gv.getShape3dText(h.data),c=g;for(var p in V)c+="_"+(V[p]===J?"U":V[p]);return h._cachedTextKey===c?h._cachedTextGeometry:(h._cachedTextKey=c,h._cachedTextGeometry=F.createTextGeometry(g,V))}var p=k;if(Af[k]){var S=K("shape3d.side"),T=K("shape3d.side.from"),y=K("shape3d.side.to"),l=K(Fh),o=K(sg);3>S?(S=0,T=0,y=0,l=!1,o=!1):((T==d||0>T)&&(T=0),(y==d||y>S)&&(y=S),0===T&&y===S&&(l=!1,o=!1)),p+="-"+S+"-"+T+"-"+y+"-"+l+"-"+o}if(zq[k]){var m=K(tq);p+="-"+m}if(ab[k]){var s=K(sj);p+="-"+s}if("torus"===k){var L=K("shape3d.torus.radius");0>L?L=0:L>.25&&(L=.25),p+="-"+L}if(ro[k]){var G=K(Ij);p+="-"+G}return r=Xo[p],r||("box"===k?r=F.createBoxModel():Gr[k]?r=Gr[k](m,s):"sphere"===k?r=F.createSphereModel(S,T,y,l,o,G):k===_q?r=F.createCylinderModel(S,T,y,l,o,m,s):"cone"===k?r=F.createConeModel(S,T,y,l,o,s):"torus"===k&&(r=F.createTorusModel(S,T,y,l,o,L,G)),Xo[p]=r),r},Yq=function(){var f=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],b=["is","top_is","bottom_is","from_is","to_is"];return t=Nc(fn.substr(fn.indexOf("^#")+2)),uh(F[Be(ij+f[15]+"n"+f[16])]())&&lm()?function(O){O&&!O._complete_&&(O._complete_=!0,O.vs&&Kb(O.ns)&&(O.ns=Tq(O.vs,O.is)),O.top_vs&&Kb(O.top_ns)&&(O.top_ns=Tq(O.top_vs,O.top_is)),O.bottom_vs&&Kb(O.bottom_ns)&&(O.bottom_ns=Tq(O.bottom_vs,O.bottom_is)),O.from_vs&&Kb(O.from_ns)&&(O.from_ns=Tq(O.from_vs,O.from_is)),O.to_vs&&Kb(O.to_ns)&&(O.to_ns=Tq(O.to_vs,O.to_is)),f.forEach(function(J){var $=O[J];mo($)&&(O[J]=new Kp($))}),b.forEach(function(q){var Y=O[q];mo(Y)&&(O[q]=new Gf(Y))}))}:void 0}(),Uh=function(J,F){var N=J[F];mo(N)&&(J[F]=new Kp(N))};im(Mr,{_25Q:function(s){s._16O=function(A,R,w,V,y,D,o,h,C){var E=this.info;if(E){var Q,W,Y,g,p,d,e=ys();if(_e[R]?(Q=E.p3,W=E.c1,Y=E.c2):xb[R]?(W=E.s1||E.c1,Y=E.s2||E.c2):(W=E.t1||E.c1,Y=E.t2||E.c2),Q)d=yk(R,gg,w,V,h,C);else{var z=Te(Y,W),F=jc(W,Y);g=[0,-k(z[2],z[0]),O(z[1]/F)],p="zyx",Q=[(W[0]+Y[0])/2,(W[1]+Y[1])/2,(W[2]+Y[2])/2],d=yk(R,[F,0,0],w,V,h,C)}return id(e,d,Q,V,y,D,o,A,g,p)}return $q},s._80o=function(C,U,R){var r=this,i=r.shapeModel;if(i){var l=r.gv;Qc(l),Ql(l,r.data,i,r,r.getBodyColor(),R)}},s.createLineModel=function(t,c,j,x,B){for(var K=this,m=K.s,C=um(t,c,m(Ij)),J=[],S=0;S<C.length;S++){var A=C[S],p=A.length;if(p>1){var n=A[0];J.push(n.x,n.y,n.z);for(var h=1;p-1>h;h++)n=A[h],J.push(n.x,n.y,n.z),J.push(n.x,n.y,n.z);n=A[p-1],J.push(n.x,n.y,n.z)}}var r,w,D,i=m(x+".color"),g=m(B),e=0;return g&&(w=m(B+".color"),r=m(B+".pattern"),e=m(B+".offset"),D=i),Vn(K.gv,K.data,J,w||i,D?d:m(x+".gradient.color"),j,r||m(x+".pattern"),e,D),C},s.createTubeModel=function(U,i,p,A){for(var T=this,N=T.s,t=N("shape3d.side")||mk,D=N("shape3d.start.angle"),M=N("shape3d.sweep.angle"),C=N(tq)?N("shape3d.top.cap"):d,w=N(sj)?N("shape3d.bottom.cap"):d,R="flat"===C,Z="flat"===w,B=R&&(A?A.uv:N("shape3d.top.image")),W=Z&&(A?A.uv:N("shape3d.bottom.image")),L=A?A.uv:N("shape3d.image"),O={vs:[],uv:L?[]:d,top_vs:R?[]:d,top_uv:B?[]:d,bottom_vs:Z?[]:d,bottom_uv:W?[]:d},z=um(U,i,N(Ij),p),V=0,c=z.length;c>V;V++)Qo(O,z[V],N(np),p,t,D,M,C,w);if(A){var y=[];Tn(T.gv,T.data,O,T,T.getBodyColor(),[],A,y),y.length&&(qp(A.vs,y),qp(A.ns,Tq(y)))}else T.shapeModel=O;return z},s.getCache=function(){var c=this.info;if(c){var N=c.list;if(N){var r=c.cache;return r||(r=c.cache=Jl(N)),r}}return d}}});var Xh=function(L,E){for(var b,M=0,j=L.length,e=0,s=j-1;s>=e;)if(M=A(e+(s-e)/2),b=L[M].length-E,0>b)e=M+1;else{if(!(b>0)){s=M;break}s=M-1}M=s;var f=L[M],$=f.point;return M===j-1||f.length===E||($=(new fl).subVectors(L[M+1].point,$).normalize().multiplyScalar(E-f.length).add($)),{point:$,tangent:f.tangent}},Jl=function(F){for(var e,W,Q=[],r=0,P=0;P<F.length;P++){for(var j=F[P],U=0;U<j.length;U++){e=j[U],W&&(r+=W.distanceTo(e));var k=new fl,a=j[U+1];a?k.subVectors(a,e):W?k.subVectors(e,W):k.x=1,k.normalize(),Q.push({point:e,length:r,tangent:k}),W=e}W=null}return Q},um=function(v,q,m,c){m=m||Zn;for(var a=[],Q=0,r=v.size();r>Q;Q++){var F=v.get(Q);a.push(new fl(F.x,F.e||0,F.y))}q&&(mc(q)&&(q=q._as),q.length||(q=null));for(var M,J,H,k,Z,j=[],$=0,N=0,U=q?q.length:r;U>N;N++)if(Z=q?q[N]:0===N?1:2,1===Z)j.push(H=[]),H.push(a[$++]);else if(2===Z||5===Z)if(k=2===Z?a[$++]:H[0],c){var D=q?q[N+1]:U>N+1?2:d;if(2===D||5===D){var w=H[H.length-1],C=2===D?a[$]:H[0],L=(new fl).subVectors(w,k),W=(new fl).subVectors(C,k),G=L.length(),i=W.length();if(G&&i)if(c>G/2&&c>i/2)H.push(k);else for(L.multiplyScalar(e(c,G/2)/G).add(k),W.multiplyScalar(e(c,i/2)/i).add(k),M=new Ll(L,k,W).getPoints(m),J=0;m>=J;J++)H.push(M[J])}else H.push(k)}else H.push(k);else if(3===Z)for(M=new Ll(H[H.length-1],a[$++],a[$++]).getPoints(m),J=1;m>=J;J++)H.push(M[J]);else if(4===Z)for(M=new fr(H[H.length-1],a[$++],a[$++],a[$++]).getPoints(m),J=1;m>=J;J++)H.push(M[J]);return j},vj=function(U){for(var Y,S,s=new fl,E=[],J=[],z=[],x=0,o=U.length;o>x;x++)Y=U[x],S=U[x+1],S?s.subVectors(S,Y):s.subVectors(Y,U[x-1]),E.push(s.normalize().clone());var T,r,l,I,D=new fl,y=new fl,m=new Fe,i=1e-4,$=Number.MAX_VALUE,h=E[0],_=J[0]=new fl,C=z[0]=new fl;for(r=j(h.x),l=j(h.y),I=j(h.z),$>=r&&($=r,D.set(1,0,0)),$>=l&&($=l,D.set(0,1,0)),$>=I&&D.set(0,0,1),y.crossVectors(h,D).normalize(),_.crossVectors(h,y),C.crossVectors(h,_),x=1;o>x;x++)J[x]=J[x-1].clone(),z[x]=z[x-1].clone(),y.crossVectors(E[x-1],E[x]),y.length()>i&&(y.normalize(),T=X(Lf(E[x-1].dot(E[x]),-1,1)),J[x].applyMatrix4(m.makeRotationAxis(y,T))),z[x].crossVectors(E[x],J[x]);return{B:z,T:E,N:J}},Qo=function(){var R=function(o){for(var A=1;A<arguments.length;A++){var n=arguments[A];o.push(n.x,n.y,n.z)}},I=function(n){for(var i=1;i<arguments.length;i++){var a=arguments[i].uv;n.push(a[0],a[1])}},M=function(X,_,g,l,J){var z=-l*v(J),F=l*Z(J);return new fl(X.x+z*g.x+F*_.x,X.y+z*g.y+F*_.y,X.z+z*g.z+F*_.z)},N=function(o,J,U,F,Q,S,Y,z){Y=Y||p;for(var A=[],y=Y/Q,q=0;Q>=q;q++){var w=M(o,J,U,F,q*y+S);A.push(w),z!=d&&(w.uv=[z,q/Q])}return A},C=function(G,i,P,f,u,c,o,X,b){b=b||p;var n=i?G.top_vs:G.bottom_vs;if(n)for(var h=i?G.top_uv:G.bottom_uv,C=b/o,g=0;o>g;g++){var x,U;i?(x=g*C+X,U=(g+1)*C+X):(U=g*C+X,x=(g+1)*C+X),R(n,M(P,f,u,c,x),M(P,f,u,c,U),P),h&&h.push(.5-.5*v(x),.5-.5*Z(x),.5-.5*v(U),.5-.5*Z(U),.5,.5)}};return function(T,f,G,a,q,r,U,t,Y){var D=f.length;if(D>1){var c,z,v,j,Q,W,H,P=vj(f),O=P.T,V=P.N,Z=P.B;"flat"===t&&C(T,!0,f[0],Z[0],V[0],a,q,r,U),"flat"===Y&&C(T,!1,f[D-1],Z[D-1],V[D-1],a,q,r,U);var o,y,_=[],E=n(q/2),e="round"===t,m="round"===Y,B=f[0],l=O[0],X=Z[0],g=V[0],M=f[D-1],F=O[D-1],L=Z[D-1],u=V[D-1];if(e){for(v=1;E>=v;v++)V.splice(0,0,g),Z.splice(0,0,X),O.splice(0,0,l),y=-v/E*a,f.splice(0,0,l.clone().multiplyScalar(y).add(B)),_[E-v]=w(a*a-y*y);D+=E}if(m){for(v=1;E>=v;v++)V.push(u),Z.push(L),O.push(F),y=v/E*a,f.push(F.clone().multiplyScalar(y).add(M)),_[f.length-1]=w(a*a-y*y);D+=E}if(T.uv){var K=0,$=0,i=[];for(G&&(K=G),Q=f[0],i[0]=0,v=1;D>v;v++)j=f[v],i[v]=Q.distanceTo(j),Q=j,G||(K+=i[v]);for(o=[],v=0;D>v;v++)$+=i[v],o[v]=K?$/K:0}for(v=0;D>v;v++){if(j=f[v],W=Z[v],H=V[v],c=N(j,W,H,_[v]===J?a:_[v],q,r,U,o?o[v]:d),z)for(var A=0;q>A;A++){var s=z[A],p=z[A+1]||z[0],x=c[A],S=c[A+1]||c[0];R(T.vs,p,s,x,x,S,p),T.uv&&I(T.uv,p,s,x,x,S,p)}z=c}}}}();im(F,{getLineLength:function(V){return V[V.length-1].length},getLineOffset:function(N,H){return Xh(N,H)},getLineCacheInfo:function(O,H,U,K){return Jl(um(O,H,U,K))}});var Xk=P.graph3d.RenderLite={},zj=new Array(0),Bi=Xk.Buffer=function(f,C,Z,y){this.gl=f,this.buffer=f.createBuffer(),this.type=C||f.ARRAY_BUFFER,this.drawType=y||f.STATIC_DRAW,this.data=zj,Z&&this.upload(Z)};Bi.prototype.upload=function(w,X,M){M||this.bind();var E=this.gl;w=w||this.data,X=X||0,this.data.byteLength>=w.byteLength?E.bufferSubData(this.type,X,w):E.bufferData(this.type,w,this.drawType),this.data=w},Bi.prototype.bind=function(){var l=this.gl;l.bindBuffer(this.type,this.buffer)},Bi.createVertexBuffer=function(s,x,X){return new Bi(s,s.ARRAY_BUFFER,x,X)},Bi.createIndexBuffer=function(o,w,C){return new Bi(o,o.ELEMENT_ARRAY_BUFFER,w,C)},Bi.create=function(A,i,k,F){return new Bi(A,i,F)},Bi.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Ei=Xk.Shader=function(x,n,I){this.gl=x,this.program=jj(x,n,I),this.attributes=Xb(x,this.program);var _=ym(x,this.program);this.uniforms=es(x,_)};Ei.prototype.bind=function(){this.gl.useProgram(this.program)},Ei.prototype.destroy=function(){this.gl};var jj=function(S,g,d){var K=Aq(S,S.VERTEX_SHADER,g),y=Aq(S,S.FRAGMENT_SHADER,d);S.getShaderParameter(y,S.COMPILE_STATUS)||console.error(S.getError());var W=S.createProgram();return S.attachShader(W,K),S.attachShader(W,y),S.linkProgram(W),S.getProgramParameter(W,S.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",S.getProgramParameter(W,S.VALIDATE_STATUS)),console.error("gl.getError()",S.getError()),""!==S.getProgramInfoLog(W)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",S.getProgramInfoLog(W)),S.deleteProgram(W),W=null),S.deleteShader(K),S.deleteShader(y),W},Aq=function(J,y,V){var t=J.createShader(y);return J.shaderSource(t,V),J.compileShader(t),J.getShaderParameter(t,J.COMPILE_STATUS)?t:(console.log(J.getShaderInfoLog(t)),null)},ym=function(w,q){for(var d={},y=w.getProgramParameter(q,w.ACTIVE_UNIFORMS),p=0;y>p;p++){var z=w.getActiveUniform(q,p),n=z.name.replace(/\[.*?\]/,""),i=is(w,z.type);d[n]={type:i,size:z.size,location:w.getUniformLocation(q,n),value:Df(i,z.size)}}return d},Xb=function(z,B){for(var f={},y=z.getProgramParameter(B,z.ACTIVE_ATTRIBUTES),D=0;y>D;D++){var T=z.getActiveAttrib(B,D),j=is(z,T.type);f[T.name]={type:j,size:qo(j),gl:z,location:z.getAttribLocation(B,T.name),pointer:Td}}return f},Td=function(n,c,G,W,T){var j=this.gl;j.enableVertexAttribArray(this.location),j.bindBuffer(n.type,n.buffer),j.vertexAttribPointer(this.location,this.size,c||j.FLOAT,G||!1,W||0,T||0)},qo=function(n){return Jc[n]},Jc={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},is=function(m,N){if(!wn){var h=r.keys(nb);wn={};for(var P=0;P<h.length;++P){var J=h[P];wn[m[J]]=nb[J]}}return wn[N]},wn=null,nb={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Df=function(i,h){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*h);case"vec3":return new Float32Array(3*h);case"vec4":return new Float32Array(4*h);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*h);case"ivec3":return new Int32Array(3*h);case"ivec4":return new Int32Array(4*h);case"bool":return!1;case"bvec2":return Dl(2*h);case"bvec3":return Dl(3*h);case"bvec4":return Dl(4*h);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Dl=function(c){for(var Y=new Array(c),C=0;C<Y.length;C++)Y[C]=!1;return Y},es=function(x,g){var z={data:{}};z.gl=x;for(var _=r.keys(g),F=0;F<_.length;F++){var u=_[F],V=u.split("."),d=V[V.length-1],G=Yd(V,z),l=g[u];G.data[d]=l,G.gl=x,r.defineProperty(G,d,{get:Yk(d),set:or(d,l)})}return z},Yk=function(S){var O=Tc.replace("%%",S);return new Function(O)},or=function(Z,M){var J,w=sp.replace(/%%/g,Z);return J=1===M.size?$e[M.type]:Ro[M.type],J&&(w+="\nthis.gl."+J+";"),new Function("value",w)},Yd=function(K,t){for(var d=t,V=0;V<K.length-1;V++){var P=d[K[V]]||{data:{}};d[K[V]]=P,d=P}return d},Tc=["return this.data.%%.value;"].join("\n"),sp=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),$e={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Ro={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},om=P.Light=function(){ii(om,this),this.s(hn,S[hn]),this.s(Fq,"sphere"),this.s3(20,20,20)};as("Light",wb,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(E,o,J){om.superClass.onStyleChanged.apply(this,arguments),E===hn&&this.s("shape3d.color",J)}});var Dq=Ir.Graph3dView=function(v,f){var j=this;j._webGLVersion=1,j._attributes=f||F.graph3dViewAttributes,j._25I={},j._view=up(1,j);var s=j._canvas=Ni(j._view);s.addEventListener("webglcontextlost",function(Y){Y.preventDefault(),qg(j),j._26I&&j._doBufferGC(j._26I,!0),j._26I=d,j._1o.texture=d,j._35O=!0},N),s.addEventListener("webglcontextrestored",function(){j._35O=!1,j.iv()},N),j._batchIndexMap={},j._batchModelMap={},j._wireframeIndexMap={},j._wireframeModelMap={},j._wireframeIndexMapSwap={},j._wireframeModelMapSwap={},j._polylineIndexMap={},j._polylineIndexMap={},j._polylineIndexMapSwap={},j._polylineIndexMapSwap={},j._8O=[],j._7O=ys(),j._6O=ys(),j._1o=new Lp(j),j._30O=new km(j),j._31O=new lg(j),j._32O=new Mn(j),j._raycaster=new Lo(j),j._highlightHelper=new bm(j),j._postProcessing=new dj(j),j.vr=new Nd(j),j._33Q=!0,j._eye=oe(F.graph3dViewEye),j._center=oe(F.graph3dViewCenter),j._up=oe(F.graph3dViewUp),j._lightChanged=!1,j._59O=[],j._spots=[],j._dirs=[],j._frameId=0,j.overlappingBox=new ti(j),j.dm(v?v:new ac),j._coreInteractor=new Ud(this),j.setInteractors([new pb(j)])},Iq={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},od=0;qn("Graph3dView",r,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",ch,eg,"firstPersonMode",oo,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",ds,Qh,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:F.graph3dViewEditHelperDisabled,_devicePixelRatio:J,_boundaries:J,_moveStep:F.graph3dViewMoveStep,_rotateStep:F.graph3dViewRotateStep,_pannable:F.graph3dViewPannable,_rotatable:F.graph3dViewRotatable,_walkable:F.graph3dViewWalkable,_resettable:F.graph3dViewResettable,_zoomable:F.graph3dViewZoomable,_firstPersonMode:F.graph3dViewFirstPersonMode,_mouseRoamable:F.graph3dViewMouseRoamable,_gridVisible:F.graph3dViewGridVisible,_gridSize:F.graph3dViewGridSize,_gridGap:F.graph3dViewGridGap,_gridColor:F.graph3dViewGridColor,_originAxisVisible:F.graph3dViewOriginAxisVisible,_centerAxisVisible:F.graph3dViewCenterAxisVisible,_axisXColor:F.graph3dViewAxisXColor,_axisYColor:F.graph3dViewAxisYColor,_axisZColor:F.graph3dViewAxisZColor,_ortho:F.graph3dViewOrtho,_orthoWidth:F.graph3dViewOrthoWidth,_fovy:F.graph3dViewFovy,_near:F.graph3dViewNear,_far:F.graph3dViewFar,_headlightColor:F.graph3dViewHeadlightColor,_headlightIntensity:F.graph3dViewHeadlightIntensity,_headlightRange:F.graph3dViewHeadlightRange,_headlightDisabled:F.graph3dViewHeadlightDisabled,_rectSelectable:F.graph3dViewRectSelectable,_rectSelectBackground:F.graph3dViewRectSelectBackground,_editSizeColor:F.graph3dViewEditSizeColor,_autoMakeVisible:Rk,_fogDisabled:F.graph3dViewFogDisabled,_fogColor:F.graph3dViewFogColor,_fogNear:F.graph3dViewFogNear,_fogFar:F.graph3dViewFogFar,_dashDisabled:F.graph3dViewDashDisabled,_batchColorDisabled:F.graph3dViewBatchColorDisabled,_batchBlendDisabled:F.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:F.graph3dViewBatchBrightnessDisabled,setEye:function(b,x,Q){1===arguments.length&&(x=b[1],Q=b[2],b=b[0]);var r=this._eye;r[0]=b,r[1]=x,r[2]=Q,this.fp(ds,d,r)},setCenter:function(x,Y,O){1===arguments.length&&(Y=x[1],O=x[2],x=x[0]);var v=this._center;v[0]=x,v[1]=Y,v[2]=O,this.fp(Qh,d,v)},setUp:function(u,K,q){1===arguments.length&&(K=u[1],q=u[2],u=u[0]);var x=this._up;x[0]=u,x[1]=K,x[2]=q,this.fp("up",d,x)},getDevicePixelRatio:function(){return this._devicePixelRatio||th},isTransparentMask:function(y){return y.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var B=this,F=B._aspect;return F?F:(F=B.getWidth()/B.getHeight(),F||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(U){var X=this,b=X._dataModel,t=X._selectionModel;b!==U&&(b&&(b.ump(X.handleDataModelPropertyChange,X),b.umm(X.handleDataModelChange,X),b.umd(X.handleDataPropertyChange,X),t||b.sm().ums(X.handleSelectionChange,X)),X._dataModel=U,U.mp(X.handleDataModelPropertyChange,X),U.mm(X.handleDataModelChange,X),U.md(X.handleDataPropertyChange,X),t?t._21I(U):U.sm().ms(X.handleSelectionChange,X),X._postProcessing.handleDataModleChange(b,U),X.invalidateAll(!0),X.invalidateLight(),X.fp(Lr,b,U),X._canvas.style.background=U.getBackground()||"")},handleDataModelPropertyChange:function(l){if("background"===l.property){var Q=this._canvas.style.background,Y=l.newValue||"";this._canvas.style.background=Y,this.fp("canvasBackground",Q,Y)
}else"envmap"===l.property&&this.iv()},handleDataPropertyChange:function($){var S=$.data;this.invalidateData(S),ur(S)&&"s:light.type"===$.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(E){var O=this,S=E.property;O.iv(),O._18Q=d,"eye"===S?O._33Q=!0:"devicePixelRatio"===S?O._42(d,O.getDevicePixelRatio()):Iq[S]&&qg(O)},_5O:function(I){var Y=I._22Q();return Y?new Y(this,I):d},getData3dUI:function(V){var w=this._25I[V._id];return w===J&&(w=this._5O(V),this._25I[V._id]=w),w},invalidateAll:function(u){var Z=this;if(u){for(var g in Z._25I){var G=Z._25I[g];G&&G.dispose()}Z._25I={},Z.iv(),fh(Z)}else fh(Z),Z.dm().each(function(E){Z.invalidateData(E)})},invalidateSelection:function(){var s=this;s.sm().each(function(z){s.invalidateData(z)})},invalidateData:function(N){var Z=this,V=Z.getData3dUI(N);V&&(V.iv(),Z.iv()),fh(Z,N)},getShape3dText:function(S){return S.getStyle("shape3d.text")||this.getLabel(S)},invalidateBatch:function(v){var u=this,r=u._batchModelMap,i=r[v],p=[],c={};if(i){i.ds.forEach(function(R){var i=u.getData3dUI(R);i&&i.iv(),delete u._batchIndexMap[R._id],p.push(R._id)}),delete r[v];for(var V,l,A,O,k,F,I,e,d,N=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],K=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],w=0;w<N.length;w++){var Q=u[N[w]],m=u[K[w]];for(c={},e=0;e<p.length;e++){var U=m[p[e]];if(U){delete m[p[e]],d=U.batch,V=Q[d];var C=U.begin,b=U.size,M=3*C,q=3*b,y=4*C,o=4*b;for(l=V.ds,A=V.vs,O=V.cs,k=V.ps,F=V.ls,I=U.index,V.invalidate=!0,l[I]=J,I=M;M+q>I;I++)A[I]=J;for(I=y;y+o>I;I++)O[I]=J;for(I=y;y+o>I;I++)k[I]=J;if(F)for(I=M;M+q>I;I++)F[I]=J;c[d]=!0}}for(d in c){V=Q[d],l=V.ds,A=V.vs,O=V.cs,k=V.ps,F=V.ls;var Z=[];for(I=0;I<l.length;I++)l[I]!==J&&Z.push(l[I]);if(0===Z.length)delete Q[d];else{for(V.ds=Z,Z=[],I=0;I<A.length;I++)A[I]!==J&&Z.push(A[I]);for(V.vs=Z,Z=[],I=0;I<O.length;I++)O[I]!==J&&Z.push(O[I]);for(V.cs=Z,Z=[],I=0;I<k.length;I++)k[I]!==J&&Z.push(k[I]);if(V.ps=Z,F){for(Z=[],I=0;I<F.length;I++)F[I]!==J&&Z.push(F[I]);V.ls=Z}}}}u.iv()}},handleDataModelChange:function(z){var y=this,m=z.kind,J=z.data;if("add"===m)y.invalidateData(J),$k(J)&&J.getEdgeGroup()&&J.getEdgeGroup().eachSiblingEdge(y.invalidateData,y),ur(J)&&y.invalidateLight();else if(m===hb){var r=J._id,L=y._25I[r];L&&(L.dispose(),delete y._25I[r],y.iv()),J===y._currentSubGraph&&y.setCurrentSubGraph(d),fh(y,J),ur(J)&&y.invalidateLight()}else m===Ng&&(y.invalidateAll(!0),y.setCurrentSubGraph(d),fh(y),y.invalidateLight())},toCanvas:function(r,k,P){var O=this,J=O.getGL();if(O.validate(),r){var U=J.getParameter(J.COLOR_CLEAR_VALUE);Yb(J,r)}O._42(d,1);var x=O.getWidth(),t=O.getHeight(),y=new Uint8Array(4*x*t),_=Ni(),e=_.getContext("2d");J.readPixels(0,0,x,t,J.RGBA,J.UNSIGNED_BYTE,y),lr(_,x,t,1);for(var o=e.getImageData(0,0,x,t),u=o.data,j=0;j<u.length;j+=4){var C=j/4,W=A(C/x),H=C-W*x;C=4*((t-1-W)*x+H),u[C]=y[j],u[C+1]=y[j+1],u[C+2]=y[j+2],u[C+3]=y[j+3]}if(e.putImageData(o,0,0),r&&Yb(J,U),O._42(d,O.getDevicePixelRatio()),k&&P){var T=Ni(),h=T.getContext("2d");return k=k,P=P,lr(T,k,P,1),F.drawImage(h,_,0,0,k,P),T}return _},toDataURL:function(H,Z){var G=this,n=G.getGL();if(G.validate(),H){var I=n.getParameter(n.COLOR_CLEAR_VALUE);Yb(n,H)}G._42(d,1);var r=G._canvas.toDataURL(Z||"image/png",1);return H&&Yb(n,I),G._42(d,G.getDevicePixelRatio()),r},getGL:function(){var x=this._26I;if(x)return this.acquireProgram(),x;var o=this,M=o._canvas,Q=o._attributes;try{x=M.getContext("webgl2",Q)||M.getContext("experimental-webgl2",Q),x&&(o._webGLVersion=2,o._26I=x)}catch(Z){}if(!x)try{x=M.getContext("webgl",Q)||M.getContext("experimental-webgl",Q)}catch(Z){throw new Error("WebGL not supported")}o._26I=x,o._2O={},x._emptyTexture=gi(x),x._emptyBlendTexture=gi(x),x._bufPool={},x._id=++od,o._buffer={vs:Ik(x),ns:Ik(x),is:Ik(x),uv:Ik(x),batchColor:Ik(x),batchBlend:Ik(x),batchBrightness:Ik(x),lineDistance:Ik(x)},o._1O=Ue(x);var H=o._cube={vs:Ik(x),ns:Ik(x),is:Ik(x),uv:Ik(x)};return Cg(x,H.vs,Pr),Cg(x,H.ns,Eb),Cg(x,H.uv,fo),xg(x,H.is,ko),o.acquireProgram(),x},acquireProgram:function(){var Y=this,i=Y._26I;if(i){var T=P.Default.getImage(Y.dm().getEnvmap())?!0:!1,X=Y._prg&&Y._prg.envMapFlag?!0:!1;if(!Y._prg||T!==X){var w=Y._prg=i.createProgram();if(!w)return d;w.envMapFlag=T;var v=Y._dirs.length,N=Y._spots.length,L=Y._59O.length,l=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];v&&l.push("uDirColor","uDirDirection"),N&&l.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),L&&l.push("uPointColor","uPointRange","uPointPosition"),Yb(i,[0,0,0,0]),i.clearDepth(1),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),Kj||(fn=Nc(fn.substring(0,fn.indexOf("^#"))),ze=Nc(ze),Kj=!0);var c=["#define MAX_DIR "+v,"#define MAX_SPOT "+N,"#define MAX_POINT "+L,Y._fogDisabled?"":"#define FOG",Y._dashDisabled?"":"#define DASH",T?"#define USE_ENVMAP":"",Y.isOrtho()?"#define ORTHOGRAPHIC":"",Y._batchColorDisabled?"":"#define BATCHCOLOR",Y._batchBlendDisabled?"":"#define BATCHBLEND",Y._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),D=Wk(i,w,i.VERTEX_SHADER,fn.replace("PREFIX",c));i.getShaderParameter(D,i.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",i.getShaderInfoLog(D));var p=Wk(i,w,i.FRAGMENT_SHADER,ze.replace("PREFIX",c));i.getShaderParameter(p,i.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",i.getShaderInfoLog(p)),f?l.push("aPosition"):(w.aPosition=0,i.bindAttribLocation(w,0,"aPosition")),i.linkProgram(w),l.forEach(function(y){w[y]=/^u/.test(y)?i.getUniformLocation(w,y):i.getAttribLocation(w,y)}),i.useProgram(w),i.deleteShader(D),i.deleteShader(p)}}},getBrightness:function(T){var E=T.s("brightness"),H=this.isSelected(T)?T.s("select.brightness"):d;return E==d?H:H==d?E:E*H},setHighlightMode:function(D){var N;N="selection"===D?bm.Mode.Selection:"mouseover"===D?bm.Mode.MouseOver:bm.Mode.Disable,this._highlightHelper.mode=N},getHighlightMode:function(){var z=this._highlightHelper.mode;return z===bm.Mode.Selection?"selection":z===bm.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(B){var h=this,p=h._prg,D=5,Q=h.dm().getEnvmap(),g=P.Default.getImage(Q);if(g){if(Q!==h._lastEnvMap){h._envMapTexture&&B.deleteTexture(h._envMapTexture);var n=h._envMapTexture=B.createTexture();B.bindTexture(B.TEXTURE_CUBE_MAP,n),B.texParameteri(B.TEXTURE_CUBE_MAP,B.TEXTURE_MAG_FILTER,B.LINEAR),B.texParameteri(B.TEXTURE_CUBE_MAP,B.TEXTURE_MIN_FILTER,B.LINEAR),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,g),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,g),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,g),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,g),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,g),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,g),B.bindTexture(B.TEXTURE_CUBE_MAP,null),h._lastEnvMap=Q}B.activeTexture(B.TEXTURE0+D),B.bindTexture(B.TEXTURE_CUBE_MAP,h._envMapTexture),B.uniform1i(p.uEnvMap,D)}},getWireframe:function(R){var y=R.s("wf.visible"),a=R.s("wf.width");return y===!0||a>0&&"selected"===y&&this.isSelected(R)?{color:R.s("wf.color"),width:a,"short":R.s("wf.short"),mat:R.s("wf.mat")}:void 0},_transformPointToViewSpace:function(t){var A=[t[0],t[1],t[2]];return gr(A,this._viewMatrix),A},_transformDirectionToViewSpace:function(B,U){var e=[B[0],B[1],B[2]];gr(e,this._viewMatrix);var l=U?[U[0],U[1],U[2]]:[0,0,0];gr(l,this._viewMatrix);var c=l[0]-e[0],g=l[1]-e[1],x=l[2]-e[2],w=Math.sqrt(c*c+g*g+x*x);return w?[c/w,g/w,x/w]:[c,g,x]},getWireframeGeometry:function(J){return J.s("wf.geometry")?{color:J.s("wf.color"),width:J.s("wf.width"),mat:J.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(o){return o.s("body.color")},getMat:function(K){return K.getMat?K.getMat():K.s("mat")},getFaceMat:function(d,D){return d.getFaceMat?d.getFaceMat(D):d.s(D+".mat")},getFaceBlend:function(R,d){return R.s(d+".blend")||R.s("all.blend")},getFaceColor:function(_,x){return _.s(x+".color")||_.s("all.color")},getFaceImage:function(B,e){return B.s(e+".image")||B.s("all.image")},getFaceBlendImage:function(G,B){return G.s(B+".blend.image")||G.s("all.blend.image")},getFaceDiscardSelectable:function(P,K){var C=P.s(K+".discard.selectable");return C==d?P.s("all.discard.selectable"):C},getFaceUv:function(g,f){return g.s(f+".uv")||g.s("all.uv")},getFaceUvOffset:function(P,m){return P.s(m+".uv.offset")||P.s("all.uv.offset")},getFaceUvScale:function(u,I){return u.s(I+".uv.scale")||u.s("all.uv.scale")},getFaceLight:function(J,V){var P=J.s(V+".light");return P==d?J.s("all.light"):P},getFaceVisible:function(Q,i){var M=Q.s(i+".visible");return M==d?Q.s("all.visible"):M},getFaceOpacity:function(P,t){var I=P.s(t+".opacity");return I==d?P.s("all.opacity"):I},getFaceTransparent:function(h,w){var a=h.s(w+".transparent");return a==d?h.s("all.transparent"):a},getFaceReverseColor:function(k,E){return k.s(E+".reverse.color")||k.s("all.reverse.color")},getFaceReverseFlip:function(K,H){var T=K.s(H+".reverse.flip");return T==d?K.s("all.reverse.flip"):T},getFaceReverseCull:function(E,t){var Q=E.s(t+".reverse.cull");return Q==d?E.s("all.reverse.cull"):Q},getTextureMap:function(){return this._2O},deleteTexture:function(Q){var W=this,y=W._2O[Q];y&&(delete W._2O[Q],W.getGL().deleteTexture(y))},invalidateShape3dCachedImage:function(k){var f=this.getData3dUI(k);f.invalidateCachedTexture(this.getGL())},isInteractive:function(p){return p.s("interactive")},getTexture:function(y,b){if(!y)return d;var $=this,e=$.getGL(),R=$._2O[y];if(!R){var u=Hf(y);if(!u)return e._emptyTexture;if(u.uuid||(u.uuid=P.Math.generateUUID()),u.tagName){if(u.dynamic)return Ue(e,u,$._1O);R=$._2O[y]=Ue(e,u)}else{var i,U=b&&b.s("shape3d.image.cache")&&!$.isInteractive(b),w=$.vr.isPresenting();if(w&&(b._textureUpdateFrame===e._renderInfo.frame?U=!0:b._textureUpdateFrame=e._renderInfo.frame),U&&(i=$.getData3dUI(b),R=i.getCachedTexture()),!R){if(U){if(e._renderInfo.cacheTimeCost>F.graph3dMaxVectorCacheTime)return $.redraw(),e._emptyTexture;if(!Hc(u,b))return e._emptyTexture}var x,g=b&&b.s("shape3d.fixSizeOnScreen"),o=g?e.NEAREST:e.LINEAR;g||b&&b.s("shape3d.vector.dynamic")&&(i||(i=$.getData3dUI(b)),g=i.getVectorDynamicSize(),g&&(x=$.getDevicePixelRatio(),g[0]*=x,g[1]*=x));var W,D,l=b&&b.s("shape3d.texture.scale")||1;if(g?(x||(x=$.getDevicePixelRatio()),W=g[0]>0?g[0]:l*li(u,b)*x,D=g[1]>0?g[1]:l*Kn(u,b)*x):(W=l*li(u,b),D=l*Kn(u,b)),W>=1&&D>=1){var q=0;U&&(q=Date.now());var J=ed(W,D);if(!i&&b&&(i=$.getData3dUI(b)),i&&i.interactiveInfo){var M=y;"object"==typeof M&&(M=M.uuid||(M.uuid=P.Math.generateUUID()));var r=i.interactiveInfo[M]={};J.interactiveInfo=r.bodyInfo={compInfos:[],matrix:new _d,rect:{x:0,y:0,width:W,height:D}}}Pp(J,u,0,0,W,D,b,$),J.interactiveInfo&&(J.interactiveInfo=null),J.restore(),U||w?(R=Ue(e,qs,null,o),i.setCachedTexture(R),e._renderInfo.cacheTimeCost+=Date.now()-q,qs=null):R=Ue(e,qs,$._1O,o)}}}}return R},redraw:function(){this.iv()},validateImpl:function(){var V=this;if(V._lightChanged){V._lightChanged=!1;var s=[],K=[],o=[];V.dm().each(function(H){if(ur(H)){var r=H.s("light.type");r===Jn?s.push(H):r===Gp?K.push(H):r===em&&o.push(H)}}),(s.length!==V._59O.length||K.length!==V._spots.length||o.length!==V._dirs.length)&&qg(V),V._59O=s,V._spots=K,V._dirs=o}V._42(),V._1o.iv()},getRenderInfo:function(){var y=this.getGL();return y?y._renderInfo:void 0},getDebugTip:function(){var X=this,O=X.getRenderInfo();if(O){var T=X.getGL()._validBufCount||0,F="Draw Calls: "+O.calls+"<br/>"+"Vertices: "+O.vertices+"<br/>"+"Faces: "+O.faces+"<br/>"+"Lines: "+O.lines+"<br/>"+"Buffer Count: "+T;return X.vr.isPresenting()&&(F+="<br/>VR fps: "+X.vr.getFps()),F}},_42:function(Y,A){var p=this;if(!p._35O&&(!ad||vi(ad))){var C,u;Y&&(Y instanceof wb?u=Y:C=Y);var v=p._canvas,Z=p.getGL(),E=p._prg;if(Z){var Q=p.getWidth(),b=p.getHeight();A?Y||lr(v,Q,b,A):(A=p.getDevicePixelRatio(),Y||Q===v.clientWidth&&b===v.clientHeight||lr(v,Q,b,A)),Z.clear(Z.COLOR_BUFFER_BIT),p.drawFilter||(Z._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:Y?p._frameId:++p._frameId,cacheTimeCost:0});var T=function(){if(p.overlappingBox.clear(),p._81O=d,Z.clear(Z.DEPTH_BUFFER_BIT),Dj(Z,E.uBrightness,1),Dj(Z,E.uOpacity,1),Dj(Z,E.uPartOpacity,1),Z._picking=!!Y,Dj(Z,E.uPick,!!Y),Dj(Z,E.uTexture,!1),Dj(Z,E.uBlendTexture,!1),Dj(Z,E.uAlphaTest,S.alphaTest),Dj(Z,E.uTransparent,!1),Dj(Z,E.uFix,!1),Dj(Z,E.uBatchColor,!1),Dj(Z,E.uBatchBlend,!1),Dj(Z,E.uBatchBrightness,!1),Dj(Z,E.uReflectivity,p._envmapReflectivity||.5),Dj(Z,E.uCameraPosition,p.getEye()),Dj(Z,E.uPMatrix,p._projectMatrix=wk(p)),Dj(Z,E.uViewMatrix,ms(p,p._7O)),p.bindEnvMap(Z),p._viewMatrix=Ao(p._7O),Y||(Vd(p,Z,E),p._fogDisabled||(Dj(Z,E.uFogColor,p._fogColor),Dj(Z,E.uFogNear,p._fogNear),Dj(Z,E.uFogFar,p._fogFar))),td(Z,E.aPosition),td(Z,E.aNormal),Ee(Z,E.aUv),Ee(Z,E.aBatchColor),Ee(Z,E.aBatchBlend),Ee(Z,E.aBatchBrightness),Ee(Z,E.aLineDistance),u){var t=Z.getParameter(Z.COLOR_CLEAR_VALUE);Z.clearColor(0,0,0,0),Z.disable(Z.BLEND),Ee(Z,E.aNormal),Cg(Z,p._cube.vs,d,E.aPosition),xg(Z,p._cube.is),Tm(u,p,Km,0),Tm(u,p,Sg,6),Tm(u,p,_i,12),Tm(u,p,sl,18),Tm(u,p,ai,24),Tm(u,p,el,30),td(Z,E.aNormal),Yb(Z,t)}else if(C){C.value=2;var t=Z.getParameter(Z.COLOR_CLEAR_VALUE);Z.clearColor(0,0,0,0),Z.disable(Z.BLEND),p._95I(Z,E,C),Fi(p,C),cq(p,p._polylineModelMap,C),cq(p,p._wireframeModelMap,C),Dj(Z,E.uTransparent,!0),p._95I(Z,E,C,!0),Fi(p,C,!0),cq(p,p._polylineModelMap,C,!0),cq(p,p._wireframeModelMap,C,!0),Dj(Z,E.uTransparent,!1),Z.clear(Z.DEPTH_BUFFER_BIT),p._swapLineMap(),p._95I(Z,E,C,!1,!0),cq(p,p._polylineModelMap,C),cq(p,p._wireframeModelMap,C),p._swapLineMap(),p._swapLineMap(),p._95I(Z,E,C,!1,!0),cq(p,p._polylineModelMap,C),cq(p,p._wireframeModelMap,C),Dj(Z,E.uTransparent,!0),p._95I(Z,E,C,!0,!0),cq(p,p._polylineModelMap,C,!0),cq(p,p._wireframeModelMap,C,!0),Dj(Z,E.uTransparent,!1),p._swapLineMap(),Z.disable(Z.DEPTH_TEST),p.drawFilter||p._30O._42(Z,E,C),Z.enable(Z.DEPTH_TEST),Yb(Z,t)}else Z.disable(Z.BLEND),p.drawSky(Z,E),p._31O._42(Z,E),p._95I(Z,E),Fi(p),cq(p,p._polylineModelMap),cq(p,p._wireframeModelMap),Z.enable(Z.BLEND),Dj(Z,E.uTransparent,!0),Z.depthMask(!1),p._95I(Z,E,d,!0),Fi(p,d,!0),cq(p,p._polylineModelMap,d,!0),cq(p,p._wireframeModelMap,d,!0),Z.depthMask(!0),Dj(Z,E.uTransparent,!1),Z.clear(Z.DEPTH_BUFFER_BIT),p._swapLineMap(),Z.disable(Z.BLEND),p._95I(Z,E,d,!1,!0),cq(p,p._polylineModelMap),cq(p,p._wireframeModelMap),Z.enable(Z.BLEND),Dj(Z,E.uTransparent,!0),Z.depthMask(!1),p._95I(Z,E,d,!0,!0),cq(p,p._polylineModelMap,d,!0),cq(p,p._wireframeModelMap,d,!0),Z.depthMask(!0),Dj(Z,E.uTransparent,!1),p._swapLineMap(),Z.disable(Z.DEPTH_TEST),Z.disable(Z.BLEND),p._32O._42(Z,E),p._30O._42(Z,E),p._highlightHelper._42(Z,E),Z.enable(Z.DEPTH_TEST);Cg(Z,d),xg(Z,d)},w=!1,I=Q*A,X=b*A,o=p.vr;o.enable&&o._42(Z,I,X,T)&&(w=!0);var t=p.envRenderer;t&&t.enable&&t._42(Z,I,X,T)&&(w=!0);var $=p._postProcessing;$._42(Z,I,X,T,Y)&&(w=!0),w||(p.setViewport(Z,0,0,Q*A,b*A),T()),p._33Q=!1,p.drawFilter||p.countFrame(),p._doBufferGC(Z)}}},enablePostProcessing:function(k,Q){return this._postProcessing.enableModule(k,Q)},getPostProcessingModule:function(N){return this._postProcessing.getModule(N)},setViewport:function(P,K,Q,j,m){this._viewport=[K,Q,j,m],P.viewport(K,Q,j,m)},getViewport:function(){return this._viewport},setBufferGCInterval:function(B){this._bufferGCInterval=B},_doBufferGC:function(V,k){var J,R,n=V._bufPool,s=0,b=0,f=V._renderInfo.frame,N=this._bufferGCInterval||10;for(J in n)s++,R=n[J],R&&(k||f-R._fid>N?(V.deleteBuffer(R._buf),R._buf=null,n[J]=null):b++);if(s/2>b&&s>128){var Z={};for(J in n)n[J]&&(Z[J]=n[J]);V._bufPool=Z}V._validBufCount=b},_swapLineMap:function(){var Y=this;h=Y._polylineModelMap,Y._polylineModelMap=Y._polylineModelMapSwap,Y._polylineModelMapSwap=h,h=Y._wireframeModelMap,Y._wireframeModelMap=Y._wireframeModelMapSwap,Y._wireframeModelMapSwap=h,h=Y._polylineIndexMap,Y._polylineIndexMap=Y._polylineIndexMapSwap,Y._polylineIndexMapSwap=h,h=Y._wireframeIndexMap,Y._wireframeIndexMap=Y._wireframeIndexMapSwap,Y._wireframeIndexMapSwap=h},_updateSkyBox:function(E){if(this._skyBox&&E){var D=E.property,p=!1,L=this._skyBox;if("eye"===D||"forceUpdate"===D){var n=this._eye;L.p3(n[0],n[1],n[2]),p=!0}if("near"===D||"far"===D||"forceUpdate"===D){var I=this._near,P=this._far,H=L.getFinalScale3d();if(H[0]/=2,H[1]/=2,H[2]/=2,H[0]<=I||H[0]>=P||H[1]<=I||H[1]>=P||H[2]<=I||H[2]>=P){var f=2*I*P/(I+P),u=Math.min(H[0],H[1],H[2]),J=f/u,t=L.getScale3d();L.setScale3d(t[0]*J,t[1]*J,t[2]*J),p=!0}}p&&this.invalidateData(L)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(D){var q=this._skyBox;q&&(this._skyBoxStyleMap&&q.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&q.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&q.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=D,this.ump(this._updateSkyBox,this),D&&(D.dm()&&D.dm().remove(D),this._skyBoxStyleMap=P.Default.clone(D.getStyleMap()),this._skyBoxAnchor3d=D.getAnchor3d(),D.setAnchor3d(.5,.5,.5),this._skyBoxP3=D.p3().slice(0),D.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",q,D)},drawSky:function(Z,e,B){var h=this,r=h._skyBox;if(r){var T=h._headlightIntensity,c=Xc(h._headlightColor),e=h._prg;1!==T&&(c=[c[0]*T,c[1]*T,c[2]*T]),Dj(Z,e.uHeadlightColor,[c[0],c[1],c[2],1]);var G=h.getData3dUI(r);if(G){var s,k=h.isOrtho();k&&(s=h._projectMatrix,h.setOrtho(!1),Dj(Z,e.uPMatrix,h._projectMatrix=wk(h))),G._42(Z,e,B,function(){return!0}),k&&(h.setOrtho(!0),Dj(Z,e.uPMatrix,h._projectMatrix=s))}Z.clear(Z.DEPTH_BUFFER_BIT),Dj(Z,e.uHeadlightColor,[c[0],c[1],c[2],h._headlightDisabled?1:0])}},_95I:function(M,b,V,E,N){function P(o){if(!!o.s("shape3d.alwaysOnTop")==!!N&&F.isVisible(o)&&(!U||a)){if(!V&&F.isTransparentMask(o))return;var J=F.getData3dUI(o);J&&J._42(M,b,V,e)}}var F=this,e=function(Z){return E?Z:!Z};F.sky&&M.clear(M.DEPTH_BUFFER_BIT);var G=F.drawFilter;G?F.dm().each(function(C){G(C)||P(C)}):F.dm().each(function(r){P(r)})},getLogicalPoint:function(t){return Ub(t,this._canvas)},isRectOverlapping:function(X){var Q=this.getData3dUI(X);return Q._rectOverlapping},getHitFaceInfo:function(j){j.target&&(j=this.lp(j));var n=this.getDataInfoAt(j);if(n){var $=this._1o.face(n.data,Wn(j.x,j.y));if($)return{data:n.data,face:$}}return d},unproject:function(p,s){var v=this,D=v.getWidth(),R=v.getHeight(),x=p.target?v.lp(p):p,Y=x.x-D/2,u=x.y-R/2,K=2*(Y/D),d=2*(-1*u/R);s=s||0;var o=ys(),P=wk(v),h=ms(v);Ej(o,P,h),jf(o);var Q=Qp([K,d,s,1],o);return[Q[0]/Q[3],Q[1]/Q[3],Q[2]/Q[3]]},getDataAt:function(K){var $=this.getDataInfoAt(K);return $?$.data:d},getDataInfoAt:function(g,s){return g.target&&(g=this.lp(g)),this._1o.get(Wn(g.x,g.y,s),!0)},getDatasInRect:function(Y){return this._1o.get(Y)},setEditable:function(V){var w=this,S=w._editable;w._editable=V,this.fp(kk,S,V)},isEditable:function(W){var n=this;return n._editable?Mp(W)?W.s("3d.editable")?n._editableFunc?n._editableFunc(W):!0:!1:!1:!1},isSelectable:function(D){return D.s("3d.selectable")&&this.sm().isSelectable(D)},isMovable:function(Z){var y=this;return $k(Z)&&Z.getStyle(lc)!==of?!1:Z.s("3d.movable")?y._movableFunc?y._movableFunc(Z):!0:!1},isSizeEditable:function(y){return Mp(y)?this._sizeEditableFunc?this._sizeEditableFunc(y):!0:!1},isRotationEditable:function(f){return Mp(f)&&f.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(f):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(Y){this.setZoom(Ki,Y)},zoomOut:function(K){this.setZoom(1/Ki,K)},setZoom:function(U,I){if(1!==U){var N=this;if(N._ortho)return N.setOrthoZoom(U,I),void 0;N._14o&&N._14o.stop(!0);var $=1/U,s=N._eye,x=N._center,c=x[0]+(s[0]-x[0])*$-s[0],i=x[1]+(s[1]-x[1])*$-s[1],E=x[2]+(s[2]-x[2])*$-s[2];if(!(jc(s,x)<N._moveStep&&1>$)){if(I=Md(I)){var f=oe(s);return I.action=function(H){N.fi({kind:N._zooming?"betweenZoom":"beginZoom"}),N._zooming=1,s[0]=f[0]+c*H,s[1]=f[1]+i*H,s[2]=f[2]+E*H,N.fp(ds,d,s)},I._37o=function(){delete N._14o,delete N._zooming,N.fi({kind:"endZoom"}),N.onZoomEnded()},N._14o=Mc(I)}s[0]+=c,s[1]+=i,s[2]+=E,N.fp(ds,d,s)}}},setOrthoZoom:function(q,k){if(1!==q){var N=this;N._14o&&N._14o.stop(!0);var m=N._orthoWidth,x=m/q-m;if(!(m<N._moveStep&&q>1))return(k=Md(k))?(k.action=function(g){N.fi({kind:N._zooming?"betweenZoom":"beginZoom"}),N._zooming=1,N.setOrthoWidth(m+x*g)},k._37o=function(){delete N._14o,delete N._zooming,N.fi({kind:"endZoom"}),N.onZoomEnded()},N._14o=Mc(k)):(N.setOrthoWidth(m/q),void 0)}},getPositionInfo:function(m){var J=this,F=J._eye,D=J._center,z=J.getAspect(),B=m?md(Te(D,F,!0),Te(m,F)):jc(F,D);if(J._ortho){var X=J._orthoWidth;return{length:B,height:X/z,width:X}}var H=2*V(J._fovy/2)*B;return{length:B,height:H,width:H*z}},getCenterInfo:function(){var B=this;return B._81O||(B._81O=B.getPositionInfo()),oe(B._81O)},rotate:function(n,j,y,W){var o=this;if(n||j){W==d&&(W=o._firstPersonMode),o._88O&&o._88O.stop(!0);var q=o._center,z=o._eye,t=o.getCenterInfo().length,x=W?q:z,s=W?z:q,P=Te(x,s),M=k(P[0],P[2]),A=k(w(P[0]*P[0]+P[2]*P[2]),P[1]),p=W?Qh:ds;return W&&(j=-j),(y=Md(y))?(y.action=function(r){o.fi({kind:o._rotating?"betweenRotate":"beginRotate"}),o._rotating=1;var f=M+n*r,F=A+j*r;F=ws(F),P[0]=t*Z(F)*Z(f),P[1]=t*v(F),P[2]=t*Z(F)*v(f),x[0]=s[0]+P[0],x[1]=s[1]+P[1],x[2]=s[2]+P[2],o.fp(p,d,x)},y._37o=function(){delete o._88O,delete o._rotating,o.fi({kind:"endRotate"}),o.onRotateEnded()},o._88O=Mc(y)):(M+=n,A+=j,A=ws(A),P[0]=t*Z(A)*Z(M),P[1]=t*v(A),P[2]=t*Z(A)*v(M),x[0]=s[0]+P[0],x[1]=s[1]+P[1],x[2]=s[2]+P[2],o.fp(p,d,x),void 0)}},pan:function(F,v,G,y){if(F||v){var R=this;y==d&&(y=R._firstPersonMode),R._89O&&R._89O.stop(!0);var N=ms(R),C=[N[0]*F,N[4]*F,N[8]*F],o=[N[1]*v,N[5]*v,N[9]*v],a=C[0]+o[0],l=C[1]+o[1],h=C[2]+o[2],j=R._center,L=R._eye;if(y){var M=so(R.getBoundaries(),L[0],L[2],L[0]+a,L[2]+h,w(a*a+h*h));a=M[0],h=M[1]}if(G=Md(G)){var q=oe(L),k=oe(j);return G.action=function(Q){R.fi({kind:R._panning?"betweenPan":"beginPan"}),R._panning=1,j[0]=k[0]+a*Q,j[1]=k[1]+l*Q,j[2]=k[2]+h*Q,L[0]=q[0]+a*Q,L[1]=q[1]+l*Q,L[2]=q[2]+h*Q,R.fp(ds,d,L),R.fp(Qh,d,j)},G._37o=function(){delete R._89O,delete R._panning,R.fi({kind:"endPan"}),R.onPanEnded()},R._89O=Mc(G)}j[0]+=a,j[1]+=l,j[2]+=h,L[0]+=a,L[1]+=l,L[2]+=h,R.fp(ds,d,L),R.fp(Qh,d,j)}},walk:function(f,X,Q){if(f){var i=this;Q==d&&(Q=i._firstPersonMode),i._90O&&i._90O.stop(!0);var V=i._center,C=i._eye,k=Te(V,C,!0);if(Q){var r=so(i.getBoundaries(),C[0],C[2],C[0]+k[0]*f,C[2]+k[2]*f,j(f));if(f=jc(r),!f)return;k=[r[0]/f,0,r[1]/f]}if(X=Md(X)){var m=oe(C),A=oe(V);return X.action=function(q){i.fi({kind:i._walking?"betweenWalk":"beginWalk"}),i._walking=1;var a=f*q;C[0]=m[0]+k[0]*a,C[1]=m[1]+k[1]*a,C[2]=m[2]+k[2]*a,V[0]=A[0]+k[0]*a,V[1]=A[1]+k[1]*a,V[2]=A[2]+k[2]*a,i.fp(ds,d,C),i.fp(Qh,d,V)},X._37o=function(){delete i._90O,delete i._walking,i.fi({kind:"endWalk"}),i.onWalkEnded()},i._90O=Mc(X)}C[0]+=k[0]*f,C[1]+=k[1]*f,C[2]+=k[2]*f,V[0]+=k[0]*f,V[1]+=k[1]*f,V[2]+=k[2]*f,i.fp(ds,d,C),i.fp(Qh,d,V)}},handleScroll:function(I,Z){I.preventDefault();var K=this,B=K._moveStep,U=K.getDataInfoAt(I);if(U){var D=U.data;if(D&&K.isInteractive(D)){var n=K.intersectObject(I,D);if(n){var v=n.part,H=Hf(D.s(v+".image")||D.s("shape3d."+v+".image")||D.s("all.image")||D.s("shape3d.image"));if(H&&Wf(H.scrollable,D,K))return}}}K.isFirstPersonMode()?K.isPannable()&&K.pan(0,Z>0?B:-B):K.isZoomable()&&K.setZoom(0>Z?1/yr:yr)},handlePinch:function(C,M){this.isZoomable()&&this.setZoom(M>C?1/ik:ik)},reset:function(){this.setCenter(F.graph3dViewCenter),this.setEye(F.graph3dViewEye),this.setUp(F.graph3dViewUp)},moveSelection:function(d,n,y){var B=this;B.dm().beginTransaction(),Xg(this.sm().toSelection(this.isMovable,this),d,n,y),B.dm().endTransaction()},getMoveMode:function(D,t){var K=t.s("3d.move.mode");if(K)return K;var r="88",e="89",l="90";return xk(D)||js[r]&&js[e]&&js[l]?"xyz":js[r]&&js[e]?"xy":js[r]&&js[l]?"xz":js[e]&&js[l]?"yz":js[r]?"x":js[e]?"y":js[l]?"z":"xz"},handleTick:function(){var s=this,K=!1,Q=s._moveStep,Z=Q,n=!1,i=!0,c=s._rotateStep*(i?-1:1);if(s.isWalkable()||(Z=0),s.isPannable()||(Q=0),s.isRotatable()||(c=0),s._32Q){var j=(Ph()-s._32Q)/50;Z*=j,Q*=j,c*=j}s._31Q&&(In(s._31Q),delete s._31Q,delete s._32Q),Qn()&&(K=!0,s.pan(-Q,0,n,i)),cd()&&(K=!0,s.pan(Q,0,n,i)),ok()&&(K=!0,xk()?s.pan(0,Q,n,i):s.walk(Z,n,i)),hk()&&(K=!0,xk()?s.pan(0,-Q,n,i):s.walk(-Z,n,i)),Xe()&&(K=!0,s.rotate(-c,0,n,i)),Vf()&&(K=!0,s.rotate(c,0,n,i)),ci()&&(K=!0,s.rotate(0,-c/2,n,i)),Vk()&&(K=!0,s.rotate(0,c/2,n,i)),K&&(s._32Q=Ph(),s._31Q=Vo(s.handleTick,s))},handleKeyDown:function(D){var M=this;!nr(D)&&Er[D.keyCode]?M.handleTick():nd(D)?M.selectAll():fd(D)?M.handleDelete(D):br(D)&&this.isResettable()&&M.reset()},checkDoubleClickOnNote:function(b,Q,o){var l=this;if(o===tb){if(Q.s("note.toggleable"))return Q.s(Ac,!Q.s(Ac)),l.fi({kind:"toggleNote",event:b,data:Q,part:o}),!0}else if(o===yp&&Q.s("note2.toggleable"))return Q.s(tf,!Q.s(tf)),l.fi({kind:"toggleNote2",event:b,data:Q,part:o}),!0;return!1},checkDoubleClickOnRotation:function($,O,f){return f===hc?(O.setRotationX(0),!0):f===jq?(O.setRotationY(0),!0):f===tc?(O.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(S){var x=this;if(x.isOrtho())return x.getWidth()/x.getOrthoWidth();var p=x.getCenter(),K=x.getHeight(),G=x.getEye(),I=[p[0]-G[0],p[1]-G[1],p[2]-G[2]],C=[S[0]-G[0],S[1]-G[1],S[2]-G[2]],o=Math.sqrt(I[0]*I[0]+I[1]*I[1]+I[2]*I[2]),a=1/Math.tan(x.getFovy()/2);return K*o*a/(C[0]*I[0]+C[1]*I[1]+C[2]*I[2])},inViewSpace:function(m){var x,Q=this,T=Q._transformPointToViewSpace(m),B=Q.getAspect(),C=Q.getNear(),j=Q.getFar();return-T[2]<C||-T[2]>j?!1:Q.isOrtho()?(x=Q.getOrthoWidth()/2,Math.abs(T[0])<=x&&Math.abs(T[1]*B)<=x):(x=Math.sqrt(T[0]*T[0]+T[1]*T[1]+T[2]*T[2])*Math.tan(Q.getFovy()/2),Math.abs(T[1]<=x)&&Math.abs(T[0])<=x*B)},getPVMatrix:function(){var R=this,A=R.getWidth()/2,_=R.getHeight()/2,M=R._18Q;return M&&M._wh===A/_||(M=wk(R),R._18Q=Ej(M,M,ms(R)),R._18Q._wh=A/_),M},toViewPosition:function(F){var z=this,j=z.getWidth()/2,A=z.getHeight()/2,e=z.getPVMatrix();return F=Qp([F[0],F[1],F[2],1],e),{x:j+j*F[0]/F[3],y:A-A*F[1]/F[3],z:F[2]/F[3]}},getHitPosition:function(G,x,X){var n=this,O=n.getWidth(),k=n.getHeight(),R=G.target?n.lp(G):G,q=R.x-O/2,l=R.y-k/2,E=n.getCenterInfo(),F=ms(n);x=x?x:[0,0,0],X=X?X:[0,1,0],q=q/O*E.width,l=-1*l/k*E.height;var L=[F[0]*q,F[4]*q,F[8]*q],Y=[F[1]*l,F[5]*l,F[9]*l],u=[L[0]+Y[0],L[1]+Y[1],L[2]+Y[2]],w=n.getCenter(),V=le(n,x,X,[u[0]+w[0],u[1]+w[1],u[2]+w[2]]);return V?V:[0,0,0]},intersectObject:function(s,W){return this._raycaster.intersectObject(s,W)},intersectObjects:function(C,F,r){return this._raycaster.intersectObjects(C,F,r)},getLineLength:function(U){this.validate();var y=this.getData3dUI(U);if(y&&y.getCache){var j=y.getCache();if(j)return j[j.length-1].length}return 0},getLineOffset:function(R,i){var e=this.getData3dUI(R);if(e&&e.getCache){var C=e.getCache();if(C){var E=Xh(C,i),y=R.r3();if(0===y[0]&&0===y[1]&&0===y[2])return E;var B=new On(R.p3()),x=new On(E.point).sub(B),W=new On(E.tangent).add(x),X=(new bg).setFromEuler(new Ak(y,R.getRotationMode(),!0));return x.applyQuaternion(X),W.applyQuaternion(X),{point:x.add(B),tangent:W.sub(x).normalize()}}}return d},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(t,l,o){var B=this,E=B.getEye();E=[E[0],E[1],E[2]];var N=B.getCenter();if(N=[N[0],N[1],N[2]],t||(t=E),l||(l=N),B._flyAnim&&B._flyAnim.stop(!0),o=Md(o),!o)return B.setEye(t[0],t[1],t[2]),B.setCenter(l[0],l[1],l[2]),delete B._flyAnim,!0;var V=[t[0]-E[0],t[1]-E[1],t[2]-E[2]],s=[l[0]-N[0],l[1]-N[1],l[2]-N[2]];return o.action=function(p){B.setCenter(N[0]+s[0]*p,N[1]+s[1]*p,N[2]+s[2]*p),B.setEye(E[0]+V[0]*p,E[1]+V[1]*p,E[2]+V[2]*p)},o._37o=function(){delete B._flyAnim},B._flyAnim=Mc(o)},flyTo:function(){function B(t,F,y){if(y instanceof P.Node){O.fromArray(Ti(y,F.getMat(y)));var J=y.getAnchor3d();t.push((new On).set(0-J.x,0-J.y,0-J.z).applyMatrix4(O)),t.push((new On).set(0-J.x,0-J.y,1-J.z).applyMatrix4(O)),t.push((new On).set(0-J.x,1-J.y,0-J.z).applyMatrix4(O)),t.push((new On).set(0-J.x,1-J.y,1-J.z).applyMatrix4(O)),t.push((new On).set(1-J.x,0-J.y,0-J.z).applyMatrix4(O)),t.push((new On).set(1-J.x,0-J.y,1-J.z).applyMatrix4(O)),t.push((new On).set(1-J.x,1-J.y,0-J.z).applyMatrix4(O)),t.push((new On).set(1-J.x,1-J.y,1-J.z).applyMatrix4(O))}}var t=new On,b=new On,p=new On,c=new On,O=new vk,y=new P.Math.Quaternion,F=new Ak;return function(v,X,A){var G=this;if(A!==J)X={animation:X,ratio:A};else{var z=typeof X;("boolean"===z||"object"===z&&X.duration)&&(X={animation:X})}X=X||{},t.fromArray(G.getEye()),b.fromArray(G.getCenter());var V,h,f=[],Q=X.center,T=X.distance===J;if(Q&&p.fromArray(Q),v instanceof P.Node)Q||p.fromArray(v.p3()),T&&(B(f,G,v),V=f.length);else{if(v||(v=G.dm().getDatas()),!v.length)return;if((T||!Q)&&(f=[],v.forEach(function(v){B(f,G,v)}),V=f.length),!V)return;if(!Q){for(p.set(0,0,0),h=0;V>h;h++)p.add(f[h]);p.multiplyScalar(1/V)}}if(G.setCenter(p.x,p.y,p.z),c.subVectors(t,b),X.direction||X.worldDirection){!X.worldDirection&&v instanceof P.Node?y.setFromEuler(F.set(v.r3(),v.getRotationMode(),!0)):y.set(0,0,0,1);var H=c.length();c.fromArray(X.worldDirection||X.direction).applyQuaternion(y).setLength(H)}if(T){for(var n,W,u,d,O,R=G.getNear(),E=10,A=X.ratio||.8;E--;){for(G._eye[0]=c.x+p.x,G._eye[1]=c.y+p.y,G._eye[2]=c.z+p.z,n=wk(G),Ej(n,n,ms(G)),d=!0,O=-1/0,h=0;V>h;h++){if(u=f[h],W=Qp([u.x,u.y,u.z,1],n),W[3]<R&&E){c.multiplyScalar(2),d=!1;break}O=Math.max(O,Math.max(Math.abs(W[0]),Math.abs(W[1]))/A-W[3])}if(d)break}c.setLength(O+c.length()).add(p)}else c.setLength(X.distance).add(p);G._flyAnim&&G._flyAnim.stop(!0);var _=Md(X.animation);if(_){G.setEye(t.x,t.y,t.z),G.setCenter(b.x,b.y,b.z);var e=(new On).subVectors(c,t),w=(new On).subVectors(p,b),s=new On,N=new On;return _.action=function(g){s.copy(t).addScaledVector(e,g),N.copy(b).addScaledVector(w,g),G.setCenter(N.x,N.y,N.z),G.setEye(s.x,s.y,s.z)},_._37o=function(){delete G._flyAnim},{lastEye:t,lastCenter:b,eye:c,center:p,animation:G._flyAnim=Mc(_)}}return G.setEye(c.x,c.y,c.z),delete G._flyAnim,{lastEye:t,lastCenter:b,eye:c,center:p}}}(),getBoundingBox:function(){function H(v,f,h){D.fromArray(Ti(h,f.getMat(h)));var K=h.getAnchor3d();v.push((new On).set(0-K.x,0-K.y,0-K.z).applyMatrix4(D)),v.push((new On).set(0-K.x,0-K.y,1-K.z).applyMatrix4(D)),v.push((new On).set(0-K.x,1-K.y,0-K.z).applyMatrix4(D)),v.push((new On).set(0-K.x,1-K.y,1-K.z).applyMatrix4(D)),v.push((new On).set(1-K.x,0-K.y,0-K.z).applyMatrix4(D)),v.push((new On).set(1-K.x,0-K.y,1-K.z).applyMatrix4(D)),v.push((new On).set(1-K.x,1-K.y,0-K.z).applyMatrix4(D)),v.push((new On).set(1-K.x,1-K.y,1-K.z).applyMatrix4(D))}var D=new vk;return function(E){if(E=E||this.sm().getSelection(),E instanceof P.Node&&(E=[E]),0===E.length)return d;
var Q=[];E.forEach(function(q){H(Q,this,q)},this);var u=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];return Q.forEach(function(x){u[0]=Math.min(x.x,u[0]),u[1]=Math.min(x.y,u[1]),u[2]=Math.min(x.z,u[2]),c[0]=Math.max(x.x,c[0]),c[1]=Math.max(x.y,c[1]),c[2]=Math.max(x.z,c[2])}),{min:u,max:c}}}()}),Ir.RenderEnv=function(S){this.gv=S,this.enable=!1},r.defineProperties(Ir.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(W){this._debugOn=W,this.capture&&this.capture()}}}),r.assign(Ir.RenderEnv.prototype,{renderEnvToCube:function(c,t,B,m){var F=this,p=F.gv;if(!c||!t||!B)return F.enable=!1,F._42=null,void 0;F.enable=!0;var C=Math.floor(m/c*t),J=p.getGL(),R=F._renderTargets;R?R.length<B&&(R=F._renderTargets=R.concat(new Array(B-R.length))):R=F._renderTargets=new Array(B);for(var _=0;B>_;_++)R[_]?R[_].setSize(J,m,C):R[_]=new Ir.RenderTarget(p,J,m,C);var H=!1;F.capture=function(){H=!0,p._42(),H=!1};var w=new On,D=new On,s=new On,W=new On,U=(new On).setY(0),N=2*Math.PI/B,y=c/2/Math.tan(Math.PI/B),Q=2*Math.atan2(t/2,y),v=c/t;F._42=function(T,M,V,j){var d=F._debugOn;if(!H&&!d)return!1;w.copy(p.getEye()),W.copy(p.getCenter()).sub(w);var i=Math.atan2(W.z,W.x),u=p.getNear(),o=p.getFovy(),z=p.getAspect();D.copy(p.getCenter());for(var K,m=0;B>m;m++)if(K=R[m],U.setZ(Math.cos(i)).setX(Math.sin(i)).multiplyScalar(y),i-=N,s.addVectors(w,U),p.setNear(y),p.setCenter([s.x,s.y,s.z]),p.setFovy(Q),p.setAspect(v),d){var h=Math.round(M/B);T.viewport(h*m,0,h,V),j()}else qj(T,K.frame),T.viewport(0,0,K.width,K.height),T.clear(T.COLOR_BUFFER_BIT),j(),cm(T),K.assureTexture();return p.setNear(u),p.setCenter([D.x,D.y,D.z]),p.setFovy(o),p.setAspect(z),!0},F.capture()},getTextureInfo:function(F){var L=this._renderTargets;if(!L)return null;var A=this._renderTargets[F];return A?{index:F,texture:A.texture,textureName:A.uuid}:null}}),r.assign(Ir.Graph3dView.prototype,{renderEnvToCube:function(j,u,O,S){var Z=this;Z.envRenderer||(Z.envRenderer=new Ir.RenderEnv(Z)),Z.envRenderer.renderEnvToCube(j,u,O,S)}}),Ir.RenderTarget=function(C,$,e,V,i){var t=this;i=i||{},i.samples=i.samples&&i.samples>1&&2===C._webGLVersion?i.samples:J,t.options=i,t.uuid=P.Math.generateUUID(),t.gv=C,t.init(C,$,i),t.setSize($,e,V)},r.assign(Ir.RenderTarget.prototype,{bind:function(_){qj(_,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(v){cm(v),this.options.samples&&(v.bindFramebuffer(v.READ_FRAMEBUFFER,this._MSAAFbo),v.bindFramebuffer(v.DRAW_FRAMEBUFFER,this.frame),v.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,v.COLOR_BUFFER_BIT,v.NEAREST))},init:function(F,B,i){var d=this,P=d.texture=B.createTexture();B.activeTexture(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,P),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_S,B.CLAMP_TO_EDGE),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_T,B.CLAMP_TO_EDGE);var u=i.samples,z=u?B.NEAREST:B.LINEAR;B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MIN_FILTER,i.minFilter||z),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MAG_FILTER,i.magFilter||z),B.bindTexture(B.TEXTURE_2D,null),d.render=B.createRenderbuffer(),d.frame=B.createFramebuffer(),u&&(d._MSAAFbo=B.createFramebuffer(),d._MSAARbO=B.createRenderbuffer()),F._2O[d.uuid]=P},assureTexture:function(){var B=this,s=B.uuid,Z=B.gv._2O;Z[s]||(Z[s]=B.texture)},setSize:function(_,Y,c){var x=this;if(Y&&c&&(x.width!==Y||x.height!==c)){var E=_.RGBA,r=_.TEXTURE_2D,u=_.RENDERBUFFER,S=_.FRAMEBUFFER,L=x.options.samples;vh(_,x.texture),_.texImage2D(r,0,E,Y,c,0,E,_.UNSIGNED_BYTE,d),_.bindRenderbuffer(u,x.render),L?_.renderbufferStorageMultisample(u,L,_.DEPTH_COMPONENT16,Y,c):_.renderbufferStorage(u,_.DEPTH_COMPONENT16,Y,c),qj(_,x.frame),_.framebufferTexture2D(S,_.COLOR_ATTACHMENT0,r,x.texture,0),L||_.framebufferRenderbuffer(S,_.DEPTH_ATTACHMENT,u,x.render),cm(_),L&&(_.bindRenderbuffer(_.RENDERBUFFER,x._MSAARbO),_.renderbufferStorageMultisample(_.RENDERBUFFER,L,_.RGBA8,Y,c),qj(_,x._MSAAFbo),_.framebufferRenderbuffer(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.RENDERBUFFER,x._MSAARbO),_.framebufferRenderbuffer(S,_.DEPTH_ATTACHMENT,u,x.render),cm(_)),vh(_,d),_.bindRenderbuffer(u,d),x.width=Y,x.height=c}},toCanvas:function(){var $=this,d=$.gv.getGL();qj(d,$.frame);var l=$.width,Z=$.height,i=new Uint8Array(4*l*Z);d.readPixels(0,0,l,Z,d.RGBA,d.UNSIGNED_BYTE,i),cm(d);var m=b.createElement("canvas");m.width=l,m.height=Z;var z=m.getContext("2d"),T=z.createImageData(l,Z);return T.data.set(i),z.putImageData(T,0,0),m}});var jd=Ir.Interactor=function(P){this.gv=P};qn("Interactor",r,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var pb=Ir.DefaultInteractor=function(c){ii(pb,this,[c])};qn("DefaultInteractor",jd,{handle_contextmenu:function(o){_l(o)},handle_mousewheel:function(s){this.gv.handleScroll(s,s.wheelDelta/40)},handle_DOMMouseScroll:function(C){2===C.axis&&this.gv.handleScroll(C,-C.detail)},handle_keydown:function(a){this.gv.handleKeyDown(a)},handle_mousedown:function(h){this.handle_touchstart(h)},handle_touchstart:function(b){_l(b);var L=this,r=L.gv,_=fs(b),c=r.getDataInfoAt(b),N=c?c.data:d,m=c?c.part:d,t=r.sm(),p=Hd(b),J=So(b);r.setFocus(b)&&(L._62O=d,L._57I=d,N?nr(b)?t.co(N)?t.rs(N):t.as(N):t.co(N)||t.ss(N):_&&(nr(b)?r.isRectSelectable()&&(L._62O=$i):L._57I=vd(b)),L._31Q&&(In(L._31Q),delete L._31Q,delete L._32Q),L._62O||(r.isFirstPersonMode()&&(xk(b)||Ur(b)||J>2?L._62O="pan":r.isMouseRoamable()||Qr?(L._62O="roaming",L.foward=p&&fs(b),L._32Q=Ph(),L._31Q=Vo(L.tick,L)):_||(L._62O="roaming")),L._62O||(_&&p&&Bl[m]?(L._62O=m,L.p3=N.p3()):_&&p&&Mp(N)&&r.isSelected(N)?r.isMovable(N)?(L._62O="move",L.p3=N.p3(),L.movedata=N):r.isInteractive(N)&&(L._62O="none"):Qr&&(J>2?L._62O="pan":2===J&&(L.dist=en(b),L._62O="pinch")))),L.point=r.lp(b),Pb(L,b),As(b)?r.handleDoubleClick(b,N,m):r.handleClick(b,N,m))},tick:function(){var w=this,P=w.gv,d=P._moveStep;w.point&&P.isWalkable()&&(w._32Q&&(d*=(Ph()-w._32Q)/50),P.walk(w.foward?d:-d),w._32Q=Ph(),w._31Q=Vo(w.tick,w))},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(T){var l=this._57I;l&&(jc(l,vd(T))<=1&&this.gv.sm().cs(),this._57I=d)},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowTouchMove:function(S){var h,i,Y=this,Z=Y.gv,y=Y._62O,o=Y.point,q=Z.dm(),F=Z.lp(S),J=F.x-o.x,u=F.y-o.y,G=Z.getWidth(),r=Z.getHeight();if(G&&r){var K=-p*J/G,D=-p*u/r;if("roaming"===y)Y.rotate(S,K/2,D/2);else if(y===hc||y===jq||y===tc)Z._86O||q.beginTransaction(),Z.fi({kind:Z._86O?"betweenEditRotation":"beginEditRotation",event:S}),Z._86O=1,Z.sm().each(function(P){if(Mp(P)&&Z.isRotationEditable(P)){var W=j(K)>j(D)?K:D;y===hc?P.setRotationX(P.getRotationX()+W):y===jq?P.setRotationY(P.getRotationY()+W):y===tc&&P.setRotationZ(P.getRotationZ()+W)}});else if("move"===y||Bl[y]){y===Ai||y===pm||y===Wb?(Z._87O||q.beginTransaction(),Z.fi({kind:Z._87O?"betweenEditScale":"beginEditScale",event:S}),Z._87O=1):(Z._moving||q.beginTransaction(),Z.fi({kind:Z._moving?"betweenMove":"beginMove",event:S}),Z._moving=1);var c,t=Y.p3,$=Z.getPositionInfo(t),w=ms(Z);c=y===pl?"x":y===Fo?"y":y===Ke?"z":y===Ai?"sx":y===pm?"sy":y===Wb?"sz":Z.getMoveMode(S,Y.movedata),J=J/G*$.width,u=-1*u/r*$.height;var x,O,X=[w[0]*J,w[4]*J,w[8]*J],N=[w[1]*u,w[5]*u,w[9]*u],b=X[0]+N[0],E=X[1]+N[1],H=X[2]+N[2],g=[t[0]+b,t[1]+E,t[2]+H],L=Te(Z.getEye(),g,!0);if("xyz"===c?(x=g,Z.moveSelection(b,E,H)):"xz"===c?(x=le(Z,t,[0,1,0],g),x&&Z.moveSelection(x[0]-t[0],0,x[2]-t[2])):"xy"===c?(x=le(Z,t,[0,0,1],g),x&&Z.moveSelection(x[0]-t[0],x[1]-t[1],0)):"yz"===c?(x=le(Z,t,[1,0,0],g),x&&Z.moveSelection(0,x[1]-t[1],x[2]-t[2])):"x"===c||"sx"===c?(L[0]=0,x=le(Z,t,L,g),x&&(O=x[0]-t[0],"x"===c?Z.moveSelection(O,0,0):Z.sm().each(function(l){Mp(l)&&Z.isSizeEditable(l)&&(h=l.getScaleX()+O/100,i=h/l.getScaleX(),l.setScaleX(h),xk(S)&&(l.setScaleY(l.getScaleY()*i),l.setScaleTall(l.getScaleTall()*i)))}))):"y"===c||"sy"===c?(L[1]=0,x=le(Z,t,L,g),x&&(O=x[1]-t[1],"y"===c?Z.moveSelection(0,O,0):Z.sm().each(function(Q){Mp(Q)&&Z.isSizeEditable(Q)&&(h=Q.getScaleTall()+O/100,i=h/Q.getScaleTall(),Q.setScaleTall(h),xk(S)&&(Q.setScaleY(Q.getScaleY()*i),Q.setScaleX(Q.getScaleX()*i)))}))):("z"===c||"sz"===c)&&(L[2]=0,x=le(Z,t,L,g),x&&(O=x[2]-t[2],"z"===c?Z.moveSelection(0,0,O):Z.sm().each(function(y){Mp(y)&&Z.isSizeEditable(y)&&(h=y.getScaleY()+O/100,i=h/y.getScaleY(),y.setScaleY(h),xk(S)&&(y.setScaleX(y.getScaleX()*i),y.setScaleTall(y.getScaleTall()*i)))}))),!x)return;Y.p3=x}else if(y===$i){var m=Y.div;m||(m=Y.div=rp(),oq(Y.getView(),m),m.op=o,m.style.background=Z.getRectSelectBackground()),Z.fi({kind:Z._rectSelecting?"betweenRectSelect":"beginRectSelect",event:S}),Z._rectSelecting=1,m.rect=io(m.op,F),Hi(m,m.rect)}else if("pinch"===y&&2===So(S)){Z.fi({kind:Z._pinching?"betweenPinch":"beginPinch",event:S}),Z._pinching=1;var O=en(S);Z.handlePinch(O,Y.dist),Y.dist=O}else"pan"===y||xk(S)||Ur(S)?Y.pan(S,J,u):"none"===y||Z.isFirstPersonMode()||(fs(S)?Y.rotate(S,K,D):(Y.pan(S,J,0),Z.isWalkable()&&(Z.fi({kind:Z._walking?"betweenWalk":"beginWalk",event:S}),Z._walking=1,Z.walk(u/Z.getHeight()*Z.getCenterInfo().height))));Y.point=F}},pan:function(m,y,x){var G=this.gv;if(G.isPannable()){var n=G.getWidth(),k=G.getHeight();if(!n||!k)return;var X=G.getCenterInfo(),K=y/n*X.width,q=-1*x/k*X.height;G.fi({kind:G._panning?"betweenPan":"beginPan",event:m}),G._panning=1,G.pan(-K,-q)}},rotate:function(S,u,$){var a=this.gv;a.isRotatable()&&(a.fi({kind:a._rotating?"betweenRotate":"beginRotate",event:S}),a._rotating=1,a.rotate(u,$))},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(G){var M=this,c=M.gv,V=c.dm(),b=M.div;if(b){var v=c.getDatasInRect(b.rect);if(!v.isEmpty()){var y=c.sm(),k=y.toSelection();v.each(function(h){y.co(h)?k.remove(h):k.add(h)}),y.ss(k)}Hq(b)}c._moving&&(delete c._moving,c.fi({kind:"endMove",event:G}),c.onMoveEnded(),V.endTransaction()),c._panning&&(delete c._panning,c.fi({kind:"endPan",event:G}),c.onPanEnded()),c._rotating&&(delete c._rotating,c.fi({kind:"endRotate",event:G}),c.onRotateEnded()),c._86O&&(delete c._86O,c.fi({kind:"endEditRotation",event:G}),V.endTransaction()),c._87O&&(delete c._87O,c.fi({kind:"endEditScale",event:G}),V.endTransaction()),c._pinching&&(delete c._pinching,c.fi({kind:"endPinch",event:G}),c.onPinchEnded()),c._rectSelecting&&(delete c._rectSelecting,c.fi({kind:"endRectSelect",event:G}),c.onRectSelectEnded()),c._walking&&(delete c._walking,c.fi({kind:"endWalk",event:G}),c.onWalkEnded()),M.dist=M.point=M._62O=M.p3=M.movedata=M.div=M._57I=M._32Q=M._31Q=M.foward=d}});var Ag=Ir.MapInteractor=function(h){ii(Ag,this,[h]),this._minPhi=0,this._maxPhi=5*M/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};qn("MapInteractor",jd,{handle_contextmenu:function(e){_l(e)},handle_mousewheel:function(c){this.gv.handleScroll(c,c.wheelDelta/40)},handle_DOMMouseScroll:function(e){2===e.axis&&this.gv.handleScroll(e,-e.detail)},handle_keydown:function(d){this.gv.handleKeyDown(d)},handle_mousedown:function(F){this.handle_touchstart(F)},handle_touchstart:function(k){_l(k);var R=this,o=R.gv;if(o.setFocus(k)){o.lp(k);var h=o.getDataInfoAt(k),A=h?h.data:d,u=h?h.part:d;if(!A||!o.isInteractive(A)){var J=R.editing={point:o.lp(k)};Qr?J.touch=!0:(J.touch=!1,J.clickLeft=fs(k),J.pan=Ur(k)?!0:"left"===this.panButton===J.clickLeft),Pb(R,k)}As(k)?o.handleDoubleClick(k,A,u):o.handleClick(k,A,u)}},handle_mouseup:function($){this.handle_touchend($)},handle_touchend:function(){},handleWindowMouseMove:function(m){this.handleWindowTouchMove(m)},handleWindowTouchMove:function(O){var S=this,j=S.gv,I=S.editing;if(I){var B=j.lp(O),x=I.point,t=B.x-x.x,P=B.y-x.y;if(!I.moved){if(Math.abs(t)<S.threshold&&Math.abs(P)<S.threshold&&!(O.touches&&O.touches.length>1))return;I.moved=!0}if(I.point=B,I.touch){var Z=O.touches.length;if(2!==Z)S.pan(O,t,P);else{if(1>=Z)return;var l=O.touches,u={x:l[0].clientX,y:l[0].clientY},s={x:l[1].clientX,y:l[1].clientY},G={x:s.x-u.x,y:s.y-u.y},c=I.lastCenter,H=Math.atan2(G.y,G.x),V=I.theta,b=0;V==d?V=I.theta=H:(b=H-V,I.thetaStarted||Math.abs(b)>S.touchRotateThreshold?(I.thetaStarted=!0,I.theta=H):b=0);var o=M*(u.y+s.y)/2/j.getHeight(),$=I.phi,z=0;$==d?$=I.phi=o:(z=o-$,I.phiStarted||Math.abs(z)>S.touchRotateThreshold?(I.phiStarted=!0,I.phi=o):z=0);var _,y=Math.sqrt(G.x*G.x+G.y*G.y),n=I.vlen;if(n){var A=u.x-c.x,v=u.y-c.y,X=s.x-c.x,F=s.y-c.y,m=Math.sqrt(A*A+v*v),g=Math.sqrt(X*X+F*F),f=n/2,L=S._sign2(m-f),K=S._sign2(g-f);0>L*K||0===L&&0===K?(_=1,I.vlen=y):(_||(_=y/n),I.scaleStarted||Math.abs(_-1)>S.touchScaleThreshold?(I.vlen=y,I.scaleStarted=!0):_=1)}else n=I.vlen=y,_=1;1!==_&&j.setZoom(_),(z||b)&&S.rotate(O,b,-z),I.lastCenter={x:(s.x+u.x)/2,y:(s.y+u.y)/2}}}else if(I.pan)S.pan(O,t,P);else{var k=j.getWidth(),T=j.getHeight();if(!k||!T)return;var e=-p*t/k,R=-p*P/T;S.rotate(O,e,R)}}},_sign2:function(B){return Math.abs(B)<this._touchScaleCheckAccuracy?0:B>0?1:-1},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},handleWindowTouchEnd:function(_){var j=this,f=j.editing;if(j.editing=null,f){var I=j.gv;if(!f.moved&&f.clickLeft){var U=I.getDataAt(_);U?I.sm().setSelection([U]):I.sm().clearSelection()}else I._panning=null,I._rotating=null,I.fi({kind:f.pan?"endPan":"endRotate",event:_})}},pan:function(U,H,e){var p=this,L=p.gv;if(L.isPannable()){var l=L.getWidth(),C=L.getHeight();if(l&&C){var y=L.getCenterInfo(),Z=-H/l*y.width,h=1*e/C*y.height;L.fi({kind:L._panning?"betweenPan":"beginPan",event:U}),L._panning=1;var G=p.keepHorizon,r=p.editing.touch;if((r&&U.touches&&U.touches.length>1||!r&&xk(U))&&(G=!G),!G)return L.pan(Z,h);if(Z||h){var V=ms(L),i=[V[0]*Z,V[4]*Z,V[8]*Z],D=[V[1],0,V[9]],F=Math.sqrt(D[0]*D[0]+D[2]*D[2]);F&&(D=[D[0]/F*h,0,D[2]/F*h]);var f=i[0]+D[0],j=i[1]+D[1],K=i[2]+D[2],I=L._center,W=L._eye;I[0]+=f,I[1]+=j,I[2]+=K,W[0]+=f,W[1]+=j,W[2]+=K,L.fp(ds,d,W),L.fp(Qh,d,I)}}}},rotate:function(r,Y,S){var t=this,A=t.gv;if(A.isRotatable()){var j=A._center,m=A._eye,J=Te(m,j),a=k(w(J[0]*J[0]+J[2]*J[2]),J[1]),V=a+S;V=Math.max(t.minPhi,Math.min(t.maxPhi,V)),S=V-a,A.fi({kind:A._rotating?"betweenRotate":"beginRotate",event:r}),A._rotating=1,A.rotate(Y,S)}}}),r.defineProperties(Ag.prototype,{panButton:{get:function(){return this._panButton},set:function(t){this._panButton=t}},minPhi:{get:function(){return this._minPhi},set:function(w){this._minPhi=w}},maxPhi:{get:function(){return this._maxPhi},set:function(e){this._maxPhi=e}},keepHorizon:{get:function(){return this._keepHorizon},set:function(C){this._keepHorizon=C}},threshold:{get:function(){return this._threshold},set:function(q){this._threshold=q}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(c){this._touchScaleThreshold=c}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(L){this._touchRotateThreshold=L}}});var Lp=function(R){this.gv=R};$o(Lp,r,{_iv:!0,iv:function(){this._iv=!0},face:function(i,Y){var b=this,N=b.gv.getGL();if(!N||!Mp(i))return d;var f=Y.x,r=Y.width,o=Y.height,z=b.height-Y.y-o,p=A(r/2),F=new Uint8Array(4*r*o),Q=0;for(b.iv(),b.validate(i),qj(N,b.frame),N.readPixels(f,z,r,o,N.RGBA,N.UNSIGNED_BYTE,F),cm(N),b.iv();p>=Q;Q++)for(var V=p-Q,R=p+Q,j=V;R>=j;j++)for(var O=V;R>=O;O++)if(j===V||j===R||O===V||O===R){var e=tj.m[F[4*(j*r+O)]];if(e)return e}},get:function(f,k){this.validate();var g=this,p=g.gv.getGL();if(!p)return d;var D,F,b=f.x,e=f.width,M=f.height,u=g.height-f.y-M,x=A(e/2),G=new Uint8Array(4*e*M),L=0,m=G.length,$=k?d:new nm,j=k?d:{};if(qj(p,g.frame),p.readPixels(b,u,e,M,p.RGBA,p.UNSIGNED_BYTE,G),cm(p),k){for(;x>=L;L++)for(var S=x-L,O=x+L,w=S;O>=w;w++)for(var z=S;O>=z;z++)if((w===S||w===O||z===S||z===O)&&(D=g.info(G,4*(w*e+z))))return D}else for(;m>L;L+=4)D=g.info(G,L),D&&(F=D.data,j[F._id]||($.add(F),j[F._id]=F));return $},info:function(x,C){return this.colorMap[(x[C]<<16)+(x[C+1]<<8)+x[C+2]+((127&x[C+3])<<24)]},validate:function(Q){var U=this,M=U.gv,t=M.getGL();if(t){var i=M.getWidth(),G=M.getHeight(),K=t.RGBA,b=t.TEXTURE_2D,s=t.RENDERBUFFER,o=t.FRAMEBUFFER;U.texture||(U.texture=Ue(t),U.render=t.createRenderbuffer(),U.frame=t.createFramebuffer()),(U.width!==i||U.height!==G)&&(vh(t,U.texture),t.texImage2D(b,0,K,i,G,0,K,t.UNSIGNED_BYTE,d),zb(t,t.TEXTURE_MIN_FILTER,t.LINEAR),t.bindRenderbuffer(s,U.render),t.renderbufferStorage(s,t.DEPTH_COMPONENT16,i,G),qj(t,U.frame),t.framebufferTexture2D(o,t.COLOR_ATTACHMENT0,b,U.texture,0),t.framebufferRenderbuffer(o,t.DEPTH_ATTACHMENT,s,U.render),vh(t,d),t.bindRenderbuffer(s,d),cm(t),U.width=i,U.height=G),U._iv&&(U._iv=!1,qj(t,U.frame),M._42(Q||(U.colorMap={}),1),cm(t))}}});var lg=function(B){this.gv=B};$o(lg,r,{gap:0,size:0,_42:function(t,S){var y=this,h=y.gv,o=h._gridGap,b=h._gridSize;if(h._gridVisible){if(y.gap!==o||y.size!==b){for(var i=[],z=h._gridSize/2,C=o*z,w=0;2*z+1>w;w++){var E=6*w,N=6*(2*z+1)+E;i[E]=-C,i[E+1]=0,i[E+2]=-C+w*o,i[E+3]=C,i[E+4]=0,i[E+5]=-C+w*o,i[N]=-C+w*o,i[N+1]=0,i[N+2]=-C,i[N+3]=-C+w*o,i[N+4]=0,i[N+5]=C}y.vs=new Kp(i),y.gap=o,y.size=b}Qc(h),ph(t,S),Bb(t),bb(t,S,1,h._gridColor,h._buffer.vs,y.vs),Co(t,0,y.vs.length/3,t.LINES),sn(t),Dp(t,S)}else y.vs=y.gap=y.size=d}});var Mn=function(j){this.gv=j};$o(Mn,r,{_42:function(E,M){var i=this.gv,q=i._buffer.vs,Z=i._axisXColor,z=i._axisYColor,$=i._axisZColor,C=i._originAxisVisible,h=i._centerAxisVisible;if(C||h){var T=f?E.TRIANGLES:E.TRIANGLE_FAN,w=E.LINES;if(Qc(i),ph(E,M),Bb(E),C){var W=i.getCenterInfo(),J=e(W.width,W.height)/5,H=.8*J,F=.05*J;bb(E,M,1.5,Z,q,new Kp([0,0,0,J,0,0,H,F,0,H,0,F,H,-F,0,H,0,-F,H,F,0,0,0,0,0,J,0,F,H,0,0,H,F,-F,H,0,0,H,-F,F,H,0,0,0,0,0,0,J,F,0,H,0,F,H,-F,0,H,0,-F,H,F,0,H])),Co(E,0,2,w),Co(E,1,6,T),bb(E,M,d,z),Co(E,7,2,w),Co(E,8,6,T),bb(E,M,d,$),Co(E,14,2,w),Co(E,15,6,T)}if(h){var R=i._center,S=R[0],Q=R[1],s=R[2],W=i.getPositionInfo(R);J=e(W.width,W.height)/20,bb(E,M,1.5,Z,q,new Kp([S,Q,s,S+J,Q,s,S,Q,s,S,Q+J,s,S,Q,s,S,Q,s+J])),Co(E,0,2,w),bb(E,M,d,z),Co(E,2,2,w),bb(E,M,d,$),Co(E,4,2,w)}sn(E),Dp(E,M)}}});var bm=function(P){this.gv=P,this.onMouseOver=this.onMouseOver.bind(this),this.mode=bm.Mode.Disable};bm.Mode={Disable:0,Selection:1,MouseOver:2},$o(bm,r,{onMouseOver:function(G){F.preventDefault(G);var j=this.gv.getDataAt(G);j!==this.mouseOverData&&(this.mouseOverData=j,this.gv.iv())},setFetchTargetFunc:function(V){this.fetchTargetFunc=V},_42:function(g,j){var Y,m=this,s=m._mode;if(s!==bm.Mode.Disable&&(s===bm.Mode.Selection?Y=m.gv.sm().getSelection().toArray(function(s){return s.s("highlight.visible")}):s===bm.Mode.MouseOver&&m.mouseOverData&&m.mouseOverData.s("highlight.visible")&&(Y=[m.mouseOverData]),m.fetchTargetFunc&&(Y=m.fetchTargetFunc(Y)),Y&&Y.length)){var H=m.gv,e=H.vr.isPresenting(),N=H.getWidth();if(e){var Q=H.getWidth;N/=2,H.getWidth=function(){return N};var h=H.getViewport()}var r,c=H.getDevicePixelRatio(),W=N*c,L=H.getHeight()*c;(r=m._renderTarget)?r.setSize(g,W,L):m._renderTarget=r=new Ir.RenderTarget(H,g,W,L),qj(g,r.frame),H.drawFilter=function(w){return Y.indexOf(w)<0?!0:void 0},H._42({}),H.drawFilter=null,cm(g),e&&(H.getWidth=Q,H.setViewport(g,h[0],h[1],h[2],h[3])),m.shader||(m.shader=new Xk.Shader(g,Rq.vs,Rq.fs));var J=m.shader;if(m.shader.bind(),g.enable(g.BLEND),g.activeTexture(g.TEXTURE0+0),g.bindTexture(g.TEXTURE_2D,r.texture),J.uniforms.image=0,J.uniforms.textureSize=[W,L],J.uniforms.edgeWidth=S["highlight.width"],m.highlightColor!==S["highlight.color"]){var V=Yl(m.highlightColor=S["highlight.color"]);m.highlightColorData=[V[0]/255,V[1]/255,V[2]/255,V[3]/255]}J.uniforms.edgeColor=m.highlightColorData,m.ibuffer?(m.ibuffer.upload(),m.vbuffer.upload()):(m.ibuffer=Xk.Buffer.createIndexBuffer(g,new Uint16Array([0,2,1,1,2,3])),m.vbuffer=Xk.Buffer.createVertexBuffer(g,new Float32Array([0,0,1,0,0,1,1,1]))),J.attributes.pos.pointer(m.vbuffer),g.drawElements(g.TRIANGLES,6,g.UNSIGNED_SHORT,0),g.disable(g.BLEND),g.bindTexture(g.TEXTURE_2D,null),g.useProgram(j)}}}),r.defineProperties(bm.prototype,{mode:{get:function(){return this._mode},set:function(t){var j=this._mode;t!==j&&(this._mode=t,t===bm.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):j===bm.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var Rq={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},km=function(Y){this.gv=Y},pl="edit_tx",Fo="edit_ty",Ke="edit_tz",hc="edit_rx",jq="edit_ry",tc="edit_rz",Ai="edit_sx",pm="edit_sy",Wb="edit_sz",Bl={};Bl[pl]=1,Bl[Fo]=1,Bl[Ke]=1,Bl[hc]=1,Bl[jq]=1,Bl[tc]=1,Bl[Ai]=1,Bl[pm]=1,Bl[Wb]=1,$o(km,r,{_42:function(A,m,$){var U=this,h=U.gv,T=h.sm().ld();if(T&&h.isEditable(T)&&!h.isEditHelperDisabled()&&Mp(T)&&(!h.isFirstPersonMode()||!h.isMouseRoamable()&&!Qr)){Qc(h);var F,r,B=h.isMovable(T),X=h.isRotationEditable(T),S=h.isSizeEditable(T),e=h._axisXColor,a=h._axisYColor,j=h._axisZColor,M=h._editSizeColor,G=T.p3(),c=jc(h.getEye(),G)/10,R=c/($?5:10),z=.7*c,y=.4*z,K=G[0],n=G[1],u=G[2];F=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],B&&U._17O(A,m,T,$,pl,e,F,[K,n-R,u,K+z,n-R,u,K+z,n,u,K+z,n,u,K,n,u,K,n-R,u,K,n-R,u+R,K+z,n-R,u+R,K+z,n-R,u,K+z,n-R,u,K,n-R,u,K,n-R,u+R]),r=K+z,S&&U._17O(A,m,T,$,Ai,M,F,[r,n-R,u,r+y,n-R,u,r+y,n,u,r+y,n,u,r,n,u,r,n-R,u,r,n-R,u+R,r+y,n-R,u+R,r+y,n-R,u,r+y,n-R,u,r,n-R,u,r,n-R,u+R]),r+=y,X&&U._17O(A,m,T,$,hc,e,F,[r,n-R,u,r+y,n-R,u,r+y,n,u,r+y,n,u,r,n,u,r,n-R,u,r,n-R,u+R,r+y,n-R,u+R,r+y,n-R,u,r+y,n-R,u,r,n-R,u,r,n-R,u+R]),F=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],B&&U._17O(A,m,T,$,Fo,a,F,[K,n,u,K,n+z,u,K-R,n+z,u,K-R,n+z,u,K-R,n,u,K,n,u,K,n,u,K,n,u-R,K,n+z,u-R,K,n+z,u-R,K,n+z,u,K,n,u]),r=n+z,S&&U._17O(A,m,T,$,pm,M,F,[K,r,u,K,r+y,u,K-R,r+y,u,K-R,r+y,u,K-R,r,u,K,r,u,K,r,u,K,r,u-R,K,r+y,u-R,K,r+y,u-R,K,r+y,u,K,r,u]),r+=y,X&&U._17O(A,m,T,$,jq,a,F,[K,r,u,K,r+y,u,K-R,r+y,u,K-R,r+y,u,K-R,r,u,K,r,u,K,r,u,K,r,u-R,K,r+y,u-R,K,r+y,u-R,K,r+y,u,K,r,u]),F=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],B&&U._17O(A,m,T,$,Ke,j,F,[K,n,u,K,n,u+z,K,n-R,u+z,K,n-R,u+z,K,n-R,u,K,n,u,K,n-R,u,K-R,n-R,u,K-R,n-R,u+z,K-R,n-R,u+z,K,n-R,u+z,K,n-R,u]),r=u+z,S&&U._17O(A,m,T,$,Wb,M,F,[K,n,r,K,n,r+y,K,n-R,r+y,K,n-R,r+y,K,n-R,r,K,n,r,K,n-R,r,K-R,n-R,r,K-R,n-R,r+y,K-R,n-R,r+y,K,n-R,r+y,K,n-R,r]),r+=y,X&&U._17O(A,m,T,$,tc,j,F,[K,n,r,K,n,r+y,K,n-R,r+y,K,n-R,r+y,K,n-R,r,K,n,r,K,n-R,r,K-R,n-R,r,K-R,n-R,r+y,K-R,n-R,r+y,K,n-R,r+y,K,n-R,r])}},_17O:function(w,c,a,m,D,M,e,l){var o=this.gv._buffer;Oj(w,c,m,!0,a,D),no(w,c,d,!0,d,!0,d,!1),Dj(w,c.uDiffuse,M),Cg(w,o.vs,new Kp(l),c.aPosition),Cg(w,o.ns,new Kp(e),c.aNormal),Bb(w),Co(w,0,12),sn(w),Tb(w,c)}});var Lo=P.Raycaster=function(g){this.gv=g,this.maxTriangleTest=1/0};as("Raycaster",r,{intersect:function(i){var O=this,I=O.gv,L=I.getDataAt(i);return L?O.intersectObject(i,L):null},intersectObjects:function(V,Y,s){var T,w,L,N,Z=this,r=1/0,D=V.origin||(new On).fromArray(Z.gv.getEye()),S=Z.maxTriangleTest,p=[];return Y.forEach(function(Y){s&&s(Y)===!1||Y.s("intersect")!==!1&&p.push(Y)}),p.sort(function($,t){return D.distanceToSquared2($.p3())-D.distanceToSquared2(t.p3())}),Z.countTriangles=0,p.forEach(function(d){Z.countTriangles>S||(T=Z.intersectObject(V,d),T&&(w=D.distanceToSquared(T.world),r>w&&(L=d,N=T,r=w)))}),Z.countTriangles=0,{data:L,intersect:N}},intersectObject:function(n,K){if(n instanceof Qi)return this._intersectObjectImpl(n,K);var s,Z,Y=this,S=Y.gv;Z=S.unproject(n);var o=S.getEye();S.isOrtho()?(s=Te(S.getCenter(),o),s[0]+=s[0],s[1]+=s[1],s[2]+=s[2]):s=o,s=new On(s);var W=new On(Z).sub(s).normalize(),M=new P.Math.Ray(s,W);return Y._intersectObjectImpl(M,K)},_intersectObjectImpl:function(){function V(){var F=new On;return F.subVectors(o,w),W.subVectors(B,w),F.cross(W).normalize(),F}function b(N,R,z,Z,L,t,A){return Nn.barycoordFromPoint(N,R,z,Z,h),L.multiplyScalar(h.x),t.multiplyScalar(h.y),A.multiplyScalar(h.z),L.add(t).add(A),L.clone()}var H=new vk,t=new vk,N=new Qi,Q=new On,k=new On,q=new On,E=new On,Z=new On,B=new On,w=new On,o=new On,I=new kc,i=new kc,$=new kc,W=new On,Y={vs:Pr,is:ko,uv:fo},h=new On;return function(J,m){var d=this.gv.getData3dUI(m),M=m.mat||d.mat;if(M){H.fromArray(M),t.getInverse(H),N.copy(J).applyMatrix4(t);var l,r,F="body",x=d.shapeModel;if(x||(x=Eg(d)),x||(m instanceof P.Node&&!(m instanceof P.Shape)?(l=!0,x=Y):(r=!0,x=[d.left,d.front,d.right,d.back,d.top,d.bottom])),!x)return console.log("Can not find shape model."),null;mo(x)||(x=[x]);var u,S,e,j,X,U,G,a,y,_,D,z,s,C,p,O,R=1/0,v=["","top_","bottom_"],W=!1;for(u=0,S=x.length;S>u;u++)if(s=x[u])for(e=0,j=v.length;j>e;e++)if(C=v[e],G=s[C+"vs"],a=s[C+"is"],y=s[C+"uv"]||s[C+"tuv"],G){if(p=s[C+"boundingBox"]){var D=N.intersectBox(p);if(!D)continue;if(N.origin.distanceTo(D)>R)continue;O=!1}else s[C+"boundingBox"]=p=new P.Math.Box3,O=!0;for(X=0,U=a?a.length:G.length/3;U>X;X+=3)this.countTriangles++,a?(k.fromArray(G,3*a[X]),q.fromArray(G,3*a[X+1]),E.fromArray(G,3*a[X+2])):(k.fromArray(G,3*X),q.fromArray(G,3*(X+1)),E.fromArray(G,3*(X+2))),O&&(p.expandByPoint(k),p.expandByPoint(q),p.expandByPoint(E)),_=N.intersectTriangle(k,q,E,!0,Q),_&&(z=N.origin.distanceTo(_),R>z&&(R=z,Z.copy(_),B.copy(k),w.copy(q),o.copy(E),""!==C?F=C.slice(0,-1):l?F=am[Math.floor(X/6)]:r&&(F=am[u]),y&&(W=!0,a?(I.fromArray(y,2*a[X]),i.fromArray(y,2*a[X+1]),$.fromArray(y,2*a[X+2])):(I.fromArray(y,2*X),i.fromArray(y,2*(X+1)),$.fromArray(y,2*(X+2))))))}if(!isFinite(R))return null;var c,K=Z.clone().applyMatrix4(H);W&&(c=b(Z,B,w,o,I,i,$));var A=V(B,w,o),L=V(B.applyMatrix4(H),w.applyMatrix4(H),o.applyMatrix4(H)),f=N.direction.dot(A);return f>0&&(A.multiplyScalar(-1),L.multiplyScalar(-1)),{world:K,local:Z.clone(),worldNormal:L,normal:A,uv:c,part:F}}}}()});var ar=function(X,l){this.gv=X,this.s=function(c,x,S){return x==d&&(x=S),x==d?l.getStyle(c):Wf(x,l,X)},this.data=l};$o(ar,r,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(o,e,g,t){var V=this,M=V.data;if(!(M instanceof Mi)){var $,Y,f,v,m,p,c,N=V.gv,w=M._id,J=V.s("shape3d.alwaysOnTop")?null:V.s("batch"),j=N._batchIndexMap,u=N._batchModelMap,T=N.isSelectable(M),R=N.getBrightness(M),q=R!=d&&1!==R;if(V.needValidate(o)){if(f=Db(j,u,M,J),V.validate(f,J?Rn[J]||tp:d),f&&(v=j[w],m=v.size=f.vs.length/3-v.begin,c=f.rs))for(R=q?R:1,p=0;m>p;p++)c.push(R);if(Mp(M)){var x=N.getWireframeGeometry(M);if(x)Mk(N,M,x);else{var D=N.getWireframe(M);D&&Mk(N,M,D)}}V.labelInfo=V.label2Info=V.noteInfo=V.note2Info=V._38o=d,V._24O(Re,"getLabel"),V._24O(Jj,"getLabel2"),V._26O(tb,"getNote"),V._26O(yp,"getNote2"),V._15O(),V.interactiveInfo=N.isInteractive(M)?{}:d,V._iv=!1}q&&Dj(o,e.uBrightness,R),Dj(o,e.uAlphaTest,V.s("alphaTest")),Dj(o,e.uUseEnvMap,M.s("envmap")?!0:!1),Dj(o,e.uReflectivity,M.s("envmap")||.01),Y=Oj(o,e,g,T,M,Zi),Y&&(xf(Y,j[w],u),xf(Y,N._polylineIndexMap[w],N._polylineModelMap),xf(Y,N._wireframeIndexMap[w],N._wireframeModelMap)),j[w]||V._80o(o,e,t),N.isLabelVisible(M)&&(($=V.labelInfo)&&(Oj(o,e,g,T,M,Re),V._28O($,Re,t)),($=V.label2Info)&&(Oj(o,e,g,T,M,Jj),V._28O($,Jj,t))),N.isNoteVisible(M)&&(($=V.noteInfo)&&(Oj(o,e,g,T,M,tb),V._29O($,tb,t)),($=V.note2Info)&&(Oj(o,e,g,T,M,yp),V._29O($,yp,t))),($=V._38o)&&V._99O(o,e,$,g,T,t),q&&Dj(o,e.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return $q},_80o:function(){},dispose:function(){},_calcAnchorMat:function(H){if(H.hasOwnProperty("_anchor")||H.hasOwnProperty("_anchorElevation")){var $=H.getAnchor3d(),N={x:$.x-.5,y:$.y-.5,z:$.z-.5},K=ys();return ve(K,[-N.x,-N.y,-N.z]),K}},getBodyColor:function(Q){var H=this.data,w=this.gv.getBodyColor(H);return w?w:Q?H.getStyle(Q):d},_24O:function(X,n){var S=this,v=S.data,O=S.gv,E=S.s,M=O[n](v);if(M!=d){var L=E(X+".scale"),u=E(X+".max"),A=S[X+"Info"]={label:M,textureScale:E(X+".texture.scale"),color:O[n+"Color"](v),font:E(X+".font"),align:E(X+".align"),background:O[n+"Background"](v)},W=A.rect=pg(A,M);u>0&&u<W.width&&(A.labelWidth=W.width,W.width=u),W.x=W.y=0,W.width*=L,W.height*=L,A.mat=S._16O(E(X+".autorotate"),E(X+".position"),W,E(X+".face"),E(X+".t3"),E(X+".r3"),E(X+".rotationMode"));var g=W.width/2,t=W.height/2;A.vs=new Kp([-g,t,0,-g,-t,0,g,-t,0,g,t,0]),W.width/=L,W.height/=L}},_26O:function(F,Z){var g=this,q=g.data,p=g.gv,j=g.s,x=p[Z](q);if(x!=d){var E=j(F+".scale"),C=this[F+"Info"]={note:x,textureScale:j(F+".texture.scale"),expanded:j(F+".expanded"),font:j(F+".font"),color:j(F+".color"),align:j(F+".align"),borderWidth:j(F+".border.width"),borderColor:j(F+".border.color"),background:p[Z+"Background"](q)};if(C.expanded){var z=j(F+".max"),J=pg(C,x);J.width+=6,J.height+=2,z>0&&z<J.width&&(C.labelWidth=J.width,J.width=z);var X={x:-J.width/2,y:-8-J.height,width:J.width,height:J.height+8}}else X={x:-6,y:-18,width:12,height:18};C.mat=g._16O(j(F+".autorotate"),j(F+".position"),d,j(F+".face"),j(F+".t3"),j(F+".r3"),j(F+".rotationMode")),C.rect=X,1!==E&&(X=oe(X),X.x*=E,X.height*=E,X.y=-X.height,X.width*=E);var R=X.x,f=X.y,O=X.width,w=X.height;C.vs=new Kp([R,-f,0,R,-f-w,0,R+O,-f-w,0,R+O,-f,0])}},_28O:function(X,F,k){if(k(this.s(F+".transparent"))){var s=X.rect,C=X.textureScale,M=s.width*C,Q=s.height*C;if(M>=1&&Q>=1){var l=ed(M,Q);1!==C&&(l.translate(l,s.x,s.y),l.scale(C,C),l.translate(l,-s.x,-s.y)),uq(l,X),l.restore(),fb(this,F,X.mat,X.vs,!0)}}},_29O:function(t,n,V){if(V(this.s(n+".transparent"))){var y=t.rect,R=t.textureScale,I=y.x,B=y.y,x=y.width*R,w=y.height*R;if(x>=1&&w>=1){y.x=y.y=0;var M=ed(x,w);1!==R&&M.scale(R,R),ts(M,t),M.restore(),y.x=I,y.y=B,fb(this,n,t.mat,t.vs,!1)}}},_99O:function(R,u,m,q,O,M){if(m){var h=this,b=h.gv,J=h.data,k=b._buffer,n=b._1O,K=m.icons;for(var e in K){var C=K[e],I=m.rects[e];if(I&&M(Wf(C.transparent,J,b))){Oj(R,u,q,O,J,e);var L=Wf(C.shape3d,J,b),A=L?[L]:Wf(C.names,J,b),y=A?A.length:0,c=Wf(C.textureScale,J,b)||1,G=Wf(C.light,J,b);G==d&&(G=L?!0:!1),no(R,u,Wf(C.blend,J,b),G,Wf(C.opacity,J,b),Wf(C.reverseFlip,J,b),Wf(C.reverseColor,J,b),Wf(C.reverseCull,J,b));for(var N=0;y>N;N++){var v=A[N],P=I[N];if(Eo(h,P.mat),L)Ql(b,J,Eg(h,L),h);else{var i=Hf(v);if(i){var f=P.width*c,U=P.height*c;if(f>=1&&U>=1){var Q=ed(f,U);wo(Q,i,Wf(C.stretch,J,b),0,0,f,U,J,b),Q.restore(),Ue(R,qs,n),Bb(R,u,n,Wf(C.discardSelectable,J,b),k.uv,$g),Cg(R,k.vs,P.vs,u.aPosition),Lc(R,k.ns,Of,u.aNormal),hf(R,k.is,pn),Qj(R,0,pn.length),sn(R,u,n)}}}Io(b)}Tb(R,u)}}}}});var Zc=function($,s){ii(Zc,this,[$,s])};$o(Zc,ar,{_16O:function(T,P,Z,m,S,f,s,I,A){var h=this.data,U=h.getFinalScale3d(),b=yk(P,U,Z,m,I,A);if(h.hasOwnProperty("_anchor")||h.hasOwnProperty("_anchorElevation")){var E=h.getAnchor3d();b[0]-=(E.x-.5)*U[0],b[1]-=(E.y-.5)*U[1],b[2]-=(E.z-.5)*U[2]}return id(ys(),b,h.p3(),m,S,f,s,T,h.getFinalRotation3d(),h.getRotationMode())},clear:function(){var t=this;t.faceMat=t.mat=t.shapeModel=t.left=t.right=t.front=t.back=t.top=t.bottom=t.csg=d},needValidate:function(R){if(this._iv)return this._validateFrameId=R._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var n=R._renderInfo.frame;if(this._validateFrameId!==n)return this._validateFrameId=n,!0
}return!1},validate:function(n,H){var p=this,o=p.gv,d=p.data,G=p.shapeName=p.s(Fq),B=Eg(p,G);p._updateAutoRotation(),p._updateFixSize2d(),p._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(se(o,d,"_wireframeModelMap","_wireframeIndexMap"),se(o,d,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var z=Ti(d,o.getMat(d),B?p.s("shape3d.scaleable"):!0),h=p._calcAnchorMat(d);if(h&&Ej(z,z,h),d.mat=z,p.clear(),B||!G)if(n){var R=[];B?Tn(o,d,B,p,p.getBodyColor(),[z],n,R):(jk(o,d,n,H,z,Km,R,xn),jk(o,d,n,H,z,_i,R,rs),jk(o,d,n,H,z,ai,R,os),jk(o,d,n,H,z,el,R,ng),jk(o,d,n,H,z,Sg,R,Mm),jk(o,d,n,H,z,sl,R,Wi)),R.length&&(qp(n.vs,R),qp(n.ns,Tq(R)))}else p.mat=z,(p.shapeModel=B)||(p._cubeUvs=null,p.vf(Km,0),p.vf(_i,16),p.vf(Sg,8),p.vf(sl,24),p.vf(ai,32),p.vf(el,40))},_updateAutoRotation:function(){var U=new Ak;return function(){var X=this,H=X.data,f=X.s("shape3d.autorotate");if(!f)return H._dynamicRotation&&delete H._dynamicRotation,void 0;var c,z=X.gv;c="string"==typeof f?[f.indexOf("x")<0?z._eye[0]:z._center[0],f.indexOf("y")<0?z._eye[1]:z._center[1],f.indexOf("z")<0?z._eye[2]:z._center[2]]:z._eye;var j=z._center,x=H.p3(),s=mp([x[0]+c[0]-j[0],x[1]+c[1]-j[1],x[2]+c[2]-j[2]],x,z._up);U.set(0,0,0,H.getRotationMode(),!0).setFromRotationMatrix(s);var A=H._dynamicRotation;A&&Math.abs(A[0]-U.x)<1e-5&&Math.abs(A[1]-U.y)<1e-5&&Math.abs(A[2]-U.z)<1e-5||(H._dynamicRotation=[U.x,U.y,U.z])}}(),_updateFixSize2d:function(){var o=this,J=o.data,b=o.s("shape3d.fixSizeOnScreen");if(!b)return J._dynamicScale3d&&delete J._dynamicScale3d,void 0;var w=o.gv;J.getFinalScale3d();var Q=Ti(J,w.getMat(J)),E=gr([0,0,0],Q),l=w.toViewPosition(E);if(!isNaN(l.x)&&!isNaN(l.y)){var e=gr([1,0,0],Q),G=w.toViewPosition(e),V=gr([0,1,0],Q),L=w.toViewPosition(V),Y=G.x-l.x,p=L.y-l.y;if(Y&&p){var S=J._dynamicScale3d||[1,1,1],s=Hf(J.s("shape3d.image")),I=b[0]>0?b[0]:s?li(s,J):20,q=b[1]>0?b[1]:s?Kn(s,J):20,F=Math.abs(Y/I),R=Math.abs(p/q);Math.abs(F-1)<.001&&Math.abs(R-1)<.001||(J._dynamicScale3d=[S[0]/F,S[1]/R,S[2]])}}},_updateOverlapping:function(){var h=this,Y=h.s("hide.overlapping.group");if(!Y)return h._rectOverlapping&&(h._rectOverlapping=J),void 0;var I,D,M,A=h.gv,l=h.data,t=Ti(l,A.getMat(l)),g=1/0,w=1/0,e=-1/0,O=-1/0,T=l.getAnchor3d(),S=T.x,H=T.y,r=T.z;for(I=0;8>I;I++){if(D=gr([(I>>2)-S,(1&I>>1)-H,(1&I)-r],t),M=A.toViewPosition(D),isNaN(M.x)||isNaN(M.y))return;g=Math.min(g,M.x),e=Math.max(e,M.x),w=Math.min(w,M.y),O=Math.max(O,M.y)}var W={x:g,y:w,w:e-g,h:O-w};h._rectOverlapping=A.overlappingBox.isOverlapping(Y,W)},getVectorDynamicSize:function(){var l,L=this,M=L.s("shape3d"),I=L.data;if("billboard"===M||"plane"===M||(l=I._currentCubeElementId)!=d){var p,h,z=L.gv,J=Ti(I,z.getMat(I)),H=I.getAnchor3d(),N=.5-H.x,y=.5-H.y,T=.5-H.z,W=L.s("shape3d.vector.dynamic.maxsize"),F=function(w,P){w[0]+=N,w[1]+=y,w[2]+=T,P[0]+=N,P[1]+=y,P[2]+=T;var H=z.toViewPosition(gr(w,J)),b=z.toViewPosition(gr(P,J)),e=H.x-b.x,l=H.y-b.y;return Math.min(W,Math.sqrt(e*e+l*l))};if("billboard"===M)p=F([-.5,0,0],[.5,0,0]),h=F([0,-.5,0],[0,.5,0]);else if("plane"===M)p=F([-.5,0,0],[.5,0,0]),h=F([0,0,-.5],[0,0,.5]);else if(I._currentCubeElementId!=d){var v=3*ko[l+1],e=3*ko[l],r=3*ko[l+2];p=F([Pr[v],Pr[v+1],Pr[v+2]],[Pr[r],Pr[r+1],Pr[r+2]]),h=F([Pr[v],Pr[v+1],Pr[v+2]],[Pr[e],Pr[e+1],Pr[e+2]])}return[p,h]}},getCachedTexture:function(){var y=this,$=y.data,N=$._currentCubeElementId;return N!=d?y._cubeCachedImage?y._cubeCachedImage[N]:null:y._shape3dCachedImage},setCachedTexture:function(x){var _=this,h=_.data,K=h._currentCubeElementId;K!=d?(_._cubeCachedImage||(_._cubeCachedImage={}),_._cubeCachedImage[K]=x):_._shape3dCachedImage=x},invalidateCachedTexture:function(U){var F,f,l,x=this;if((l=x._shape3dCachedImage)&&(U.deleteTexture(l),x._shape3dCachedImage=null),f=x._cubeCachedImage){for(F in f)U.deleteTexture(f[F]);x._cubeCachedImage=null}},vf:function(J,j){var f=this;if(f.gv.getFaceVisible(f.data,J)){var p=Xm(f,J);p.mat&&(f.faceMat=!0);var r=p.uv;if(r){var k=f._cubeUvs;k||(k=f._cubeUvs=new Kp([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var w=0;8>w;w++)k[j+w]=r[w]}return p}},_billboardInView:function(){var T=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],U=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],u=new qf(new On(-1,-1,-1),new On(1,1,1)),W=new qf,Y=new On,w=new vk,p=new vk;return function(g){var s=this;if(!s.mat)return!0;var _="billboard"===g?T:U;W.makeEmpty(),p.fromArray(s.mat),w.fromArray(s.gv.getPVMatrix()).multiply(p);for(var e=0,H=_.length;H>e;e+=3)W.expandByPoint(Y.fromArray(_,e).applyMatrix4(w));return W.intersectsBox(u)}}(),_80o:function(U,N,e){var v=this;if(v._rectOverlapping)return!0;var G=v.shapeModel;if(G||!v.shapeName){var o=v.s("shape3d");if(("billboard"===o||"plane"===o)&&!v._billboardInView(o))return!0;var y=v.gv,Q=v.data,K=y._cube;Qc(y,v.mat),G?Ql(y,Q,G,v,v.getBodyColor(),e):(Cg(U,K.vs,d,N.aPosition),Cg(U,K.ns,d,N.aNormal),xg(U,K.is),v._18O(U,N,v.left,0,e),v._18O(U,N,v.front,6,e),v._18O(U,N,v.right,12,e),v._18O(U,N,v.back,18,e),v._18O(U,N,v.top,24,e),v._18O(U,N,v.bottom,30,e)),Io(y),v.faceMat&&(v._18O(U,N,v.left,0,e,!0),v._18O(U,N,v.front,6,e,!0),v._18O(U,N,v.right,12,e,!0),v._18O(U,N,v.back,18,e,!0),v._18O(U,N,v.top,24,e,!0),v._18O(U,N,v.bottom,30,e,!0))}},_18O:function(l,r,I,Q,s,n){if(I){if(!s(I.transparent))return;if(n&&!I.mat||!n&&I.mat)return;var v=this.data.s("polygonOffset");v&&Jg(l,v),n&&Qc(this.gv,I.mat);var w=this,m=w.data;m._currentCubeElementId=Q;var E=w.gv,j=E.getTexture(I.texture,m),h=I.uv,u=I.uvScale,g=I.uvOffset,x=I.discardSelectable;j?h?Bb(l,r,j,x,E._buffer.uv,w._cubeUvs,g,u):Bb(l,r,j,x,E._cube.uv,d,g,u):Bb(l),no(l,r,I.blend,I.light,I.opacity,I.reverseFlip,I.reverseColor,I.reverseCull),Dj(l,r.uDiffuse,I.color||S["color.empty"]),Qj(l,Q,6),Tb(l,r),sn(l,r,j),n&&Io(E),v&&zi(l),m._currentCubeElementId=null}}});var Ec=function(D,t){ii(Ec,this,[D,t])};$o(Ec,ar,{_25Q:1,validate:function(L){var O=this,b=O.gv,I=O.data,t=O.s,G=t("edge.width"),M=I._40I,c=I._41I;if(O.shapeModel=O.info=d,M&&c){var K,k,H,x,p,w,m,P,J,u,v=I.isLooped(),Z=t(lc),S=F.getEdgeType(Z);if(S){var B=S(I,_j(O,b,I,v,Z),b,O._19Q);if(!B.points||B.points.isEmpty())return;w=O.info={},m=B.segments,p=B.points,P=p.size();for(var z=M.getElevation(),E=c.getElevation(),a=0;P>a;a++){var N=p.get(a);N.e==d&&(N.e=z+(E-z)*a/(P-1))}J=wp(p.get(0)),u=wp(p.get(P-1));var T=P%2;0===T?(w.c1=wp(p.get(P/2-1)),w.c2=wp(p.get(P/2))):w.p3=wp(p.get((P-T)/2)),w.s1=J,w.s2=wp(p.get(1)),w.t1=wp(p.get(P-2)),w.t2=u}else{p=new nm,w=O.info={};var r=t("edge.offset"),y=t("edge.center"),X=t("edge.source.t3"),i=t("edge.target.t3"),W=M.p3(),g=c.p3();if(X&&(W[0]+=X[0],W[1]+=X[1],W[2]+=X[2]),i&&(g[0]+=i[0],g[1]+=i[1],g[2]+=i[2]),Z===of){m=t("edge.segments");var q=w.points=t(Zk)||pr;if(P=q.size()){J=wp(q.get(0)),u=wp(q.get(P-1)),!y&&r&&(H=Te(J,W,!0),r=e(r,jc(W,J)),W=[W[0]+H[0]*r,W[1]+H[1]*r,W[2]+H[2]*r],H=Te(g,u,!0),r=e(r,jc(u,g)),g=[g[0]-H[0]*r,g[1]-H[1]*r,g[2]-H[2]*r]);var T=P%2;0===T?(K=wp(q.get(P/2-1)),k=wp(q.get(P/2))):w.p3=wp(q.get((P-T)/2)),w.s1=W,w.s2=J,w.t1=u,w.t2=g}else!y&&r&&(H=Te(g,W,!0),x=jc(W,g),r=Kc(r,x),W=[W[0]+H[0]*r,W[1]+H[1]*r,W[2]+H[2]*r],g=[g[0]-H[0]*r,g[1]-H[1]*r,g[2]-H[2]*r]),K=W,k=g;p.add({x:W[0],y:W[2],e:W[1]}),p.addAll(q),p.add({x:g[0],y:g[2],e:g[1]})}else{var j=_j(O,b,I,v,Z);if(O._19Q||(j=-j),v){var n=W[0],h=W[1],A=W[2],$=M.getTall()/2+j;K=[n-j,h+$,A],k=[n+j,h+$,A],p.add({x:n-j,y:A,e:h}),p.add({x:n-j,y:A,e:h+$}),p.add({x:n+j,y:A,e:h+$}),p.add({x:n+j,y:A,e:h})}else{H=Te(g,W,!0),x=jc(W,g);var s={x:W[0],y:W[2]},R={x:g[0],y:g[2]},Y=yq(d,s,R,j),V=Y.x-s.x,_=Y.y-s.y;r=Kc(r,x),H[0]*=r,H[1]*=r,H[2]*=r,K=[W[0]+H[0]+V,W[1]+H[1],W[2]+H[2]+_],k=[g[0]-H[0]+V,g[1]-H[1],g[2]-H[2]+_],y?(p.add({x:W[0],y:W[2],e:W[1]}),p.add({x:K[0],y:K[2],e:K[1]}),p.add({x:k[0],y:k[2],e:k[1]}),p.add({x:g[0],y:g[2],e:g[1]})):(p.add({x:K[0],y:K[2],e:K[1]}),p.add({x:k[0],y:k[2],e:k[1]}))}}w.c1=K,w.c2=k}w.list=t(Fq)===_q?O.createTubeModel(p,m,G/2,L):O.createLineModel(p,m,G,"edge","edge.dash")}}});var Ch=function(O,D){ii(Ch,this,[O,D])};$o(Ch,Zc,{_80o:function(U,Z,F){var D=this,$=D.gv,l=D.shapeModel;Qc($,D.mat),l?Ql($,D.data,l,D,D.getBodyColor(),F):(tk(D,U,Z,D.left,F),tk(D,U,Z,D.front,F),tk(D,U,Z,D.right,F),tk(D,U,Z,D.back,F),tk(D,U,Z,D.top,F),tk(D,U,Z,D.bottom,F)),Io($)},validate:function(l,A){var T,B,R=this,S=R.s,M=R.data,X=M.p3(),Q=M._thickness/2,I=M.isClosePath(),z=M.getPoints(),r=M.getSegments(),x=S(Ij),h=l&&l.uv;if(R.clear(),0>Q)B=R.shapeModel=No(z,r,S(tq),S(sj),x,S(np),M.getTall(),M.getShapeElevation(),I),S(fm)?S("shape3d.image")||delete B.uv:(delete B.vs,delete B.ns,delete B.uv),S("shape3d.top.image")||delete B.top_uv,S("shape3d.bottom.image")||delete B.bottom_uv;else if(S(Fq)===_q)T=vm(z,r,x,I),B=R.shapeModel={vs:[]},S("shape3d.image")&&(B.uv=[],B.sum=S(np)||mh(T)||1,B.len=0),S(tq)&&!I&&(B.top_vs=[],S("shape3d.top.image")&&(B.top_uv=[])),S(sj)&&!I&&(B.bottom_vs=[],S("shape3d.bottom.image")&&(B.bottom_uv=[])),R._12O(T,Q);else{var p,i,Y,k,m,u,V,K,Z,D;if(T=vm(z,r,x,I),m=R.vf(Sg,h,!1,A),Q&&(u=R.vf(sl,h,!1,A),V=I?d:R.vf(Km,h,!1,A),K=I?d:R.vf(_i,h,!1,A),Z=R.vf(ai,h,!1,A),D=R.vf(el,h,!1,A)),Q){for(var U=0,P=T.length;P>U;U++)T[U]=R._tryRemoveBezierPoints(T[U],Q);R._12O(T,Q)}else m&&T.forEach(function(x){if(k=x.length,k>0)for(p=x[0],Y=1;k>Y;Y++)i=x[Y],R.addV(m.vs,p,i),p=i});R._20Q(T),l||(m&&(m.ns=Tq(m.vs),Uh(m,"vs"),Uh(m,Fc)),Q&&(u&&(u.ns=Tq(u.vs),Uh(u,"vs"),Uh(u,Fc)),V&&(V.ns=Tq(V.vs),Uh(V,"vs"),Uh(V,Fc)),K&&(K.ns=Tq(K.vs),Uh(K,"vs"),Uh(K,Fc)),Z&&(Z.ns=Tq(Z.vs),Uh(Z,"vs"),Uh(Z,Fc)),D&&(D.ns=Tq(D.vs),Uh(D,"vs"),Uh(D,Fc))))}var t=R.mat=ys();ve(t,X),jl(t,M.getFinalRotation3d(),M.getRotationMode());var E=M.getScale3d(),J=M._dynamicScale3d;J&&(E[0]*=J[0],E[1]*=J[1],E[2]*=J[2]),rq(t,E),ve(t,pe(X)),l&&(xm(R,t,l,B),R.clear())},_20Q:function(D){var l,Y,M,g,s,q,c,O=this,m=O.front,K=O.back,t=O.top,i=O.bottom,N=m?m.tuv:d,Z=K?K.tuv:d,o=t?t.tuv:d,L=i?i.tuv:d,b=0;(N||Z||o||L)&&(l=O.s(np)||mh(D)||1,D.forEach(function(Q){if(Y=Q.length,Y>0)for(q=Q[0],M=1;Y>M;M++)c=Q[M],g=b/l,b+=jc(q,c),s=b/l,O._14O(m,g,s),O._14O(K,1-s,1-g),O._14O(t,g,s),O._14O(i,g,s),q=c}))},_14O:function(T,G,Y){if(T){var L=T.uv,q=T.tuv;if(q){if(L)var c=L[0]+(L[6]-L[0])*G,E=L[1]+(L[7]-L[1])*G,O=L[2]+(L[4]-L[2])*G,$=L[3]+(L[5]-L[3])*G,H=L[2]+(L[4]-L[2])*Y,D=L[3]+(L[5]-L[3])*Y,B=L[0]+(L[6]-L[0])*Y,I=L[1]+(L[7]-L[1])*Y;else c=G,E=0,O=G,$=1,H=Y,D=1,B=Y,I=0;q.push(O,$,H,D,B,I,B,I,c,E,O,$)}}},_13O:function(L){var t=L.uv,u=L.tuv;u&&(t?u.push(t[2],t[3],t[4],t[5],t[6],t[7],t[6],t[7],t[0],t[1],t[2],t[3]):u.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(r,U){var V=r.length;if(4>V)return r;var z,s,l,p,X,C,x=!1,T=function(v){return r[v]},f=function(W){return r[V-1-W]};for(X=0;1>=X;X++)for(C=X?f:T,s=C(0),l=C(1),z=2;V-1>z;z++)if(p=C(z),!p.remove)if(p.b){var B=yq(s,l,p,U);B.adjust?(p.remove=!0,x=!0):(s=l,l=p)}else s=l,l=p;if(!x)return r;var a=[];for(z=0;V>z;z++)r[z].remove||a.push(r[z]);return a},_12O:function(Q,J){var M,U,g,s,Z,C=this;Q.forEach(function(x){if(Z=x.length,Z>0)for(M={p:x[0],n:!0},s=1;Z>s;s++)U=x[s],g=Z-1>s?x[s+1]:d,C.addPoint(M,U,g,J,x)})},addPoint:function(S,$,Z,I,P){var z,R,o,X,h,F,t,B,Q,v=this,M=S.p,f=S.f,w=S.b,c=v.s("shape3d.side")||mk,E=v.s("shape3d.start.angle"),D=v.s("shape3d.sweep.angle"),L=v.shapeModel,T=v.data.isClosePath();if(S.n&&(S.n=!1,f=T&&P.length>2?yq(P[P.length-2],M,$,I):yq(d,M,$,I),w=Gh(M,f),L?L.top_vs&&v._10O(w,f,c,E,D,L.top_vs,L.top_uv):(z=v.left)&&(v.addV(z.vs,w,f),v._13O(z))),R=Z?yq(M,$,Z,I):T&&P.length>2?yq(M,$,P[1],I):yq(M,$,d,I),o=Gh($,R),L){var Y,s,u=L.vs,b=L.uv,g=L.sum;for(b&&(Y=L.len/g,L.len+=jc(M,$),s=L.len/g),F=v._9O(w,f,c,E,D),t=v._9O(o,R,c,E,D),B=0;c>B;B++)Q=B+1,qp(u,F[Q]),qp(u,t[B]),qp(u,F[B]),qp(u,t[B]),qp(u,F[Q]),qp(u,t[Q]),b&&(X=B/c,h=Q/c,b.push(Y,h,s,X,Y,X,s,X,Y,h,s,h));!Z&&L.bottom_vs&&v._10O(o,R,c,E,D,L.bottom_vs,L.bottom_uv,!0)}else!Z&&(z=v.right)&&(v.addV(z.vs,R,o),v._13O(z)),(z=v.front)&&v.addV(z.vs,f,R),(z=v.back)&&v.addV(z.vs,o,w),(z=v.top)&&v.addH(z.vs,f,R,o,w,!0),(z=v.bottom)&&v.addH(z.vs,w,o,R,f);S.p=$,S.f=R,S.b=o},_10O:function(w,c,_,M,m,z,k,K){var h,G,N=this,B=N.data,J=N._9O(w,c,_,M,m),Y=(w.x+c.x)/2,t=(w.y+c.y)/2,A=B.getShapeElevation(),D=0;for(D=0;_>D;D++)K?(qp(z,J[D]),qp(z,J[D+1])):(qp(z,J[D+1]),qp(z,J[D])),qp(z,[Y,A,t]),k&&(K?(h=p*(D+1)/_+M,G=p*D/_+M):(h=p*D/_+M,G=p*(D+1)/_+M),k.push(.5-.5*v(G),.5-.5*Z(G),.5-.5*v(h),.5-.5*Z(h),.5,.5))},_9O:function(q,A,J,m,R){var G,H,T=this,w=T.data,C=[],y=(q.x+A.x)/2,i=(q.y+A.y)/2,b=w.getTall()/2,B=w.getShapeElevation(),M=0;for(R=R||p;J>=M;M++)G=R*M/J+m,H=v(G),C.push([y+(q.x-y)*H,B+b*Z(G),i+(q.y-i)*H]);return C},addV:function(L,M,f){var Q=M.x,K=M.y,F=f.x,J=f.y,T=this.data,C=T.getShapeElevation(),y=T.getTall()/2;L.push(Q,C-y,K,F,C-y,J,F,C+y,J,F,C+y,J,Q,C+y,K,Q,C-y,K)},addH:function(v,E,j,R,p,c){var O=this.data,g=O.getTall()/2,T=O.getShapeElevation()+(c?g:-g);v.push(E.x,T,E.y,j.x,T,j.y,R.x,T,R.y,R.x,T,R.y,p.x,T,p.y,E.x,T,E.y)},vf:function(I,z,c,m){var s,K=this,B=K.gv.getFaceVisible(K.data,I);return(c||B)&&(s=Xm(K,I,m),s.vs=[],s.tuv=B&&(s.texture||z)?[]:d,s.visible=B),s}});var bq=function(h,r){ii(bq,this,[h,r])};$o(bq,ar,{_25Q:1,validate:function(f){var W=this,G=W.data,x=W.s,N=G.getPoints(),m=N.size();if(W.shapeModel=W.info=d,m>1){var P=W.info={},H=G.getSegments(),v=G.getThickness(),U=wp(N.get(0)),L=wp(N.get(m-1)),$=m%2;0===$?(P.c1=wp(N.get(m/2-1)),P.c2=wp(N.get(m/2))):P.p3=wp(N.get((m-$)/2)),P.s1=U,P.s2=wp(N.get(1)),P.t1=wp(N.get(m-2)),P.t2=L,P.list=x(Fq)===_q?W.createTubeModel(N,H,v/2,f):W.createLineModel(N,H,v,"shape.border","shape.dash")}var B=G.p3(),e=W.mat=ys();ve(e,B),jl(e,G.getFinalRotation3d(),G.getRotationMode());var A=G.getScale3d(),n=G._dynamicScale3d;n&&(A[0]*=n[0],A[1]*=n[1],A[2]*=n[2]),rq(e,A),ve(e,pe(B))},_80o:function(b,w,c){var I=this,C=I.shapeModel;if(C){var H=I.gv;Qc(H,I.mat),Ql(H,I.data,C,I,I.getBodyColor(),c),Io(H)}}});var Nd=P.graph3d.VR=function(d){var $=this;$.gv=d,$._controllers=[],$.switch=new rn($),$._enable=!1,$._defaultCallLater=P.Default.callLater,$._defaultCancelLater=In,"undefined"!=typeof H&&"VRFrameData"in H&&($._frameData=new H.VRFrameData),$.measureOflength=1,$.eyesOffset=[0,0,0],$._orientation=new P.Math.Quaternion,$._lastHeadPose=[0,0,0],$._offsetToBeAdd=[0,0,0],$._fpsInfo={time:0,fps:0,frames:0}};$o(Nd,r,{ms_fire:!0,_42:function(W,B,u,f){var q=this,j=q.gv;if(!j.drawFilter&&q._deviceInAction){var e=q._device;if(e){var y=q._measureOflength;e.depthNear=j.getNear()*y,e.depthFar=j.getFar()*y;var i=q._offsetToBeAdd;if(q.eyesOffset[0]+=i[0],q.eyesOffset[1]+=i[1],q.eyesOffset[2]+=i[2],i[0]=0,i[1]=0,i[2]=0,e.isPresenting===!1)return q._controllers.forEach(function(G){G&&G.update()}),j.iv(),!1;var k=q._frameData;e.getFrameData(k);var c=k.pose.position;if(c){var R=q.toViewPosition(c);j.setEye(R),q._orientation.fromArray(k.pose.orientation);var M=new P.Math.Vector3(0,0,-10*q._scaleFactor);M.applyQuaternion(q._orientation),j.setCenter([R[0]+M.x,R[1]+M.y,R[2]+M.z])}q._controllers.forEach(function(N){N&&N.update()}),j.setViewport(W,0,0,B/2,u),q._viewMatrix=q._copyViewMatrix(k.leftViewMatrix),q._projectMatrix=q._copyProjectMatrix(k.leftProjectionMatrix),f(),j.setViewport(W,B/2,0,B/2,u),q._viewMatrix=q._copyViewMatrix(k.rightViewMatrix),q._projectMatrix=q._copyProjectMatrix(k.rightProjectionMatrix),f(),q._lastViewMatrix=q._viewMatrix,q._lastProjectMatrix=q._projectMatrix,q._viewMatrix=null,q._projectMatrix=null,q.submitFrame();var d=Date.now(),t=q._fpsInfo;return d-t.time>1e3?(t.fps=Math.round(1e3*(t.frames+1)/(d-t.time)),t.time=d,t.frames=0):t.frames++,!0}}},onVRDisplayPresentChange:function(){var P=this.isPresenting();this._injectGraphView(P),this.fp("present",!P,P)},getOrientation:function(){return this._orientation},addController:function(S){S=S||0;var p=this,C=p.getController(S);return C?C:(C=new Yi(p,S),p._controllers.push(C),C)},getController:function(T){T=T||0;for(var p=this._controllers,M=0,l=p.length;l>M;M++)if(p[M]&&p[M].id===T)return p[M];return null},removeController:function(o){o=o||0;for(var N=this._controllers,b=0,J=N.length;J>b;b++)if(N[b]&&N[b].id===o)return N.splice(b,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(X,e){var o=this,R=o._scaleFactor,d=o._eyesOffset,f=o._lastHeadPose;return f[0]=X[0]*R,f[1]=X[1]*R,f[2]=X[2]*R,e?(e[0]=f[0]+d[0],e[1]=f[1]+d[1],e[2]=f[2]+d[2],e):[f[0]+d[0],f[1]+d[1],f[2]+d[2]]},addEyesOffset:function(O,l,d){var Z=this._offsetToBeAdd;Z[0]+=O,Z[1]+=l,Z[2]+=d},_copyViewMatrix:function(G){var s=this.dup(G),V=this._scaleFactor;s[12]*=V,s[13]*=V,s[14]*=V;var g=this._eyesOffset;if(g&&(g[0]||g[1]||g[2])){var A=g[0],S=g[1],l=g[2];s[12]-=s[0]*A+s[4]*S+s[8]*l,s[13]-=s[1]*A+s[5]*S+s[9]*l,s[14]-=s[2]*A+s[6]*S+s[10]*l}return s},shutdown:function(){var h=this._device;h&&h.isPresenting&&h.exitPresent()},isPresenting:function(){var f=this._device;return f&&f.isPresenting},_copyProjectMatrix:function(h){var r=this.dup(h),$=this._scaleFactor;return r[14]*=$,r},dup:function(X,f){for(var a=X.length,G=f||new Array(a);a--;)G[a]=X[a];return G},getViewMatrix:function(z){var B=this._viewMatrix;return B?this.dup(B,z):void 0},getProjectMatrix:function(){var _=this._projectMatrix;return _?this.dup(_):void 0},submitFrame:function(){var w=this;if(w._enable&&w._deviceInAction){var G=w._device;G&&G.isPresenting&&(G.submitFrame(),w.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(p){var n=this.gv;return n.intersectObjects(p,n.dm().getDatas())},setDevice:function(v){var $=this;$._device=v},_injectGraphView:function(){var C,X,E;return function(w){var Y=this.gv;if(!w)return C&&(Y.getWidth=C,Y.getHeight=X,Y.getDevicePixelRatio=E),void 0;var A=this._device,g=A.getEyeParameters("left"),e=g.renderWidth,M=g.renderHeight;C=Y.getWidth,X=Y.getHeight,E=Y.getDevicePixelRatio,Y.getWidth=function(){return 2*e},Y.getHeight=function(){return M},Y.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(W){var e=this;if(!W)return Vo=P.Default.callLater=e._defaultCallLater,In=P.Default.cancelLater=e._defaultCancelLater,void 0;var e=this;Vo=P.Default.callLater=function(C,B,g,f){var L=e._device;return L&&L.isPresenting?f?_(function(){Vo(C,B,g)},f):L.requestAnimationFrame(function(){e._deviceInAction=!0,C.apply(B,g),e._deviceInAction=!1}):e._defaultCallLater(C,B,g,f)},In=P.Default.cancelLater=function(n,d){var S=e._device;return S&&S.isPresenting?d?i(n):S.cancelAnimationFrame(n):e._defaultCancelLater(n,d)}}}),r.defineProperties(Nd.prototype,{enable:{get:function(){return this._enable},set:function(k){var x=this;x._enable!==k&&(x._enable=k,k?(x.switch.showButton(),x._injectCallLaterFunc(!0)):(x.shutdown(),x.switch.hideButton(),x._injectCallLaterFunc(!1)),x.fp("enable",!k,k))}},measureOflength:{get:function(){return this._measureOflength},set:function(y){this._measureOflength=y;var k=this._scaleFactor=1/y;this._controllers.forEach(function(U){U&&U._setScaleFactor(k)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(o){this._eyesOffset=o}},controllerModel:{get:function(){return this._controllerModel},set:function(R){var S;"object"==typeof R?(S=R.mtl,R=R.obj):(S=R+".mtl",R+=".obj");var u=this,L=u._controllerModel;L&&L.obj===R&&L.mtl===S||(L=u._controllerModel={obj:R,mtl:S},F.loadObj(R,S,{finishFunc:function(m,B){u._controllerModel===L&&F.setShape3dModel("vrControllerModel",B)}}))}},interactive:{get:function(){return!!this._interactive},set:function(j){!!j!=!!this._interactive&&(this._interactive=j,j&&this.addController(0),this.gv.getCoreInteractor().enableVR(j))}}});var Yi=function(r,W){function k(K){var U=navigator.getGamepads&&navigator.getGamepads();if(U)for(var Y=0,x=0,g=U.length;g>Y;Y++){var d=U[Y];if(d){var u=d.id;if("OpenVR Gamepad"===u||"OpenVR Controller"===u||0===u.indexOf("Oculus Touch")||0===u.indexOf("Spatial Controller")){if(x===K)return d;x++}}}}function c(t,N,q){return Math.abs(t[0]-N[0])<q&&Math.abs(t[1]-N[1])<q&&Math.abs(t[2]-N[2])<q?!0:!1}var f=this;f.vr=r,f.id=W;var L,q,Z=[0,0],b=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],B=new wb;B.s("shape3d","vrControllerModel"),B.isController=!0,B.s("intersect",!1),f.getGamepad=function(){return q},f.isButtonPressed=function(M){for(var i,e=0,u=b.length;u>e;e++)if(i=b[e],i.id===M)return i.pressed;return!1},f.getNode=function(){return B};var A=.003;f.setRotationEpsilon=function(P){A=P};var j=5e-4,Y=j;f.setPositionEpsilon=function(Z){j=Z,Y=Z*f.vr._scaleFactor},f._setScaleFactor=function(I){B.s3(I,I,I),Y=j*I},f._setScaleFactor(f.vr._scaleFactor);var h,o=new bg,g=new vk,S=[0,0,0],G=[0,0,0],H=new Ak,n=new On,P=new Qi;f.getRay=function(){return h?(P.origin.fromArray(S),P.direction.copy(n),h=!1,P):P},f.update=function(){if(L=q,q=k(W),L!=q&&console.log("gamepad changed",q),!q||q.pose===J)return q=null,B.s("3d.visible",!1),void 0;if(F.getShape3dModel("vrControllerModel")){B.dm()||r.gv.dm().add(B),B.s("3d.visible",!0);var y=q.pose;if(null!==y){y.position&&(f.vr.toViewPosition(y.position,S),c(B.p3(),S,Y)||(h=!0,B.p3(S))),y.orientation&&(o.fromArray(y.orientation),n.set(0,0,-1).applyQuaternion(o).normalize(),g.makeRotationFromQuaternion(o),H.set(0,0,0,B.getRotationMode(),!0).setFromRotationMatrix(g),G[0]=H.x,G[1]=H.y,G[2]=H.z,c(B.r3(),G,A)||(h=!0,B.r3(G))),h&&r.fp("gamepad.pose",null,{position:S,rotation:G,id:W});var j=q.axes;(Z[0]!==j[0]||Z[1]!==j[1])&&(Z=[j[0],j[1]],r.fp("gamepad.axes",null,{id:W,axes:Z}));var p,D,C,O,v=q.buttons;for(p=0,D=v.length;D>p;p++)if(C=v[p],O=C.pressed,O!==b[p].pressed){b[p].pressed=O;var t={id:W},w="state";t[w]=t._62O=O?"down":"up",r.fp("gamepad.button."+b[p].id,null,t)}}}}},rn=function(t){this.vr=t,this._button=null};$o(rn,r,{showButton:function(){var l=this.assureButton();if(!l.parentNode){var v=this.vr.gv,g=v.getView();v._79O?g.insertBefore(l,v._79O):g.appendChild(l)}},hideButton:function(){var Z=this._button;Z&&Z.parentNode&&Z.parentNode.removeChild(Z)},assureButton:function(){var z=this._button;return z?z:this._button=this.createButton(this.vr.gv)},createButton:function(M){function E(s,A){s.textContent=A&&A.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function J(K){f.style.display="",f.style.cursor="pointer",f.style.left="calc(50% - 50px)",f.style.width="100px",E(f,K),f.onmouseenter=function(){f.style.opacity="1.0"},f.onmouseleave=function(){f.style.opacity="0.5"},f.onclick=function(){K.isPresenting?K.exitPresent():K.requestPresent([{source:M.getCanvas()}])},M.vr.setDevice(K)}function s(){f.style.display="",f.style.cursor="auto",f.style.left="calc(50% - 75px)",f.style.width="150px",E(f,null),f.onmouseenter=null,f.onmouseleave=null,f.onclick=null,M.vr.setDevice(null)}function u(K){K.style.position="absolute",K.style.bottom="20px",K.style.padding="12px 6px",K.style.border="1px solid #fff",K.style.borderRadius="4px",K.style.color="#000",K.style.font="normal 13px sans-serif",K.style.textAlign="center",K.style.opacity="0.5",K.style.outline="none",K.style.zIndex="999"}if("getVRDisplays"in navigator){var f=this._button=b.createElement("button");return f.style.display="none",u(f),H.addEventListener("vrdisplayconnect",function(K){J(K.display)},N),H.addEventListener("vrdisplaydisconnect",function(){s()},N),H.addEventListener("vrdisplaypresentchange",function(J){E(f,J.display),M.vr.onVRDisplayPresentChange()},N),navigator.getVRDisplays().then(function(X){X.length>0?J(X[0]):s()}),f}var y=b.createElement("a");return y.href="https://webvr.info",y.innerHTML="当前不支持 webvr",y.style.left="calc(50% - 90px)",y.style.width="180px",y.style.textDecoration="none",u(y),y}}),r.defineProperties(rn.prototype,{});var dj=P.graph3d.PostProcessing=function(k){function $(){if(!T){var r=k.getGL();T=new Ir.RenderTarget(k,r,null,null,{samples:S.renderTextureSamples||1}),K=new Xk.Shader(r,N.vs,N.fs),o=Xk.Buffer.createIndexBuffer(r,new Uint16Array([0,2,1,1,2,3])),x=Xk.Buffer.createVertexBuffer(r,new Float32Array([0,0,1,0,0,1,1,1]))}}var T,K,o,x,a=this,g={},f=!1;!function(){r.keys(dj).forEach(function(d){g[d]=new dj[d](k)})}(),a.getModule=function(O){return O?g[O]:a},a.getModuleList=function(){return r.keys(g)},a.handleDataModleChange=function(g,Q){g&&(g.setPostProcessingData(a.serialize()),g.removeSerializeListener(a.onDataModelSerialize,a)),Q&&(Q.addSerializeListener(a.onDataModelSerialize,a),a.deserialize(Q.getPostProcessingData()))},a.onDataModelSerialize=function(K){"serialize"===K.type?k.dm()._postProcessingData=a.serialize():"deserialize"===K.type&&a.deserialize(k.dm().getPostProcessingData())},a.serialize=function(){var Y,t,o,A={};for(Y in g)t=g[Y],A[Y]={enable:t.enable},o=t.serializeProperties,o&&o.forEach(function(O){A[Y][O]=t[O]});return A},a.deserialize=function(P){if(P){var b,t,e,A;for(b in P)if(t=g[b]){e=P[b],a.enableModule(b,e.enable);for(A in e)"enable"!==A&&(t[A]=e[A])}}else{var b,t;for(b in g)t=g[b],t.enable=!1,t.resetProperties&&t.resetProperties()}},a.decodeShader=function(P){var o,x,U,z="",F="";for(U=0;U<P.length;U++)o=P[U],"%"===o?o="'":"a"===o?o='"':"]"===o&&(o="\\"),x=String.fromCharCode(o.charCodeAt(0)-1),U%2?F+=x:z=x+z;return F+z},a.createShader=function(p,W,g){var C=W.indexOf("^#"),r=a.decodeShader(W.substr(0,C)),X=a.decodeShader(W.substr(C+2));if(g){var x=g(r,X);x&&x.vs&&(r=x.vs),x&&x.fs&&(X=x.fs)}return new Xk.Shader(p,r,X)},a.enableModule=function(L,j){var s,W,y,t=L.split(",");for(s=0,W=t.length;W>s;s++)y=t[s].trim(),g[y]&&(g[y].enable=j);f=!1;for(y in g)if(g[y].enable){f=!0;break}f&&$()};var N={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};a._42=function(D,w,s,M,X){if(f&&!X){T.setSize(D,w,s),T.bind(D),D.clear(D.COLOR_BUFFER_BIT|D.DEPTH_BUFFER_BIT),k.setViewport(D,0,0,w,s),M(),T.unbind(D);var C,S=T;for(C in g)S=g[C]._42(D,S)||S;return k.setViewport(D,0,0,w,s),D.clear(D.COLOR_BUFFER_BIT|D.DEPTH_BUFFER_BIT),K.bind(),D.activeTexture(D.TEXTURE0+0),D.bindTexture(D.TEXTURE_2D,S.texture),K.uniforms.image=0,o.upload(),x.upload(),K.attributes.pos.pointer(x),D.drawElements(D.TRIANGLES,6,D.UNSIGNED_SHORT,0),D.bindTexture(D.TEXTURE_2D,null),D.useProgram(k._prg),!0}}},yo=P.graph3d.PostProcessing.Bloom=function(I){function c(){var D=I.getWidth(),g=I.getHeight();if(D&&g){i=[D,g],$=!0;var B,Q=I.getGL(),L=Math.round(i[0]/2),p=Math.round(i[1]/2);for(U=new Ir.RenderTarget(I,Q,L,p),B=0;f>B;B++)E.push(new Ir.RenderTarget(I,Q,L,p)),l.push(new Ir.RenderTarget(I,Q,L,p)),L=Math.round(L/2),p=Math.round(p/2);var v=I._postProcessing;H=v.createShader(Q,yo._34Q);for(var B=0;f>B;B++)O[B]=v.createShader(Q,yo._35Q,function(q,I){return{fs:I.replace(/DEFINE_VALUE/g,V[B])}});Z=v.createShader(Q,yo._36Q,function(n,S){return{fs:S.replace(/NUM_MIPS/g,f)}}),j=v.createShader(Q,yo.finalShader),A=Xk.Buffer.createIndexBuffer(Q,new Uint16Array([0,2,1,1,2,3])),z=Xk.Buffer.createVertexBuffer(Q,new Float32Array([0,0,1,0,0,1,1,1]))}}var D,x,p,A,z,R=this,J=!1,$=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){D=1.5,x=.55,p=.4},r.defineProperties(R,{enable:{get:function(){return J},set:function(N){!!J!=!!N&&(J=N,N&&!$&&c())}},strength:{get:function(){return D},set:function(t){D=t}},threshold:{get:function(){return x},set:function(X){x=X}},radius:{get:function(){return p},set:function(h){p=h}}}),this.resetProperties();var U,H,Z,j,i=[256,256],E=[],l=[],f=5,V=[3,5,7,9,11],O=[];R._42=function(s,a){function u(G,H,$,f){qj(s,H.frame),I.setViewport(s,0,0,H.width,H.height),f?f(s):s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),t!==G&&G.bind();var o=0;for(var S in $){var x=$[S];x instanceof WebGLTexture&&(s.activeTexture(s.TEXTURE0+o),s.bindTexture(s.TEXTURE_2D,x),x=o,o++),G.uniforms[S]=x}for(t!==G&&(A.upload(),z.upload(),G.attributes.pos.pointer(z),t=G),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0);o--;)s.activeTexture(s.TEXTURE0+o),s.bindTexture(s.TEXTURE_2D,null);cm(s)}if(J){$||c();var t;u(H,U,{smoothWidth:.01,luminosityThreshold:x,tDiffuse:a.texture});var m,q=U,N=Math.round(i[0]/2),V=Math.round(i[1]/2);for(m=0;f>m;m++)u(O[m],E[m],{colorTexture:q.texture,direction:[1,0],texSize:[N,V]}),u(O[m],l[m],{colorTexture:E[m].texture,direction:[0,1],texSize:[N,V]}),N=Math.round(N/2),V=Math.round(V/2),q=l[m];return u(Z,E[0],{blurTexture1:l[0].texture,blurTexture2:l[1].texture,blurTexture3:l[2].texture,blurTexture4:l[3].texture,blurTexture5:l[4].texture,bloomStrength:D,bloomRadius:p,bloomTintColor:[1,1,1]}),u(j,a,{image:E[0].texture},function(G){G.enable(G.BLEND),G.blendEquation(G.FUNC_ADD),G.blendFunc(G.SRC_ALPHA,G.ONE)}),s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD),s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA),a}}};yo._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",yo._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d1j/t2j!p-on!viTjuhiihqj!fgxm0pnbvuT<ftwvbgsgzjjeo)h5!dwffwd!3>!!wsVpwm<pDvhobjsgGp`smnh!t~bn<qxm!f+s!31E/!3d!p>m,p!snUvfTyuuivhsjff<xv<oxj!g+p!s*n3!fwmfqdn3b!tu!f,y!T2jf{mfq<nbvto)j!g>p,s!nn!vwTffdt3v!gegjjsefd<ucjhpso/<*u$fetfgggjPowfv!!L.F!SwOVFwM!`-SfBsEvJuVyTf!UEsFpGmJpOdF!`)WEB3MfVsFvu$yeffug!j>o!f3!fTmJqHnNbBt!!E4FdGfJwOF<`cWhBsM/V*FufgtmgpgbPuw!vh!b,v!twtVjwb!o-Qfesgv)ujyof!Ugsmppmbpud!!y)-E!3jfos!vgumypfbuu!!>t!j2hfnmbq*n!b|t!s4fdufvwso<!y1!/+4!:f9{:j5T!w+o!jf!y+q!)o!p.j1u/d6f!s+j!ey!!>+!!uyf0t)g!gtPjwhvn!b3!d+f!wtj<h*nbbn*h*j0Ttgj!h-nyb)<ge~Qowbpjjtet!vnbbhj!o>)!*x!!|ubwpfmdg3!<j*ojw)Tujb{pfm!g>!!>2!/y1!!u0b!pumfgyT|j!{*f!<,,g!mjp!b<uT!VgJTEjBhSn`bM!F>O!SgFmLp!b=u!)jT!J<H2N!B>*!<j!gumopjb!u)!sxpfgjh<inuvTTvuni!h>j!fhxb!v+t!tcjhbso/Q*ewgV)w1!/-1f-s!vguTyjfhUnsbp*m<pdw!f)dE43!fesjvgugyvftuf!T>v!n",yo._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",yo.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Jk=P.graph3d.PostProcessing.Dof=function(P){function B(){Y=!0;var v=P.getGL();Q=new Ir.RenderTarget(P,v),X=P._postProcessing.createShader(v,Jk._38Q),w=Xk.Buffer.createIndexBuffer(v,new Uint16Array([0,2,1,1,2,3])),F=Xk.Buffer.createVertexBuffer(v,new Float32Array([0,0,1,0,0,1,1,1]))}var Q,X,w,F,q,K,g,T,m=this,c=!1,Y=!1;
this.serializeProperties="aperture,maxblur,image".split(","),this.resetProperties=function(){this.aperture=.025,this.maxblur=1,this.image=null},r.defineProperties(m,{enable:{get:function(){return c},set:function(l){!!c!=!!l&&(c=l,l&&!Y&&B())}},image:{get:function(){return K},set:function(j){K!==j&&(K=j,q&&(P.getGL().deleteTexture(q),q=null),P.iv())}},maxblur:{get:function(){return g},set:function(a){g!==a&&(g=a,P.iv())}},aperture:{get:function(){return T},set:function(Z){T!==Z&&(T=Z,P.iv())}}}),this.resetProperties(),m._42=function(T,b){function j(A,r,Q,R){qj(T,r.frame),P.setViewport(T,0,0,r.width,r.height),R?R(T):T.clear(T.COLOR_BUFFER_BIT|T.DEPTH_BUFFER_BIT),E!==A&&A.bind();var l=0;for(var f in Q){var u=Q[f];u instanceof WebGLTexture&&(T.activeTexture(T.TEXTURE0+l),T.bindTexture(T.TEXTURE_2D,u),u=l,l++),A.uniforms[f]=u}for(E!==A&&(w.upload(),F.upload(),A.attributes.pos.pointer(F),E=A),T.drawElements(T.TRIANGLES,6,T.UNSIGNED_SHORT,0);l--;)T.activeTexture(T.TEXTURE0+l),T.bindTexture(T.TEXTURE_2D,null);cm(T)}if(c){Y||B();var E;if(!q){var k=Hf(this.image);if(!k||!k.tagName)return b;q=Ue(T,k)}var $=b.width,S=b.height;return Q.setSize(T,$,S),j(X,Q,{tColor:b.texture,tDepth:q,aspect:$/S,aperture:this.aperture,maxblur:this.maxblur}),Q}}};Jk._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",im(F,{accordionViewExpandIcon:dq(We),accordionViewCollapseIcon:dq(We,!0),accordionViewLabelColor:Oh,accordionViewLabelFont:xr,accordionViewTitleBackground:xq,accordionViewSelectBackground:Ab,accordionViewSelectWidth:3,accordionViewSeparatorColor:J,splitViewDividerSize:1,splitViewDividerBackground:xq,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Ig,rect:[2,2,12,12],background:We}]},propertyViewLabelColor:co,propertyViewLabelSelectColor:Oh,propertyViewLabelFont:xr,propertyViewExpandIcon:dq(yn),propertyViewCollapseIcon:dq(yn,!0),propertyViewBackground:rr,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:fq,propertyViewColumnLineColor:fq,propertyViewSelectBackground:Ab,listViewLabelColor:co,listViewLabelSelectColor:Oh,listViewLabelFont:xr,listViewRowLineVisible:!1,listViewRowLineColor:fq,listViewSelectBackground:Ab,treeViewLabelColor:co,treeViewLabelSelectColor:Oh,treeViewLabelFont:xr,treeViewExpandIcon:dq(ne),treeViewCollapseIcon:dq(ne,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:fq,treeViewSelectBackground:Ab,treeViewDoubleClickToToggle:!0,tableViewLabelColor:co,tableViewLabelSelectColor:Oh,tableViewLabelFont:xr,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:fq,tableViewColumnLineColor:fq,tableViewSelectBackground:Ab,treeTableViewLabelColor:co,treeTableViewLabelSelectColor:Oh,treeTableViewLabelFont:xr,treeTableViewExpandIcon:dq(ne),treeTableViewCollapseIcon:dq(ne,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:fq,treeTableViewColumnLineColor:fq,treeTableViewSelectBackground:Ab,tableHeaderLabelColor:co,tableHeaderLabelFont:xr,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Ul,tableHeaderBackground:rr,tableHeaderMoveBackground:Op,tableHeaderInsertColor:Ab,tableHeaderSortDescIcon:un(yn,!0),tableHeaderSortAscIcon:un(yn),tabViewTabGap:1,tabViewLabelColor:Oh,tabViewLabelFont:xr,tabViewTabBackground:xq,tabViewSelectWidth:3,tabViewSelectBackground:Ab,tabViewMoveBackground:Op,tabViewInsertColor:Ab,toolbarLabelColor:co,toolbarLabelSelectColor:Oh,toolbarLabelFont:xr,toolbarBackground:rr,toolbarSelectBackground:Ab,toolbarItemGap:8,toolbarSeparatorColor:bh},!0);var Zq={translateX:1,sortColumn:1},_b={sortable:1,sortOrder:1,sortFunc:1},Gb={focusData:1},Yc={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},kh={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},gp=function(L,T){T.add(L),L.hasChildren()&&L.eachChild(function(c){gp(c,T)})},Do=function(v,K,H,q,U,N,$,x,R,e,Z){var O,I=H.getValueType(e),P=H.getAlign(e);if(H.getEnumValues(e)){var l=H.toEnumLabel(K,e),E=Lm||0,s=0,i=N,L=F.getTextSize(q,l).width;return O=Hf(H.toEnumIcon(K,e)),O&&(s=N+Lm/2,"center"===P?s+=(x-(E+L))/2:"right"===P&&(s=s+x-(E+L)),dg(v,O,s,$+R/2,e,Z),i=s+Lm/2),l!=d&&(O?Kh(v,l,q,U,i,$,x-(i-N),R):Kh(v,l,q,U,N,$,x,R,P)),void 0}return K=H.formatValue(K),K!=d?I===te?(Pe(v,N,$,x,R,K),void 0):I===Rb||!I&&dr(K)?(O=Hf(K?Sb:Sf),dg(v,O,N+x/2,$+R/2,e,Z),void 0):(Kh(v,K,q,U,N,$,x,R,P),void 0):void 0},gk=function(l,h){var J=h.view,O=Wd(l),I=h.column||h.property;J.getDataModel().beginTransaction(),h.editor=l,l.info=h,J.setCurrentEditor(l),J.getView().insertBefore(O,J._79O),Hi(l,h.editorRect),l.setFocus?l.setFocus():Wr(l),l.commitValue=function($,j){l._17Q&&(l=l._17Q),j||J.setValue(h.data,I,l.getValue?l.getValue():l.value),l.close&&l.close(),Hq(O)},I.onEditorCreated&&I.onEditorCreated(h)},Bq=function(H,Q,D,T,L){var c=bj(H,D),z=Q.value,f=Q.view,s=L.getValueType(Q.data);return c.onblur=c.onchange=function(){f.endEditing()},"input"===H?(z=L.formatValue(z),z!=d&&(c.value=z),c.onkeydown=function(y){mq(y)?f.endEditing():xd(y)&&f.endEditing(!0)},(s===ij||s===ml)&&c.addEventListener(jn,F.numberListener,N)):H===$i&&T.forEach(function(n){var N=b.createElement("option");N.innerHTML=L.toEnumLabel(n),N.value=n,L.isEnumEqual(z,n)&&(N.selected=!0),oq(c,N)}),gk(c,Q),c},an=P.widget={},ho=function(s,n,v){$o(l+".widget."+s,n,v)};im(Mr,{ms_value:function(o){o.getValue=function(E){var l=this.getItemById(E),u=l.element;return Jp(u)?u:u?u.getValue?u.getValue():u.value:l.selected},o.setValue=function(X,z){var o=this.getItemById(X);if(o){var F=o.element;F&&!Jp(F)?F.setValue?F.setValue(z):F.value=z:dr(z)?(o.selected=z,this.iv()):(o.element=z,this.iv())}},o.v=function(L,n){var l=this;if(2===arguments.length)l.setValue(L,n);else{if(!yl(L))return l.getValue(L);for(var j in L)l.setValue(j,L[j])}return l}},_46o:function(W){W._icon=d,W._accessType=d,W._valueType=d,W._editable=!1,W._batchEditable=!0,W._align=Km,W._nullable=!0,W._emptiable=!1,W.setParent=sb,W.formatValue=function(A){var B=this,_=B._valueType;return B.getEnumValues()?B.toEnumLabel(A):_===Rb?!!A:A!=d&&_===ij?E(A):A},W.setEnum=function(s,P,b,t,K,S,h){var V=this;s&&!mo(s)&&s.values&&(t=s.editable,b=s.icons,P=s.labels,K=s.strict,S=s.maxHeight,h=s.dropDownWidth,s=s.values),mc(s)&&(s=s._as),mc(P)&&(P=P._as),mc(b)&&(b=b._as),V._enumValues=s,V._enumLabels=P,V._enumIcons=b,V._enumEditable=t,V._enumStrict=K==d?!0:K,V._enumMaxHeight=S,V._enumDropDownWidth=h,s&&s.length&&nq(s[0])&&(V._valueType=ml),V.fp("enum",!1,!0)},W.getEnumDropDownWidth=function(){return this._enumDropDownWidth},W.getEnumMaxHeight=function(){return this._enumMaxHeight},W.isEnumEditable=function(){return this._enumEditable},W.getEnumValues=function(){return this._enumValues},W.getEnumLabels=function(){return this._enumLabels},W.getEnumIcons=function(){return this._enumIcons},W.isEnumStrict=function(){return this._enumStrict},W.isEnumEqual=function(K,x){return this._enumStrict?K===x:K==x},W.toEnumLabel=function(v,E){var B=this,w=B.getEnumValues(E),Y=B.getEnumLabels(E);if(w&&Y)for(var T=0;T<w.length;T++)if(B.isEnumEqual(v,w[T]))return Y[T];return v},W.toEnumIcon=function(T,C){var w=this,R=w.getEnumValues(C),n=w.getEnumIcons(C);if(R&&n)for(var z=0;z<R.length;z++)if(w.isEnumEqual(T,R[z]))return n[z];return J}},_45o:function(g){g._87o=function(J,p,B,r,_,G){if(J){var j=this,c=j._90I,I=rp(1);j._columnLineVisible&&(_-=1),j._rowLineVisible&&(G-=1),0>=_||0>=G||(j._90I||(c=j._90I={}),c[p]||(c[p]=new nm),Hi(I,j.tx()+B,j.ty()+r,_,G),oq(I,J),j._view.insertBefore(I,j._79O),J.onParentAdded&&J.onParentAdded(I),c[p].add(I))}},g._76o=function(){var u=this,g=u._90I;if(g){for(var P in g)g[P].each(function(j){Hq(j)});delete u._90I}},g._77o=function(w){var U=this;if(U._90I){var $=U._90I[w];$&&($.each(function(w){Hq(w)}),delete U._90I[w])}}},_47o:function(u){u.getValue=function(I,q){return q.getValue?q.getValue(I,q,this):Vm(I,q.getAccessType(),q.getName())},u.setValue=function(p,Q,b){if(Q.isEmptiable(p)||""!==b||(b=J),Q.isNullable(p)||b!=d){var e=this,l=Q.getName(p),X=Q.getAccessType(p),w=Q.getValueType(p);w===ij&&Jp(b)?b=W(b):w===ml&&Jp(b)?b=parseFloat(b):w===Rb&&Jp(b)&&(b="true"===b),e._batchEditable&&Q._batchEditable&&e.isSelected(p)?e.sm().each(function(w){Q.setValue?Q.setValue(w,Q,b,e):bo(w,X,l,b)}):Q.setValue?Q.setValue(p,Q,b,e):bo(p,X,l,b)}},u.setCurrentEditor=function(s){this.endEditing(),this._currentEditor=s,this.redraw()},u.isEditing=function(M,R){var q=this,U=q._currentEditor;if(!U)return!1;if(R){var W=U.info;return W?(W.column||W.property)===R&&W.data===M:!1}return!0},u.endEditing=function(s){var D=this,w=D._currentEditor;w&&(delete D._currentEditor,w.commitValue&&w.commitValue(w.info,s),D.redraw(),D.getDataModel().endTransaction())},u.beginEditing=function(L){this.endEditing();var o=this,P=L.column||L.property;if(P.beginEditing)P.beginEditing(L);else{var B=L.data,j=L.value,c=o.getSelectBackground(B),f=P.getEnumValues(B),t=P.getSlider(B),h=P.getColorPicker(B);if(t){var u=sd(an.Slider,t);return u.setValue(j),u.getView().onblur=function(){o.endEditing()},u.isInstant()&&(u.onValueChanged=function(){o.setValue(B,P,u.getValue())}),gk(u,L),void 0}if(h||P.getValueType(B)===te){var Y=sd(an.ColorPicker,h);return Y.setValue(j),Y.onClosed=function(){o.endEditing()},Y.isInstant()&&(Y.onValueChanged=function(i,F){o.setValue(B,P,F)}),gk(Y,L),Y.open(),void 0}if(f){if(an.ComboBox){var r=new an.ComboBox;r.setValue(j),r.setValues(f),r.setLabels(P.getEnumLabels(B)),r.setIcons(P.getEnumIcons(B)),r.setEditable(P.isEnumEditable(B)),r.setStrict(P.isEnumStrict(B)),r.setMaxHeight(P.getEnumMaxHeight(B)),r.setDropDownWidth(P.getEnumDropDownWidth(B)),r.onClosed=function(){o.endEditing()},gk(r,L),r.open()}else Bq($i,L,c,f,P);return}var n=P.getValueType(B);if(n===Rb||dr(j))return o.setValue(B,P,!j),void 0;if(P.getItemEditor(B)){var T=bc(P.getItemEditor(B)),e=new T(B,P,o,L),U=e.getView();return U._17Q=e,e.setValue(j),Sh(U),gk(U,L),e.editBeginning&&e.editBeginning(),void 0}Bq("input",L,c,d,P)}}},_44o:function(b){b.init=function(T){var f=this,X=f.th=new Fd(T),P=f._view=up(1,f);f.tv=f._tableView=T,oq(P,X.getView()),oq(P,T.getView()),X.mp(function(O){O.property===Kq&&f.iv()}),f.iv()},b.getTableView=function(){return this.tv},b.getTableHeader=function(){return this.th},b.getDataModel=function(){return this.tv.dm()},b.getColumnModel=function(){return this.tv.getColumnModel()},b.setColumns=function(n){this.tv.setColumns(n)},b.addColumns=function(v){this.tv.addColumns(v)},b.endEditing=function(){this.tv.endEditing()},b.validateImpl=function(){var b=this,O=b.th,e=Rc(O),B={x:0,y:0,width:b.getWidth(),height:e};Hi(O,B),B.y=e,B.height=T(0,b.getHeight()-e),Hi(b.tv,B)}},ms_vs:function(L){L._41o=function(){return this._29I.height<this._59I},L._43o=function(){var G=this;G._41o()&&(G._58I||(_(function(){G._94O()},vs),G.iv()),G._58I=new Date)},L._94O=function(){var y=this;if(y._58I){var O=new Date;O.getTime()-y._58I.getTime()>=vs?(delete y._58I,y.iv()):_(function(){y._94O()},vs)}},L._93I=function(){var c=this,C=c._27I;if(c._58I||!c._autoHideScrollBar){C||oq(c._79O,C=c._27I=rp());var q=c._29I,T=q.height,i=c._59I,X=c.getScrollBarSize(),h=q.width-X-2,S=T*(-c.ty()/i),u=T*(T/i),g=C.style;i>T?(ls>u&&(S=S+u/2-ls/2,0>S&&(S=0),S+ls>T&&(S=T-ls),u=ls),g.visibility=Tl,g.background=c.getScrollBarColor(),g.borderRadius=X/2+Cf,Hi(C,h,S,X,u)):g.visibility=op}else C&&(C.style.visibility=op)}},ms_hs:function(e){e._40o=function(){return this._29I.width<this._91I},e._42o=function(){var Z=this;Z._40o()&&(Z._95O||(_(function(){Z._94I()},vs),Z.iv()),Z._95O=new Date)},e._94I=function(){var L=this;if(L._95O){var W=new Date;W.getTime()-L._95O.getTime()>=vs?(delete L._95O,L.iv()):_(function(){L._94I()},vs)}},e._92I=function(){var E=this,i=E._28I;if(E._95O||!E._autoHideScrollBar){i||oq(E._79O,i=E._28I=rp());var u=E._29I,x=u.width,e=E._91I,N=E.getScrollBarSize(),T=u.height-N-2,H=x*(-E.tx()/e),C=x*(x/e),K=i.style;e>x?(ls>C&&(H=H+C/2-ls/2,0>H&&(H=0),H+ls>x&&(H=x-ls),C=ls),K.visibility=Tl,K.background=E.getScrollBarColor(),K.borderRadius=N/2+Cf,Hi(i,H,T,C,N)):K.visibility=op}else i&&(i.style.visibility=op)}}}),Zh(Sb,ff(16,16,[{type:hp,rect:[1,1,14,14],background:Ab},{type:Um,rect:[1,1,14,14],width:1,color:hd},{type:zd,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Zh(Sf,ff(16,16,{type:Um,rect:[1,1,14,14],width:1,color:hd})),Zh(Lq,ff(16,16,[{type:To,rect:[2,2,12,12],borderWidth:1,borderColor:hd,background:"#FFF"},{type:To,rect:[4,4,8,8],background:Ab}])),Zh(Pc,ff(16,16,{type:To,rect:[2,2,12,12],borderWidth:1,borderColor:hd})),Mr._15Q=function(G){G._29I=xp,G._59I=0,G._91I=0,G._5o=function(f){var p=this;p._30I=new nm,p._rows=new nm,p._rowMap={},p._31I=0,p._14I=0,p._view=up(1,p),p._canvas=Ni(p._view),oq(p._view,p._79O=rp()),p.dm(f?f:new ac)},G.getCheckIcon=function(i){var G=this.sm(),V=G.co(i);return G.sg()?Hf(V?Lq:Pc):Hf(V?Sb:Sf)},G.checkData=function(o){var R=this.sm(),f=R.co(o);R.sg()&&f||(this._32o=1,f?R.rs(o):R.as(o),delete this._32o)},G.getDataAt=function(c){c.target&&(c=this.lp(c));var J=A(c.y/this._rowHeight),C=this._rows;return 0>J||J>=C.size()?d:C.get(J)},G.onDataDoubleClicked=function(){},G.onDataClicked=function(){},G.adjustTranslateX=function(){return 0},G.adjustTranslateY=function(k){var D=this.getHeight()-this._59I;return D>k&&(k=D),k>0?0:E(k)},G.onPropertyChanged=function(O){var U=this,s=O.property;Yc[s]?U.ivm():Gb[s]||U.redraw(),s===gl?U._42o():s===qk&&U._43o()},G.getLabel=function(M){return M.toLabel()},G.getLabelFont=function(){return this._labelFont},G.getLabelColor=function(V){var r=this;if(r.isCheckMode()){if(r._focusData===V)return r._labelSelectColor}else if(r.isSelected(V))return r._labelSelectColor;return r._labelColor},G.getStartRowIndex=function(){return this._31I},G.getEndRowIndex=function(){return this._14I},G.getRowDatas=function(){return this._rows},G.getRowIndex=function(m){return this._rowMap[m._id]},G.getRowSize=function(){return this._rows.size()},G.getViewRect=function(){return oe(this._29I)},G.isVisible=function(X){return this._visibleFunc?this._visibleFunc(X):!0},G.getCurrentSortFunc=function(){return this._sortFunc},G.setDataModel=function(_){var c=this,k=c._dataModel,Y=c._selectionModel;k!==_&&(k&&(k.umm(c.handleDataModelChange,c),k.umd(c.handleDataPropertyChange,c),k.umh(c.handleHierarchyChange,c),Y||k.sm().ums(c.handleSelectionChange,c)),c._dataModel=_,_.mm(c.handleDataModelChange,c),_.md(c.handleDataPropertyChange,c),_.mh(c.handleHierarchyChange,c),Y?Y._21I(_):_.sm().ms(c.handleSelectionChange,c),c.fp("dataModel",k,_))},G.validateModel=function(){var G=this;G._rows.clear(),G._rowMap={},G.buildChildren(G._dataModel._roots);var L=G._rows=G._rows.toList(G.isVisible,G),C=0,Z=G.getCurrentSortFunc(),t=L.size();for(Z&&L.sort(Z);t>C;C++)G._rowMap[L.get(C)._id]=C},G.buildChildren=function(M){var n=this;M.each(function(B){n._rows.add(B),n.buildChildren(B._children)})},G.handleDataModelChange=function(){this.ivm()},G.handleDataPropertyChange=function(c){"parent"===c.property?this.ivm():this.invalidateData(c.data)},G.handleHierarchyChange=function(){this.ivm()},G.handleSelectionChange=function(y){y.datas.each(this.invalidateData,this),this.onSelectionChanged(y)},G.onSelectionChanged=function(h){var z=this,c=z.sm();!z.isAutoMakeVisible()||1!==c.size()||"set"!==h.kind&&"append"!==h.kind||z._32o||z.makeVisible(c.ld())},G.handleBackgroundClick=function(e){fs(e)&&!this.isCheckMode()&&this.sm().cs()},G.makeVisible=function(i){i&&(this._23I=i,this.iv())},G.scrollToIndex=function(A){var N=this,_=N._29I,j=_.height,Z=N._rowHeight,h=Z*A;A>=0&&A<N._rows.size()&&j>0&&(h+Z>_.y+j?N.ty(-h+j-Z):h<_.y&&N.ty(-h))},G.autoScroll=function(f,v){var x=this,l=x._rowHeight,c=l,O=l/4,h=x._29I,S=x.lp(f),C={x:x.tx(),y:x.ty()};return l>0&&h&&(S.x-h.x<c?x.translate(O,0):h.x+h.width-S.x<c&&x.translate(-O,0),S.y-h.y<c?x.translate(0,O):h.y+h.height-S.y<c&&x.translate(0,-O)),C.x=x.tx()-C.x,C.y=x.ty()-C.y,v&&(v.x+=C.x,v.y+=C.y),C},G.getTopRowOrderSelection=function(){var n=this.sm().getTopSelection(),H={},A=new nm;return n.each(function(K){H[K._id]=K}),this._rows.each(function(U){H[U._id]&&A.add(U)}),A},G.getRowOrderSelection=function(){var l=new nm;return this._rows.each(function(Q){this.isSelected(Q)&&l.add(Q)},this),l},G.ivm=function(){this.invalidateModel()},G.invalidateModel=function(){var J=this;J._96I||(J._96I=1,J._32I=1,delete J._24I),J.iv()},G.redraw=function(){var s=this;s._32I||(s._32I=1,delete s._24I,s.iv())},G.invalidateData=function(V){var b=this;wg?b.redraw():b._32I||(b._24I||(b._24I={}),b._24I[V._id]=V,b.iv())},G.getFocusData=function(){return this._focusData},G.setFocusDataById=function(F){this.setFocusData(this.dm().getDataById(F))},G.setFocusData=function(a){var r=this,I=r._focusData;I!==a&&(r._focusData=a,r.fp("focusData",I,a),I&&r.invalidateData(I),a&&(r.invalidateData(a),r.isAutoMakeVisible()&&r.makeVisible(a)))},G.drawRowBackground=function(A,$,k,E,u,q,H){var Z=this,h=Z.isCheckMode();($===Z._focusData&&h||k&&!h)&&Pe(A,E,u,q,H,Z.getSelectBackground($))},G.drawData=function(S,U,A){var e=this,F=e._rowHeight,n=F*A,x=e._29I,W=x.x,t=x.width;S.save(),S.beginPath(),S.rect(W,n,t,F),S.clip(),e._87o(e.drawRow(S,U,e.isSelected(U),W,n,t,F),A,W,n,t,F),S.restore(),e._rowLineVisible&&Pe(S,W,n+F-1,t,1,e._rowLineColor)},G._12I=function(S){var W=this,s=W._31I,G=W._29I,y=G.x,u=G.y,I=G.width,c=G.height;for(S.beginPath(),S.rect(y,u,I,c),S.clip(),S.clearRect(y,u,I,c),W._76o(),W._93db(S);s<W._14I;s++)W.drawData(S,W._rows.get(s),s);W._92db(S)},G._13I=function(G){for(var A,u=this,c=u._rowHeight,Q=u._29I,f=Q.x,R=Q.width,H=u._31I,q=u._30I;H<u._14I;H++)A=u._rows.get(H),u._24I[A._id]&&q.add({data:A,index:H});q.isEmpty()||(G.beginPath(),q.each(function(u){G.rect(f,u.index*c,R,c)}),G.clip(),q.each(function(B){G.clearRect(f,B.index*c,R,c)}),q.each(function(y){u._77o(y.index)}),u._93db(G),q.each(function(Z){u.drawData(G,Z.data,Z.index)}),u._92db(G),q.clear())},G.preValidateModel=function(){this.endEditing&&this.endEditing()},G.validateImpl=function(){var l=this,H=l._canvas,W=l.getWidth(),z=l.getHeight(),c=l._rowHeight,b=l._32I;(W!==H.clientWidth||z!==H.clientHeight)&&(lr(H,W,z),b=1);var R=U&&!a;l._96I&&!R&&(l.preValidateModel(),l.validateModel());var J=l._29I,x={x:-l.tx(),y:-l.ty(),width:W,height:z},T=l._rows.size(),v=Hr(H),y=l._23I;b||nn(x,J)||(b=1),l._29I=x,l._59I=T*c+l.getScrollBarSize(),l._31I=A(x.y/c),l._14I=n((x.y+x.height)/c),l._31I<0&&(l._31I=0),l._14I>T&&(l._14I=T),l._99I&&b&&l._99I(),zm(v,l.tx(),l.ty(),1),b?l._12I(v):l._24I&&l._13I(v),l._93I(),l._92I(),v.restore(),l._32I=l._24I=l._96I=d,y&&(l.scrollToIndex(l.getRowIndex(y)),delete l._23I),l.tx(l.tx()),l.ty(l.ty())}},Mr._48o=function(e){e._rootVisible=!0,e._rootData=d,e._35o=function(){this._expandMap={},this._levelMap={}},e.validateModel=function(){var h=this,O=h._rootData;h._rows.clear(),h._levelMap={},h._rowMap={},h._currentLevel=0,O?h._rootVisible?h.isVisible(O)&&h.buildData(O):h.buildChildren(O):h.buildChildren(),delete h._currentLevel},e.buildData=function(L){var t=this,b=L._id,K=t._rows;t._rowMap[b]=K.size(),K.add(L),t._levelMap[b]=t._currentLevel,t.isExpanded(L)&&(t._currentLevel++,t.buildChildren(L),t._currentLevel--)},e.buildChildren=function(k){var K=this,X=k?k._children:K._dataModel._roots,a=K.getCurrentSortFunc();a&&K.isChildrenSortable(k)?X.toList(K.isVisible,K).sort(a).each(K.buildData,K):X.each(function(g){K.isVisible(g)&&K.buildData(g)})},e.getLevel=function(u){return this._levelMap[u._id]},e.getToggleIcon=function(p){var l=this,U=l._loader,s=l._collapseIcon;return U&&!U.isLoaded(p)?s:p.hasChildren()?l.isExpanded(p)?l._expandIcon:s:d},e.isCheckMode=function(){return this._checkMode!=d},e.isChildrenSortable=function(){return!0},e.handleDataModelChange=function(O){var w=this;O.kind===hb?delete w._expandMap[O.data._id]:O.kind===Ng&&(w._expandMap={}),w.ivm()},e.toggle=function(P){var i=this;i.isExpanded(P)?i.collapse(P):i.expand(P)},e.isExpanded=function(H){return 1===this._expandMap[H._id]},e.expand=function(C){var A=this,G=A._loader;A.isExpanded(C)||(G&&!G.isLoaded(C)&&G.load(C),A._expandMap[C._id]=1,A.ivm(),A.onExpanded(C))},e.onExpanded=function(){},e.collapse=function(y){var O=this;O.isExpanded(y)&&(delete O._expandMap[y._id],O.ivm(),O.onCollapsed(y))},e.onCollapsed=function(){},e.expandAll=function(X){if(X)this.expand(X),X.eachChild(function(a){this.expandAll(a)},this);else{var V=this;V._dataModel.each(function(a){a.hasChildren()&&(V._expandMap[a._id]=1)}),V.ivm()}},e.collapseAll=function(){this._expandMap={},this.ivm()},e.makeVisible=function(f){if(f){var G=this;if(!G._rootData||f.isDescendantOf(G._rootData)){for(var n=f._parent;n;)G.expand(n),n=n._parent;G._23I=f,G.iv()}}},e.checkData=function(W){var u,O=this,n=O._checkMode,$=O.sm(),S=$.co(W);if(!$.sg()||!S){if(O._32o=1,n===Cq)S?$.rs(W):$.as(W);else if(n===Gm)u=new nm(W),u.addAll(W._children);else if("descendant"===n)u=new nm,gp(W,u);else if("all"===n&&(u=new nm,gp(W,u),!S))for(var P=W._parent;P;)u.add(P),P=P._parent;u&&(S?$.rs(u):$.as(u)),delete O._32o}},e._97I=function(p,w,m,e,$,l,U){var E=this,r=E._indent,X=E._levelMap[w._id],P=E.getIconWidth(w),k=Hf(E.getToggleIcon(w));k?(e+=r*X,dg(p,k,e+r/2,$+U/2,w,E),e+=r):e+=r*(X+1),E._checkMode&&(dg(p,E.getCheckIcon(w),e+r/2,$+U/2,w,E),e+=r),E.drawIcon(p,w,e,$,P,U),E.drawLabel(p,w,e+P,$,U)}},Mr._14Q=function(y){y.getIcon=function(F){return F.getIcon()},y.getIconWidth=function(W){return this.getIcon(W)?this._indent:0},y.drawIcon=function(f,e,u,z,W,w){if(W){var S=this,G=S.getBodyColor(e),q=Hf(S.getIcon(e),G);q&&(w-=S.isRowLineVisible()?1:0,wo(f,q,Pg,u,z,W,w,e,S,G),rl(f,S.getBorderColor(e),u,z,W,w))}},y.drawLabel=function(V,o,n,L,R){var j=this;Kh(V,j.getLabel(o),j.getLabelFont(o),j.getLabelColor(o),n,L,0,R)}},Mr._50o=function(o){o._98I=function(){var A=this,r=A._39o=new ac;A._60I=new nm,r.mm(A._17o,A),r.md(A._18o,A),r.mh(A._19o,A)},o.setColumns=function(f){this._39o.clear(),this.addColumns(f)},o.addColumns=function(y){var _=this._39o;y.forEach(function(z){if(!(z instanceof Bk)){var l=bc(z.className);z=sd(l?l:Bk,z)}_.add(z)})},o.onColumnClicked=function(){},o.onCheckColumnClicked=function(){},o._3Q=function(g){for(var m,z=0,p=this._60I,N=p.size();N>z;z++)if(m=p.get(z),m.column===g)return m;return d},o.getColumnAt=function(Y){var B=this._4Q(Y);return B?B.column:d},o._4Q=function(W){for(var C=this,z=W.target?C.lp(W).x:W.x,j=C._60I,B=0;B<j.size();B++){var m=j.get(B),G=m.startX;if(z>=G&&z<G+m.column.getWidth())return m}return d},o.getToolTip=function(f){var z=this,L=z.getDataAt(f),I=z.getColumnAt(f);return L&&I?I.getToolTip(L,z):d},o.adjustTranslateX=function(U){var I=this.getWidth()-this._91I;return I>U&&(U=I),U>0?0:E(U)},o._99I=function(){var _=this,q=_._29I,p=_._60I;p.clear(),_._91I=0,_._39o._roots.each(function(z){if(z.isVisible()){var h=_._91I+z.getWidth();_._91I<=q.x+q.width&&h>=q.x&&p.add({column:z,startX:_._91I}),_._91I=h}}),_._91I+=_.getScrollBarSize()},o.drawData=function(d,J,K){var x=this,z=x._rowHeight,c=z*K,D=x.isSelected(J),_=x._29I,R=_.x,Q=_.width;x.drawRowBackground(d,J,D,R,c,Q,z),x._60I.each(function(N){var S=N.column,P=N.startX,p=S.getWidth();p>0&&!x.isEditing(J,S)&&(d.save(),d.beginPath(),d.rect(P,c,p,z),d.clip(),x._87o(x.drawCell(d,J,D,S,P,c,p,z),K,P,c,p,z),x._columnLineVisible&&Pe(d,P+p-1,c,1,z,x._columnLineColor),d.restore())}),x._rowLineVisible&&Pe(d,R,c+z-1,Q,1,x._rowLineColor)},o.drawCell=function(j,c,M,F,a,K,v,z){var A=this;if(F.drawCell)return F.drawCell(j,c,M,F,a,K,v,z,A);var E=A.getValue(c,F);Do(j,E,F,A.getLabelFont(c,F,E),A.getLabelColor(c,F,E),a,K,v,z,c,A)},o.getColumnModel=function(){return this._39o},o._17o=function(){this.redraw()},o._18o=function(f){var r=this;f.data===r._sortColumn&&_b[f.property]?r.ivm():(r._42o(),r.redraw())},o._19o=function(){this.redraw()},o.getCurrentSortFunc=function(){var I=this,Y=I._sortColumn;if(Y&&Y.isSortable()){var u=Y.getSortFunc(),U=Wq===Y.getSortOrder()?1:-1;return u||(u=kb),function(k,R){return u.call(I,I.getValue(k,Y),I.getValue(R,Y),k,R)*U}}return I._sortFunc},o.isCellEditable=function(m,M,R){return M.isEditable()&&this.isEditable()?M.isCellEditable?M.isCellEditable(m,M,R,this):!0:!1},o._37O=function(W,_){if(fs(_))for(var v=this,e=v.lp(_),M=v._60I,J=v._rowHeight,o=v._29I,A=o.x,w=o.y,g=o.width,k=o.height,R=0;R<M.size();R++){var T=M.get(R),c=T.startX,E=T.column,z=E.getWidth();if(E!==v._31o&&E!==v._4o&&e.x>=c&&e.x<c+z&&v.isCellEditable(W,E,_)){var u={x:c,y:v.getRowIndex(W)*J,width:z,height:J},m={x:u.x+v.tx(),y:u.y+v.ty(),width:u.width,height:u.height},P=0,n=0;return u.x<A?P=u.x-A:u.x+u.width>A+g&&(P=u.x+u.width-A-g),P&&(v.tx(v.tx()-P),m.x-=P),u.y<w?n=u.y-w:u.y+J>w+k&&(n=u.y+J-w-k),n&&(v.ty(v.ty()-n),m.y-=n),v.beginEditing({data:W,column:E,value:v.getValue(W,E),event:_,rect:u,editorRect:m,view:v}),void 0}}}},an.BaseItemEditor=function(o,v,H,E){this._data=o,this._column=v,this._master=H,this._editInfo=E},ho("BaseItemEditor",r,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Ah=P.Tab=function(){ii(Ah,this)};as("Tab",Oc,{ms_ac:["view","closable","disabled","visible"],_icon:d,_closable:!1,_disabled:!1,_visible:!0,setParent:sb});var Bk=P.Column=function(){ii(Bk,this)};as("Column",Oc,{_46o:1,ms_ac:["accessType","valueType",Tl,kk,Mf,ib,"align",te,"sortOrder",mn,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Wq,_sortFunc:d,_sortable:!0,_clickable:!0,setWidth:function(r){16>r&&(r=16);var k=this._width;this._width=r,this.fp(ib,k,r)},getToolTip:function(y,x){return this.formatValue(x.getValue(y,this))}});var Nf=P.Property=function(){ii(Nf,this)};as("Property",Oc,{_46o:1,ms_ac:["accessType","valueType",kk,Mf,"categoryName",te,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:d,getToolTip:function(m,i,t){var I=this;return i?I.formatValue(t.getValue(m,I)):t.getPropertyName(I)}}),an.AccordionView=function(){var V=this;V._20o={},V._21o=new nm,V._10o=d,V._9o=d,V._11o=d,V._view=up(0,V),V.iv()},ho("AccordionView",r,{ms_v:1,ms_fire:1,ms_ac:[$p,Jq,"titleHeight",Dk,Tk,"titleBackground","selectWidth",sk,"orientation","separatorColor"],_expandIcon:F.accordionViewExpandIcon,_collapseIcon:F.accordionViewCollapseIcon,_titleHeight:wl,_labelColor:F.accordionViewLabelColor,_labelFont:F.accordionViewLabelFont,_titleBackground:F.accordionViewTitleBackground,_selectBackground:F.accordionViewSelectBackground,_selectWidth:F.accordionViewSelectWidth,_orientation:"v",_separatorColor:F.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(n,J,E,x){var p=this,k=rp();if(p._20o[n])throw n+" already exists";k.onmousedown=_l,k.style.cursor=Ob,k.addEventListener(Qr?kg:Uq,function(M){_l(M)},N),k.addEventListener(Qr?Rr:Kf,function(B){_l(B),fs(B)&&(p._10o===n?p.collapse():p.expand(n))},N),oq(p._view,k),p._20o[n]={content:J,div:k,canvas:Ni(k),icon:x},p._21o.add(n),E&&p.expand(n),p.iv()
},remove:function(l){var m=this,C=m._20o[l];C&&(Hq(C.div),delete m._20o[l],m._21o.remove(l),m.iv())},clear:function(){var M=this;M._21o.toArray().forEach(M.remove,M),M._20o={},M._21o.clear(),M.iv()},isExpanded:function(u){return this._10o===u},expand:function(f){var j=this;j._20o[f]&&j._10o!==f&&(j._10o=f,j.onExpanded(f),j.iv())},onExpanded:function(){},collapse:function(){var F=this;F._10o&&(F.onCollapsed(F._10o),delete F._10o,F.iv())},onCollapsed:function(){},initCanvas:function(X,Z,x){lr(X,Z,x);var g=Hr(X);return zm(g,0,0,1),g.clearRect(0,0,Z,x),g},drawTitle:function(G,S,T,Z,k){var u=this,r=Hf(k.icon),d=u.isExpanded(S),B=u._titleHeight,M=u._titleBackground,v=u._selectWidth,L=u._separatorColor,C=Hf(d?u._expandIcon:u._collapseIcon),X=v+4;Pe(G,0,0,T,Z,M),d&&v&&Pe(G,0,0,v,Z,u._selectBackground),(d||u._21o.get(u._21o.size()-1)!==S)&&Pe(G,0,Z-1,T,1,L?L:iq(M)),r&&(dg(G,r,X+li(r)/2,B/2),X+=li(r)+2),Kh(G,S,u.getLabelFont(S),u.getLabelColor(S),X,0,0,B),C&&dg(G,C,T-li(C)/2-4,B/2)},validateImpl:function(){var h=this,b=h._view,z=0,l=0,r=h.getWidth(),A=h.getHeight(),K=h._titleHeight,P=h._21o.size()*K,o=h._11o,a=h._9o;delete h._11o,delete h._9o,h._21o.each(function(D){var p,U,k=h._20o[D],s=k.content,b=h._10o===D;ki(h)?(Hi(k.div,z,0,K,A),p=h.initCanvas(k.canvas,K,A),Rg(p,0,A),Nl(p,-L),h.drawTitle(p,D,A,K,k),p.restore(),b?(U=T(0,r-P),s&&(h._11o=s,h._9o=Wd(s),Hi(s,z+K,0,U,A)),z+=K+U):z+=K):(Hi(k.div,0,l,r,K),p=h.initCanvas(k.canvas,r,K),h.drawTitle(p,D,r,K,k),p.restore(),b?(U=T(0,A-P),s&&(h._11o=s,h._9o=Wd(s),Hi(s,0,l+K,r,U)),l+=K+U):l+=K)});var e=h._9o;o&&o!==h._11o&&o.endEditing&&o.endEditing(),e&&e!==a&&oq(b,e),a&&a!==e&&Hq(a)}}),an.SplitView=function(i,P,O,l){var w=this,U=w._dividerDiv=rp(),Y=w._60O=Ni(),u=w._61O=Ni(),W=Y.style,g=u.style;w._view=up(1,w),oq(w._view,U),W.msTouchAction=lk,W.pointerEvents=lk,W.cursor=Ob,g.msTouchAction=lk,g.pointerEvents=lk,g.cursor=Ob,i&&w.setLeftView(i),P&&w.setRightView(P),O&&w.setOrientation(O),l!=d&&w.setPosition(l),w.setStatus(Bd),new Vh(w)},ho("SplitView",r,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:F.splitViewDividerSize,_dividerBackground:F.splitViewDividerBackground,_dragOpacity:F.splitViewDragOpacity,_toggleIcon:F.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(i,j){var n=this,t=n._position;isNaN(i)||(j||(n._82O=0>i?-1:i>1?1:0),n._position=i,n.fp(Or,t,i))},getLeftView:function(){return this._leftView},setLeftView:function(x){var M=this,t=M._leftView,R=M._view;if(M._leftView!==x){if(t&&t!==M._rightView){var h=Wd(t);h.parentNode===R&&Hq(h)}if(M._leftView=x,x){var m=Wd(x);m.parentNode!==R&&R.insertBefore(m,M._dividerDiv)}M.fp("leftView",t,x)}},getRightView:function(){return this._rightView},setRightView:function(b){var v=this,F=v._rightView,X=v._view;if(v._rightView!==b){if(F&&F!==v._leftView){var u=Wd(F);u.parentNode===X&&Hq(u)}if(v._rightView=b,b){var f=Wd(b);f.parentNode!==X&&X.insertBefore(f,v._dividerDiv)}v.fp("rightView",F,b)}},validateImpl:function(){var A=this,X=A._draggable,p=A._position,u=A.getWidth(),x=A.getHeight(),Y=A._dividerSize,j=A._dividerBackground,B=Qr?18:8,o=A._dividerDiv,S=A._82O,$=A._60O,N=A._61O,Z=A._toggleIcon,y=A._status,F=o.style,w=null,z=Qr?20:4,v=Z.comps[0];Y>=B||0===Y?A._coverDiv&&(Hq(A._coverDiv),delete A._coverDiv):A._coverDiv||(A._coverDiv=rp(),f&&(A._coverDiv.style.background=Ve),oq(o,A._coverDiv)),A._togglable?$.parentNode||(oq(o,$),oq(o,N)):(Hq($),Hq(N));var k=A._coverDiv,g=A._leftView,b=A._rightView;if(ki(A)){if(Y>u&&(Y=u),y===Bd)if(1===S)var n=e(p,u),W=T(0,u-Y-n);else-1===S?(W=e(-p,u),n=T(0,u-Y-W)):(n=E((u-Y)*p),W=T(0,u-Y-n));else"cl"===y?(n=0,W=T(0,u-Y)):"cr"===y&&(W=0,n=T(0,u-Y));g&&Hi(g,0,0,n,x),b&&Hi(b,n+Y,0,W,x),Hi(o,n,0,Y,x),A._22o=n,k&&(Hi(k,Y/2-B/2,0,B,x),k.style.cursor=X?lo:""),o.style.cursor=X?lo:"";var q=o.clientHeight/2,I=o.clientWidth;lr($,I,I),Hi($,0,q-I-z,I,I),w=Hr($),zm(w,0,0,1),v.rotation=-L,Pp(w,Z,0,0,I,I),w.restore(),lr(N,I,I),Hi(N,0,q+z,I,I),w=Hr(N),zm(w,0,0,1),v.rotation=L,Pp(w,Z,0,0,I,I),w.restore()}else{if(Y>x&&(Y=x),y===Bd)if(1===S)var D=e(p,x),h=T(0,x-Y-D);else-1===S?(h=e(-p,x),D=T(0,x-Y-h)):(D=E((x-Y)*p),h=T(0,x-Y-D));else"cl"===y?(D=0,h=T(0,x-Y)):"cr"===y&&(h=0,D=T(0,x-Y));g&&Hi(g,0,0,u,D),b&&Hi(b,0,D+Y,u,h),Hi(o,0,D,u,Y),A._22o=D,k&&(Hi(k,0,Y/2-B/2,u,B),k.style.cursor=X?Wj:""),F.cursor=X?Wj:"";var t=o.clientWidth/2,I=o.clientHeight;lr($,I,I),Hi($,t-I-z,0,I,I),w=Hr($),zm(w,0,0,1),v.rotation=0,Pp(w,Z,0,0,I,I),w.restore(),lr(N,I,I),Hi(N,t+z,0,I,I),w=Hr(N),zm(w,0,0,1),v.rotation=M,Pp(w,Z,0,0,I,I),w.restore()}F.background=j}});var Vh=function(r){this.sv=r,this.addListeners()};$o(Vh,r,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(M){var S=this,c=S.sv,q=c._dividerDiv,A=c._60O,U=c._61O,f=c._status,P=M.target;if(P===A)f===Bd?c.setStatus("cl"):"cr"===f&&c.setStatus(Bd);else if(P===U)f===Bd?c.setStatus("cr"):"cl"===f&&c.setStatus(Bd);else if(Hd(M)&&(P===q||P===c._coverDiv)&&(_l(M),c.isDraggable())){c.getLeftView(),c.getRightView();var y=S.maskDiv=rp();if(y.style.left=0,y.style.top=0,y.style.width=c.getWidth()+"px",y.style.height=c.getHeight()+"px",c.getView().appendChild(y),!c.isContinuousLayout()){var L=S.resizeDiv=rp();L.style.left=q.style.left,L.style.top=q.style.top,L.style.width=q.style.width,L.style.height=q.style.height,L.style.opacity=c.getDragOpacity(),L.style.background=c.getDividerBackground(),oq(S.getView(),L)}S._lastAbsPosition=c._22o,S._86o=ki(c)?vd(M).x:vd(M).y,Pb(S,M)}},handleWindowTouchMove:function(g){Hd(g)&&this.update(g,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(g){var N=this;N.update(g,!0),N.sv.setStatus(Bd),N.maskDiv&&Hq(N.maskDiv),N.resizeDiv&&Hq(N.resizeDiv),N.maskDiv=N.resizeDiv=d},handle_mousedown:function(E){fs(E)&&this.handle_touchstart(E)},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowMouseUp:function(f){this.handleWindowTouchEnd(f)},update:function(j,W){var V=this,m=V.sv,H=ki(m)?m.getWidth():m.getHeight(),M=m._dividerSize,F=V._lastAbsPosition-V._86o;ki(m)?(F+=vd(j).x,F>H-M&&(F=H-M),0>F&&(F=0),V.resizeDiv&&(V.resizeDiv.style.left=F+Cf)):(F+=vd(j).y,F>H-M&&(F=H-M),0>F&&(F=0),V.resizeDiv&&(V.resizeDiv.style.top=F+Cf)),W&&H!==M&&(1===m._82O?m.setPosition(F,1):-1===m._82O?m.setPosition(F-H+M,1):m.setPosition(F/(H-M),1))}}),an.TabView=function(){var p=this,E=p._view=up(1,p),M=p._91O=rp(1),R=p._tabModel=new ac,D=R.sm(),v=p.invalidate;p._7o=new nm,p._canvas=Ni(M),oq(E,M),oq(E,p._92O=rp(1)),D.setSelectionMode(gq),D.ms(p.handleSelectionChange,p),R.mm(v,p),R.mh(v,p),R.md(v,p),p._interactor=new zr(p),p.iv()},ho("TabView",r,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Dk,Tk,"tabBackground","selectWidth",sk,"moveBackground","insertColor"],_tabPosition:ai,_tabHeight:wl,_tabGap:F.tabViewTabGap,_labelColor:F.tabViewLabelColor,_labelFont:F.tabViewLabelFont,_tabBackground:F.tabViewTabBackground,_selectWidth:F.tabViewSelectWidth,_selectBackground:F.tabViewSelectBackground,_moveBackground:F.tabViewMoveBackground,_insertColor:F.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(z,L,a){var W,I=this._tabModel;return z instanceof Ah?(W=z,L&&W.setView(L)):(W=new Ah,W.setName(z),W.setView(L)),I.add(W),a&&I.sm().ss(W),W},getLabel:function(E){return E.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(w){this._23o=w,this.iv()},get:function(V){var i=this,u=i._tabModel;if(nq(V))return u._roots.get(V);if(Jp(V)){var W;return u.each(function(D){V===i.getLabel(D)&&(W=D)}),W}return V instanceof Ah?V:d},select:function(M){this._tabModel.sm().ss(this.get(M))},remove:function(K){var H=this;if(K=H.get(K)){var r=H._tabModel,_=r._roots.indexOf(K);H._tabModel.remove(K),H.selectByIndex(--_)}},getCurrentTab:function(){return this._8o},hideTabView:function(S,l){l.parentNode===this._92O&&(xe(l)?(l.style.display=xj,l._tab_=S):Hq(l),de())},showTabView:function(J,F){xe(F)&&(F.style.display="block",F._tab_=J),F.parentNode!==this._92O&&(oq(this._92O,F),de())},_24o:function(){var H,I=this,U=I._8o,$=I._9o,e=I._tabModel.sm().ld();e&&(H=Wd(e.getView())),H!==$&&($&&(U.getView()&&U.getView().endEditing&&U.getView().endEditing(),I.hideTabView(U,$)),H&&I.showTabView(e,H)),I._8o=e,I._9o=H,U!==e&&I.onTabChanged(U,e)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(x,f){this.selectByIndex(--f)},selectByIndex:function(r){var s=this,Y=s._tabModel,a=Y.size();if(a&&!Y.sm().ld()){r==d&&(r=0),r>=a&&(r=a-1),0>r&&(r=0);for(var T=r;T>=0;T--){var v=s.get(T);if(!v.isDisabled())return s.select(v),v}for(T=r+1;a>T;T++)if(v=s.get(T),!v.isDisabled())return s.select(v),v}},getTabWidth:function(j){var C=4,M=Hf(j.getIcon());M&&(C+=li(M,j)+4);var W=this.getLabel(j);return W&&(C+=Zj(this.getLabelFont(j),W).width+4),j.isClosable()&&(C+=10),C},drawTab:function(O,y,q,N,v,D,I){var S,G=this,o=G._tabPosition,B=q+4,K=G._selectWidth,V=Hf(y.getIcon()),d=y.isDisabled(),Y=G.getLabelColor(y),i=G.getLabelFont(y),c=G.getLabel(y),k=G._selectBackground,t=o===Km+"-vertical",T=o===_i+"-vertical";(t||T)&&(B=N+4),d&&(O.globalAlpha=dc),Pe(O,q,N,v,D,I),y===G._8o&&K&&(o===ai?Pe(O,q,N+D-K,v,K,k):o===Km?Pe(O,q+v-K,N,K,D,k):o===_i?Pe(O,q,N,K,D,k):t?Pe(O,q+v-K,N,K,D,k):T?Pe(O,q,N,K,D,k):Pe(O,q,N,v,K,k));var s=v/2;if(t&&(Rg(O,s,N+D/2),Nl(O,M),Rg(O,-s,-N-D/2)),V){var m=Kn(V,y),F=li(V,y);if(t||T){var U=q+v/2,H=B+m/2;Rg(O,U,H),Nl(O,L),Rg(O,-U,-H),dg(O,V,q+v/2,B+m/2,y,G),Rg(O,U,H),Nl(O,-L),Rg(O,-U,-H),B+=m+4}else dg(O,V,B+F/2,N+D/2,y,G),B+=F+4}return t||T?(Rg(O,v/2,B+v/2),Nl(O,L),Rg(O,-v/2,-B-v/2),Kh(O,c,i,Y,q,B,D,v),Rg(O,v/2,B+v/2),Nl(O,-L),Rg(O,-v/2,-B-v/2)):Kh(O,c,i,Y,B,N,v,D),t&&(Rg(O,s,N+D/2),Nl(O,-M),Rg(O,-s,-N-D/2)),y.isClosable()&&(S=T?{x:q+v-12,y:N+D-12,width:12,height:12}:{x:q+v-12,y:N+2,width:12,height:12},this.drawCloseIcon(y,O,Y,S)),d&&(O.globalAlpha=1),S},drawCloseIcon:function(x,o,s,T){var j=T.x,y=T.y;o.strokeStyle=s,o.lineWidth=1,o.beginPath(),o.moveTo(j+2,y+8),o.lineTo(j+8,y+2),o.moveTo(j+8,y+8),o.lineTo(j+2,y+2),o.stroke()},getTabAt:function(d){var s=this._interactor._8Q(d);return s?s.tab:null},validateImpl:function(){var d=this;d._24o();var m,p=d._canvas,s=d._tabPosition,_=d._91O,c=d._92O,U=d._tabModel,G=d.getWidth(),Z=d.getHeight(),C=d._tabHeight,R=d._7o,M=d._tabGap,f=s===ai,F=s===Km,y=s===_i,r=s===Km+"-vertical",h=s===_i+"-vertical",x=d._23o,W=0;if((F||y)&&U._roots.each(function(K){W=T(d.getTabWidth(K),W)}),f?(Hi(_,0,0,G,C),m={x:0,y:C,width:G,height:T(0,Z-C)}):F?(Hi(_,0,0,W,Z),m={x:W,y:0,width:T(0,G-W),height:Z}):y?(Hi(_,G-W,0,W,Z),m={x:0,y:0,width:T(0,G-W),height:Z}):r?(Hi(_,0,0,C,Z),m={x:C,y:0,width:T(0,G-C),height:Z}):h?(Hi(_,G-C,0,C,Z),m={x:0,y:0,width:T(0,G-C),height:Z}):(Hi(_,0,Z-C,G,C),m={x:0,y:0,width:G,height:T(0,Z-C)}),Hi(c,m),r||h){d._9o&&(m.x=0,Hi(d._8o.getView(),m)),lr(p,C,Z);var o=Hr(p),Q=0;if(zm(o,0,d.ty(),1),o.clearRect(0,0,C,Z),R.clear(),U._roots.each(function(s){if(s.isVisible()){var l,H=d.getTabWidth(s);x&&x.tab===s||(l=d.drawTab(o,s,0,Q,C,H,d._tabBackground)),R.add({_75o:l,tab:s,startY:Q,endY:Q+H,height:H}),Q+=H+M}}),d._23Q=T(0,Q-M),x){var J=x.position;d.drawTab(o,x.tab,0,x.startY,C,x.height,d._moveBackground),Pe(o,0,J,C,1,d._insertColor)}if(o.restore(),d._selectionChanged){d._selectionChanged=!1;for(var j=d.ty(),t=0;t<R.size();t++){var K=R.get(t);if(K.tab===d._8o){if(K.endY+j<0){d.ty(-K.startY);break}if(K.startY+j>Z){d.ty(Z-K.endY);break}}}}d.ty(d.ty())}else if(F||y){d._9o&&(m.x=0,Hi(d._8o.getView(),m)),lr(p,W,Z);var o=Hr(p),Q=0;if(zm(o,0,d.ty(),1),o.clearRect(0,0,W,Z),R.clear(),U._roots.each(function(y){if(y.isVisible()){var g;x&&x.tab===y||(g=d.drawTab(o,y,0,Q,W,C,d._tabBackground)),R.add({_75o:g,tab:y,startY:Q,endY:Q+C,height:C}),Q+=C+M}}),d._23Q=T(0,Q-M),x){var J=x.position;d.drawTab(o,x.tab,0,x.startY,W,x.height,d._moveBackground),Pe(o,0,J,W,1,d._insertColor)}if(o.restore(),d._selectionChanged){d._selectionChanged=!1;for(var j=d.ty(),t=0;t<R.size();t++){var K=R.get(t);if(K.tab===d._8o){if(K.endY+j<0){d.ty(-K.startY);break}if(K.startY+j>Z){d.ty(Z-K.endY);break}}}}d.ty(d.ty())}else{d._9o&&(m.y=0,Hi(d._8o.getView(),m)),lr(p,G,C);var o=Hr(p),e=0;if(zm(o,d.tx(),0,1),o.clearRect(0,0,G,C),R.clear(),U._roots.each(function(S){if(S.isVisible()){var j,Q=d.getTabWidth(S);x&&x.tab===S||(j=d.drawTab(o,S,e,0,Q,C,d._tabBackground)),R.add({_75o:j,tab:S,startX:e,endX:e+Q,width:Q}),e+=Q+M}}),d._64I=T(0,e-M),x){var J=x.position;d.drawTab(o,x.tab,x.startX,0,x.width,C,d._moveBackground),Po(o,d._insertColor,J,0,C)}if(o.restore(),d._selectionChanged){d._selectionChanged=!1;for(var B=d.tx(),t=0;t<R.size();t++){var K=R.get(t);if(K.tab===d._8o){if(K.endX+B<0){d.tx(-K.startX);break}if(K.startX+B>G){d.tx(G-K.endX);break}}}}d.tx(d.tx())}for(var z=[],u=c.children,t=0;t<u.length;t++){var N=u[t],P=N._tab_;P&&!U.contains(P)&&z.push(N)}z.forEach(function(l){c.removeChild(l)})}});var zr=function(S){this.tv=S,this.addListeners()};$o(zr,r,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(A){this.handleScroll(A,10*(A.wheelDelta/40))},handle_DOMMouseScroll:function(C){this.handleScroll(C,10*-C.detail)},handleScroll:function(P,q){_l(P);var b=this.tv,x=b._tabPosition;!b._40o()||x!==ai&&x!==el||b.tx(this.tv.tx()+q),!b._41o()||x!==Km&&x!==_i&&x!==Km+"-vertical"&&x!==_i+"-vertical"||b.ty(this.tv.ty()+q)},_8Q:function(j){var N,w,k=this.tv,X=k._tabPosition,K=k._7o;if(X===ai||X===el){var U=k.lp(j).x;for(N=0;N<K.size();N++)if(w=K.get(N),w.startX<=U&&U<=w.endX)return w}else if(X===Km||X===_i||X===Km+"-vertical"||X===_i+"-vertical"){var E=k.lp(j).y;for(N=0;N<K.size();N++)if(w=K.get(N),w.startY<=E&&E<=w.endY)return w}return d},isClickable:function(B){var H=this.tv,R=H._tabPosition,P=this._73o=this._8Q(B);return!H._40o()||R!==ai&&R!==el?!H._41o()||R!==Km&&R!==_i&&R!==Km+"-vertical"&&R!==_i+"-vertical"?P&&(!P.tab.isDisabled()||H.isMovable()):!0:!0},handle_mousemove:function(g){var e=this;yd?e._74o=e._8Q(g):e.getView().style.cursor=e.isClickable(g)?Ob:""},handle_mousedown:function(S){this.handle_mousemove(S),this.handle_touchstart(S)},handle_touchstart:function(T){var A=this,I=A.tv,U=I._tabPosition;_l(T),fs(T)&&A.isClickable(T)&&(U===ai||U===el?(A.x=vd(T).x,A.lp=I.lp(T),A.tx=I.tx()):(A.y=vd(T).y,A.lp=I.lp(T),A.ty=I.ty()),Pb(A,T))},handleWindowMouseMove:function(j){this.handleWindowTouchMove(j)},handleWindowTouchMove:function(Z){var E,M=this,k=M.tv,F=k._tabPosition,q=M._73o;if(F===ai||F===el){if(E=vd(Z).x-M.x,!M._25o&&!M.moving&&j(E)>2&&(k._40o()&&!nr(Z)?M._25o=1:q&&k.isMovable()&&(M.moving=1)),M._25o)k.tx(M.tx+E);else if(M.moving){var m=M.lp.x+E,r=k._tabGap/2;k._7o.each(function(B){var G=B.endX,p=m-B.startX<G-m;m>=B.startX&&G>=m&&k._7Q({tab:q.tab,startX:q.startX+E,width:q.width,front:p,insertTab:B.tab,position:p?T(0,B.startX-r):e(k._64I,G+r)})})}}else if(E=vd(Z).y-M.y,!M._25o&&!M.moving&&j(E)>2&&(k._41o()&&!nr(Z)?M._25o=1:q&&k.isMovable()&&(M.moving=1)),M._25o)k.ty(M.ty+E);else if(M.moving){var U=M.lp.y+E,r=k._tabGap/2;k._7o.each(function(C){var b=C.endY,p=U-C.startY<b-U;U>=C.startY&&b>=U&&k._7Q({tab:q.tab,startY:q.startY+E,height:q.height,front:p,insertTab:C.tab,position:p?T(0,C.startY-r):e(k._23Q,b+r)})})}},handleWindowMouseUp:function(D){this.handleWindowTouchEnd(D)},handleWindowTouchEnd:function(){var y=this,K=y.tv,L=K._tabPosition,s=K.getTabModel(),U=s._roots,E=y._73o;if(y.moving){var f=K._23o;if(f&&f.insertTab!==f.tab){var z=f.tab,r=U.remove(z),D=U.indexOf(f.insertTab);D>=0&&(f.front||D++,D<=U.size()&&(U.add(z,D),s._38I(z,r,D)))}K._7Q(d),delete y.moving}else if(!y._25o&&E){z=E.tab;var p=y._74o;if(!p||p.tab===z)if(!z.isDisabled()&&mb(E._75o,y.lp)){var N=function(){var y=U.indexOf(z);s.remove(z),K.onTabClosed(z,y)};K.onTabClosing(z,N)&&N()}else z.isDisabled()||K._8o===z||s.sm().ss(z)}y._25o=y._73o=y._74o=L===ai||L===el?y.x=y.lp=y.tx=d:y.y=y.lp=y.ty=d}}),an.PropertyView=function(l){var U=this;U._view=up(1,U),U._canvas=Ni(U._view),oq(U._view,U._79O=rp()),U._rows=new nm,U._28o=new nm,U._26o={},U._26Q={};var Y=U._propertyModel=new ac,h=U.ivm;Y.mm(h,U),Y.md(h,U),Y.mh(h,U),U.dm(l?l:new ac),new Uk(U)},ho("PropertyView",r,{ms_ac:[Dk,Ih,Tk,kk,Mf,"categorizable",Lj,mn,oo,$p,Jq,Rj,Nr,Ui,"selectRowIndex",sk,"background",hl,Gl,re,yb,Og],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:xp,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Lm,_background:F.propertyViewBackground,_expandIcon:F.propertyViewExpandIcon,_collapseIcon:F.propertyViewCollapseIcon,_scrollBarColor:Pj,_scrollBarSize:_p,_autoHideScrollBar:lb,_selectBackground:F.propertyViewSelectBackground,_rowHeight:ue,_rowLineVisible:F.propertyViewRowLineVisible,_rowLineColor:F.propertyViewRowLineColor,_10I:.5,_columnLineVisible:F.propertyViewColumnLineVisible,_columnLineColor:F.propertyViewColumnLineColor,_labelColor:F.propertyViewLabelColor,_labelSelectColor:F.propertyViewLabelSelectColor,_labelFont:F.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(n){0>n&&(n=0),n>1&&(n=1);var X=this,Z=X._10I;X._10I=n,X.fp("columnPosition",Z,n)},getPropertyName:function(q){return q.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(Q,p,_){return _===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(U,N){return N===this._selectRowIndex?this._labelSelectColor:U.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(z){var H=this.getHeight()-this._59I;return H>z&&(z=H),z>0?0:E(z)},isExpanded:function(H){if(!H)return!0;var F=this._26o[H];return F?F.isExpanded:!(this._26Q[H]===!1)},toggle:function(W){var n=this;n.isExpanded(W)?n.collapse(W):n.expand(W)},expandAll:function(){this.validate();for(var l in this._26o)this.expand(l)},expand:function(m){if(m&&m!==xj){var y=this,l=y._26o[m];l&&!l.isExpanded&&(l.isExpanded=!0,y.onExpanded(m),y.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var Q in this._26o)this.collapse(Q)},collapse:function(y){if(y&&y!==xj){var d=this,W=d._26o[y];W&&W.isExpanded&&(W.isExpanded=!1,d.onCollapsed(y),d.ivm())}},onCollapsed:function(){},getCategoryName:function(J){if(!this.isCategorizable())return xj;var N=J.getCategoryName();return N?N:xj},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(n){var h=this,G=h._dataModel;G!==n&&(G&&(G.umd(h.handlePropertyChange,h),h._selectionModel||G.sm().ums(h.handleSelectionChange,h)),h._dataModel=n,n.md(h.handlePropertyChange,h),h._selectionModel?h._selectionModel._21I(n):n.sm().ms(h.handleSelectionChange,h),h.fp(Lr,G,n))},isVisible:function(V){return this._visibleFunc?this._visibleFunc(V):!0},onPropertyChanged:function(a){var t=this,z=a.property;kh[z]?t.ivm():t.iv(),z===qk&&t._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:pr},handlePropertyChange:function(Q){this._27o===Q.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var k=this;k._96I||(k.setSelectRowIndex(-1),k._96I=1,k.iv())},redraw:function(){this.iv()},validateModel:function(){var D=this,_=D._rows,c=D._28o,n={},Y=new nm,M=D._27o;D.updateCurrentData(),M!==D._27o&&D.endEditing(),_.clear(),c.clear(),D.getRawProperties().each(function(r){if(D.isVisible(r)){Y.add(r);var k=D.getCategoryName(r);n[k]||(c.add(k,k===xj?0:J),n[k]={isExpanded:D.isExpanded(k),properties:new nm})}}),D._sortFunc&&Y.sort(D._sortFunc);for(var t in D._26o)D._26Q[t]=D.isExpanded(t);D._26o=n,c.each(function(P){P!==xj&&_.add(P);var X=n[P];X.isExpanded&&Y.each(function(n){D.getCategoryName(n)===P&&(X.properties.add(n),_.add({property:n,data:D._27o}))},D)})},validateImpl:function(){var S=this;S._76o(),S._96I&&(S.validateModel(),delete S._96I);var w=S._canvas,p=S.getWidth(),O=S.getHeight(),i=-S.ty(),z=S._rowHeight,Y=S._indent,W=p-Y,l=S._rows,b=l.size(),P=S._9I=Y+W*S._10I,D=S._59I=b*z;lr(w,p,O),S._29I={x:0,y:i,width:p,height:O},S._31I=A(i/z),S._14I=n((i+O)/z),S._31I<0&&(S._31I=0),S._14I>b&&(S._14I=b);var I,K=Hr(w),R=S._background;zm(K,0,-i,1),K.beginPath(),K.rect(0,i,p,O),K.clip(),K.clearRect(0,i,p,O),S._93db(K),R&&Pe(K,0,0,Y,D,R);for(var X=S._31I;X<S._14I;X++){var G=l.get(X),i=z*X;if(Jp(G))R&&Pe(K,Y,i,W,z,R),I=Hf(S.isExpanded(G)?S._expandIcon:S._collapseIcon),I&&wo(K,I,Pg,0,i,Y,z),K.save(),K.beginPath(),K.rect(Y,i,W,z),K.clip(),S.drawCategoryName(K,G,X,Y,i,W,z),K.restore();else{var H=G.property,E=G.data,I=Hf(H.getIcon()),v=S._selectRowIndex===X?S.getSelectBackground():d;if(I&&wo(K,I,Pg,0,i,Y,z),v&&Pe(K,Y,i,W,z,v),K.save(),K.beginPath(),K.rect(Y,i,P-Y,z),K.clip(),S.drawPropertyName(K,H,X,Y,i,P-Y,z),K.restore(),!S.isEditing(E,H)){var y=P+1,x=p-P-1;K.save(),K.beginPath(),K.rect(y,i,x,z),K.clip(),S._87o(S.drawPropertyValue(K,H,S.getValue(E,H),X,y,i,x,z,E),X,y,i,x,z),K.restore()}}S._rowLineVisible&&Pe(K,Y,i+z-1,W,1,S._rowLineColor)}S._columnLineVisible&&(Pe(K,P,0,1,D,S._columnLineColor),Pe(K,p-1,0,1,D)),S._92db(K),S._93I(),K.restore(),S.ty(S.ty())},drawCategoryName:function(h,K,Y,B,S,D,G){Kh(h,K,this.getCategoryFont(K),this.getCategoryColor(K),B,S,D,G)},drawPropertyName:function(O,Y,X,W,n,J,N){return Y.drawPropertyName?(Y.drawPropertyName(O,Y,X,W,n,J,N,this),void 0):(Kh(O,this.getPropertyName(Y),this.getPropertyFont(Y,X),this.getPropertyColor(Y,X),W,n,J,N),void 0)},drawPropertyValue:function(F,_,j,Z,R,n,z,d,D){return _.drawPropertyValue?_.drawPropertyValue(F,_,j,Z,R,n,z,d,D,this):(Do(F,j,_,this.getLabelFont(_,j,Z),this.getLabelColor(_,j,Z),R,n,z,d,D,this),void 0)},isPropertyEditable:function(m){return m.isEditable()&&this.isEditable()},setProperties:function(U){this._propertyModel.clear(),this.addProperties(U)},addProperties:function(L){if(L){var M=this._propertyModel;L.forEach(function(B){if(!(B instanceof Nf)){var q=bc(B.className);B=sd(q?q:Nf,B)}M.add(B)})}},getRowIndexAt:function(Z){var L=this,m=A(L.lp(Z).y/L._rowHeight);return m>=0&&m<L._rows.size()?m:-1},getPropertyAt:function(j){var b=this,D=b.getRowIndexAt(j);return D>=0?b._rows.get(D).property:d},getToolTip:function(y){var M=this,T=M.getPropertyAt(y),z=M._27o;return T&&z?T.getToolTip(z,M._9I<M.lp(y).x,M):d}});var Uk=function(b){this.pv=b,this.addListeners()};$o(Uk,r,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(t){this.getView().style.cursor=t},clear:function(){var K=this;K._62O=K.cp=K.ty=K.p=d,K.setCursor(Cq)},handle_mousedown:function(x){this.handle_touchstart(x)},handle_touchstart:function(h){var K=this,T=K.pv;_l(h),T.setFocus(h)&&(fs(h)?(K.cp=vd(h),K.ty=T.ty(),K.p=T.getColumnPosition(),K.handle_touchmove(h)):T.setSelectRowIndex(T.getRowIndexAt(h)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(b){this.handle_touchend(b)},handle_touchend:function(K){var N=this;if(N.cp&&!N._62O){var u=N.pv,h=u.lp(K),P=h.x,G=h.y,$=u._indent,e=u.getRowIndexAt(K),x=u._9I;if(e>=0){var C=u._rowHeight,V=C*e,W=u._rows.get(e),b=W.property;if(Jp(W))Hf(u.isExpanded(W)?u._expandIcon:u._collapseIcon)&&P>=0&&$>=P&&G>=V&&V+C>=G?u.toggle(W):As(K)&&u.toggle(W);else if(P>x&&u.isPropertyEditable(b,K)){var S={x:x+1,y:V,width:u.getWidth()-x-1,height:C},U={x:S.x+u.tx(),y:S.y+u.ty(),width:S.width,height:S.height},E=0,A=u._29I;S.y<A.y?E=S.y-A.y:S.y+C>A.y+A.height&&(E=S.y+C-A.y-A.height),E&&(u.ty(u.ty()-E),U.y-=E),u.beginEditing({data:W.data,property:b,value:u.getValue(W.data,b),event:K,rect:S,editorRect:U,view:u})}}u.setSelectRowIndex(e)}N.clear()},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(X){var Y=this,C=Y.pv,k=Y.ty,s=Y.cp,D=vd(X),E=Y._62O;if("p"===E)C.setTranslateY(k+D.y-s.y);else if("c"===E){var x=C.getWidth()-C._indent;if(x>16){var B=Y.p-(s.x-D.x)/x,l=16/x;l>B&&(B=l),B>1-l&&(B=1-l),C.setColumnPosition(B)}}else"s"===E&&C.setTranslateY(k+(s.y-D.y)*C._59I/C._29I.height)},handle_mousemove:function(E){this.handle_touchmove(E)},handle_touchmove:function(x){if(!yd&&fs(x)){var y=this,Y=y.pv,l=j(Y.lp(x).x-Y._9I)<=(Qr?8:3);y.cp?y._62O||(l?(y._62O="c",Pb(y)):j(vd(x).y-y.cp.y)>=2&&(y._62O=y.isV(x)?"s":"p",Pb(y))):(l?y.setCursor(lo):y.setCursor(Cq),y.isV(x)&&Y._43o())}},isV:function(d){var q=this.pv,c=q._29I;return q._41o()&&c.x+c.width-q.lp(d).x<Bm},handle_mousewheel:function(y){this.handleScroll(y,y.wheelDelta/40)},handle_DOMMouseScroll:function(S){2===S.axis&&this.handleScroll(S,-S.detail)},handleScroll:function(O,G){var q=this.pv;_l(O),q.endEditing(),q.translate(0,G*q.getRowHeight())},handle_keydown:function(J){var r=this.pv,A=r._rows.size(),K=r._selectRowIndex+(ci(J)?-1:1);(ci(J)||Vk(J))&&(0>K&&(K=0),K>=A&&(K=A-1),r.setSelectRowIndex(K))}}),an.ListView=function(v){this._5o(v),new sq(this)},ho("ListView",r,{ms_ac:[Dk,Ih,Tk,hl,Lj,Gl,re,mn,oo,Rj,Nr,Ui,eg,sk],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Lm,_rowHeight:ue,_rowLineVisible:F.listViewRowLineVisible,_rowLineColor:F.listViewRowLineColor,_scrollBarColor:Pj,_scrollBarSize:_p,_autoMakeVisible:Rk,_autoHideScrollBar:lb,_selectBackground:F.listViewSelectBackground,_labelColor:F.listViewLabelColor,_labelSelectColor:F.listViewLabelSelectColor,_labelFont:F.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function($){var h=this,e=h._checkMode;h._checkMode=$,h.fp(fp,e,$)},drawRow:function(s,X,$,S,H,z,l){var P=this,B=0,W=P._indent,U=P.getIconWidth(X);P.drawRowBackground(s,X,$,S,H,z,l),P._checkMode&&(dg(s,Hf(P.getCheckIcon(X)),B+W/2,H+l/2,X,P),B+=W),P.drawIcon(s,X,B,H,U,l),P.drawLabel(s,X,B+U,H,l)}});var sq=function(E){this.list=E,this._lastSelectDataTime=Ph(),this.addListeners()};$o(sq,r,{ms_listener:1,getView:function(){return this.list._view},clear:function(M){var D=this,Y=D.list;M&&"d"===D._62O&&!D.dragCancel&&Y.handleDragAndDrop(M,"end"),Y.draggingData&&(Y.draggingData=null,Y.redraw()),D.dragCancel=D._62O=D._isV=D._isH=D.cp=D.tx=D.ty=d},handle_mousedown:function(I){this.handle_touchstart(I)},handle_touchstart:function(m){var V=this,Y=V.list;if(_l(m),Y.setFocus(m)){var q=Y.getDataAt(m);V.cp=vd(m),V.tx=Y.tx(),V.ty=Y.ty(),fs(m)?q&&Y.handleDragAndDrop&&!V.isV(m)&&!V.isH(m)&&(Y.draggingData=q,Y.redraw(),Y.handleDragAndDrop(m,"prepare")):(q&&V._33o(m,q),V.clear(m))}},handleWindowMouseUp:function(r){this.clear(r)},handleWindowTouchEnd:function(N){this.clear(N)},handle_mouseup:function(I){this.handle_touchend(I)},handle_touchend:function(F){var Y=this,j=Y.list;if(!Y._isV&&!Y._isH&&Y.cp&&!Y._62O){var x=j.getDataAt(F);x?(j.isCheckMode()?Y._34o(F,x):Y._33o(F,x),As(F)?j.onDataDoubleClicked(x,F):j.onDataClicked(x,F)):j.handleBackgroundClick(F)}Y.clear(F)},handleWindowMouseMove:function(v){this.handleWindowTouchMove(v)},handleWindowTouchMove:function(m){var D=this,c=D.list,K=D._62O,U=D.tx,y=D.ty,Q=D.cp,W=vd(m),t=c._29I;"p"===K?c.setTranslate(U+W.x-Q.x,y+W.y-Q.y):"v"===K?c.ty(y+(Q.y-W.y)*c._59I/t.height):"h"===K?c.tx(U+(Q.x-W.x)*c._91I/t.width):"d"===K&&(D.dragCancel||c.handleDragAndDrop(m,"between"))},handle_mousemove:function(F){this.handle_touchmove(F)},handle_touchmove:function(N){if(!yd&&fs(N)){var v=this,j=v.list;if(v._isV=v.isV(N),v._isH=v.isH(N),v.cp){if(!v._62O){if(jc(vd(N),v.cp)<2)return;v._isV?v._62O="v":v._isH?v._62O="h":j.draggingData&&!this.dragCancel?(v._62O="d",j.handleDragAndDrop(N,"begin")):v._62O="p",v._62O&&"d"!==v._62O&&j.draggingData&&(j.draggingData=null,j.redraw()),Pb(v)}}else v._isV&&j._43o(),v._isH&&j._42o()}},isV:function(C){var v=this.list,u=v._29I;return v._41o()&&u.x+u.width-v.lp(C).x<Bm},isH:function($){var d=this.list,A=d._29I;return d._40o()&&A.y+A.height-d.lp($).y<Bm},handle_mousewheel:function(n){this.handleScroll(n,n.wheelDelta/40,n.wheelDelta!==n.wheelDeltaX)},handle_DOMMouseScroll:function(O){this.handleScroll(O,-O.detail,1)},handleScroll:function(n,f,k){var v=this.list;_l(n),v.endEditing&&v.endEditing(),k&&v._41o()?v.translate(0,f*v.getRowHeight()):v._40o()&&v.translate(10*f,0)},handle_keydown:function(X){if(!F.isInput(X.target)){var q,R=this.list,t=R.sm(),s=R._rows,x=s.size();if(nd(X))R.selectAll();else if(fd(X))R.handleDelete&&R.handleDelete(X);else if(xd(X))"d"!==this._62O||this.dragCancel||(R.handleDragAndDrop(X,"cancel"),this.dragCancel=!0);else if(br(X))R.isCheckMode()&&(q=R.getFocusData(),q&&R.checkData(q));else if(ci(X)||Vk(X)){var z=R.isCheckMode();if(q=z?R.getFocusData():t.ld()){var b=R.getRowIndex(q);b>=0&&(ci(X)?0!==b&&(q=s.get(b-1),z?R.setFocusData(q):t.ss(q)):b!==x-1&&(q=s.get(b+1),z?R.setFocusData(q):t.ss(q)))}else x>0&&(q=s.get(0),z?R.setFocusData(q):t.ss(q))}}},_34o:function(z,K){var q=this.list,O=q.lp(z).x;return O>=0&&O<=q._indent?(q.checkData(K),void 0):(q.setFocusData(K),void 0)},_33o:function(G,c){var m=this.list,R=m.sm(),y=R.ld();if(nr(G))m.isSelected(c)?R.rs(c):R.as(c);else if(xk(G))if(y)for(var k=m.getRowIndex(y),W=m.getRowIndex(c);k!==W;)k+=W>k?1:-1,R.as(m._rows.get(k));else R.ss(c);else if(fs(G)){var r=Ph();if(R.contains(c)){var f=r-this._lastSelectDataTime;m.handleDataDoubleSelect&&f>500&&1500>f&&m.handleDataDoubleSelect(G,c)}R.ss(c),this._lastSelectDataTime=r}else R.contains(c)||R.ss(c)}}),an.TreeView=function(u){var Q=this;Q._35o(),Q._5o(u),new Vq(Q)},ho("TreeView",r,{ms_ac:[Dk,Ih,Tk,"rootVisible",fp,"rootData",mn,oo,Rj,Nr,Ui,Lj,hl,Gl,re,$p,Jq,eg,sk,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:d,_indent:Lm,_rowHeight:ue,_rowLineVisible:F.treeViewRowLineVisible,_rowLineColor:F.treeViewRowLineColor,_scrollBarColor:Pj,_scrollBarSize:_p,_autoHideScrollBar:lb,_expandIcon:F.treeViewExpandIcon,_collapseIcon:F.treeViewCollapseIcon,_autoMakeVisible:Rk,_selectBackground:F.treeViewSelectBackground,_labelColor:F.treeViewLabelColor,_labelSelectColor:F.treeViewLabelSelectColor,_labelFont:F.treeViewLabelFont,_doubleClickToToggle:F.treeViewDoubleClickToToggle,drawRow:function(k,z,f,$,D,E,y){var N=this;N.drawRowBackground(k,z,f,$,D,E,y),N._97I(k,z,f,0,D,E,y)},isOnToggleIcon:function(i){var w=this.getDataAt(i);if(w){var q=this.getIndent(),S=this.lp(i).x;if(Hf(this.getToggleIcon(w))){var k=q*this.getLevel(w);if(S>=k&&k+q>=S)return!0}}return!1}});var Vq=function(t){ii(Vq,this,[t])};$o(Vq,sq,{toggle:function(l,h,y,$){var b=this.list,M=b.lp(l).x;if(Hf(b.getToggleIcon(h))){var N=y*$;if(M>=N&&N+y>=M)return b.toggle(h),!0}return b.isDoubleClickToToggle()&&As(l)?(b.toggle(h),!0):!1},_34o:function(M,h){var y=this.list,t=y.lp(M).x,p=y._levelMap[h._id],j=y._indent,n=j*(p+1);return t>=n&&n+j>=t?(y.checkData(h),void 0):(this.toggle(M,h,j,p)||y.setFocusData(h),void 0)},_33o:function(Q,J){var U=this,o=U.list;U.toggle(Q,J,o._indent,o.getLevel(J))||Vq.superClass._33o.call(U,Q,J)},handle_keydown:function(X){if(Xe(X)||Vf(X)){var F=this.list,y=F._rows,Q=F.isCheckMode(),L=F.sm(),h=Q?F.getFocusData():L.ld();h?h.hasChildren()&&(Xe(X)?F.collapse(h):F.expand(h)):y.size()>0&&(h=y.get(0),Q?F.setFocusData(h):L.ss(h))}else Vq.superClass.handle_keydown.call(this,X)}});var cj=an.TableView=function(A){this._98I(),this._5o(A),new Kl(this)};ho("TableView",r,{ms_ac:[Dk,Ih,Tk,"sortMode",kk,Mf,hl,Gl,re,yb,Og,"sortColumn",mn,oo,Rj,Nr,Ui,eg,sk],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:il,_editable:!0,_batchEditable:!1,_rowHeight:ue,_rowLineVisible:F.tableViewRowLineVisible,_rowLineColor:F.tableViewRowLineColor,_columnLineVisible:F.tableViewColumnLineVisible,_columnLineColor:F.tableViewColumnLineColor,_scrollBarColor:Pj,_scrollBarSize:_p,_autoHideScrollBar:lb,_autoMakeVisible:Rk,_selectBackground:F.tableViewSelectBackground,_labelColor:F.tableViewLabelColor,_labelSelectColor:F.tableViewLabelSelectColor,_labelFont:F.tableViewLabelFont,getCheckColumn:function(){var F=this;
if(!F._31o){var U=F._31o=new Bk;U.setEditable(!0),U.setWidth(40),U.getValue=F.getCheckColumValue,U.drawCell=F.drawCheckColumnCell}return F._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(r){var l=this,B=l._39o,g=l.getCheckColumn();r!==l.isCheckMode()&&(r?B.add(g,0):B.remove(g),l.fp(fp,!r,r))},getCheckColumValue:function(F,Z,U){return U.isSelected(F)},drawCheckColumnCell:function(w,b,B,I,X,a,z,D,$){dg(w,$.getCheckIcon(b),X+z/2,a+D/2,b,$)}});var Kl=function(c){ii(Kl,this,[c])};$o(Kl,sq,{_34o:function(M,o){var b=this.list,l=b._31o;if(b.isCellEditable(o,l,M)){var w=b._3Q(l),B=b.lp(M).x;if(w&&B>=w.startX&&B<w.startX+l.getWidth())return b.checkData(o),void 0}b._37O(o,M),b.setFocusData(o)},_33o:function(W,F){this.list._37O(F,W),Kl.superClass._33o.apply(this,arguments)}});var ob=an.TreeTableView=function(P){var p=this,L=p._4o=new Bk;p._35o(),p._98I(),p._5o(P),L.setDisplayName("Name"),L.setEditable(!0),L.setWidth(180),L.drawCell=hi,L.getValue=zc,p._39o.add(L),new Ne(p)},hi=function(E,T,s,Q,u,D,z,U,W){W._97I(E,T,s,u,D,z,U)},zc=function(g,j,u){return u.getLabel(g)};ho("TreeTableView",r,{ms_ac:[Dk,Ih,Tk,"sortMode",kk,Mf,Lj,fp,"rootData","rootVisible",mn,oo,"sortColumn",$p,Jq,Rj,Nr,Ui,eg,re,hl,Gl,yb,Og,sk,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:il,_checkMode:d,_editable:!0,_batchEditable:!1,_indent:Lm,_rowHeight:ue,_rowLineVisible:F.treeTableViewRowLineVisible,_rowLineColor:F.treeTableViewRowLineColor,_columnLineVisible:F.treeTableViewColumnLineVisible,_columnLineColor:F.treeTableViewColumnLineColor,_expandIcon:F.treeTableViewExpandIcon,_collapseIcon:F.treeTableViewCollapseIcon,_scrollBarColor:Pj,_scrollBarSize:_p,_autoHideScrollBar:lb,_autoMakeVisible:Rk,_selectBackground:F.treeTableViewSelectBackground,_labelColor:F.treeTableViewLabelColor,_labelSelectColor:F.treeTableViewLabelSelectColor,_labelFont:F.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Ne=function(W){ii(Ne,this,[W])};$o(Ne,sq,{_34o:function(q,T){var h=this.list,u=h._4o,m=h._3Q(u),$=h.lp(q).x;if(m){var S=h._indent,N=m.startX+S*h.getLevel(T);if(Hf(h.getToggleIcon(T))&&$>=N&&N+S>=$)return h.toggle(T),void 0;if(h.isCellEditable(T,u)&&(N+=S,$>=N&&N+S>=$))return h.checkData(T),void 0}h._37O(T,q),h.setFocusData(T)},_33o:function(Q,t){var J=this.list,B=J.lp(Q).x;if(Hf(J.getToggleIcon(t))){var E=J._3Q(J._4o);if(E){var f=J._indent,W=E.startX+f*J.getLevel(t);if(B>=W&&W+f>=B)return J.toggle(t),void 0}}J._37O(t,Q),Ne.superClass._33o.apply(this,arguments)}});var Fd=an.TableHeader=function(m){var _=this,K=_._view=up(1,_),t=_._39o=m.getColumnModel(),y=_.iv;_.tv=_._tableView=m,_._60I=new nm,_._canvas=Ni(K),K.style.background=F.tableHeaderBackground||"",K.style.height=aj+Cf,t.mm(y,_),t.md(y,_),t.mh(y,_),m.mp(function(s){Zq[s.property]&&_.iv()},_),new mi(_),_.iv()};ho("TableHeader",r,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Dk,Tk,Lj,"moveBackground","insertColor",yb,Og,"resizable","movable"],_checkIcon:Sf,_movable:!0,_resizable:!0,_labelColor:F.tableHeaderLabelColor,_labelFont:F.tableHeaderLabelFont,_columnLineColor:F.tableHeaderColumnLineColor,_columnLineVisible:F.tableHeaderColumnLineVisible,_sortDescIcon:F.tableHeaderSortDescIcon,_sortAscIcon:F.tableHeaderSortAscIcon,_moveBackground:F.tableHeaderMoveBackground,_insertColor:F.tableHeaderInsertColor,_indent:Lm,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(G){return G.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(N){return N.getColor()||this._labelColor},getLabelAlign:function(C){return C._align},onPropertyChanged:function(){this.iv()},_5Q:function(A){this._61I=A,this.iv()},getLogicalPoint:function(G){return Ub(G,this._canvas,this.tv.tx())},validateImpl:function(){var A=this,y=A._canvas,S=A.getWidth(),K=A.getHeight(),E=A.tv,x=A._60I,Z=A._61I,i=-E.tx(),s=0;(S!==y.clientWidth||K!==y.clientHeight)&&lr(y,S,K),x.clear(),A._39o._roots.each(function(B){if(B.isVisible()){var u=s+B.getWidth();i+S>=s&&u>=i&&x.add({column:B,startX:s}),s=u}});var W=Hr(y);if(zm(W,-i,0,1),W.beginPath(),W.rect(i,0,S,K),W.clip(),W.clearRect(i,0,S,K),x.each(function(u){var _=u.column,I=u.startX,J=_.getWidth();J>0&&(W.save(),W.beginPath(),W.rect(I,0,J,K),W.clip(),Z&&Z.column===_||A.drawColumn(W,_,I,0,J,K),A._columnLineVisible&&Pe(W,I+J-1,0,1,K,A._columnLineColor),W.restore())}),Z){var B=Z.column,s=Z.startX,N=Z.position,g=B.getWidth();W.save(),W.beginPath(),W.rect(s,0,g,K),W.clip(),W.fillStyle=A._moveBackground,W.fill(),A.drawColumn(W,B,s,0,g,K),W.restore(),Po(W,A._insertColor,N,0,K)}W.restore()},_6Q:function(d){var _=this.tv;return _._31o===d&&_.sm().getSelectionMode()===Pk},drawColumn:function(s,x,M,G,o,K){var v=this,J=v.tv,Z=Hf(x.getIcon()),_=v.getLabelAlign(x);if(v._6Q(x)){var Q=Hf(v._checkIcon);dg(s,Q,M+o/2,G+K/2,x,v)}else{var t=v.getLabel(x),n=v.getLabelFont(x),b=v.getLabelColor(x),A=Zj(n,t).width,r=Z?v._indent:0;_===Km?(Z&&wo(s,Z,Pg,M,G,r,K),Kh(s,t,n,b,M+r,G,o,K,Km)):_===_i?(Z&&wo(s,Z,Pg,M+o-A-r,G,r,K),Kh(s,t,n,b,M,G,o,K,_i)):(Z&&wo(s,Z,Pg,M+(o-A-r)/2,G,r,K),Kh(s,t,n,b,M+(o-A+r)/2,G,0,K,Km))}if(x.isSortable()&&J.getSortColumn()===x&&(Z=Hf(x.getSortOrder()===Wq?v._sortAscIcon:v._sortDescIcon))){var W=li(Z,x)/2+2;dg(s,Z,_===_i?M+W:M+o-W,G+K/2,x,J)}}});var mi=function(M){var K=this;K.th=M,K.tv=M._tableView,K.addListeners()};$o(mi,r,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(u){this.getView().style.cursor=u},handle_mousemove:function(A){if(!yd){var B=this;delete B._29o,B.setCursor(Cq);for(var i=B.th,e=i._60I,x=i.lp(A).x,h=e.size()-1;h>=0;h--){var L=e.get(h),Q=L.column,H=L.startX+Q.getWidth();if(i.isResizable()&&j(H-x)<=(Qr?10:3))return B._29o=L,B.setCursor(lo),void 0;x>L.startX&&H>x&&(B._29o=L),(Q.isClickable()||Q.isSortable()||i.isMovable()||B.tv.getCheckColumn&&Q===B.tv.getCheckColumn())&&x>L.startX&&H>x&&B.setCursor(Ob)}}},handle_mousedown:function(n){this.handle_touchstart(n)},handle_touchstart:function(x){var o=this;_l(x),o.tv.endEditing(),o.handle_mousemove(x),o._29o&&(o.x=vd(x).x,o.lx=o.th.lp(x).x,o.w=o._29o.column.getWidth(),Pb(o,x))},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(U){var S=this,O=S.th,f=S.getView().style.cursor,h=S._29o,n=vd(U).x-S.x;if(S.resizing||S.moving||(f===lo?S.resizing=1:O.isMovable()&&f===Ob&&j(n)>2&&(S.moving=1)),S.resizing)h.column.setWidth(S.w+n);else if(S.moving){var q=S.lx+n;O._60I.each(function(V){var b=V.startX,$=b+V.column.getWidth();if(q>=b&&$>=q){var N={column:h.column,startX:h.startX+n,front:$-q>q-b,insertColumn:V.column};N.position=N.front?b:$,O._5Q(N)}})}},_16Q:function(d,U){var E=this,Z=E.tv,v=E.th,J=v._checkIcon;if(v._6Q(d)){var W=Hf(J),i=E.lx,r=d.getWidth(),B=li(W,d);if(i>=U+r/2-B&&U+r/2+B>=i){v.setCheckIcon(J===Sb?Sf:Sb);var N=Z.sm(),S=Z._rows;return J===Sb?N.rs(S):N.ss(S),Z.onCheckColumnClicked(d),!0}}return!1},handleWindowMouseUp:function(F){this.handleWindowTouchEnd(F)},handleWindowTouchEnd:function(y){var v=this,N=v.tv,k=v.th,m=v._29o;if(v.moving){var H=k._61I;if(H&&H.insertColumn!==H.column){var D=H.column,a=N.getColumnModel()._roots,l=a.remove(D),V=a.indexOf(H.insertColumn);V>=0&&(H.front||V++,V<=a.size()&&(a.add(D,V),N.getColumnModel()._38I(D,l,V)))}k._5Q(d),delete v.moving}else if(!v.resizing&&m){D=m.column;var n=k.lp(y).x,_=m.startX,X=!0;if(k.onColumnClicked){var S=k.onColumnClicked(D,y,_);S===!1&&(X=!1)}if(X&&n>=_&&n<=_+D.getWidth()&&!v._16Q(D,_)){if(D.isSortable()){var U=N.getSortMode(),F=D.getSortOrder();U===il?N.getSortColumn()===D?(F===dh&&N.setSortColumn(d),D.setSortOrder(F===Wq?dh:Wq)):N.setSortColumn(D):"bistate"===U&&(N.getSortColumn()===D?D.setSortOrder(F===Wq?dh:Wq):N.setSortColumn(D))}N.onColumnClicked(D,y,_)}}v._29o=v.resizing=v.x=v.lx=v.w=d}}),an.TablePane=function(f){this.init(new cj(f))},ho("TablePane",r,{ms_v:1,_44o:1}),an.TreeTablePane=function(U){this.init(new ob(U))},ho("TreeTablePane",r,{ms_v:1,_44o:1}),an.Toolbar=function(k){var q=this,u=q._view=up(1,q),w=u.style;w.background=F.toolbarBackground||"",w.height=wl+Cf,q._canvas=Ni(u),q._30o=new nm,q._90I=new nm,q.setItems(k||[]),u.handleGroupSelectedChanged=function(R){if(R.isSelected()){var S=R.getGroupId();null!=S&&q._items.forEach(function(P){var x=P.element;x&&x!==R&&x.setSelected&&x.getGroupId&&x.getGroupId()===S&&x.setSelected(!1)})}},new Ef(q)},ho("Toolbar",r,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Mh,Dk,Tk,Ih,sk,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:F.toolbarLabelColor,_labelSelectColor:F.toolbarLabelSelectColor,_labelFont:F.toolbarLabelFont,_selectBackground:F.toolbarSelectBackground,_itemGap:F.toolbarItemGap,_separatorColor:F.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(R){var e=this.getItemInfoAt(R);return e?e.item.toolTip:d},getLabelColor:function(Y){return Y&&Y.selected&&Y.type!==Sb&&Y.type!==Mb?this._labelSelectColor:this._labelColor},onPropertyChanged:function(L){this.iv(),L.property===Mh&&this._items.forEach(function(b){Cj(b)})},redraw:function(){this.iv()},addItem:function(w,x){var F=this._items;x==d?F.push(w):F.splice(x,0,w),this.fp(Mh,d,F)},removeItem:function(A){if(A)for(var k=this._items,g=0;g<k.length;g++)A===k[g]&&(k.splice(g,1),this.fp(Mh,d,k))},removeItemById:function(j){if(j!=d)for(var w=this._items,S=0;S<w.length;S++)if(j===w[S].id){var $=w.splice(S,1)[0];return this.fp(Mh,d,w),$}},getItemById:function(r){if(r!=d)for(var t=this._items,F=0;F<t.length;F++){var i=t[F];if(r===i.id)return i}},setItemVisible:function(l,G){var E=this.getItemById(l);E&&(E.visible=G)},getItemInfos:function(){return this._30o},getItemInfoAt:function(J){var v=this,$=0,c=v._30o,T=v.lp(J),z=T.x,G=T.y;if(G>=0&&G<=v.getHeight())for(;$<c.size();$++){var w=c.get($);if(w.startX<=z&&z<=w.endX)return w}return d},drawItem:function(J,Q,h,w,U){if(Q.visible===!1)return 0;if(sr(Q.visible)&&!Q.visible())return 0;var q=this,e=Q.disabled;e&&(J.globalAlpha=dc);var B=q.drawItemImpl(J,Q,h,w,U),T=q._itemGap;return e&&(J.globalAlpha=1),this._currentItem!==Q||"separator"===Q||Q.separator===!0||Q.unfocusable||rl(J,q._separatorColor,h-T/2,0,B+T,w),B},drawItemImpl:function($,f,J,W,u){var Y=this,r=Y._view,n=Y._itemGap,z=W/2,D=f.type,i=f.element,N=f.label;Jp(i)&&(N=i,i=d);var a,I=Y.getLabelFont(f),v=Y.getLabelColor(f),o=f.selected,l=Hf(f.icon),H=li(l,f),C=0,y=H+(N?Zj(I,N).width:0);if("separator"===f||f.separator===!0)return Po($,Y._separatorColor,J,W/4,z),1;if(i){l&&dg($,l,J+H/2,z,f,Y),Kh($,N,I,v,J+H,0,0,W);var U=Wd(i);u||Y._90I.add(U),U.parentNode!==r&&oq(r,U),i.iv&&i.iv(),i.validate&&i.validate();var q=U.getBoundingClientRect(),P=q.width,p=U.style;return Sh(U),p.left=Y.tx()+J+y+Cf,p.top=(W-q.height)/2+Cf,y+P}return D===Mb?a=Hf(o?Lq:Pc):D===Sb&&(a=Hf(o?Sb:Sf)),a?(C=li(a,f),dg($,a,J+C/2,z,f,Y),J+=C,y+=C):o&&Pe($,J-n/2,0,y+n,W,Y.getSelectBackground(f)),l&&dg($,l,J+H/2,z,f,Y),Kh($,N,I,v,J+H,0,0,W),y},validateImpl:function(){var Q=this,A=Q._canvas,P=Q.getWidth(),D=Q.getHeight(),F=Q._30o,$=Q._items;lr(A,P,D);var h=Hr(A),j=Q._itemGap,a=j/2;zm(h,Q.tx(),0,1),h.clearRect(0,0,P,D);var p=Q._90I;Q._90I=new nm,F.clear(),$.forEach(function(n){var I=Q.drawItem(h,n,a,D);F.add({item:n,startX:a,endX:a+I,width:I}),I&&(a+=I+j)}),p.each(function(u){Q._90I.contains(u)||Hq(u)});var N=Q._64I;Q._64I=T(0,a),h.restore(),Q._stickToRight?(Q._65O=0,h=Hr(A),a=P-Q._64I+j,zm(h,0,0,1),h.clearRect(0,0,P,D),F.clear(),$.forEach(function(W){var N=Q.drawItem(h,W,a,D,!0);F.add({item:W,startX:a,endX:a+N,width:N}),N&&(a+=N+j)}),h.restore()):Q.tx(Q.tx()),N!==Q._64I&&Q.onSumWidthChanged(N,Q._64I)},onSumWidthChanged:function(){},handleClick:function(W,E){var b=this,u=W.type,e=W.action,H=W.groupId,S=W.selected;W.disabled||(H!=d?S||(W.selected=!0,this._items.forEach(function(j){j.groupId===H&&W!==j&&(j.selected=!1)}),e&&W.action(W,b,E)):u===Sb||"toggle"===u?(W.selected=!S,e&&W.action(W,b,E)):e&&W.action(W,b,E)),de(),b.iv()}});var Ef=function(h){this.tb=h,this.addListeners()};$o(Ef,r,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(h){this.handleScroll(h,10*(h.wheelDelta/40))},handle_DOMMouseScroll:function(n){this.handleScroll(n,10*-n.detail)},handleScroll:function(K,m){_l(K);var G=this.tb;G.isScrollable()&&!G._stickToRight&&(G.tx(G.tx()+m),og())},handle_mousemove:function(l){var H=this;yd||H.setItem(l)},handle_mouseout:function(Z){var V=this;Z.target===V.getView()?V.tb.setCurrentItem(d):V.handle_mousemove(Z)},handle_mousedown:function(q){this.handle_mousemove(q),this.handle_touchstart(q)},handle_touchstart:function(P){var T=this,W=T.tb,m=P.target;fs(P)&&(m===T.getView()||m===W._canvas)&&(_l(P),W.setFocus(P)&&(this.setItem(P,!0),(W.isScrollable()||T.info&&!T.info.item.disabled)&&(T.x=vd(P).x,T.tx=W.tx(),Pb(T,P))))},handleWindowMouseMove:function(m){this.handleWindowTouchMove(m)},handleWindowTouchMove:function(w){var N=this,S=N.tb;if(!S._stickToRight){var D=vd(w).x-N.x;!N._25o&&j(D)>2&&S.isScrollable()&&(N._25o=1),N._25o&&S.tx(N.tx+D)}},handleWindowMouseUp:function(k){this.handleWindowTouchEnd(k)},handleWindowTouchEnd:function(L){var F=this,Y=F.tb,T=F.info,Z=F.tb.getItemInfoAt(L);if(!F._25o&&T){var V=T.item;Z&&Z.item===V&&Y.handleClick(V,L)}F._25o=F.x=F.tx=d,F.setItem()},setItem:function(J,p){var M=this,V=M.tb,h=M.info=J?V.getItemInfoAt(J):d,X=h?h.item:d;V.setCurrentItem(X),p&&X&&sr(X.onDown)&&X.onDown(J)}}),an.BorderPane=function(){this._view=up(1,this),this.iv()},ho("BorderPane",r,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(O,G){this._12o("leftView",O),G!=d&&this.setLeftWidth(G)},getRightView:function(){return this._rightView},setRightView:function(k,g){this._12o("rightView",k),g!=d&&this.setRightWidth(g)},getTopView:function(){return this._topView},setTopView:function(L,r){this._12o("topView",L),r!=d&&this.setTopHeight(r)},getBottomView:function(){return this._bottomView},setBottomView:function(J,w){this._12o("bottomView",J),w!=d&&this.setBottomHeight(w)},getCenterView:function(){return this._centerView},setCenterView:function(F){this._12o("centerView",F)},_12o:function(Q,l){var I=this,D="_"+Q,K=I._view,Z=I[D];Z!==l&&(Z&&(Z.getView?Hq(Z.getView()):Hq(Z)),I[D]=l,l&&(l.getView?oq(K,l.getView(),1):oq(K,l,1)),I.fp(Q,Z,l))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var P=this,I=P._topView,w=P._bottomView,Z=P._leftView,X=P._rightView,t=P._centerView,p=P.getWidth(),Q=P.getHeight(),q=0,D=0,L=p,i=Q,s=0,B=0,j=0,l=0;I&&(s=P._topHeight==d?Rc(I):P._topHeight,D=s),w&&(B=P._bottomHeight==d?Rc(w):P._bottomHeight,i=Q-B),Z&&(j=P._leftWidth==d?ll(Z):P._leftWidth,q=j),X&&(l=P._rightWidth==d?ll(X):P._rightWidth,L=p-l);var S=T(0,L-q),a=T(0,i-D);I&&Hi(I,0,0,p,s),w&&Hi(w,0,i,p,B),Z&&Hi(Z,0,D,j,a),X&&Hi(X,L,D,l,a),t&&Hi(t,q,D,S,a)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);